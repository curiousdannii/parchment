{
  "version": 3,
  "sources": ["../../node_modules/js-cookie/dist/js.cookie.mjs", "../../node_modules/lodash-es/_freeGlobal.js", "../../node_modules/lodash-es/_root.js", "../../node_modules/lodash-es/_Symbol.js", "../../node_modules/lodash-es/_getRawTag.js", "../../node_modules/lodash-es/_objectToString.js", "../../node_modules/lodash-es/_baseGetTag.js", "../../node_modules/lodash-es/isObjectLike.js", "../../node_modules/lodash-es/isSymbol.js", "../../node_modules/lodash-es/_arrayMap.js", "../../node_modules/lodash-es/isArray.js", "../../node_modules/lodash-es/_baseToString.js", "../../node_modules/lodash-es/_trimmedEndIndex.js", "../../node_modules/lodash-es/_baseTrim.js", "../../node_modules/lodash-es/isObject.js", "../../node_modules/lodash-es/toNumber.js", "../../node_modules/lodash-es/isFunction.js", "../../node_modules/lodash-es/_coreJsData.js", "../../node_modules/lodash-es/_isMasked.js", "../../node_modules/lodash-es/_toSource.js", "../../node_modules/lodash-es/_baseIsNative.js", "../../node_modules/lodash-es/_getValue.js", "../../node_modules/lodash-es/_getNative.js", "../../node_modules/lodash-es/_WeakMap.js", "../../node_modules/lodash-es/_baseCreate.js", "../../node_modules/lodash-es/_copyArray.js", "../../node_modules/lodash-es/_defineProperty.js", "../../node_modules/lodash-es/_arrayEach.js", "../../node_modules/lodash-es/_isIndex.js", "../../node_modules/lodash-es/_baseAssignValue.js", "../../node_modules/lodash-es/eq.js", "../../node_modules/lodash-es/_assignValue.js", "../../node_modules/lodash-es/_copyObject.js", "../../node_modules/lodash-es/isLength.js", "../../node_modules/lodash-es/isArrayLike.js", "../../node_modules/lodash-es/_isPrototype.js", "../../node_modules/lodash-es/_baseTimes.js", "../../node_modules/lodash-es/_baseIsArguments.js", "../../node_modules/lodash-es/isArguments.js", "../../node_modules/lodash-es/stubFalse.js", "../../node_modules/lodash-es/isBuffer.js", "../../node_modules/lodash-es/_baseIsTypedArray.js", "../../node_modules/lodash-es/_baseUnary.js", "../../node_modules/lodash-es/_nodeUtil.js", "../../node_modules/lodash-es/isTypedArray.js", "../../node_modules/lodash-es/_arrayLikeKeys.js", "../../node_modules/lodash-es/_overArg.js", "../../node_modules/lodash-es/_nativeKeys.js", "../../node_modules/lodash-es/_baseKeys.js", "../../node_modules/lodash-es/keys.js", "../../node_modules/lodash-es/_nativeKeysIn.js", "../../node_modules/lodash-es/_baseKeysIn.js", "../../node_modules/lodash-es/keysIn.js", "../../node_modules/lodash-es/_nativeCreate.js", "../../node_modules/lodash-es/_hashClear.js", "../../node_modules/lodash-es/_hashDelete.js", "../../node_modules/lodash-es/_hashGet.js", "../../node_modules/lodash-es/_hashHas.js", "../../node_modules/lodash-es/_hashSet.js", "../../node_modules/lodash-es/_Hash.js", "../../node_modules/lodash-es/_listCacheClear.js", "../../node_modules/lodash-es/_assocIndexOf.js", "../../node_modules/lodash-es/_listCacheDelete.js", "../../node_modules/lodash-es/_listCacheGet.js", "../../node_modules/lodash-es/_listCacheHas.js", "../../node_modules/lodash-es/_listCacheSet.js", "../../node_modules/lodash-es/_ListCache.js", "../../node_modules/lodash-es/_Map.js", "../../node_modules/lodash-es/_mapCacheClear.js", "../../node_modules/lodash-es/_isKeyable.js", "../../node_modules/lodash-es/_getMapData.js", "../../node_modules/lodash-es/_mapCacheDelete.js", "../../node_modules/lodash-es/_mapCacheGet.js", "../../node_modules/lodash-es/_mapCacheHas.js", "../../node_modules/lodash-es/_mapCacheSet.js", "../../node_modules/lodash-es/_MapCache.js", "../../node_modules/lodash-es/toString.js", "../../node_modules/lodash-es/_arrayPush.js", "../../node_modules/lodash-es/_getPrototype.js", "../../node_modules/lodash-es/_basePropertyOf.js", "../../node_modules/lodash-es/_stackClear.js", "../../node_modules/lodash-es/_stackDelete.js", "../../node_modules/lodash-es/_stackGet.js", "../../node_modules/lodash-es/_stackHas.js", "../../node_modules/lodash-es/_stackSet.js", "../../node_modules/lodash-es/_Stack.js", "../../node_modules/lodash-es/_baseAssign.js", "../../node_modules/lodash-es/_baseAssignIn.js", "../../node_modules/lodash-es/_cloneBuffer.js", "../../node_modules/lodash-es/_arrayFilter.js", "../../node_modules/lodash-es/stubArray.js", "../../node_modules/lodash-es/_getSymbols.js", "../../node_modules/lodash-es/_copySymbols.js", "../../node_modules/lodash-es/_getSymbolsIn.js", "../../node_modules/lodash-es/_copySymbolsIn.js", "../../node_modules/lodash-es/_baseGetAllKeys.js", "../../node_modules/lodash-es/_getAllKeys.js", "../../node_modules/lodash-es/_getAllKeysIn.js", "../../node_modules/lodash-es/_DataView.js", "../../node_modules/lodash-es/_Promise.js", "../../node_modules/lodash-es/_Set.js", "../../node_modules/lodash-es/_getTag.js", "../../node_modules/lodash-es/_initCloneArray.js", "../../node_modules/lodash-es/_Uint8Array.js", "../../node_modules/lodash-es/_cloneArrayBuffer.js", "../../node_modules/lodash-es/_cloneDataView.js", "../../node_modules/lodash-es/_cloneRegExp.js", "../../node_modules/lodash-es/_cloneSymbol.js", "../../node_modules/lodash-es/_cloneTypedArray.js", "../../node_modules/lodash-es/_initCloneByTag.js", "../../node_modules/lodash-es/_initCloneObject.js", "../../node_modules/lodash-es/_baseIsMap.js", "../../node_modules/lodash-es/isMap.js", "../../node_modules/lodash-es/_baseIsSet.js", "../../node_modules/lodash-es/isSet.js", "../../node_modules/lodash-es/_baseClone.js", "../../node_modules/lodash-es/cloneDeep.js", "../../node_modules/lodash-es/now.js", "../../node_modules/lodash-es/debounce.js", "../../node_modules/lodash-es/throttle.js", "../../node_modules/lodash-es/_unescapeHtmlChar.js", "../../node_modules/lodash-es/unescape.js", "../../src/upstream/asyncglk/src/common/misc.ts", "../../src/upstream/asyncglk/src/blorb/iff.ts", "../../src/upstream/asyncglk/src/blorb/blorb.ts", "../../src/upstream/asyncglk/src/common/constants.ts", "../../src/upstream/asyncglk/src/glkapi/constants.ts", "../../src/upstream/asyncglk/src/dialog/common/cache.ts", "../../src/upstream/asyncglk/src/glkapi/common.ts", "../../src/upstream/asyncglk/src/glkapi/filerefs.ts", "../../src/upstream/asyncglk/src/glkapi/interface.ts", "../../src/upstream/asyncglk/src/glkapi/lib_constants.ts", "../../src/upstream/asyncglk/src/glkapi/streams.ts", "../../src/upstream/asyncglk/src/glkapi/windows.ts", "../../src/upstream/asyncglk/src/glkapi/glkapi.ts", "../../src/upstream/asyncglk/src/glkote/common/glkote.ts", "../../src/upstream/asyncglk/src/glkote/web/shared.ts", "../../src/upstream/asyncglk/src/glkote/web/metrics.ts", "../../src/upstream/asyncglk/src/glkote/web/transcript-recorder.ts", "../../src/upstream/asyncglk/src/glkote/web/input.ts", "../../src/upstream/asyncglk/src/glkote/web/windows.ts", "../../src/upstream/asyncglk/src/glkote/web/web.ts", "../../node_modules/base32768/src/index.js", "../../src/upstream/glkote/dialog.js", "../../src/upstream/glkote/glkapi.js", "../../src/common/options.ts", "../../src/common/file.ts", "../../src/common/formats.ts", "../../src/common/launcher.ts"],
  "sourcesContent": ["/*! js-cookie v3.0.5 | MIT */\n/* eslint-disable no-var */\nfunction assign (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      target[key] = source[key];\n    }\n  }\n  return target\n}\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\nvar defaultConverter = {\n  read: function (value) {\n    if (value[0] === '\"') {\n      value = value.slice(1, -1);\n    }\n    return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n  },\n  write: function (value) {\n    return encodeURIComponent(value).replace(\n      /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n      decodeURIComponent\n    )\n  }\n};\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\n\nfunction init (converter, defaultAttributes) {\n  function set (name, value, attributes) {\n    if (typeof document === 'undefined') {\n      return\n    }\n\n    attributes = assign({}, defaultAttributes, attributes);\n\n    if (typeof attributes.expires === 'number') {\n      attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n    }\n    if (attributes.expires) {\n      attributes.expires = attributes.expires.toUTCString();\n    }\n\n    name = encodeURIComponent(name)\n      .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n      .replace(/[()]/g, escape);\n\n    var stringifiedAttributes = '';\n    for (var attributeName in attributes) {\n      if (!attributes[attributeName]) {\n        continue\n      }\n\n      stringifiedAttributes += '; ' + attributeName;\n\n      if (attributes[attributeName] === true) {\n        continue\n      }\n\n      // Considers RFC 6265 section 5.2:\n      // ...\n      // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n      //     character:\n      // Consume the characters of the unparsed-attributes up to,\n      // not including, the first %x3B (\";\") character.\n      // ...\n      stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n    }\n\n    return (document.cookie =\n      name + '=' + converter.write(value, name) + stringifiedAttributes)\n  }\n\n  function get (name) {\n    if (typeof document === 'undefined' || (arguments.length && !name)) {\n      return\n    }\n\n    // To prevent the for loop in the first place assign an empty array\n    // in case there are no cookies at all.\n    var cookies = document.cookie ? document.cookie.split('; ') : [];\n    var jar = {};\n    for (var i = 0; i < cookies.length; i++) {\n      var parts = cookies[i].split('=');\n      var value = parts.slice(1).join('=');\n\n      try {\n        var found = decodeURIComponent(parts[0]);\n        jar[found] = converter.read(value, found);\n\n        if (name === found) {\n          break\n        }\n      } catch (e) {}\n    }\n\n    return name ? jar[name] : jar\n  }\n\n  return Object.create(\n    {\n      set,\n      get,\n      remove: function (name, attributes) {\n        set(\n          name,\n          '',\n          assign({}, attributes, {\n            expires: -1\n          })\n        );\n      },\n      withAttributes: function (attributes) {\n        return init(this.converter, assign({}, this.attributes, attributes))\n      },\n      withConverter: function (converter) {\n        return init(assign({}, this.converter, converter), this.attributes)\n      }\n    },\n    {\n      attributes: { value: Object.freeze(defaultAttributes) },\n      converter: { value: Object.freeze(converter) }\n    }\n  )\n}\n\nvar api = init(defaultConverter, { path: '/' });\n/* eslint-enable no-var */\n\nexport { api as default };\n", "/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n", "import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n", "import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n", "import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n", "/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n", "import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n", "/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n", "import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n", "/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nexport default arrayMap;\n", "/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n", "import Symbol from './_Symbol.js';\nimport arrayMap from './_arrayMap.js';\nimport isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default baseToString;\n", "/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nexport default trimmedEndIndex;\n", "import trimmedEndIndex from './_trimmedEndIndex.js';\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nexport default baseTrim;\n", "/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n", "import baseTrim from './_baseTrim.js';\nimport isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n", "import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n", "import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n", "import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n", "/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n", "import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n", "/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n", "import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n", "import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nexport default WeakMap;\n", "import isObject from './isObject.js';\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nexport default baseCreate;\n", "/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nexport default copyArray;\n", "import getNative from './_getNative.js';\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nexport default defineProperty;\n", "/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nexport default arrayEach;\n", "/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nexport default isIndex;\n", "import defineProperty from './_defineProperty.js';\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nexport default baseAssignValue;\n", "/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n", "import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignValue;\n", "import assignValue from './_assignValue.js';\nimport baseAssignValue from './_baseAssignValue.js';\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nexport default copyObject;\n", "/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nexport default isLength;\n", "import isFunction from './isFunction.js';\nimport isLength from './isLength.js';\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nexport default isArrayLike;\n", "/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nexport default isPrototype;\n", "/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nexport default baseTimes;\n", "import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n", "import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n", "/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nexport default stubFalse;\n", "import root from './_root.js';\nimport stubFalse from './stubFalse.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nexport default isBuffer;\n", "import baseGetTag from './_baseGetTag.js';\nimport isLength from './isLength.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nexport default baseIsTypedArray;\n", "/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nexport default baseUnary;\n", "import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nexport default nodeUtil;\n", "import baseIsTypedArray from './_baseIsTypedArray.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nexport default isTypedArray;\n", "import baseTimes from './_baseTimes.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isIndex from './_isIndex.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default arrayLikeKeys;\n", "/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n", "import overArg from './_overArg.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nexport default nativeKeys;\n", "import isPrototype from './_isPrototype.js';\nimport nativeKeys from './_nativeKeys.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeys;\n", "import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeys from './_baseKeys.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nexport default keys;\n", "/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default nativeKeysIn;\n", "import isObject from './isObject.js';\nimport isPrototype from './_isPrototype.js';\nimport nativeKeysIn from './_nativeKeysIn.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeysIn;\n", "import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeysIn from './_baseKeysIn.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nexport default keysIn;\n", "import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n", "import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n", "/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n", "import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n", "import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n", "import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n", "import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n", "/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n", "import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n", "import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n", "import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n", "import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n", "import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n", "import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n", "import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n", "import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n", "/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n", "import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n", "import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n", "import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n", "import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n", "import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n", "import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n", "import baseToString from './_baseToString.js';\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nexport default toString;\n", "/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n", "import overArg from './_overArg.js';\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nexport default getPrototype;\n", "/**\n * The base implementation of `_.propertyOf` without support for deep paths.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyOf(object) {\n  return function(key) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nexport default basePropertyOf;\n", "import ListCache from './_ListCache.js';\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nexport default stackClear;\n", "/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nexport default stackDelete;\n", "/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nexport default stackGet;\n", "/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nexport default stackHas;\n", "import ListCache from './_ListCache.js';\nimport Map from './_Map.js';\nimport MapCache from './_MapCache.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nexport default stackSet;\n", "import ListCache from './_ListCache.js';\nimport stackClear from './_stackClear.js';\nimport stackDelete from './_stackDelete.js';\nimport stackGet from './_stackGet.js';\nimport stackHas from './_stackHas.js';\nimport stackSet from './_stackSet.js';\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nexport default Stack;\n", "import copyObject from './_copyObject.js';\nimport keys from './keys.js';\n\n/**\n * The base implementation of `_.assign` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssign(object, source) {\n  return object && copyObject(source, keys(source), object);\n}\n\nexport default baseAssign;\n", "import copyObject from './_copyObject.js';\nimport keysIn from './keysIn.js';\n\n/**\n * The base implementation of `_.assignIn` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssignIn(object, source) {\n  return object && copyObject(source, keysIn(source), object);\n}\n\nexport default baseAssignIn;\n", "import root from './_root.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nexport default cloneBuffer;\n", "/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nexport default arrayFilter;\n", "/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nexport default stubArray;\n", "import arrayFilter from './_arrayFilter.js';\nimport stubArray from './stubArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nexport default getSymbols;\n", "import copyObject from './_copyObject.js';\nimport getSymbols from './_getSymbols.js';\n\n/**\n * Copies own symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbols(source, object) {\n  return copyObject(source, getSymbols(source), object);\n}\n\nexport default copySymbols;\n", "import arrayPush from './_arrayPush.js';\nimport getPrototype from './_getPrototype.js';\nimport getSymbols from './_getSymbols.js';\nimport stubArray from './stubArray.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own and inherited enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n  var result = [];\n  while (object) {\n    arrayPush(result, getSymbols(object));\n    object = getPrototype(object);\n  }\n  return result;\n};\n\nexport default getSymbolsIn;\n", "import copyObject from './_copyObject.js';\nimport getSymbolsIn from './_getSymbolsIn.js';\n\n/**\n * Copies own and inherited symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbolsIn(source, object) {\n  return copyObject(source, getSymbolsIn(source), object);\n}\n\nexport default copySymbolsIn;\n", "import arrayPush from './_arrayPush.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nexport default baseGetAllKeys;\n", "import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbols from './_getSymbols.js';\nimport keys from './keys.js';\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nexport default getAllKeys;\n", "import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbolsIn from './_getSymbolsIn.js';\nimport keysIn from './keysIn.js';\n\n/**\n * Creates an array of own and inherited enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeysIn(object) {\n  return baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nexport default getAllKeysIn;\n", "import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nexport default DataView;\n", "import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nexport default Promise;\n", "import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n", "import DataView from './_DataView.js';\nimport Map from './_Map.js';\nimport Promise from './_Promise.js';\nimport Set from './_Set.js';\nimport WeakMap from './_WeakMap.js';\nimport baseGetTag from './_baseGetTag.js';\nimport toSource from './_toSource.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nexport default getTag;\n", "/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Initializes an array clone.\n *\n * @private\n * @param {Array} array The array to clone.\n * @returns {Array} Returns the initialized clone.\n */\nfunction initCloneArray(array) {\n  var length = array.length,\n      result = new array.constructor(length);\n\n  // Add properties assigned by `RegExp#exec`.\n  if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n    result.index = array.index;\n    result.input = array.input;\n  }\n  return result;\n}\n\nexport default initCloneArray;\n", "import root from './_root.js';\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nexport default Uint8Array;\n", "import Uint8Array from './_Uint8Array.js';\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nexport default cloneArrayBuffer;\n", "import cloneArrayBuffer from './_cloneArrayBuffer.js';\n\n/**\n * Creates a clone of `dataView`.\n *\n * @private\n * @param {Object} dataView The data view to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned data view.\n */\nfunction cloneDataView(dataView, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n  return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nexport default cloneDataView;\n", "/** Used to match `RegExp` flags from their coerced string values. */\nvar reFlags = /\\w*$/;\n\n/**\n * Creates a clone of `regexp`.\n *\n * @private\n * @param {Object} regexp The regexp to clone.\n * @returns {Object} Returns the cloned regexp.\n */\nfunction cloneRegExp(regexp) {\n  var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n  result.lastIndex = regexp.lastIndex;\n  return result;\n}\n\nexport default cloneRegExp;\n", "import Symbol from './_Symbol.js';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a clone of the `symbol` object.\n *\n * @private\n * @param {Object} symbol The symbol object to clone.\n * @returns {Object} Returns the cloned symbol object.\n */\nfunction cloneSymbol(symbol) {\n  return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nexport default cloneSymbol;\n", "import cloneArrayBuffer from './_cloneArrayBuffer.js';\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nexport default cloneTypedArray;\n", "import cloneArrayBuffer from './_cloneArrayBuffer.js';\nimport cloneDataView from './_cloneDataView.js';\nimport cloneRegExp from './_cloneRegExp.js';\nimport cloneSymbol from './_cloneSymbol.js';\nimport cloneTypedArray from './_cloneTypedArray.js';\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Initializes an object clone based on its `toStringTag`.\n *\n * **Note:** This function only supports cloning values with tags of\n * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n *\n * @private\n * @param {Object} object The object to clone.\n * @param {string} tag The `toStringTag` of the object to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneByTag(object, tag, isDeep) {\n  var Ctor = object.constructor;\n  switch (tag) {\n    case arrayBufferTag:\n      return cloneArrayBuffer(object);\n\n    case boolTag:\n    case dateTag:\n      return new Ctor(+object);\n\n    case dataViewTag:\n      return cloneDataView(object, isDeep);\n\n    case float32Tag: case float64Tag:\n    case int8Tag: case int16Tag: case int32Tag:\n    case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n      return cloneTypedArray(object, isDeep);\n\n    case mapTag:\n      return new Ctor;\n\n    case numberTag:\n    case stringTag:\n      return new Ctor(object);\n\n    case regexpTag:\n      return cloneRegExp(object);\n\n    case setTag:\n      return new Ctor;\n\n    case symbolTag:\n      return cloneSymbol(object);\n  }\n}\n\nexport default initCloneByTag;\n", "import baseCreate from './_baseCreate.js';\nimport getPrototype from './_getPrototype.js';\nimport isPrototype from './_isPrototype.js';\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nexport default initCloneObject;\n", "import getTag from './_getTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]';\n\n/**\n * The base implementation of `_.isMap` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n */\nfunction baseIsMap(value) {\n  return isObjectLike(value) && getTag(value) == mapTag;\n}\n\nexport default baseIsMap;\n", "import baseIsMap from './_baseIsMap.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsMap = nodeUtil && nodeUtil.isMap;\n\n/**\n * Checks if `value` is classified as a `Map` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n * @example\n *\n * _.isMap(new Map);\n * // => true\n *\n * _.isMap(new WeakMap);\n * // => false\n */\nvar isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\nexport default isMap;\n", "import getTag from './_getTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar setTag = '[object Set]';\n\n/**\n * The base implementation of `_.isSet` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n */\nfunction baseIsSet(value) {\n  return isObjectLike(value) && getTag(value) == setTag;\n}\n\nexport default baseIsSet;\n", "import baseIsSet from './_baseIsSet.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsSet = nodeUtil && nodeUtil.isSet;\n\n/**\n * Checks if `value` is classified as a `Set` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n * @example\n *\n * _.isSet(new Set);\n * // => true\n *\n * _.isSet(new WeakSet);\n * // => false\n */\nvar isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\nexport default isSet;\n", "import Stack from './_Stack.js';\nimport arrayEach from './_arrayEach.js';\nimport assignValue from './_assignValue.js';\nimport baseAssign from './_baseAssign.js';\nimport baseAssignIn from './_baseAssignIn.js';\nimport cloneBuffer from './_cloneBuffer.js';\nimport copyArray from './_copyArray.js';\nimport copySymbols from './_copySymbols.js';\nimport copySymbolsIn from './_copySymbolsIn.js';\nimport getAllKeys from './_getAllKeys.js';\nimport getAllKeysIn from './_getAllKeysIn.js';\nimport getTag from './_getTag.js';\nimport initCloneArray from './_initCloneArray.js';\nimport initCloneByTag from './_initCloneByTag.js';\nimport initCloneObject from './_initCloneObject.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isMap from './isMap.js';\nimport isObject from './isObject.js';\nimport isSet from './isSet.js';\nimport keys from './keys.js';\nimport keysIn from './keysIn.js';\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values supported by `_.clone`. */\nvar cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\ncloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\ncloneableTags[boolTag] = cloneableTags[dateTag] =\ncloneableTags[float32Tag] = cloneableTags[float64Tag] =\ncloneableTags[int8Tag] = cloneableTags[int16Tag] =\ncloneableTags[int32Tag] = cloneableTags[mapTag] =\ncloneableTags[numberTag] = cloneableTags[objectTag] =\ncloneableTags[regexpTag] = cloneableTags[setTag] =\ncloneableTags[stringTag] = cloneableTags[symbolTag] =\ncloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\ncloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\ncloneableTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n * traversed objects.\n *\n * @private\n * @param {*} value The value to clone.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Deep clone\n *  2 - Flatten inherited properties\n *  4 - Clone symbols\n * @param {Function} [customizer] The function to customize cloning.\n * @param {string} [key] The key of `value`.\n * @param {Object} [object] The parent object of `value`.\n * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n * @returns {*} Returns the cloned value.\n */\nfunction baseClone(value, bitmask, customizer, key, object, stack) {\n  var result,\n      isDeep = bitmask & CLONE_DEEP_FLAG,\n      isFlat = bitmask & CLONE_FLAT_FLAG,\n      isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n  if (customizer) {\n    result = object ? customizer(value, key, object, stack) : customizer(value);\n  }\n  if (result !== undefined) {\n    return result;\n  }\n  if (!isObject(value)) {\n    return value;\n  }\n  var isArr = isArray(value);\n  if (isArr) {\n    result = initCloneArray(value);\n    if (!isDeep) {\n      return copyArray(value, result);\n    }\n  } else {\n    var tag = getTag(value),\n        isFunc = tag == funcTag || tag == genTag;\n\n    if (isBuffer(value)) {\n      return cloneBuffer(value, isDeep);\n    }\n    if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n      result = (isFlat || isFunc) ? {} : initCloneObject(value);\n      if (!isDeep) {\n        return isFlat\n          ? copySymbolsIn(value, baseAssignIn(result, value))\n          : copySymbols(value, baseAssign(result, value));\n      }\n    } else {\n      if (!cloneableTags[tag]) {\n        return object ? value : {};\n      }\n      result = initCloneByTag(value, tag, isDeep);\n    }\n  }\n  // Check for circular references and return its corresponding clone.\n  stack || (stack = new Stack);\n  var stacked = stack.get(value);\n  if (stacked) {\n    return stacked;\n  }\n  stack.set(value, result);\n\n  if (isSet(value)) {\n    value.forEach(function(subValue) {\n      result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n    });\n  } else if (isMap(value)) {\n    value.forEach(function(subValue, key) {\n      result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n    });\n  }\n\n  var keysFunc = isFull\n    ? (isFlat ? getAllKeysIn : getAllKeys)\n    : (isFlat ? keysIn : keys);\n\n  var props = isArr ? undefined : keysFunc(value);\n  arrayEach(props || value, function(subValue, key) {\n    if (props) {\n      key = subValue;\n      subValue = value[key];\n    }\n    // Recursively populate clone (susceptible to call stack limits).\n    assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n  });\n  return result;\n}\n\nexport default baseClone;\n", "import baseClone from './_baseClone.js';\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * This method is like `_.clone` except that it recursively clones `value`.\n *\n * @static\n * @memberOf _\n * @since 1.0.0\n * @category Lang\n * @param {*} value The value to recursively clone.\n * @returns {*} Returns the deep cloned value.\n * @see _.clone\n * @example\n *\n * var objects = [{ 'a': 1 }, { 'b': 2 }];\n *\n * var deep = _.cloneDeep(objects);\n * console.log(deep[0] === objects[0]);\n * // => false\n */\nfunction cloneDeep(value) {\n  return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n}\n\nexport default cloneDeep;\n", "import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n", "import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n", "import debounce from './debounce.js';\nimport isObject from './isObject.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nexport default throttle;\n", "import basePropertyOf from './_basePropertyOf.js';\n\n/** Used to map HTML entities to characters. */\nvar htmlUnescapes = {\n  '&amp;': '&',\n  '&lt;': '<',\n  '&gt;': '>',\n  '&quot;': '\"',\n  '&#39;': \"'\"\n};\n\n/**\n * Used by `_.unescape` to convert HTML entities to characters.\n *\n * @private\n * @param {string} chr The matched character to unescape.\n * @returns {string} Returns the unescaped character.\n */\nvar unescapeHtmlChar = basePropertyOf(htmlUnescapes);\n\nexport default unescapeHtmlChar;\n", "import toString from './toString.js';\nimport unescapeHtmlChar from './_unescapeHtmlChar.js';\n\n/** Used to match HTML entities and HTML characters. */\nvar reEscapedHtml = /&(?:amp|lt|gt|quot|#39);/g,\n    reHasEscapedHtml = RegExp(reEscapedHtml.source);\n\n/**\n * The inverse of `_.escape`; this method converts the HTML entities\n * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to\n * their corresponding characters.\n *\n * **Note:** No other HTML entities are unescaped. To unescape additional\n * HTML entities use a third-party library like [_he_](https://mths.be/he).\n *\n * @static\n * @memberOf _\n * @since 0.6.0\n * @category String\n * @param {string} [string=''] The string to unescape.\n * @returns {string} Returns the unescaped string.\n * @example\n *\n * _.unescape('fred, barney, &amp; pebbles');\n * // => 'fred, barney, & pebbles'\n */\nfunction unescape(string) {\n  string = toString(string);\n  return (string && reHasEscapedHtml.test(string))\n    ? string.replace(reEscapedHtml, unescapeHtmlChar)\n    : string;\n}\n\nexport default unescape;\n", "/*\n\nMiscellaneous common things\n===========================\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nexport type GlkTypedArray = Uint8Array | Uint32Array\nexport type GlkTypedArrayConstructor = Uint8ArrayConstructor | Uint32ArrayConstructor\n\n/** A DataView with support for getting and setting arrays and four character codes */\nexport class FileView extends DataView {\n    constructor(array: Uint8Array);\n    constructor(buffer: ArrayBuffer, byteOffset?: number, byteLength?: number);\n    constructor(data: Uint8Array | ArrayBuffer, byteOffset?: number, byteLength?: number) {\n        if (data instanceof Uint8Array) {\n            super(data.buffer, data.byteOffset, data.byteLength)\n        }\n        else {\n            super(data, byteOffset, byteLength)\n        }\n    }\n\n    getFourCC(index: number) {\n        return String.fromCharCode(this.getUint8(index), this.getUint8(index + 1), this.getUint8(index + 2), this.getUint8(index + 3))\n    }\n\n    getUint8Subarray(index?: number, length?: number): Uint8Array {\n        return new Uint8Array(this.buffer, this.byteOffset + (index || 0), length)\n    }\n\n    setFourCC(index: number, text: string) {\n        this.setUint8(index, text.charCodeAt(0) )\n        this.setUint8(index + 1, text.charCodeAt(1))\n        this.setUint8(index + 2, text.charCodeAt(2))\n        this.setUint8(index + 3, text.charCodeAt(3))\n    }\n\n    setUint8Array(index: number, data: Uint8Array) {\n        const subarray = this.getUint8Subarray(index, data.length)\n        subarray.set(data)\n    }\n}\n\n/** Write a Uint32Array as a big-endian Uint8Array */\nexport function Array_to_BEBuffer(arr: Uint32Array) {\n    const buf = new Uint8Array(arr.length * 4)\n    const dv = new DataView(buf.buffer)\n    for (let i = 0; i < arr.length; i++) {\n        dv.setUint32(i * 4, arr[i])\n    }\n    return buf\n}\n\n/** Read a big-endian Uint8Array into a Uint32Array */\nexport function BEBuffer_to_Array(buf: Uint8Array) {\n    const dv = new DataView(buf.buffer, buf.byteOffset, buf.length)\n    const arr = new Uint32Array(buf.length / 4)\n    for (let i = 0; i < buf.length; i += 4) {\n        arr[i / 4] = dv.getUint32(i)\n    }\n    return arr\n}\n\nexport function is_unicode_array(arr: GlkTypedArray) {\n    return arr.BYTES_PER_ELEMENT === 4\n}\n\nexport const utf8decoder = new TextDecoder()\nexport const utf8encoder = new TextEncoder()", "/*\n\nInterchange File Format\n=======================\n\nCopyright (c) 2022 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {FileView} from '../common/misc.js'\n\nexport interface IFFChunk {\n    data: Uint8Array,\n    offset: number,\n    type: string,\n}\n\n/** An Interchange File Format reader and writer */\nexport class IFF {\n    type = ''\n    chunks: IFFChunk[] = []\n\n    parse(data: Uint8Array) {\n        const view = new FileView(data)\n\n        // Check this is actually an IFF file\n        if (view.getFourCC(0) !== 'FORM') {\n            throw new Error('Not an IFF file')\n        }\n\n        // Parse the file\n        this.type = view.getFourCC(8)\n        let i = 12\n        // Adrift 5 Blorbs have an incorrect length, so just use the size of the buffer\n        //const length = view.getUint32(4) + 8\n        const length = data.length\n        while (i < length) {\n            const chunk_length = view.getUint32(i + 4)\n            if (chunk_length < 0 || (chunk_length + i) > length) {\n                throw new Error('IFF chunk out of range')\n            }\n            this.chunks.push({\n                data: view.getUint8Subarray(i + 8, chunk_length),\n                offset: i,\n                type: view.getFourCC(i),\n            })\n            i += 8 + chunk_length\n            if (i % 2) {\n                i++\n            }\n        }\n    }\n\n    write(): Uint8Array {\n        // First calculate the required buffer length\n        let buffer_length = 12\n        for (const chunk of this.chunks) {\n            buffer_length += 8 + chunk.data.length\n            if (buffer_length % 2) {\n                buffer_length++\n            }\n        }\n\n        // Now make the IFF file and return it\n        const view = new FileView(new ArrayBuffer(buffer_length))\n        view.setFourCC(0, 'FORM')\n        view.setUint32(4, buffer_length - 8)\n        view.setFourCC(8, this.type)\n        let i = 12\n        for (const chunk of this.chunks) {\n            view.setFourCC(i, chunk.type)\n            view.setUint32(i + 4, chunk.data.length)\n            view.setUint8Array(i + 8, chunk.data)\n            i += 8 + chunk.data.length\n            if (i % 2) {\n                i++\n            }\n        }\n        return view.getUint8Subarray()\n    }\n}", "/*\n\nBlorb Files and functions\n=========================\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {unescape} from 'lodash-es'\n\nimport {FileView, utf8decoder} from '../common/misc.js'\n\nimport {IFF} from './iff.js'\n\nexport interface ImageSize {\n    height: number,\n    width: number,\n}\n\nexport interface BlorbChunk {\n    /** Resource descriptions */\n    alttext?: string,\n    /** Whether a data chunk is binary */\n    binary?: boolean,\n    /** The original Chunk ID FourCC */\n    blorbtype?: string,\n    content?: Uint8Array,\n    /** Cached image dimensions */\n    imagesize?: ImageSize,\n    /** Image type */\n    type?: string,\n    /** External URL for image */\n    url?: string,\n    /** Resource usage */\n    usage: 'data' | 'exec' | 'pict' | 'sound',\n}\n\nexport interface ImageInfo extends BlorbChunk {\n    height?: number,\n    /** The resource number */\n    image: number,\n    width?: number,\n}\n\nexport interface BlorbDataChunk {\n    binary: boolean,\n    data: Uint8Array,\n}\n\n// The infomap format\nexport interface InfoMapResource {\n    height: number,\n    image: number,\n    url: string,\n    width: number,\n}\nexport type InfoMap = Record<string, InfoMapResource>\n\nconst BLORB_RESOURCE_INDEX_USAGES: Record<string, string> = {\n    Data: 'data',\n    Exec: 'exec',\n    Pict: 'pict',\n    'Snd ': 'sound',\n}\n\nconst UNKNOWN_IMAGE_TYPE = '????'\n\nexport class Blorb {\n    classname = 'Blorb'\n    /** Chunks are indexed with \"USE:NUMBER\" keys */\n    chunks: Record<string, BlorbChunk> = {}\n    private coverimagenum?: number\n    private debugdata?: Uint8Array\n    private is_inited = false\n    private metadata: Record<string, string> = {}\n\n    // The original Blorb library requires you to call init(), but I think it's better to pass the data into the constructor\n    constructor(data?: Uint8Array);\n    constructor(data?: Uint8Array) {\n        if (data) {\n            this.init(data)\n        }\n    }\n\n    init(data: Array<any>): void;\n    init(data: InfoMap, options: {format: 'infomap'}): void;\n    init(data: Uint8Array): void;\n    init(data: Array<any> | InfoMap | Uint8Array, options?: any) {\n        if (this.is_inited) {\n            return\n        }\n        if (data instanceof Uint8Array) {\n            const iff = new IFF()\n            iff.parse(data)\n            if (iff.type !== 'IFRS') {\n                throw new Error('Not a Blorb file')\n            }\n            if (iff.chunks[0].type !== 'RIdx') {\n                throw new Error('Malformed blorb: chunk 1 is not RIdx')\n            }\n\n            // Process the chunks\n            for (const iff_chunk of iff.chunks) {\n                switch (iff_chunk.type) {\n                    case 'Dbug': {\n                        // Process the debug chunk\n                        this.debugdata = iff_chunk.data\n                        break\n                    }\n                    case 'Fspc': {\n                        // Process the frontispiece chunk\n                        const view = new FileView(iff_chunk.data)\n                        this.coverimagenum = view.getUint32(0)\n                        break\n                    }\n                    case 'IFmd': {\n                        const xml = utf8decoder.decode(iff_chunk.data)\n                        // Normally parsing XML with regexes is super unwise, but the Babel spec places enough restrictions on the metadata XML that this should be safe\n                        const bibliographic = /<bibliographic>(.+)<\\/bibliographic>/is.exec(xml)\n                        const entry_pattern = /<(\\w+)>(.+)<\\/\\1>/gi\n                        const linebreak_pattern = /<br\\/>/g\n                        const whitespace_pattern = /\\s+/g\n                        if (bibliographic) {\n                            let result\n                            while ((result = entry_pattern.exec(bibliographic[1]))) {\n                                const tag = result[1].toLowerCase()\n                                let content = result[2].replace(whitespace_pattern, ' ')\n                                if (tag === 'description') {\n                                    content = content.replace(linebreak_pattern, '\\n')\n                                }\n                                this.metadata[tag] = unescape(content)\n                            }\n                        }\n                        break\n                    }\n                    case 'RDes': {\n                        // Process the resource description chunk\n                        const view = new FileView(iff_chunk.data)\n                        let i = 4\n                        while (i < view.byteLength) {\n                            const usage = BLORB_RESOURCE_INDEX_USAGES[view.getFourCC(i)]\n                            const resource_number = view.getUint32(i + 4)\n                            const text_length = view.getUint32(i + 8)\n                            const chunk = this.chunks[`${usage}:${resource_number}`]\n                            if (chunk) {\n                                chunk.alttext = utf8decoder.decode(view.getUint8Subarray(i + 12, text_length))\n                            }\n                            i += 12 + text_length\n                        }\n                        break\n                    }\n                    case 'RIdx': {\n                        // Process the resource index chunk\n                        const view = new FileView(iff_chunk.data)\n                        let i = 4\n                        while (i < view.byteLength) {\n                            const usage = view.getFourCC(i)\n                            const resource_number = view.getUint32(i + 4)\n                            const resource_offset = view.getUint32(i + 8)\n                            i += 12\n                            const resource_chunk = iff.chunks.filter(chunk => chunk.offset === resource_offset)[0]\n                            if (!resource_chunk) {\n                                throw new Error(`No Blorb chunk at offset ${resource_offset}`)\n                            }\n                            const type = resource_chunk.type\n                            const chunk: BlorbChunk = {\n                                blorbtype: type,\n                                // Embedded FORM chunks need to include the chunk headers for resource streams, so patch them now\n                                content: type === 'FORM' ? data.subarray(resource_chunk.offset, resource_chunk.offset + 8 + resource_chunk.data.length) : resource_chunk.data,\n                                usage: BLORB_RESOURCE_INDEX_USAGES[usage] as BlorbChunk['usage'],\n                            }\n                            if (usage === 'Pict') {\n                                if (type === 'JPEG') {\n                                    chunk.type = 'jpeg'\n                                }\n                                else if (type === 'PNG ') {\n                                    chunk.type = 'png'\n                                }\n                                else {\n                                    chunk.type = UNKNOWN_IMAGE_TYPE\n                                }\n                            }\n                            if (usage === 'Data') {\n                                chunk.binary = type === 'BINA' || type === 'FORM'\n                            }\n                            this.chunks[`${chunk.usage}:${resource_number}`] = chunk\n                        }\n                        break\n                    }\n                }\n            }\n        }\n        // Process the infomap format\n        else if (options?.format === 'infomap') {\n            for (const key in data) {\n                if (!Number.isInteger(+key)) {\n                    continue\n                }\n                const chunk: any = Object.assign({}, (data as InfoMap)[key])\n                delete chunk.image\n                if (chunk.height && chunk.width) {\n                    chunk.imagesize = {\n                        height: chunk.height,\n                        width: chunk.width,\n                    }\n                    delete chunk.height\n                    delete chunk.width\n                }\n                chunk.type = chunk.url.endsWith('.png') ? 'png' : 'jpeg'\n                chunk.usage = 'pict'\n                this.chunks[`pict:${key}`] = chunk\n            }\n        }\n        else if (Array.isArray(data) && data.length === 0) {\n            // Empty data, do nothing\n        }\n        else {\n            throw new Error('Unsupported Blorb.init data format')\n        }\n\n        this.is_inited = true\n    }\n\n    getlibrary(): null {\n        return null\n    }\n\n    get_chunk(usage: string, num: number): BlorbChunk | null {\n        return this.chunks[`${usage}:${num}`] || null\n    }\n\n    get_cover_pict(): number | null {\n        return this.coverimagenum ?? null\n    }\n\n    get_data_chunk(num: number): BlorbDataChunk | null {\n        const chunk = this.chunks[`data:${num}`]\n        if (!chunk?.content) {\n            return null\n        }\n        return {\n            binary: chunk.binary!,\n            data: chunk.content,\n        }\n    }\n    \n    get_debug_info(): Uint8Array | undefined {\n        return this.debugdata\n    }\n\n    /** Return the game file chunk, or null if there isn't one.\n     * If type is provided (GLUL or ZCOD) then the game file is checked to ensure it matches\n     */\n    get_exec_data(gametype?: 'GLUL' | 'ZCOD'): Uint8Array | null {\n        const chunk = this.chunks['exec:0']\n        if (!chunk?.content || (gametype && chunk.blorbtype !== gametype)) {\n            return null\n        }\n        return chunk.content\n    }\n\n    get_image_info(num: number): ImageInfo | null {\n        const chunk = this.chunks[`pict:${num}`]\n        if (!chunk) {\n            return null\n        }\n\n        // Try to extract the image sizes\n        if (!chunk.imagesize && chunk.content) {\n            if (chunk.type === 'jpeg') {\n                chunk.imagesize = get_jpeg_dimensions(chunk.content)\n            }\n            else if (chunk.type === 'png') {\n                chunk.imagesize = get_png_dimensions(chunk.content)\n            }\n        }\n\n        const img: ImageInfo = Object.assign({image: num}, chunk)\n        if (img.imagesize) {\n            img.height = img.imagesize.height\n            img.width = img.imagesize.width\n        }\n        return img\n    }\n\n    get_image_url(num: number): string | null {\n        const chunk = this.chunks[`pict:${num}`]\n        if (!chunk) {\n            return null\n        }\n\n        if (chunk.url) {\n            return chunk.url\n        }\n\n        if (chunk.type !== UNKNOWN_IMAGE_TYPE && chunk.content) {\n            chunk.url = URL.createObjectURL(new Blob([chunk.content], {type: `image/${chunk.type}`}))\n            return chunk.url\n        }\n\n        return null\n    }\n\n    get_metadata(field: string): string {\n        return this.metadata[field]\n    }\n\n    inited(): boolean {\n        return this.is_inited\n    }\n}\n\nexport function is_blorb(data: Uint8Array): boolean {\n    const view = new FileView(data)\n    return view.getFourCC(0) === 'FORM' && view.getFourCC(8) === 'IFRS'\n}\n\nfunction get_jpeg_dimensions(data: Uint8Array): ImageSize | undefined {\n    const view = new FileView(data)\n    let i = 0\n    while (i < view.byteLength) {\n        if (view.getUint8(i) !== 0xFF) {\n            return\n        }\n        while (view.getUint8(i) === 0xFF) {\n            i++\n        }\n        const marker = view.getUint8(i++)\n        // Markers with no data\n        if (marker === 0x01 || (marker >= 0xD0 && marker <= 0xD9)) {\n            continue\n        }\n        const chunklength = view.getUint16(i)\n        if (marker >= 0xC0 && marker <= 0xCF && marker !== 0xC8) {\n            if (chunklength < 7) {\n                // SOF block is too small\n                return\n            }\n            return {\n                height: view.getUint16(i + 3),\n                width: view.getUint16(i + 5),\n            }\n        }\n        i += chunklength\n    }\n}\n\nfunction get_png_dimensions(data: Uint8Array): ImageSize | undefined {\n    const view = new FileView(data)\n    if (view.getFourCC(0) !== '\\x89PNG') {\n        return\n    }\n\n    let i = 8\n    while (i < view.byteLength) {\n        const chunklength = view.getUint32(i)\n        const chunktype = view.getFourCC(i + 4)\n        i += 8\n        if (chunktype === 'IHDR') {\n            return {\n                height: view.getInt32(i + 4),\n                width: view.getInt32(i),\n            }\n        }\n        // Skip CRC\n        i += chunklength + 4\n    }\n}", "/*\n\nConstants\n=========\n\nCopyright (c) 2022 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport * as protocol from './protocol.js'\n\nexport const DEFAULT_METRICS: protocol.NormalisedMetrics = {\n    buffercharheight: 1,\n    buffercharwidth: 1,\n    buffermarginx: 0,\n    buffermarginy: 0,\n    graphicsmarginx: 0,\n    graphicsmarginy: 0,\n    gridcharheight: 1,\n    gridcharwidth: 1,\n    gridmarginx: 0,\n    gridmarginy: 0,\n    height: 50,\n    inspacingx: 0,\n    inspacingy: 0,\n    outspacingx: 0,\n    outspacingy: 0,\n    width: 80,\n}\n\nexport const KEY_CODES_TO_NAMES: Record<number, protocol.SpecialKeyCode> = {\n    8: 'delete', // Backspace to be precise\n    9: 'tab',\n    13: 'return',\n    27: 'escape',\n    33: 'pageup',\n    34: 'pagedown',\n    35: 'end',\n    36: 'home',\n    37: 'left',\n    38: 'up',\n    39: 'right',\n    40: 'down',\n    112: 'func1',\n    113: 'func2',\n    114: 'func3',\n    115: 'func4',\n    116: 'func5',\n    117: 'func6',\n    118: 'func7',\n    119: 'func8',\n    120: 'func9',\n    121: 'func10',\n    122: 'func11',\n    123: 'func12',\n}\n\nexport const KEY_CODE_DOWN = 40\nexport const KEY_CODE_RETURN = 13\nexport const KEY_CODE_UP = 38\n\nexport const NBSP = '\\xa0'\nexport const THINSPACE = '\\u2009'\n\nexport const OFFSCREEN_OFFSET = '-10000px'\n\nexport const PACKAGE_VERSION = '0.1.0'", "/*\n\nGlkApi constants\n================\n\nCopyright (c) 2022 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nexport const gestalt_Version = 0\nexport const gestalt_CharInput = 1\nexport const gestalt_LineInput = 2\nexport const gestalt_CharOutput = 3\nexport const gestalt_CharOutput_CannotPrint = 0\nexport const gestalt_CharOutput_ApproxPrint = 1\nexport const gestalt_CharOutput_ExactPrint = 2\nexport const gestalt_MouseInput = 4\nexport const gestalt_Timer = 5\nexport const gestalt_Graphics = 6\nexport const gestalt_DrawImage = 7\nexport const gestalt_Sound = 8\nexport const gestalt_SoundVolume = 9\nexport const gestalt_SoundNotify = 10\nexport const gestalt_Hyperlinks = 11\nexport const gestalt_HyperlinkInput = 12\nexport const gestalt_SoundMusic = 13\nexport const gestalt_GraphicsTransparency = 14\nexport const gestalt_Unicode = 15\nexport const gestalt_UnicodeNorm = 16\nexport const gestalt_LineInputEcho = 17\nexport const gestalt_LineTerminators = 18\nexport const gestalt_LineTerminatorKey = 19\nexport const gestalt_DateTime = 20\nexport const gestalt_Sound2 = 21\nexport const gestalt_ResourceStream = 22\nexport const gestalt_GraphicsCharInput = 23\nexport const gestalt_GarglkText = 0x1100\n\nexport const keycode_Unknown = 0xffffffff\nexport const keycode_Left = 0xfffffffe\nexport const keycode_Right = 0xfffffffd\nexport const keycode_Up = 0xfffffffc\nexport const keycode_Down = 0xfffffffb\nexport const keycode_Return = 0xfffffffa\nexport const keycode_Delete = 0xfffffff9\nexport const keycode_Escape = 0xfffffff8\nexport const keycode_Tab = 0xfffffff7\nexport const keycode_PageUp = 0xfffffff6\nexport const keycode_PageDown = 0xfffffff5\nexport const keycode_Home = 0xfffffff4\nexport const keycode_End = 0xfffffff3\nexport const keycode_Func1 = 0xffffffef\nexport const keycode_Func2 = 0xffffffee\nexport const keycode_Func3 = 0xffffffed\nexport const keycode_Func4 = 0xffffffec\nexport const keycode_Func5 = 0xffffffeb\nexport const keycode_Func6 = 0xffffffea\nexport const keycode_Func7 = 0xffffffe9\nexport const keycode_Func8 = 0xffffffe8\nexport const keycode_Func9 = 0xffffffe7\nexport const keycode_Func10 = 0xffffffe6\nexport const keycode_Func11 = 0xffffffe5\nexport const keycode_Func12 = 0xffffffe4\n// The last keycode is always (0x100000000 - keycode_MAXVAL)\nexport const keycode_MAXVAL = 28\n\nexport const evtype_None = 0\nexport const evtype_Timer = 1\nexport const evtype_CharInput = 2\nexport const evtype_LineInput = 3\nexport const evtype_MouseInput = 4\nexport const evtype_Arrange = 5\nexport const evtype_Redraw = 6\nexport const evtype_SoundNotify = 7\nexport const evtype_Hyperlink = 8\nexport const evtype_VolumeNotify = 9\n\nexport const style_Normal = 0\nexport const style_Emphasized = 1\nexport const style_Preformatted = 2\nexport const style_Header = 3\nexport const style_Subheader = 4\nexport const style_Alert = 5\nexport const style_Note = 6\nexport const style_BlockQuote = 7\nexport const style_Input = 8\nexport const style_User1 = 9\nexport const style_User2 = 10\nexport const style_NUMSTYLES = 11\n\nexport const wintype_AllTypes = 0\nexport const wintype_Pair = 1\nexport const wintype_Blank = 2\nexport const wintype_TextBuffer = 3\nexport const wintype_TextGrid = 4\nexport const wintype_Graphics = 5\n\nexport const winmethod_Left  = 0x00\nexport const winmethod_Right = 0x01\nexport const winmethod_Above = 0x02\nexport const winmethod_Below = 0x03\nexport const winmethod_DirMask = 0x0f\n\nexport const winmethod_Fixed = 0x10\nexport const winmethod_Proportional = 0x20\nexport const winmethod_DivisionMask = 0xf0\n\nexport const winmethod_Border = 0x000\nexport const winmethod_NoBorder = 0x100\nexport const winmethod_BorderMask = 0x100\n\nexport const fileusage_Data = 0x00\nexport const fileusage_SavedGame = 0x01\nexport const fileusage_Transcript = 0x02\nexport const fileusage_InputRecord = 0x03\nexport const fileusage_TypeMask = 0x0f\n\nexport const fileusage_TextMode = 0x100\nexport const fileusage_BinaryMode = 0x000\n\nexport const filemode_Write = 0x01\nexport const filemode_Read = 0x02\nexport const filemode_ReadWrite = 0x03\nexport const filemode_WriteAppend = 0x05\nexport type FileMode = typeof filemode_Write | typeof filemode_Read | typeof filemode_ReadWrite | typeof filemode_WriteAppend\n\nexport const seekmode_Start = 0\nexport const seekmode_Current = 1\nexport const seekmode_End = 2\n\nexport const stylehint_Indentation = 0\nexport const stylehint_ParaIndentation = 1\nexport const stylehint_Justification = 2\nexport const stylehint_Size = 3\nexport const stylehint_Weight = 4\nexport const stylehint_Oblique = 5\nexport const stylehint_Proportional = 6\nexport const stylehint_TextColor = 7\nexport const stylehint_BackColor = 8\nexport const stylehint_ReverseColor = 9\nexport const stylehint_NUMHINTS = 10\n\nexport const stylehint_just_LeftFlush = 0\nexport const stylehint_just_LeftRight = 1\nexport const stylehint_just_Centered = 2\nexport const stylehint_just_RightFlush = 3\n\nexport const imagealign_InlineUp = 1\nexport const imagealign_InlineDown = 2\nexport const imagealign_InlineCenter = 3\nexport const imagealign_MarginLeft = 4\nexport const imagealign_MarginRight = 5\n\nexport const zcolor_Default = -1\nexport const zcolor_Current = -2", "/*\n\nCaching Dialog wrapper\n======================\n\nCopyright (c) 2022 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {debounce} from 'lodash-es'\n\nimport {Array_to_BEBuffer, GlkTypedArray, is_unicode_array, utf8encoder} from '../../common/misc.js'\nimport {FileRef} from '../../common/protocol.js'\nimport {filemode_Read, filemode_Write, seekmode_End, seekmode_Start} from '../../glkapi/constants.js'\nimport {AutosaveData, ClassicSyncDialog, ClassicStreamingDialog, DialogOptions} from './interface.js'\n\n/** A file buffer which stores its data in its preferred stream format, only converting back to a Uint8Array when required */\nexport class FileBuffer {\n    private binary: boolean\n    private buf: GlkTypedArray\n    fref: FileRef\n    private uni: boolean\n\n    constructor(buf: GlkTypedArray, binary: boolean, fref: FileRef) {\n        this.binary = binary\n        this.buf = buf\n        this.fref = fref\n        this.uni = is_unicode_array(buf)\n    }\n\n    convert() {\n        if (this.uni) {\n            if (this.binary) {\n                return Array_to_BEBuffer(this.buf as Uint32Array)\n            }\n            else {\n                const text = String.fromCodePoint(...this.buf)\n                return utf8encoder.encode(text)\n            }\n        }\n        else {\n            return (this.buf as Uint8Array).slice()\n        }\n    }\n}\n\n/** A Dialog class that wraps another Dialog instance, caching files so that they can be written asyncronously */\nexport class CachingDialogWrapper implements ClassicSyncDialog {\n    private cache: Record<string, FileBuffer> = {}\n    classname = 'CachingDialogWrapper'\n    private Dialog: ClassicSyncDialog | ClassicStreamingDialog\n    streaming = false as const\n\n    constructor(Dialog: ClassicSyncDialog | ClassicStreamingDialog) {\n        this.Dialog = Dialog\n    }\n\n    init(_options: DialogOptions) {}\n\n    file_ref_exists(fref: FileRef) {\n        return !!this.cache[fref.filename] || this.Dialog.file_ref_exists(fref)\n    }\n\n    file_read(fref: FileRef) {\n        if (this.cache[fref.filename]) {\n            // Convert the cached file buffer back into canonical form\n            return this.cache[fref.filename].convert()\n        }\n        if (this.Dialog.streaming) {\n            const fstream = this.Dialog.file_fopen(filemode_Read, fref)\n            if (!fstream) {\n                return null\n            }\n            fstream.fseek(0, seekmode_End)\n            const length = fstream.ftell()\n            const buf = new Uint8Array(length)\n            fstream.fseek(0, seekmode_Start)\n            fstream.fread(buf)\n            fstream.fclose()\n            return buf\n        }\n        else {\n            return this.Dialog.file_read(fref)\n        }\n    }\n\n    file_remove_ref(fref: FileRef) {\n        if (this.cache[fref.filename]) {\n            delete this.cache[fref.filename]\n        }\n        this.Dialog.file_remove_ref(fref)\n    }\n\n    file_write(_fref: FileRef, _content: Uint8Array): boolean {\n        throw new Error('CachingDialogWrapper.write_file should be called instead')\n    }\n\n    inited() {\n        return true\n    }\n\n    // Bundle all writes from one JS tick\n    private write = debounce(() => {\n        for (const filename in this.cache) {\n            const filebuf = this.cache[filename]\n            if (this.Dialog.streaming) {\n                const fstream = this.Dialog.file_fopen(filemode_Write, filebuf.fref)!\n                fstream.fwrite(filebuf.convert())\n                fstream.fclose()\n            }\n            else {\n                this.Dialog.file_write(filebuf.fref, filebuf.convert())\n            }\n        }\n        this.cache = {}\n    }, 0)\n\n    write_file(fref: FileRef, content: FileBuffer) {\n        this.cache[fref.filename] = content\n        this.write()\n        return true\n    }\n\n    // And the rest just call the wrapped instance\n\n    autosave_read(signature: string) {\n        return this.Dialog.autosave_read(signature)\n    }\n\n    autosave_write(signature: string, snapshot: AutosaveData | null) {\n        this.Dialog.autosave_write(signature, snapshot)\n    }\n\n    file_clean_fixed_name(filename: string, usage: number) {\n        return this.Dialog.file_clean_fixed_name(filename, usage)\n    }\n\n    file_construct_ref(filename?: string, usage?: string, gameid?: string) {\n        return this.Dialog.file_construct_ref(filename, usage, gameid)\n    }\n\n    file_construct_temp_ref(usage: string) {\n        return this.Dialog.file_construct_temp_ref(usage)\n    }\n\n    getlibrary(name: string) {\n        return this.Dialog.getlibrary(name)\n    }\n\n    open(save: boolean, usage: string | null, gameid: string | null | undefined, callback: (fref: FileRef | null) => void) {\n        this.Dialog.open(save, usage, gameid, callback)\n    }\n}", "/*\n\nCommon GlkApi things\n====================\n\nCopyright (c) 2022 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {GlkTypedArray} from '../common/misc.js'\n\nexport function copy_array(source: GlkTypedArray, target: number[], length: number) {\n    const copy_length = Math.min(length, target.length)\n    for (let i = 0; i < copy_length; i++) {\n        target[i] = source[i]\n    }\n}\n\nexport interface TimerData {\n    interval: number\n    last_interval: number\n    started: number\n}", "/*\n\nGlk FileRefs\n============\n\nCopyright (c) 2022 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {GlkTypedArray} from '../common/misc.js'\nimport {FileRef as DialogFileRef} from '../common/protocol.js'\nimport {CachingDialogWrapper, FileBuffer} from '../dialog/common/cache.js'\n\nimport {fileusage_TextMode} from './constants.js'\nimport {GlkFref} from './interface.js'\n\nexport class FileRef implements GlkFref {\n    binary: boolean\n    private Dialog: CachingDialogWrapper\n    disprock?: number\n    filename: string\n    next: FileRef | null = null\n    prev: FileRef | null = null\n    private dfref: DialogFileRef\n    rock: number\n\n    constructor(Dialog: CachingDialogWrapper, filename: string, dialog_fref: DialogFileRef, rock: number, usage: number) {\n        this.binary = !(usage & fileusage_TextMode)\n        this.Dialog = Dialog\n        this.filename = filename\n        this.dfref = dialog_fref\n        this.rock = rock\n    }\n\n    delete_file() {\n        this.Dialog.file_remove_ref(this.dfref)\n    }\n\n    exists(): boolean {\n        return this.Dialog.file_ref_exists(this.dfref)\n    }\n\n    read(): Uint8Array | null {\n        return this.Dialog.file_read(this.dfref)\n    }\n\n    write(buf: GlkTypedArray) {\n        const filebuf = new FileBuffer(buf, this.binary, this.dfref)\n        this.Dialog.write_file(this.dfref, filebuf)\n    }\n}", "/*\n\nThe GlkApi interface\n====================\n\nCopyright (c) 2022 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {Blorb} from '../blorb/blorb.js'\nimport {FileRef} from '../common/protocol.js'\nimport {Dialog} from '../dialog/common/interface.js'\nimport {GlkOte} from '../glkote/common/glkote.js'\n\nimport * as Const from './constants.js'\n\ntype TruthyOption = boolean | number\n\nexport type GlkArray = Array<number> | Uint8Array | Uint32Array\nexport type GlkByteArray = Array<number> | Uint8Array\nexport type GlkWordArray = Array<number> | Uint32Array\n\n// Opaque classes\nexport type GlkClassName = 'fileref' | 'stream' | 'window'\nexport interface GlkFref {disprock?: number}\nexport interface GlkSchannel {disprock?: number}\nexport interface GlkStream {disprock?: number}\nexport interface GlkWindow {disprock?: number}\nexport type GlkObject = GlkFref | GlkSchannel | GlkStream | GlkWindow\n\nexport type RefStructValue = GlkWindow | number | null\n\n/** A box to hold a value */\nexport interface RefBox {\n    get_value(): RefStructValue,\n    set_value(val: RefStructValue): void,\n}\n// Existing code may pass a 0 instead of a null, so we need this type alias to remind us we can't use optional chaining\nexport type RefBoxArg = RefBox | 0\n\n/** A struct for holding multiple values */\nexport interface RefStruct {\n    get_field(index: number): RefStructValue,\n    get_fields(): RefStructValue[],\n    push_field(val: RefStructValue): void,\n    set_field(index: number, val: RefStructValue): void,\n}\nexport type RefStructArg = RefStruct | 0\n\nexport const DidNotReturn = {\n    dummy: 'Glk call has not yet returned',\n}\n\n/** A generic GiDispa interface */\nexport interface GiDispa {\n    check_autosave(): boolean,\n    class_obj_from_id(class_name: GlkClassName, disprock: number): GlkObject,\n    class_register(class_name: GlkClassName, obj: GlkObject, disprock?: number): void,\n    class_unregister(class_name: GlkClassName, obj: GlkObject): void,\n    get_retained_array(arr: GlkArray): any,\n    init(options: {\n        io: GlkApi,\n        vm: GlkVM,\n    }): void,\n    prepare_resume(arg: RefStruct): void,\n    retain_array(arr1: GlkArray, useobj?: any): void,\n    unretain_array(arr: GlkArray): void,\n}\n\n/** A generic VM interface */\nexport interface GlkVM {\n    do_autosave(save: number | any): void,\n    get_signature(): string,\n    resume(arg?: FileRef): void,\n    start(): void,\n}\n\n/** Options GlkApi consumes */\nexport interface GlkApiOptions {\n    before_select_hook?: () => void,\n    Blorb?: Blorb,\n    Dialog: Dialog,\n    do_vm_autosave?: TruthyOption,\n    exit_warning?: TruthyOption,\n    extevent_hook?: (val: any) => void,\n    GiDispa?: GiDispa,\n    glk_gestalt_hook?: (sel: number, value: number, array: GlkArray | null) => number,\n    GlkOte: GlkOte,\n    vm: GlkVM,\n}\n\n/** The main Glk API */\nexport interface GlkApi {\n    // Class functions\n    version: string,\n    init(options: GlkApiOptions): void,\n    call_may_not_return(id: number): boolean,\n    fatal_error(msg: string): void,\n    getlibrary(class_name: string): Blorb | Dialog | GiDispa | GlkOte | GlkVM | null,\n    inited(): boolean,\n    restore_allstate(state: any): void,\n    save_allstate(): any,\n    update(): void,\n\n    // References to other things\n    // TODO: remove in a future semver major update?\n    Const: typeof Const,\n    DidNotReturn: typeof DidNotReturn,\n    RefBox: new () => RefBox,\n    RefStruct: new () => RefStruct,\n\n    // Extra functions\n    byte_array_to_string(arr: GlkByteArray): string,\n    glk_put_jstring(val: string, all_bytes?: boolean): void,\n    glk_put_jstring_stream(str: GlkStream, val: string, all_bytes?: boolean): void,\n    uni_array_to_string(arr: GlkWordArray): string,\n\n    // The Glk functions\n    glk_buffer_canon_decompose_uni(buf: GlkWordArray, initlen: number): number,\n    glk_buffer_canon_normalize_uni(buf: GlkWordArray, initlen: number): number,\n    glk_buffer_to_lower_case_uni(buf: GlkWordArray, initlen: number): number,\n    glk_buffer_to_title_case_uni(buf: GlkWordArray, initlen: number, lowerrest: number): number,\n    glk_buffer_to_upper_case_uni(buf: GlkWordArray, initlen: number): number,\n    glk_cancel_char_event(win: GlkWindow): void,\n    glk_cancel_hyperlink_event(win: GlkWindow): void,\n    glk_cancel_line_event(win: GlkWindow, ev?: RefStructArg): void,\n    glk_cancel_mouse_event(win: GlkWindow): void,\n    glk_char_to_lower(val: number): number,\n    glk_char_to_upper(val: number): number,\n    glk_current_simple_time(factor: number): number,\n    glk_current_time(struct: RefStruct): void,\n    glk_date_to_simple_time_local(struct: RefStruct, factor: number): number,\n    glk_date_to_simple_time_utc(struct: RefStruct, factor: number): number,\n    glk_date_to_time_local(datestruct: RefStruct, timestruct: RefStruct): void,\n    glk_date_to_time_utc(datestruct: RefStruct, timestruct: RefStruct): void,\n    glk_exit(): typeof DidNotReturn,\n    glk_fileref_create_by_name(usage: number, filename: string, rock: number): GlkFref,\n    glk_fileref_create_by_prompt(usage: number, fmode: number, rock: number): typeof DidNotReturn,\n    glk_fileref_create_from_fileref(usage: number, oldfref: GlkFref, rock: number): GlkFref,\n    glk_fileref_create_temp(usage: number, rock: number): GlkFref,\n    glk_fileref_delete_file(fref: GlkFref): void,\n    glk_fileref_destroy(fref: GlkFref): void,\n    glk_fileref_does_file_exist(fref: GlkFref): boolean,\n    glk_fileref_get_rock(fref: GlkFref): number,\n    glk_fileref_iterate(fref?: GlkFref, rockbox?: RefBoxArg): GlkFref | null,\n    glk_gestalt(sel: number, val: number): number,\n    glk_gestalt_ext(sel: number, val: number, arr: GlkArray | null): number,\n    glk_get_buffer_stream(str: GlkStream, buf: GlkByteArray): number,\n    glk_get_buffer_stream_uni(str: GlkStream, buf: GlkWordArray): number,\n    glk_get_char_stream(str: GlkStream): number,\n    glk_get_char_stream_uni(str: GlkStream): number,\n    glk_get_line_stream(str: GlkStream, buf: GlkByteArray): number,\n    glk_get_line_stream_uni(str: GlkStream, buf: GlkWordArray): number,\n    glk_image_draw(win: GlkWindow, imgid: number, val1: number, val2: number): number,\n    glk_image_draw_scaled(win: GlkWindow, imgid: number, val1: number, val2: number, width: number, height: number): number,\n    glk_image_get_info(imgid: number, width?: RefBoxArg, height?: RefBoxArg): number,\n    glk_put_buffer(val: GlkByteArray): void,\n    glk_put_buffer_stream(str: GlkStream, val: GlkByteArray): void,\n    glk_put_buffer_stream_uni(str: GlkStream, val: GlkWordArray): void,\n    glk_put_buffer_uni(val: GlkWordArray): void,\n    glk_put_char(val: number): void,\n    glk_put_char_stream(str: GlkStream, val: number): void,\n    glk_put_char_stream_uni(str: GlkStream, val: number): void,\n    glk_put_char_uni(val: number): void,\n    glk_put_string(val: string): void,\n    glk_put_string_stream(str: GlkStream, val: string): void,\n    glk_put_string_stream_uni(str: GlkStream, val: string): void,\n    glk_put_string_uni(val: string): void,\n    glk_request_char_event(win: GlkWindow): void,\n    glk_request_char_event_uni(win: GlkWindow): void,\n    glk_request_hyperlink_event(win: GlkWindow): void,\n    glk_request_line_event(win: GlkWindow, buf: GlkByteArray, initlen?: number): void,\n    glk_request_line_event_uni(win: GlkWindow, buf: GlkWordArray, initlen?: number): void,\n    glk_request_mouse_event(win: GlkWindow): void,\n    glk_request_timer_events(msecs: number): void,\n    glk_schannel_create(rock: number): GlkSchannel | null,\n    glk_schannel_create_ext(rock: number, volume: number): GlkSchannel | null,\n    glk_schannel_destroy(schannel: GlkSchannel): void,\n    glk_schannel_get_rock(schannel: GlkSchannel): number,\n    glk_schannel_iterate(schannel?: GlkSchannel, rockbox?: RefBoxArg): GlkSchannel | null,\n    glk_schannel_pause(schannel: GlkSchannel): void,\n    glk_schannel_play(schannel: GlkSchannel, sound: number): number,\n    glk_schannel_play_ext(schannel: GlkSchannel, sound: number, repeats: number, notify: number): number,\n    glk_schannel_play_multi(schannels: GlkSchannel[], sounds: GlkArray, notify: number): number,\n    glk_schannel_set_volume(schannel: GlkSchannel, volume: number): void,\n    glk_schannel_set_volume_ext(schannel: GlkSchannel, volume: number, duration: number, notify: number): void,\n    glk_schannel_stop(schannel: GlkSchannel): void,\n    glk_schannel_unpause(schannel: GlkSchannel): void,\n    glk_select(ev: RefStruct): typeof DidNotReturn,\n    glk_select_poll(ev: RefStruct): void,\n    glk_set_echo_line_event(win: GlkWindow, val: number): void,\n    glk_set_hyperlink(val: number): void,\n    glk_set_hyperlink_stream(str: GlkStream, val: number): void,\n    glk_set_style(style: number): void,\n    glk_set_style_stream(str: GlkStream, style: number): void,\n    glk_set_terminators_line_event(win: GlkWindow, keycodes: GlkArray): void,\n    glk_set_window(win?: GlkWindow): void,\n    glk_sound_load_hint(sound: number, load: number): void,\n    glk_stream_close(str: GlkStream, result?: RefStructArg): void,\n    glk_stream_get_current(): GlkStream | null,\n    glk_stream_get_position(str: GlkStream): number,\n    glk_stream_get_rock(str: GlkStream): number,\n    glk_stream_iterate(str?: GlkStream, rockbox?: RefBoxArg): GlkStream | null,\n    glk_stream_open_file(fref: GlkFref, mode: number, rock: number): GlkStream | null,\n    glk_stream_open_file_uni(fref: GlkFref, mode: number, rock: number): GlkStream | null,\n    glk_stream_open_memory(buf: GlkByteArray | null, mode: number, rock: number): GlkStream,\n    glk_stream_open_memory_uni(buf: GlkWordArray | null, mode: number, rock: number): GlkStream,\n    glk_stream_open_resource(filenum: number, rock: number): GlkStream | null,\n    glk_stream_open_resource_uni(filenum: number, rock: number): GlkStream | null,\n    glk_stream_set_current(str: GlkStream | null): void,\n    glk_stream_set_position(str: GlkStream, pos: number, seekmode: number): void,\n    glk_style_distinguish(win: GlkWindow, style1: number, style2: number): number,\n    glk_style_measure(win: GlkWindow, style: number, hint: number, result?: RefBoxArg): number,\n    glk_stylehint_clear(wintype: number, style: number, hint: number): void,\n    glk_stylehint_set(wintype: number, style: number, hint: number, value: number): void,\n    glk_tick(): void,\n    glk_simple_time_to_date_local(time: number, factor: number, struct: RefStruct): void,\n    glk_simple_time_to_date_utc(time: number, factor: number, struct: RefStruct): void,\n    glk_time_to_date_local(timestruct: RefStruct, datestruct: RefStruct): void,\n    glk_time_to_date_utc(timestruct: RefStruct, datestruct: RefStruct): void,\n    glk_window_clear(win: GlkWindow): void,\n    glk_window_close(win: GlkWindow, stats?: RefStructArg): void,\n    glk_window_erase_rect(win: GlkWindow, left: number, top: number, width: number, height: number): void,\n    glk_window_fill_rect(win: GlkWindow, colour: number, left: number, top: number, width: number, height: number): void,\n    glk_window_flow_break(win: GlkWindow): void,\n    glk_window_get_arrangement(win: GlkWindow, method?: RefBoxArg, size?: RefBoxArg, keywin?: RefBoxArg): void,\n    glk_window_get_echo_stream(win: GlkWindow): GlkStream | null,\n    glk_window_get_parent(win: GlkWindow): GlkWindow | null,\n    glk_window_get_rock(win: GlkWindow): number,\n    glk_window_get_root(): GlkWindow | null,\n    glk_window_get_sibling(win: GlkWindow): GlkWindow | null,\n    glk_window_get_size(win: GlkWindow, width?: RefBoxArg, height?: RefBoxArg): void,\n    glk_window_get_stream(win: GlkWindow): GlkStream,\n    glk_window_get_type(win: GlkWindow): number,\n    glk_window_iterate(win?: GlkWindow, rockbox?: RefBoxArg): GlkWindow | null,\n    glk_window_move_cursor(win: GlkWindow, xpos: number, ypos: number): void,\n    glk_window_open(splitwin: GlkWindow | null, method: number, size: number, wintype: number, rock: number): GlkWindow | null,\n    glk_window_set_arrangement(win: GlkWindow, method: number, size: number, keywin?: GlkWindow): void,\n    glk_window_set_background_color(win: GlkWindow, colour: number): void,\n    glk_window_set_echo_stream(win: GlkWindow, stream: GlkStream | null): void,\n    garglk_set_reversevideo(val: number): void,\n    garglk_set_reversevideo_stream(str: GlkStream, val: number): void,\n    garglk_set_zcolors(fg: number, bg: number): void,\n    garglk_set_zcolors_stream(str: GlkStream, fg: number, bg: number): void,\n}\n\n/** An Async extension of the Glk API */\nexport interface GlkApiAsync extends GlkApi {\n    glk_fileref_create_by_prompt_async(usage: number, fmode: number, rock: number): Promise<GlkFref | null>,\n    glk_fileref_does_file_exist_async(fref: GlkFref): Promise<boolean>,\n    glk_select_async(ev: RefStruct): Promise<void>,\n    glk_stream_open_file_async(fref: GlkFref, mode: number, rock: number): Promise<GlkStream | null>,\n    glk_stream_open_file_uni_async(fref: GlkFref, mode: number, rock: number): Promise<GlkStream | null>,\n    restore_allstate_async(state: any): Promise<boolean>,\n    save_allstate_async(): Promise<any>,\n}", "/*\n\nGlkApi constants\n================\n\nCopyright (c) 2022 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {BufferWindowImage, FileMode, FileType, SpecialKeyCode, TerminatorCode} from '../common/protocol.js'\n\nimport {keycode_Delete, keycode_Down, keycode_End, keycode_Escape, keycode_Func1, keycode_Func2, keycode_Func3, keycode_Func4,  keycode_Func5, keycode_Func6, keycode_Func7, keycode_Func8, keycode_Func9, keycode_Func10, keycode_Func11, keycode_Func12, keycode_Home, keycode_Left, keycode_PageDown, keycode_PageUp, keycode_Return, keycode_Right, keycode_Tab, keycode_Up} from './constants.js'\n\nexport const GLK_NULL = 0\nexport const MAX_LATIN1 = 0xFF\nexport const QUESTION_MARK = 63\n\nexport const CSS_STYLE_PROPERTIES = ['margin-left', 'text-indent', 'text-align', 'font-size', 'font-weight', 'font-style', 'monospace', 'color', 'background-color', 'reverse']\n\nexport const FILE_MODES: Record<number, FileMode> = {\n    1: 'write',\n    2: 'read',\n    3: 'readwrite',\n    5: 'writeappend',\n}\n\nexport const FILE_TYPES: Record<number, FileType> = {\n    0: 'data',\n    1: 'save',\n    2: 'transcript',\n    3: 'command',\n}\n\nexport const IMAGE_ALIGNMENTS: Record<number, BufferWindowImage['alignment']> = {\n    1: 'inlineup',\n    2: 'inlinedown',\n    3: 'inlinecenter',\n    4: 'marginleft',\n    5: 'marginright',\n}\n\nexport const KEY_NAMES_TO_CODES: Record<SpecialKeyCode, number> = {\n    delete: keycode_Delete,\n    down: keycode_Down,\n    end: keycode_End,\n    escape: keycode_Escape,\n    func1: keycode_Func1,\n    func2: keycode_Func2,\n    func3: keycode_Func3,\n    func4: keycode_Func4,\n    func5: keycode_Func5,\n    func6: keycode_Func6,\n    func7: keycode_Func7,\n    func8: keycode_Func8,\n    func9: keycode_Func9,\n    func10: keycode_Func10,\n    func11: keycode_Func11,\n    func12: keycode_Func12,\n    home: keycode_Home,\n    left: keycode_Left,\n    pagedown: keycode_PageDown,\n    pageup: keycode_PageUp,\n    return: keycode_Return,\n    right: keycode_Right,\n    tab: keycode_Tab,\n    up: keycode_Up,\n}\n\nexport const STYLE_NAMES: Record<number, string> = {\n    0: 'normal',\n    1: 'emphasized',\n    2: 'preformatted',\n    3: 'header',\n    4: 'subheader',\n    5: 'alert',\n    6: 'note',\n    7: 'blockquote',\n    8: 'input',\n    9: 'user1',\n    10: 'user2',\n}\n\nexport const TERMINATOR_KEYS: Record<number, TerminatorCode> = {\n    0xfffffff8: 'escape',\n    0xffffffef: 'func1',\n    0xffffffee: 'func2',\n    0xffffffed: 'func3',\n    0xffffffec: 'func4',\n    0xffffffeb: 'func5',\n    0xffffffea: 'func6',\n    0xffffffe9: 'func7',\n    0xffffffe8: 'func8',\n    0xffffffe7: 'func9',\n    0xffffffe6: 'func10',\n    0xffffffe5: 'func11',\n    0xffffffe4: 'func12',\n}\n\nexport const TERMINATOR_KEYS_TO_CODES: Partial<Record<SpecialKeyCode, number>> = {\n    escape: keycode_Escape,\n    func1: keycode_Func1,\n    func2: keycode_Func2,\n    func3: keycode_Func3,\n    func4: keycode_Func4,\n    func5: keycode_Func5,\n    func6: keycode_Func6,\n    func7: keycode_Func7,\n    func8: keycode_Func8,\n    func9: keycode_Func9,\n    func10: keycode_Func10,\n    func11: keycode_Func11,\n    func12: keycode_Func12,\n}", "/*\n\nGlk Streams\n===========\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {GlkTypedArray, is_unicode_array} from '../common/misc.js'\n\nimport {filemode_Write, seekmode_Current, seekmode_End} from './constants.js'\nimport {FileRef} from './filerefs.js'\nimport {GlkArray, GlkStream, RefStructArg} from './interface.js'\nimport {GLK_NULL, MAX_LATIN1, QUESTION_MARK} from './lib_constants.js'\nimport {Window} from './windows.js'\n\nexport type Stream = ArrayBackedStream | FileStream | NullStream | WindowStream\ntype StreamType = 'array' | 'null' | 'window'\n\nabstract class StreamBase implements GlkStream {\n    disprock?: number\n    fmode: number\n    next: Stream | null = null\n    prev: Stream | null = null\n    rock: number\n    abstract type: StreamType\n    protected write_count = 0\n\n    constructor(fmode: number, rock: number) {\n        this.fmode = fmode\n        this.rock = rock\n    }\n\n    close(result?: RefStructArg) {\n        if (result) {\n            result.set_field(0, 0)\n            result.set_field(1, this.write_count)\n        }\n    }\n\n    get_buffer(_buf: GlkTypedArray): number {\n        return 0\n    }\n\n    get_char(_unicode: boolean): number {\n        return -1\n    }\n\n    get_line(_buf: GlkTypedArray): number {\n        return 0\n    }\n\n    get_position(): number {\n        return 0\n    }\n\n    abstract put_buffer(buf: GlkArray, uni: boolean): void\n    abstract put_char(ch: number): void\n    abstract put_string(str: string, style?: string): void\n\n    set_position(_mode: number, _pos: number) {}\n}\n\n/** A fixed-length TypedArray backed stream */\nexport class ArrayBackedStream extends StreamBase {\n    protected buf: GlkTypedArray\n    private close_cb?: () => void\n    /** Whether we need to check if we should expand the buffer before writing */\n    protected expandable: boolean\n    /** The length of the active region of the buffer.\n     * This can be shorter than the actual length of the buffer in two situations: a file stream, or a `filemode_Write` memory stream.\n     * See https://github.com/iftechfoundation/ifarchive-if-specs/issues/8\n     */\n    protected len: number\n    protected pos = 0\n    private read_count = 0\n    type = 'array' as const\n    protected uni: boolean\n\n    constructor(buf: GlkTypedArray, fmode: number, rock: number, close_cb?: () => void) {\n        super(fmode, rock)\n        this.buf = buf\n        this.close_cb = close_cb\n        this.expandable = fmode === filemode_Write\n        this.len = fmode === filemode_Write ? 0 : buf.length\n        this.uni = is_unicode_array(buf)\n    }\n\n    close(result?: RefStructArg) {\n        this.close_cb?.()\n        this.write()\n        if (result) {\n            result.set_field(0, this.read_count)\n            result.set_field(1, this.write_count)\n        }\n    }\n\n    protected expand(increase: number) {\n        this.len = Math.min(this.pos + increase, this.buf.length)\n        if (this.len === this.buf.length) {\n            this.expandable = false\n        }\n    }\n\n    get_buffer(buf: GlkTypedArray): number {\n        const read_length = Math.min(buf.length, this.len - this.pos)\n        // When a unicode array is read into a latin1 array we must catch non-latin1 characters\n        if (!is_unicode_array(buf) && this.uni) {\n            for (let i = 0; i < read_length; i++) {\n                const ch = this.buf[this.pos + i]\n                buf[i] = ch > MAX_LATIN1 ? QUESTION_MARK : ch\n            }\n        }\n        // Otherwise we can copy it whole\n        else {\n            buf.set(this.buf.subarray(this.pos, this.pos + read_length))\n        }\n        this.pos += read_length\n        this.read_count += read_length\n        return read_length\n    }\n\n    get_char(unicode: boolean): number {\n        if (this.pos < this.len) {\n            this.read_count++\n            const ch = this.buf[this.pos++]\n            return !unicode && ch > MAX_LATIN1 ? QUESTION_MARK : ch\n        }\n        return -1\n    }\n\n    get_line(buf: GlkTypedArray): number {\n        const read_length = Math.min(buf.length - 1, this.len - this.pos)\n        if (read_length < 0) {\n            return 0\n        }\n        const check_unicode = !is_unicode_array(buf) && this.uni\n        let i = 0\n        while (i < read_length) {\n            const ch = this.buf[this.pos++]\n            buf[i++] = check_unicode && ch > MAX_LATIN1 ? QUESTION_MARK : ch\n            if (ch === 10) {\n                break\n            }\n        }\n        buf[i] = GLK_NULL\n        this.read_count += i\n        return i\n    }\n\n    get_position(): number {\n        return this.pos\n    }\n\n    put_buffer(buf: GlkArray, uni: boolean) {\n        const buf_length = buf.length\n        this.write_count += buf_length\n        if (this.pos + buf_length > this.len && this.expandable) {\n            this.expand(buf_length)\n        }\n        const write_length = Math.min(buf_length, this.len - this.pos)\n        if (write_length === 0) {\n            return\n        }\n        // When writing a unicode array into a latin1 array we must catch non-latin1 characters\n        if (uni && !this.uni) {\n            for (let i = 0; i < write_length; i++) {\n                const ch = buf[i]\n                this.buf[this.pos + i] = ch > MAX_LATIN1 ? QUESTION_MARK : ch\n            }\n        }\n        // Otherwise we can copy it whole\n        else {\n            if (Array.isArray(buf)) {\n                buf = (uni ? Uint32Array : Uint8Array).from(buf)\n            }\n            this.buf.set(buf.subarray(0, write_length), this.pos)\n        }\n        this.pos += write_length\n        this.write()\n    }\n\n    put_char(ch: number) {\n        this.write_count++\n        if (this.pos === this.len && this.expandable) {\n            this.expand(1)\n        }\n        if (this.pos < this.len) {\n            this.buf[this.pos++] = (!this.uni && ch > MAX_LATIN1) ? QUESTION_MARK : ch\n            this.write()\n        }\n    }\n\n    put_string(str: string) {\n        this.put_buffer(Uint32Array.from(str, ch => ch.codePointAt(0)!), true)\n    }\n\n    set_position(mode: number, pos: number) {\n        if (mode === seekmode_Current) {\n            this.pos += pos\n        }\n        else if (mode === seekmode_End) {\n            this.pos = this.len + pos\n        }\n        // Default to start if the mode is invalid\n        else {\n            this.pos = pos\n        }\n        if (this.pos < 0) {\n            this.pos = 0\n        }\n        if (this.pos > this.len) {\n            this.pos = this.len\n        }\n    }\n\n    protected write() {}\n}\n\n/** FileStreams are based on array backed streams, but can grow in length */\nexport class FileStream extends ArrayBackedStream {\n    private fref: FileRef\n\n    constructor(fref: FileRef, buf: GlkTypedArray, fmode: number, rock: number) {\n        super(buf, fmode, rock)\n        this.expandable = true\n        this.fref = fref\n    }\n\n    protected expand(increase: number) {\n        const end_pos = this.pos + increase\n        this.len = end_pos\n        let maxlen = this.buf.length\n        if (end_pos > maxlen) {\n            // Always expand by at least 100\n            maxlen += Math.max(end_pos - maxlen, 100)\n            const old_buf = this.buf\n            this.buf = new (this.uni ? Uint32Array : Uint8Array)(maxlen)\n            this.buf.set(old_buf)\n        }\n    }\n\n    protected write() {\n        this.fref.write(this.buf.subarray(0, this.len))\n    }\n}\n\n/** A null stream */\nexport class NullStream extends StreamBase {\n    type = 'null' as const\n\n    put_buffer(buf: GlkArray, _uni: boolean) {\n        this.write_count += buf.length\n    }\n\n    put_char(_ch: number) {\n        this.write_count++\n    }\n\n    put_string(str: string, _style?: string) {\n        this.write_count += [...str].length\n    }\n}\n\n/** Window streams operate a little bit differently */\nexport class WindowStream extends StreamBase {\n    type = 'window' as const\n    private win: Window\n\n    constructor(win: Window) {\n        super(filemode_Write, 0)\n        this.win = win\n    }\n\n    put_buffer(buf: GlkArray, uni: boolean) {\n        if (this.win.input.type === 'line') {\n            throw new Error('Window has pending line request')\n        }\n        this.write_count += buf.length\n        this.win.put_string(String.fromCodePoint(...buf))\n        this.win.echostr?.put_buffer(buf, uni)\n    }\n\n    put_char(ch: number) {\n        if (this.win.input.type === 'line') {\n            throw new Error('Window has pending line request')\n        }\n        this.write_count++\n        this.win.put_string(String.fromCodePoint(ch))\n        this.win.echostr?.put_char(ch)\n    }\n\n    put_string(str: string, style?: string) {\n        if (this.win.input.type === 'line') {\n            throw new Error('Window has pending line request')\n        }\n        this.write_count += [...str].length\n        this.win.put_string(str, style)\n        this.win.echostr?.put_string(str, style)\n    }\n\n    set_css(name: string, val?: string | number) {\n        this.win.set_css(name, val)\n        if (this.win.echostr?.type === 'window') {\n            this.win.echostr.set_css(name, val)\n        }\n    }\n\n    set_hyperlink(val: number) {\n        this.win.set_hyperlink(val)\n        if (this.win.echostr?.type === 'window') {\n            this.win.echostr.set_hyperlink(val)\n        }\n    }\n\n    set_style(style: string) {\n        this.win.set_style(style)\n        if (this.win.echostr?.type === 'window') {\n            this.win.echostr.set_style(style)\n        }\n    }\n}", "/*\n\nGlk Windows\n===========\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {BufferWindowImage, ContentUpdate, GraphicsWindowOperation, InputUpdate, TextRun, WindowStyles, WindowUpdate as SizeUpdate} from '../common/protocol.js'\n\nimport {winmethod_Above, winmethod_BorderMask, winmethod_DirMask, winmethod_DivisionMask, winmethod_Fixed, winmethod_Left, winmethod_Right, wintype_Blank, wintype_Graphics, wintype_Pair, wintype_TextBuffer, wintype_TextGrid} from './constants.js'\nimport {GlkArray, GlkWindow} from './interface.js'\nimport {Stream, WindowStream} from './streams.js'\n\nexport type Window = BlankWindow | BufferWindow | GraphicsWindow | GridWindow | PairWindow\ntype WindowTypes = 'blank' | 'buffer' | 'graphics' | 'grid' | 'pair'\n\nexport interface WindowBox {\n    bottom: number\n    left: number\n    right: number\n    top: number\n}\n\nexport interface WindowUpdate {\n    content: ContentUpdate | null,\n    input: InputUpdate | null,\n    size: SizeUpdate | null,\n}\n\nabstract class WindowBase implements GlkWindow {\n    // TODO: Make most of these private?\n    box: WindowBox = {\n        bottom: 0,\n        left: 0,\n        right: 0,\n        top: 0,\n    }\n    disprock = 0\n    echostr: Stream | null = null\n    input: InputUpdate = {\n        id: 0,\n    }\n    next: Window | null = null\n    parent: PairWindow | null = null\n    prev: Window | null = null\n    rock: number\n    str: WindowStream\n    abstract type: WindowTypes\n    abstract typenum: number\n\n    constructor(rock: number) {\n        this.rock = rock\n        this.str = new WindowStream(this as Window)\n    }\n\n    clear() {}\n    put_string(_str: string, _style?: string) {}\n    set_css(_name: string, _val?: string | number) {}\n    set_hyperlink(_val: number) {}\n    set_style(_style: string) {}\n\n    update(): WindowUpdate {\n        if (this.type === 'blank' || this.type === 'pair') {\n            return {\n                content: null,\n                input: null,\n                size: null,\n            }\n        }\n\n        const input_update: InputUpdate = {\n            id: this.input.id,\n        }\n        copy_prop(this.input, input_update, 'hyperlink')\n        copy_prop(this.input, input_update, 'mouse')\n\n        const box = this.box\n        return {\n            content: null,\n            input: input_update,\n            size: {\n                height: box.bottom - box.top,\n                id: this.disprock,\n                left: box.left,\n                rock: this.rock,\n                top: box.top,\n                type: this.type,\n                width: box.right - box.left,\n            },\n        }\n    }\n}\n\nexport class BlankWindow extends WindowBase {\n    type = 'blank' as const\n    typenum = wintype_Blank\n}\n\nexport abstract class TextWindow extends WindowBase {\n    cleared = true\n    line_input_buf?: GlkArray\n    request_echo_line_input = true\n    stylehints: WindowStyles\n    uni_input?: boolean\n\n    constructor(rock: number, stylehints: WindowStyles) {\n        super(rock)\n        this.stylehints = stylehints\n    }\n\n    update(): WindowUpdate {\n        const update = super.update()\n\n        // TODO: don't resend stylehints when only metrics have changed?\n        if (Object.keys(this.stylehints).length) {\n            update.size!.styles = this.stylehints\n        }\n\n        const input = this.input\n        const input_update = update.input!\n        if (input.type) {\n            copy_prop(input, input_update, 'gen')\n            copy_prop(input, input_update, 'type')\n            if (input.type === 'line') {\n                input_update.maxlen = (this as TextWindow).line_input_buf!.length\n                copy_prop(input, input_update, 'initial')\n                copy_prop(input, input_update, 'terminators')\n            }\n        }\n        // Clean up the partial output\n        delete input.initial\n\n        return update\n    }\n}\n\n// A modified version of BufferWindowParagraphUpdate that always has content, and the content isn't a string\nexport interface Paragraph {\n    /** Append to last input */\n    append?: boolean\n    /** Line data */\n    content: ParagraphTextRun[]\n    /** Paragraph breaks after floating images */\n    flowbreak?: boolean\n}\ntype ParagraphTextRun = BufferWindowImage | TextRun\n\nexport class BufferWindow extends TextWindow {\n    content: Paragraph[]\n    echo_line_input = true\n    private last_par: Paragraph\n    private last_textrun: TextRun = clone_textrun(BASE_TEXTRUN, true)\n    type = 'buffer' as const\n    typenum = wintype_TextBuffer\n\n    constructor(rock: number, stylehints: WindowStyles) {\n        super(rock, stylehints)\n        this.last_textrun = clone_textrun(BASE_TEXTRUN, true)\n        this.content = [{\n            content: [this.last_textrun],\n        }]\n        this.last_par = this.content[0]\n    }\n\n    clear() {\n        this.cleared = true\n        this.clear_content()\n    }\n\n    clear_content() {\n        this.last_textrun = clone_textrun(this.last_textrun, false)\n        this.content = [{\n            append: true,\n            content: [this.last_textrun],\n        }]\n        this.last_par = this.content[0]\n    }\n\n    private clone_textrun(clone_styles: boolean, force?: boolean) {\n        if (force || this.last_textrun.text !== '') {\n            this.last_textrun = clone_textrun(this.last_textrun, clone_styles)\n            this.last_par.content!.push(this.last_textrun)\n        }\n    }\n\n    put_image(img: BufferWindowImage) {\n        img.hyperlink = this.last_textrun.hyperlink\n        this.last_par.content!.push(img)\n        this.clone_textrun(false, true)\n    }\n\n    put_string(str: string, style?: string) {\n        const old_style = this.last_textrun.style\n        if (style) {\n            this.set_style(style)\n        }\n        for (const [i, line] of str.split('\\n').entries()) {\n            if (i !== 0) {\n                this.last_textrun = clone_textrun(this.last_textrun, false)\n                this.last_par = {content: [this.last_textrun]}\n                this.content.push(this.last_par)\n            }\n            this.last_textrun.text += line\n        }\n        if (style) {\n            this.set_style(old_style)\n        }\n    }\n\n    set_css(name: string, val?: string | number) {\n        if (this.last_textrun.css_styles![name] !== val) {\n            this.clone_textrun(true)\n            if (val === undefined) {\n                delete this.last_textrun.css_styles![name]\n            }\n            else {\n                this.last_textrun.css_styles![name] = val\n            }\n        }\n    }\n\n    set_flow_break() {\n        this.last_par.flowbreak = true\n    }\n\n    set_hyperlink(val?: number) {\n        if (val === 0) {\n            val = undefined\n        }\n        if (val !== this.last_textrun.hyperlink) {\n            this.clone_textrun(false)\n            if (val) {\n                this.last_textrun.hyperlink = val\n            }\n            else {\n                delete this.last_textrun.hyperlink\n            }\n        }\n    }\n\n    set_style(style: string) {\n        if (style !== this.last_textrun.style) {\n            this.clone_textrun(false)\n            this.last_textrun.style = style\n        }\n    }\n\n    update(): WindowUpdate {\n        const update = super.update()\n\n        // Clone the textrun now because the css_style could get deleted in cleanup_paragraph_styles\n        this.last_textrun = clone_textrun(this.last_textrun, false)\n\n        // Exclude empty text runs\n        const paragraphs = this.content\n        for (const par of paragraphs) {\n            par.content = cleanup_paragraph_styles(par.content.filter((text) => 'special' in text || text.text))\n        }\n        // Only send an update if there is new content or the window has been cleared\n        if (this.cleared || paragraphs.length > 1 || paragraphs[0].content.length) {\n            update.content = {\n                id: this.disprock,\n                // Send an empty object for a blank line\n                text: paragraphs.map(par => par.append || par.flowbreak || par.content.length ? par : {}),\n            }\n            if (this.cleared) {\n                update.content.clear = true\n                this.cleared = false\n                // TODO: fg bg\n            }\n        }\n        this.clear_content()\n\n        return update\n    }\n}\n\nexport class GraphicsWindow extends WindowBase {\n    draw: GraphicsWindowOperation[] = []\n    height = 0\n    type = 'graphics' as const\n    typenum = wintype_Graphics\n    uni_input?: boolean\n    width = 0\n\n    clear() {\n        this.draw = this.draw.filter(op => op.special === 'setcolor').slice(-1)\n        this.draw.push({special: 'fill'})\n    }\n\n    update(): WindowUpdate {\n        const update = super.update()\n\n        if (this.draw.length) {\n            update.content = {\n                draw: this.draw,\n                id: this.disprock,\n            }\n            this.draw = []\n        }\n\n        update.size!.graphheight = this.height\n        update.size!.graphwidth = this.width\n\n        return update\n    }\n}\n\ninterface GridLine {\n    content: TextRun[]\n    changed: boolean\n}\n\nexport class GridWindow extends TextWindow {\n    private current_styles = clone_textrun(BASE_TEXTRUN, true)\n    height = 0\n    lines: GridLine[] = []\n    type = 'grid' as const\n    typenum = wintype_TextGrid\n    width = 0\n    x = 0\n    y = 0\n\n    clear() {\n        this.cleared = true\n        const height = this.height\n        this.update_size(0, this.width)\n        this.update_size(height, this.width)\n        this.x = this.y = 0\n    }\n\n    fit_cursor() {\n        if (this.x >= this.width) {\n            this.x = 0\n            this.y++\n        }\n        if (this.y >= this.height) {\n            return true\n        }\n    }\n\n    put_string(str: string, style?: string) {\n        const old_style = this.current_styles.style\n        if (style) {\n            this.set_style(style)\n        }\n        for (const ch of str) {\n            if (this.fit_cursor()) {\n                break\n            }\n            if (ch === '\\n') {\n                this.x = 0\n                this.y++\n                continue\n            }\n            const line = this.lines[this.y]\n            line.changed = true\n            line.content[this.x++] = clone_textrun(this.current_styles, false, ch)\n        }\n        if (style) {\n            this.set_style(old_style)\n        }\n    }\n\n    set_css(name: string, val?: string | number) {\n        if (this.current_styles.css_styles![name] !== val) {\n            this.current_styles = clone_textrun(this.current_styles, true)\n            if (val === undefined) {\n                delete this.current_styles.css_styles![name]\n            }\n            else {\n                this.current_styles.css_styles![name] = val\n            }\n        }\n    }\n\n    set_hyperlink(val: number) {\n        if (val) {\n            this.current_styles.hyperlink = val\n        }\n        else {\n            delete this.current_styles.hyperlink\n        }\n    }\n\n    set_style(style: string) {\n        this.current_styles.style = style\n    }\n\n    update_size(height: number, width: number) {\n        const oldheight = this.height\n        const oldwidth = this.width\n        this.height = height\n        this.width = width\n\n        // Resize the lines array if necessary\n        const blank_space = clone_textrun(BASE_TEXTRUN, true, ' ')\n        if (oldheight > height) {\n            this.lines.length = height\n        }\n        else if (height > oldheight) {\n            for (let i = oldheight; i < height; i++) {\n                const new_line: TextRun[] = []\n                for (let c = 0; c < width; c++) {\n                    new_line.push(clone_textrun(blank_space, false, ' '))\n                }\n                this.lines[i] = {\n                    changed: true,\n                    content: new_line,\n                }\n            }\n        }\n        // Fix the width of old rows\n        const rows_to_fix = Math.min(height, oldheight)\n        if (rows_to_fix && width !== oldwidth) {\n            for (let i = 0; i < rows_to_fix; i++) {\n                const line = this.lines[i]\n                if (width < oldwidth) {\n                    line.changed = true\n                    line.content.length = width\n                }\n                else {\n                    line.changed = true\n                    for (let c = oldwidth; c < width; c++) {\n                        line.content.push(clone_textrun(blank_space, false, ' '))\n                    }\n                }\n            }\n        }\n    }\n\n    update(): WindowUpdate {\n        const update = super.update()\n\n        if (this.lines.find(line => line.changed)) {\n            update.content = {\n                id: this.disprock,\n                lines: this.lines.flatMap((line, index) => {\n                    if (!line.changed) {\n                        return []\n                    }\n                    line.changed = false\n                    return {\n                        content: cleanup_paragraph_styles(line.content.reduce((acc: TextRun[], cur) => {\n                            if (!acc.length) {\n                                return [clone_textrun(cur, false, cur.text)]\n                            }\n\n                            // Combine adjacent characters when they have the same textrun properties\n                            const last = acc[acc.length - 1]\n                            if (cur.css_styles === last.css_styles && cur.hyperlink === last.hyperlink && cur.style === last.style) {\n                                last.text += cur.text\n                            }\n                            else {\n                                acc.push(clone_textrun(cur, false, cur.text))\n                            }\n                            return acc\n                        }, [])) as TextRun[],\n                        line: index,\n                    }\n                }),\n            }\n            if (this.cleared) {\n                update.content.clear = true\n                this.cleared = false\n                // TODO: fg bg\n            }\n        }\n\n        if (this.input.type) {\n            const input_update = update.input!\n            if (this.fit_cursor()) {\n                input_update.xpos = this.width - 1\n                input_update.ypos = this.height - 1\n            }\n            else {\n                input_update.xpos = this.x\n                input_update.ypos = this.y\n            }\n        }\n\n        update.size!.gridheight = this.height\n        update.size!.gridwidth = this.width\n\n        return update\n    }\n}\n\nexport class PairWindow extends WindowBase {\n    backward: boolean\n    child1: Window | null = null\n    child2: Window | null = null\n    border: boolean\n    dir: number\n    fixed: boolean\n    key: Window | null\n    size: number\n    type = 'pair' as const\n    typenum = wintype_Pair\n    vertical: boolean\n\n    constructor(keywin: Window, method: number, size: number) {\n        super(0)\n        this.border = (method & winmethod_BorderMask) === winmethod_BorderMask\n        this.dir = method & winmethod_DirMask\n        this.fixed = (method & winmethod_DivisionMask) === winmethod_Fixed\n        this.key = keywin\n        this.size = size\n        this.backward = this.dir === winmethod_Left || this.dir === winmethod_Above\n        this.vertical = this.dir === winmethod_Left || this.dir === winmethod_Right\n    }\n}\n\nconst BASE_TEXTRUN: TextRun = {\n    css_styles: {},\n    style: 'normal',\n    text: '',\n}\n\n/** Remove css_styles from a paragraph when empty */\nfunction cleanup_paragraph_styles(par: ParagraphTextRun[]) {\n    return par.map(tr => {\n        if (!('special' in tr)) {\n            if (!Object.keys(tr.css_styles!).length) {\n                delete tr.css_styles\n            }\n        }\n        return tr\n    })\n}\n\n/** Clone a text run */\nfunction clone_textrun(tr: TextRun, clone_styles: boolean, new_text = '') {\n    return Object.assign({}, tr, {\n        css_styles: clone_styles ? Object.assign({}, tr.css_styles) : tr.css_styles,\n        text: new_text,\n    })\n}\n\n/** Copy a property from one InputUpdate to another */\nfunction copy_prop(from: InputUpdate, to: InputUpdate, prop: keyof InputUpdate) {\n    if (from[prop]) {\n        (to[prop] as any) = from[prop]\n    }\n}", "/*\n\nGlkApi\n======\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {cloneDeep} from 'lodash-es'\n\nimport {Blorb, ImageInfo} from '../blorb/blorb.js'\nimport {DEFAULT_METRICS, PACKAGE_VERSION} from '../common/constants.js'\nimport {BEBuffer_to_Array, GlkTypedArray, GlkTypedArrayConstructor, utf8decoder} from '../common/misc.js'\nimport * as Protocol from '../common/protocol.js'\nimport {BufferWindowImage, FileRef as DialogFileRef, ImageOperation, NormalisedMetrics, SpecialInput, TerminatorCode, WindowStyles} from '../common/protocol.js'\nimport {CachingDialogWrapper} from '../dialog/common/cache.js'\nimport {GlkOte, GlkOteOptions} from '../glkote/common/glkote.js'\n\nimport {copy_array, TimerData} from './common.js'\nimport * as Const from './constants.js'\nimport {evtype_Arrange, evtype_CharInput, evtype_Hyperlink, evtype_LineInput, evtype_MouseInput, evtype_None, evtype_Redraw, evtype_Timer, filemode_Read, filemode_ReadWrite, filemode_Write, filemode_WriteAppend, fileusage_SavedGame, fileusage_TypeMask, gestalt_CharInput, gestalt_CharOutput, gestalt_CharOutput_ExactPrint, gestalt_DateTime, gestalt_DrawImage, gestalt_GarglkText, gestalt_Graphics, gestalt_GraphicsCharInput, gestalt_GraphicsTransparency, gestalt_HyperlinkInput, gestalt_Hyperlinks, gestalt_LineInput, gestalt_LineInputEcho, gestalt_LineTerminatorKey, gestalt_LineTerminators, gestalt_MouseInput, gestalt_ResourceStream, gestalt_Timer, gestalt_Unicode, gestalt_UnicodeNorm, gestalt_Version, keycode_Escape, keycode_Func1, keycode_Func12, keycode_Left, keycode_MAXVAL, keycode_Unknown, seekmode_End, stylehint_BackColor, stylehint_Indentation, stylehint_Justification, stylehint_NUMHINTS, stylehint_Oblique, stylehint_ParaIndentation, stylehint_Proportional, stylehint_ReverseColor, stylehint_Size, stylehint_TextColor, stylehint_Weight, style_NUMSTYLES, winmethod_Above, winmethod_Below, winmethod_Border, winmethod_BorderMask, winmethod_DirMask, winmethod_DivisionMask, winmethod_Fixed, winmethod_Left, winmethod_NoBorder, winmethod_Proportional, winmethod_Right, wintype_AllTypes, wintype_Blank, wintype_Graphics, wintype_Pair, wintype_TextBuffer, wintype_TextGrid, zcolor_Current, zcolor_Default} from './constants.js'\nimport {FileRef} from './filerefs.js'\nimport * as Interface from './interface.js'\nimport {DidNotReturn, GlkArray, GlkApiOptions, GlkByteArray, GlkSchannel, GlkWordArray, RefBoxArg, RefStructArg, RefStructValue} from './interface.js'\nimport {CSS_STYLE_PROPERTIES, FILE_MODES, FILE_TYPES, IMAGE_ALIGNMENTS, KEY_NAMES_TO_CODES, STYLE_NAMES, TERMINATOR_KEYS, TERMINATOR_KEYS_TO_CODES} from './lib_constants.js'\nimport {ArrayBackedStream, FileStream, NullStream, Stream} from './streams.js'\nimport {BlankWindow, BufferWindow, GraphicsWindow, GridWindow, PairWindow, TextWindow, Window, WindowBox} from './windows.js'\n\nexport class RefBox implements Interface.RefBox {\n    private value: RefStructValue = 0\n    get_value() {\n        return this.value\n    }\n    set_value(val: RefStructValue) {\n        this.value = val\n    }\n}\n\nexport class RefStruct implements Interface.RefStruct {\n    private fields: RefStructValue[] = []\n    get_field(index: number): RefStructValue {\n        return this.fields[index]\n    }\n    get_fields(): RefStructValue[] {\n        return this.fields\n    }\n    push_field(val: RefStructValue) {\n        this.fields.push(val)\n    }\n    set_field(index: number, val: RefStructValue) {\n        this.fields[index] = val\n    }\n}\n\nexport class AsyncGlk implements Interface.GlkApi {\n    private Blorb?: Blorb\n    private Dialog: CachingDialogWrapper = null as any as CachingDialogWrapper\n    private GiDispa?: Interface.GiDispa\n    private GlkOte: GlkOte = null as any as GlkOte\n    private VM: Interface.GlkVM = null as any as Interface.GlkVM\n\n    private before_select_hook: GlkApiOptions['before_select_hook']\n    private gestalt_hook: GlkApiOptions['glk_gestalt_hook']\n\n    // For assigning disprocks when there is no GiDispa\n    private disprock_counter = 1\n\n    private do_autosave = false\n\n    private exited = false\n\n    private first_fref: FileRef | null = null\n\n    private gen = 0\n\n    private metrics: NormalisedMetrics = DEFAULT_METRICS\n\n    private partial_inputs?: Record<number, string>\n\n    private selectref?: RefStruct\n\n    private special?: SpecialInput\n    private special_data?: {\n        rock: number,\n        usage: number,\n    }\n\n    private current_stream: Stream | null = null\n    private first_stream: Stream | null = null\n\n    private stylehints: {buffer: WindowStyles, grid: WindowStyles} = {\n        buffer: {},\n        grid: {},\n    }\n\n    private support: string[] = []\n\n    private timer: TimerData = {\n        interval: 0,\n        last_interval: 0,\n        started: 0,\n    }\n\n    version = PACKAGE_VERSION\n\n    private first_window: Window | null = null\n    private root_window: Window | null = null\n    private windows_changed = false\n\n    // API functions\n\n    init(options: GlkApiOptions) {\n        this.before_select_hook = options.before_select_hook\n        this.Blorb = options.Blorb\n        if (options.Dialog) {\n            this.Dialog = new CachingDialogWrapper(options.Dialog)\n        }\n        else {\n            throw new Error('No reference to Dialog')\n        }\n        this.do_autosave = !!options.do_vm_autosave\n        // exit_warning\n        // extevent_hook\n        this.GiDispa = options.GiDispa\n        this.gestalt_hook = options.glk_gestalt_hook\n        if (options.GlkOte) {\n            this.GlkOte = options.GlkOte\n        }\n        else {\n            throw new Error('No reference to GlkOte')\n        }\n        if (options.vm) {\n            this.VM = options.vm\n        }\n        else {\n            throw new Error('No reference to VM')\n        }\n\n        this.before_select_hook?.()\n        this.GiDispa?.init({\n            io: this,\n            vm: this.VM,\n        })\n        const glkote_options = options as any as GlkOteOptions\n        glkote_options.accept = this.accept.bind(this)\n        this.GlkOte.init(glkote_options)\n    }\n\n    call_may_not_return(id: number): boolean {\n        return id === 0x01 || id === 0xC0 || id === 0x62\n    }\n\n    fatal_error(msg: string) {\n        this.exited = true\n        if (!this.GlkOte) {\n            console.error('Fatal error: ' + msg)\n            return\n        }\n        this.GlkOte.error(msg)\n        this.GlkOte.update({\n            type: 'update',\n            disable: true,\n            gen: this.gen,\n        })\n    }\n\n    getlibrary(class_name: string) {\n        switch (class_name) {\n            case 'Blorb':\n                return this.Blorb || null\n            case 'Dialog':\n                return this.Dialog\n            case 'GiDispa':\n                return this.GiDispa || null\n            case 'GlkOte':\n                return this.GlkOte\n            case 'VM':\n                return this.VM\n            default:\n                return null\n        }\n    }\n\n    inited() {\n        return !!(this.GlkOte && this.VM)\n    }\n\n    restore_allstate(_state: any) {\n        throw new Error('Autosaves not yet supported')\n    }\n    save_allstate() {\n        throw new Error('Autosaves not yet supported')\n    }\n\n    update() {\n        const state: Protocol.StateUpdate = {\n            gen: this.gen,\n            type: 'update',\n        }\n\n        if (this.exited) {\n            state.disable = true\n        }\n\n        // Get the window updates\n        const contents: Protocol.ContentUpdate[] = []\n        const inputs: Protocol.InputUpdate[] = []\n        const sizes: Protocol.WindowUpdate[] = []\n        for (let win = this.first_window; win; win = win.next) {\n            const update = win.update()\n            if (update.content) {\n                contents.push(update.content)\n            }\n            if (update.input) {\n                const input_update = update.input\n                if (input_update.hyperlink || input_update.mouse || input_update.type) {\n                    inputs.push(input_update)\n                }\n            }\n            if (this.windows_changed && update.size) {\n                sizes.push(update.size)\n            }\n        }\n        if (contents.length) {\n            state.content = contents\n        }\n        if (inputs.length) {\n            state.input = inputs\n        }\n        if (sizes.length) {\n            state.windows = sizes\n        }\n        this.windows_changed = false\n\n        // TODO: Page BG colour\n\n        // Special input\n        if (this.special) {\n            state.specialinput = this.special\n            delete this.special\n        }\n\n        // Timer\n        const timer = this.timer\n        if (timer.last_interval !== timer.interval) {\n            state.timer = timer.interval || null\n            timer.last_interval = timer.interval\n        }\n\n        // Autorestore state?\n\n        // Clone the state so that any objects copied into it won't be at risk of modification by GlkOte\n        this.GlkOte.update(cloneDeep(state))\n        this.before_select_hook?.()\n        // TODO\n        // if (this.do_autosave) {}\n    }\n\n    // References to other things\n\n    Const = Const\n    DidNotReturn = DidNotReturn\n    RefBox = RefBox\n    RefStruct = RefStruct\n\n    // Extra functions\n\n    byte_array_to_string(arr: GlkByteArray) {\n        return String.fromCodePoint(...arr)\n    }\n\n    glk_put_jstring(val: string, _all_bytes?: boolean) {\n        this.glk_put_jstring_stream(this.current_stream!, val)\n    }\n\n    glk_put_jstring_stream(str: Stream, val: string, _all_bytes?: boolean) {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        str.put_string(val)\n    }\n\n    uni_array_to_string(arr: GlkWordArray) {\n        return String.fromCodePoint(...arr)\n    }\n\n    // The Glk functions\n\n    glk_buffer_canon_decompose_uni(buf: GlkWordArray, initlen: number): number {\n        return buffer_transformer(buf, initlen, str => (str as string).normalize('NFD'))\n    }\n\n    glk_buffer_canon_normalize_uni(buf: GlkWordArray, initlen: number): number {\n        return buffer_transformer(buf, initlen, str => (str as string).normalize('NFC'))\n    }\n\n    glk_buffer_to_lower_case_uni(buf: GlkWordArray, initlen: number): number {\n        return buffer_transformer(buf, initlen, str => (str as string).toLowerCase())\n    }\n\n    glk_buffer_to_title_case_uni(buf: GlkWordArray, initlen: number, lowerrest: number): number {\n        return buffer_transformer(buf, initlen, buf => (buf as Uint32Array).reduce((prev, ch, index) => {\n            const special_cases: Record<string, string> = {\n                \u00DF: 'Ss', \u01C4: '\u01C5', \u01C5: '\u01C5', \u01C6: '\u01C5', \u01C7: '\u01C8', \u01C8: '\u01C8', \u01C9: '\u01C8', \u01CA: '\u01CB', \u01CB: '\u01CB', \u01CC: '\u01CB',\n                \u01F1: '\u01F2', \u01F2: '\u01F2', \u01F3: '\u01F2', \u0587: '\u0535\u0582', \u1FB2: '\u1FBA\u0345', \u1FB3: '\u1FBC', \u1FB4: '\u0386\u0345', \u1FB7: '\u0391\u0342\u0345', \u1FBC: '\u1FBC', \u1FC2: '\u1FCA\u0345',\n                \u1FC3: '\u1FCC', \u1FC4: '\u0389\u0345', \u1FC7: '\u0397\u0342\u0345', \u1FCC: '\u1FCC', \u1FF2: '\u1FFA\u0345', \u1FF3: '\u1FFC', \u1FF4: '\u038F\u0345', \u1FF7: '\u03A9\u0342\u0345', \u1FFC: '\u1FFC', \uFB00: 'Ff',\n                \uFB01: 'Fi', \uFB02: 'Fl', \uFB03: 'Ffi', \uFB04: 'Ffl', \uFB05: 'St', \uFB06: 'St', \uFB13: '\u0544\u0576', \uFB14: '\u0544\u0565',\n                \uFB15: '\u0544\u056B', \uFB16: '\u054E\u0576', \uFB17: '\u0544\u056D',\n            }\n            const slightly_less_special_cases = ['\u1F88\u1F89\u1F8A\u1F8B\u1F8C\u1F8D\u1F8E\u1F8F', '\u1F98\u1F99\u1F9A\u1F9B\u1F9C\u1F9D\u1F9E\u1F9F', '\u1FA8\u1FA9\u1FAA\u1FAB\u1FAC\u1FAD\u1FAE\u1FAF']\n            let thischar = String.fromCodePoint(ch)\n            if (index === 0) {\n                if (special_cases[thischar]) {\n                    thischar = special_cases[thischar]\n                }\n                else if (ch >= 8064 && ch < 8112) {\n                    thischar = slightly_less_special_cases[((ch - 8064) / 16) | 0][ch % 8]\n                }\n                else {\n                    thischar = thischar.toUpperCase()\n                }\n            }\n            else if (lowerrest) {\n                thischar = thischar.toLowerCase()\n            }\n            return prev + thischar\n        }, ''), true)\n    }\n\n    glk_buffer_to_upper_case_uni(buf: GlkWordArray, initlen: number): number {\n        return buffer_transformer(buf, initlen, str => (str as string).toUpperCase())\n    }\n\n    glk_cancel_char_event(win: Window) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        delete win.input.type\n    }\n\n    glk_cancel_hyperlink_event(win: Window) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type === 'buffer' || win.type === 'grid') {\n            delete win.input.hyperlink\n        }\n    }\n\n    glk_cancel_line_event(win: Window, ev?: RefStructArg) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.input.type !== 'line' || (win.type !== 'buffer' && win.type !== 'grid')) {\n            if (ev) {\n                set_event(ev)\n            }\n            return\n        }\n\n        this.handle_line_input(win, this.partial_inputs?.[win.disprock] ?? '', ev)\n    }\n\n    glk_cancel_mouse_event(win: Window) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type === 'graphics' || win.type === 'grid') {\n            delete win.input.mouse\n        }\n    }\n\n    glk_char_to_lower(val: number): number {\n        if (val >= 0x41 && val <= 0x5A) {\n            return val + 0x20\n        }\n        if (val >= 0xC0 && val <= 0xDE && val !== 0xD7) {\n            return val + 0x20\n        }\n        return val\n    }\n\n    glk_char_to_upper(val: number): number {\n        if (val >= 0x61 && val <= 0x7A) {\n            return val - 0x20\n        }\n        if (val >= 0xE0 && val <= 0xFE && val !== 0xF7) {\n            return val - 0x20\n        }\n        return val\n    }\n\n    glk_current_simple_time(factor: number): number {\n        return Math.floor(Date.now() / (factor * 1000))\n    }\n\n    glk_current_time(struct: RefStruct) {\n        timestamp_to_time_struct(Date.now(), struct)\n    }\n\n    glk_date_to_simple_time_local(struct: RefStruct, factor: number): number {\n        return Math.floor(date_struct_to_timestamp_local(struct) / (factor * 1000))\n    }\n\n    glk_date_to_simple_time_utc(struct: RefStruct, factor: number): number {\n        return Math.floor(date_struct_to_timestamp_utc(struct) / (factor * 1000))\n    }\n\n    glk_date_to_time_local(datestruct: RefStruct, timestruct: RefStruct) {\n        timestamp_to_time_struct(date_struct_to_timestamp_local(datestruct), timestruct)\n    }\n\n    glk_date_to_time_utc(datestruct: RefStruct, timestruct: RefStruct) {\n        timestamp_to_time_struct(date_struct_to_timestamp_utc(datestruct), timestruct)\n    }\n\n    glk_exit(): typeof DidNotReturn {\n        this.exited = true\n        // What is this for?\n        /*if (option_exit_warning) {\n            GlkOte.warning(option_exit_warning);\n        }*/\n        return DidNotReturn\n    }\n\n    glk_fileref_create_by_name(usage: number, filename: string, rock: number): FileRef {\n        const fixed_filename = this.Dialog.file_clean_fixed_name(filename, usage & fileusage_TypeMask)\n        return this.create_fileref(fixed_filename, rock, usage)\n    }\n\n    glk_fileref_create_by_prompt(usage: number, fmode: number, rock: number): typeof DidNotReturn {\n        const filemode = FILE_MODES[fmode] ?? 'read'\n        const filetypenum = usage & fileusage_TypeMask\n        const filetype = FILE_TYPES[filetypenum] ?? 'data'\n\n        this.special = {\n            filemode,\n            filetype,\n            type: 'fileref_prompt',\n        }\n        if (filetypenum === fileusage_SavedGame) {\n            this.special.gameid = this.VM.get_signature()\n        }\n        this.special_data = {\n            rock,\n            usage,\n        }\n        return DidNotReturn\n    }\n\n    glk_fileref_create_from_fileref(usage: number, oldfref: FileRef, rock: number): FileRef {\n        if (!oldfref) {\n            throw new Error('Invalid Fileref')\n        }\n        return this.create_fileref(oldfref.filename, rock, usage)\n    }\n\n    glk_fileref_create_temp(usage: number, rock: number): FileRef {\n        const filetypename = FILE_TYPES[usage & fileusage_TypeMask]\n        const dialog_fref = this.Dialog.file_construct_temp_ref(filetypename)\n        return this.create_fileref(dialog_fref.filename, rock, usage, dialog_fref)\n    }\n\n    glk_fileref_delete_file(fref: FileRef) {\n        if (!fref) {\n            throw new Error('Invalid Fileref')\n        }\n        fref.delete_file()\n    }\n\n    glk_fileref_destroy(fref: FileRef) {\n        if (!fref) {\n            throw new Error('Invalid Fileref')\n        }\n        this.GiDispa?.class_unregister('fileref', fref)\n        const prev = fref.prev\n        const next = fref.next\n        fref.prev = null\n        fref.next = null\n        if (prev) {\n            prev.next = next\n        }\n        else {\n            this.first_fref = next\n        }\n        if (next) {\n            next.prev = prev\n        }\n    }\n\n    glk_fileref_does_file_exist(fref: FileRef): boolean {\n        if (!fref) {\n            throw new Error('Invalid Fileref')\n        }\n        return fref.exists()\n    }\n\n    glk_fileref_get_rock(fref: FileRef): number {\n        if (!fref) {\n            throw new Error('Invalid Fileref')\n        }\n        return fref.rock\n    }\n\n    glk_fileref_iterate(fref?: FileRef, rockbox?: RefBoxArg): FileRef | null {\n        const next_fref = fref ? fref.next : this.first_fref\n        if (rockbox) {\n            rockbox.set_value(next_fref ? next_fref.rock : 0)\n        }\n        return next_fref\n    }\n\n    glk_gestalt(sel: number, val: number): number {\n        return this.glk_gestalt_ext(sel, val, null)\n    }\n\n    glk_gestalt_ext(sel: number, val: number, arr: GlkArray | null): number {\n        const hook_res = this.gestalt_hook?.(sel, val, arr)\n        if (hook_res) {\n            return hook_res\n        }\n\n        switch (sel) {\n            case gestalt_Version:\n                return 0x00000704\n            case gestalt_CharInput:\n                // Known special keys can be returned\n                if (val <= keycode_Left && val >= keycode_Func12) {\n                    return 1\n                }\n                // But no other high bit values, non-unicode, or control codes\n                if (val >= (0x100000000 - keycode_MAXVAL) || val > 0x10FFFF || (val >= 0 && val < 32) || val >= 127 && val < 160) {\n                    return 0\n                }\n                // Otherwise assume yes\n                return 1\n            case gestalt_LineInput:\n                // Same as above, except no special keys\n                if (val > 0x10FFFF || (val >= 0 && val < 32) || val >= 127 && val < 160) {\n                    return 0\n                }\n                return 1\n            case gestalt_CharOutput:\n                // We'll output anything, but it may not result in something readable\n                if (arr) {\n                    arr[0] = 1\n                }\n                return gestalt_CharOutput_ExactPrint\n            case gestalt_LineTerminatorKey:\n                return +(val === keycode_Escape || (val >= keycode_Func12 && val <= keycode_Func1))\n            // These are dependent on what GlkOte tells us it supports\n            case gestalt_DrawImage:\n                return +((val === wintype_Graphics || val === wintype_TextBuffer) && this.support.includes('graphics'))\n            case gestalt_GarglkText:\n                return +this.support.includes('garglktext')\n            case gestalt_Graphics:\n            case gestalt_GraphicsCharInput:\n            case gestalt_GraphicsTransparency:\n                return +this.support.includes('graphics')\n            case gestalt_Hyperlinks:\n                return +this.support.includes('hyperlinks')\n            case gestalt_HyperlinkInput:\n                return +((val === wintype_TextBuffer || val === wintype_TextGrid) && this.support.includes('hyperlinks'))\n            case gestalt_MouseInput:\n                return +((val === wintype_Graphics || val === wintype_TextGrid) && this.support.includes('graphics'))\n            case gestalt_Timer:\n                return +this.support.includes('timer')\n            // These are always supported\n            case gestalt_DateTime:\n            case gestalt_LineInputEcho:\n            case gestalt_LineTerminators:\n            case gestalt_ResourceStream:\n            case gestalt_Unicode:\n            case gestalt_UnicodeNorm:\n                return 1\n            // Anything else is unsupported\n            default:\n                return 0\n        }\n    }\n\n    glk_get_buffer_stream(str: Stream, buf: GlkByteArray): number {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.fmode !== filemode_Read && str.fmode !== filemode_ReadWrite) {\n            throw new Error ('Cannot read from write-only stream')\n        }\n        if (Array.isArray(buf)) {\n            return wrap_for_array(buf, Uint8Array, arr => str.get_buffer(arr))\n        }\n        else {\n            return str.get_buffer(buf)\n        }\n    }\n\n    glk_get_buffer_stream_uni(str: Stream, buf: GlkWordArray): number {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.fmode !== filemode_Read && str.fmode !== filemode_ReadWrite) {\n            throw new Error ('Cannot read from write-only stream')\n        }\n        if (Array.isArray(buf)) {\n            return wrap_for_array(buf, Uint32Array, arr => str.get_buffer(arr))\n        }\n        else {\n            return str.get_buffer(buf)\n        }\n    }\n\n    glk_get_char_stream(str: Stream): number {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.fmode !== filemode_Read && str.fmode !== filemode_ReadWrite) {\n            throw new Error ('Cannot read from write-only stream')\n        }\n        return str.get_char(false)\n    }\n\n    glk_get_char_stream_uni(str: Stream): number {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.fmode !== filemode_Read && str.fmode !== filemode_ReadWrite) {\n            throw new Error ('Cannot read from write-only stream')\n        }\n        return str.get_char(true)\n    }\n\n    glk_get_line_stream(str: Stream, buf: GlkByteArray): number {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.fmode !== filemode_Read && str.fmode !== filemode_ReadWrite) {\n            throw new Error ('Cannot read from write-only stream')\n        }\n        if (Array.isArray(buf)) {\n            // Handle the NULL byte by adding and subtracting 1 to the read length\n            return wrap_for_array(buf, Uint8Array, arr => str.get_line(arr) + 1) - 1\n        }\n        else {\n            return str.get_line(buf)\n        }\n    }\n\n    glk_get_line_stream_uni(str: Stream, buf: GlkWordArray): number {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.fmode !== filemode_Read && str.fmode !== filemode_ReadWrite) {\n            throw new Error ('Cannot read from write-only stream')\n        }\n        if (Array.isArray(buf)) {\n            // Handle the NULL byte by adding and subtracting 1 to the read length\n            return wrap_for_array(buf, Uint32Array, arr => str.get_line(arr) + 1) - 1\n        }\n        else {\n            return str.get_line(buf)\n        }\n    }\n\n    glk_image_draw(win: Window, imgid: number, val1: number, val2: number): number {\n        const info = this.Blorb?.get_image_info(imgid)\n        if (!info) {\n            return 0\n        }\n        this.draw_image(win, info, info.height || 0, val1, val2, info.width || 0)\n        return 1\n    }\n\n    glk_image_draw_scaled(win: Window, imgid: number, val1: number, val2: number, width: number, height: number): number {\n        const info = this.Blorb?.get_image_info(imgid)\n        if (!info) {\n            return 0\n        }\n        this.draw_image(win, info, height || 0, val1, val2, width || 0)\n        return 1\n    }\n\n    glk_image_get_info(imgid: number, width?: RefBoxArg, height?: RefBoxArg): number {\n        const info = this.Blorb?.get_image_info(imgid)\n        if (height) {\n            height.set_value(info?.height || 0)\n        }\n        if (width) {\n            width.set_value(info?.width || 0)\n        }\n        return info ? 1 : 0\n    }\n\n    glk_put_buffer(val: GlkByteArray) {\n        this.glk_put_buffer_stream(this.current_stream!, val)\n    }\n\n    glk_put_buffer_stream(str: Stream, val: GlkByteArray) {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.fmode === filemode_Read) {\n            throw new Error('Cannot write to read-only stream')\n        }\n        str.put_buffer(val, false)\n    }\n\n    glk_put_buffer_stream_uni(str: Stream, val: GlkWordArray) {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.fmode === filemode_Read) {\n            throw new Error('Cannot write to read-only stream')\n        }\n        str.put_buffer(val, true)\n    }\n\n    glk_put_buffer_uni(val: GlkWordArray) {\n        this.glk_put_buffer_stream_uni(this.current_stream!, val)\n    }\n\n    glk_put_char(val: number) {\n        this.glk_put_char_stream(this.current_stream!, val)\n    }\n\n    glk_put_char_stream(str: Stream, val: number) {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.fmode === filemode_Read) {\n            throw new Error('Cannot write to read-only stream')\n        }\n        str.put_char(val)\n    }\n\n    glk_put_char_stream_uni(str: Stream, val: number) {\n        this.glk_put_char_stream(str, val)\n    }\n\n    glk_put_char_uni(val: number) {\n        this.glk_put_char_stream(this.current_stream!, val)\n    }\n\n    glk_put_string(val: string) {\n        this.glk_put_string_stream(this.current_stream!, val)\n    }\n\n    glk_put_string_stream(str: Stream, val: string) {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.fmode === filemode_Read) {\n            throw new Error('Cannot write to read-only stream')\n        }\n        str.put_string(val)\n    }\n\n    glk_put_string_stream_uni(str: Stream, val: string) {\n        this.glk_put_string_stream(str, val)\n    }\n\n    glk_put_string_uni(val: string) {\n        this.glk_put_string_stream(this.current_stream!, val)\n    }\n\n    glk_request_char_event(win: Window) {\n        this.request_char_event(win, false)\n    }\n\n    glk_request_char_event_uni(win: Window) {\n        this.request_char_event(win, true)\n    }\n\n    glk_request_hyperlink_event(win: Window) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type === 'buffer' || win.type === 'grid') {\n            win.input.hyperlink = true\n        }\n    }\n\n    glk_request_line_event(win: Window, buf: GlkByteArray, initlen?: number) {\n        this.request_line_event(win, buf, false, initlen)\n    }\n\n    glk_request_line_event_uni(win: Window, buf: GlkWordArray, initlen?: number) {\n        this.request_line_event(win, buf, true, initlen)\n    }\n\n    glk_request_mouse_event(win: Window) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type === 'graphics' || win.type === 'grid') {\n            win.input.mouse = true\n        }\n    }\n\n    glk_request_timer_events(msecs: number) {\n        this.timer.interval = msecs\n        this.timer.started = msecs ? Date.now() : 0\n    }\n\n    glk_schannel_create(_rock: number): GlkSchannel | null {\n        return null\n    }\n\n    glk_schannel_create_ext(_rock: number, _volume: number): GlkSchannel | null {\n        return null\n    }\n\n    glk_schannel_destroy(_schannel: GlkSchannel) {\n        throw new Error('Invalid Schannel')\n    }\n\n    glk_schannel_get_rock(_schannel: GlkSchannel): number {\n        throw new Error('Invalid Schannel')\n    }\n\n    glk_schannel_iterate(_schannel?: GlkSchannel, rockbox?: RefBoxArg): GlkSchannel | null {\n        if (rockbox) {\n            rockbox.set_value(0)\n        }\n        return null\n    }\n\n    glk_schannel_pause(_schannel: GlkSchannel) {\n        throw new Error('Invalid Schannel')\n    }\n\n    glk_schannel_play(_schannel: GlkSchannel, _sound: number): number {\n        throw new Error('Invalid Schannel')\n    }\n\n    glk_schannel_play_ext(_schannel: GlkSchannel, _sound: number, _repeats: number, _notify: number): number {\n        throw new Error('Invalid Schannel')\n    }\n\n    glk_schannel_play_multi(_schannels: GlkSchannel[], _sounds: GlkArray, _notify: number): number {\n        throw new Error('Invalid Schannel')\n    }\n\n    glk_schannel_set_volume(_schannel: GlkSchannel, _volume: number) {\n        throw new Error('Invalid Schannel')\n    }\n\n    glk_schannel_set_volume_ext(_schannel: GlkSchannel, _volume: number, __duration: number, notify: number) {\n        throw new Error('Invalid Schannel')\n    }\n\n    glk_schannel_stop(_schannel: GlkSchannel) {\n        throw new Error('Invalid Schannel')\n    }\n\n    glk_schannel_unpause(_schannel: GlkSchannel) {\n        throw new Error('Invalid Schannel')\n    }\n\n    glk_select(ev: RefStruct): typeof DidNotReturn {\n        this.selectref = ev\n        return DidNotReturn\n    }\n\n    glk_select_poll(ev: RefStruct) {\n        // As JS is single threaded, the only event we could possibly have had since the last glk_select_poll call is a timer event\n        set_event(ev)\n\n        const timer = this.timer\n        if (timer.interval) {\n            const now = Date.now()\n            if (now - timer.started > timer.interval) {\n                // Pretend we got a timer event\n                timer.last_interval = 0\n                timer.started = now\n                ev.set_field(0, evtype_Timer)\n            }\n        }\n    }\n\n    glk_set_echo_line_event(win: Window, val: number) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type === 'buffer') {\n            win.echo_line_input = !!val\n        }\n    }\n\n    glk_set_hyperlink(val: number) {\n        this.glk_set_hyperlink_stream(this.current_stream!, val)\n    }\n\n    glk_set_hyperlink_stream(str: Stream, val: number) {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.type === 'window') {\n            str.set_hyperlink(val)\n        }\n    }\n\n    glk_set_style(style: number) {\n        this.glk_set_style_stream(this.current_stream!, style)\n    }\n\n    glk_set_style_stream(str: Stream, style: number) {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.type === 'window') {\n            if (style < 0 || style > style_NUMSTYLES) {\n                style = 0\n            }\n            str.set_style(STYLE_NAMES[style])\n        }\n    }\n\n    glk_set_terminators_line_event(win: Window, keycodes: GlkArray) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        const terminators: TerminatorCode[] = []\n        for (const code of keycodes) {\n            if (TERMINATOR_KEYS[code]) {\n                terminators.push(TERMINATOR_KEYS[code])\n            }\n        }\n        if (terminators.length) {\n            win.input.terminators = terminators\n        }\n        else {\n            delete win.input.terminators\n        }\n    }\n\n    glk_set_window(win?: Window) {\n        this.current_stream = win ? win.str : null\n    }\n\n    glk_sound_load_hint(_sound: number, _load: number) {}\n\n    glk_stream_close(str: Stream, result?: RefStructArg) {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        str.close(result)\n        this.unregister_stream(str)\n    }\n\n    glk_stream_get_current(): Stream | null {\n        return this.current_stream\n    }\n\n    glk_stream_get_position(str: Stream): number {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        return str.get_position()\n    }\n\n    glk_stream_get_rock(str: Stream): number {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        return str.rock\n    }\n\n    glk_stream_iterate(str?: Stream, rockbox?: RefBoxArg): Stream | null {\n        const next_stream = str ? str.next : this.first_stream\n        if (rockbox) {\n            rockbox.set_value(next_stream ? next_stream.rock : 0)\n        }\n        return next_stream\n    }\n\n    glk_stream_open_file(fref: FileRef, mode: number, rock: number): Stream | null {\n        return this.create_file_stream(fref, mode, rock, false)\n    }\n\n    glk_stream_open_file_uni(fref: FileRef, mode: number, rock: number): Stream | null {\n        return this.create_file_stream(fref, mode, rock, true)\n    }\n\n    glk_stream_open_memory(buf: GlkByteArray | null, mode: number, rock: number): Stream {\n        return this.create_memory_stream(buf, mode, rock, Uint8Array)\n    }\n\n    glk_stream_open_memory_uni(buf: GlkWordArray | null, mode: number, rock: number): Stream {\n        return this.create_memory_stream(buf, mode, rock, Uint32Array)\n    }\n\n    glk_stream_open_resource(filenum: number, rock: number): Stream | null {\n        return this.create_resource_stream(filenum, rock, false)\n    }\n\n    glk_stream_open_resource_uni(filenum: number, rock: number): Stream | null {\n        return this.create_resource_stream(filenum, rock, true)\n    }\n\n    glk_stream_set_current(str: Stream | null) {\n        this.current_stream = str\n    }\n\n    glk_stream_set_position(str: Stream, pos: number, seekmode: number) {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        str.set_position(seekmode, pos)\n    }\n\n    glk_style_distinguish(_win: Window, _style1: number, _style2: number): number {\n        return 0\n    }\n\n    glk_style_measure(_win: Window, _style: number, _hint: number, result?: RefBoxArg): number {\n        if (result) {\n            result.set_value(0)\n        }\n        return 0\n    }\n\n    glk_stylehint_clear(wintype: number, style: number, hint: number) {\n        const selector = `${hint <= stylehint_Justification ? 'div' : 'span'}.Style_${STYLE_NAMES[style]}`\n        function remove_style(styles: WindowStyles) {\n            if (styles[selector]) {\n                delete styles[selector][CSS_STYLE_PROPERTIES[hint]]\n                if (!Object.keys(styles[selector]).length) {\n                    delete styles[selector]\n                }\n            }\n        }\n\n        if (wintype === wintype_AllTypes || wintype === wintype_TextBuffer) {\n            remove_style(this.stylehints.buffer)\n        }\n\n        if (wintype === wintype_AllTypes || wintype === wintype_TextGrid) {\n            remove_style(this.stylehints.grid)\n        }\n    }\n\n    glk_stylehint_set(wintype: number, style: number, hint: number, value: number) {\n        if (style < 0 || style >= style_NUMSTYLES || hint < 0 || hint >= stylehint_NUMHINTS) {\n            return\n        }\n        if (wintype === wintype_AllTypes) {\n            this.glk_stylehint_set(wintype_TextBuffer, style, hint, value)\n            this.glk_stylehint_set(wintype_TextGrid, style, hint, value)\n            return\n        }\n        if (wintype === wintype_Blank || wintype === wintype_Graphics || wintype === wintype_Pair) {\n            return\n        }\n\n        const stylehints = wintype === wintype_TextBuffer ? this.stylehints.buffer : this.stylehints.grid\n        const selector = `${hint <= stylehint_Justification ? 'div' : 'span'}.Style_${STYLE_NAMES[style]}`\n        const justifications = ['left', 'justify', 'center', 'right']\n        const weights = ['lighter', 'normal', 'bold']\n        let stylevalue: string | number | undefined\n\n        if (hint === stylehint_Indentation || hint === stylehint_ParaIndentation) {\n            stylevalue = value + 'em'\n        }\n        if (hint === stylehint_Justification) {\n            stylevalue = justifications[value]\n        }\n        if (hint === stylehint_Size) {\n            stylevalue = (1 + value * 0.1) + 'em'\n        }\n        if (hint === stylehint_Weight) {\n            stylevalue = weights[value]\n        }\n        if (hint === stylehint_Oblique) {\n            stylevalue = value ? 'italic' : 'normal'\n        }\n        if (hint === stylehint_Proportional) {\n            stylevalue = value ? 0 : 1\n        }\n        if (hint === stylehint_TextColor || hint === stylehint_BackColor) {\n            stylevalue = colour_code_to_css(value)\n        }\n        if (hint === stylehint_ReverseColor) {\n            stylevalue = value\n        }\n\n        if (stylevalue === undefined) {\n            return\n        }\n\n        if (!stylehints[selector]) {\n            stylehints[selector] = {}\n        }\n        stylehints[selector][CSS_STYLE_PROPERTIES[hint]] = stylevalue\n    }\n\n    glk_tick() {}\n\n    glk_simple_time_to_date_local(time: number, factor: number, struct: RefStruct) {\n        timestamp_to_date_struct_local(time * 1000 * factor, struct)\n    }\n\n    glk_simple_time_to_date_utc(time: number, factor: number, struct: RefStruct) {\n        timestamp_to_date_struct_utc(time * 1000 * factor, struct)\n    }\n\n    glk_time_to_date_local(timestruct: RefStruct, datestruct: RefStruct) {\n        timestamp_to_date_struct_local(time_struct_to_timestamp(timestruct), datestruct)\n    }\n\n    glk_time_to_date_utc(timestruct: RefStruct, datestruct: RefStruct) {\n        timestamp_to_date_struct_utc(time_struct_to_timestamp(timestruct), datestruct)\n    }\n\n    glk_window_clear(win: Window) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.input.type === 'line') {\n            throw new Error('Window has pending line input')\n        }\n        win.clear()\n    }\n\n    glk_window_close(win: Window, stats?: RefStructArg) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n\n        win.str.close(stats)\n\n        if (win === this.root_window) {\n            // Close the root window, which means all windows\n            this.root_window = null\n            this.remove_window(win, true)\n        }\n        else {\n            const parent_win = win.parent!\n            const sibling_win = parent_win.child1 === win ? parent_win.child2! : parent_win.child1!\n            const grandparent_win = parent_win.parent\n            if (grandparent_win) {\n                if (grandparent_win.child1 === parent_win) {\n                    grandparent_win.child1 = sibling_win\n                }\n                else {\n                    grandparent_win.child2 = sibling_win\n                }\n                sibling_win.parent = grandparent_win\n            }\n            else {\n                this.root_window = sibling_win\n                sibling_win.parent = null\n            }\n            this.remove_window(win, true)\n            this.remove_window(parent_win, false)\n\n            this.rearrange_window(sibling_win, parent_win.box)\n        }\n    }\n\n    glk_window_erase_rect(win: Window, left: number, top: number, width: number, height: number) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type !== 'graphics') {\n            throw new Error('Invalid Window: not a graphics window')\n        }\n        win.draw.push({\n            height,\n            special: 'fill',\n            width,\n            x: left,\n            y: top,\n        })\n    }\n\n    glk_window_fill_rect(win: Window, colour: number, left: number, top: number, width: number, height: number) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type !== 'graphics') {\n            throw new Error('Invalid Window: not a graphics window')\n        }\n        win.draw.push({\n            color: colour_code_to_css(colour),\n            height,\n            special: 'fill',\n            width,\n            x: left,\n            y: top,\n        })\n    }\n\n    glk_window_flow_break(win: Window) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type === 'buffer') {\n            win.set_flow_break()\n        }\n    }\n\n    glk_window_get_arrangement(win: Window, method?: RefBoxArg, size?: RefBoxArg, keywin?: RefBoxArg) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type !== 'pair') {\n            throw new Error('Invalid Window: not a pair window')\n        }\n        if (keywin) {\n            keywin?.set_value(win.key)\n        }\n        if (method) {\n            method?.set_value(win.dir | (win.fixed ? winmethod_Fixed : winmethod_Proportional) | (win.border ? winmethod_Border : winmethod_NoBorder))\n        }\n        if (size) {\n            size?.set_value(win.size)\n        }\n    }\n\n    glk_window_get_echo_stream(win: Window): Stream | null {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        return win.echostr\n    }\n\n    glk_window_get_parent(win: Window): Window | null {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        return win.parent\n    }\n\n    glk_window_get_rock(win: Window): number {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        return win.rock\n    }\n\n    glk_window_get_root(): Window | null {\n        return this.root_window\n    }\n\n    glk_window_get_sibling(win: Window): Window | null {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        const parent = win.parent\n        if (!parent) {\n            return null\n        }\n        if (parent.child1 === win) {\n            return parent.child2\n        }\n        else {\n            return parent.child1\n        }\n    }\n\n    glk_window_get_size(win: Window, widthbox?: RefBoxArg, heightbox?: RefBoxArg) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        const metrics = this.metrics\n        let height = 0\n        let width = 0\n        switch (win.type) {\n            case 'buffer':\n                height = normalise_window_dimension((win.box.bottom - win.box.top - metrics.buffermarginy) / metrics.buffercharheight)\n                width = normalise_window_dimension((win.box.right - win.box.left - metrics.buffermarginx) / metrics.buffercharwidth)\n                break\n            case 'graphics':\n            case 'grid':\n                height = win.height\n                width = win.width\n                break\n        }\n        if (heightbox) {\n            heightbox?.set_value(height)\n        }\n        if (widthbox) {\n            widthbox?.set_value(width)\n        }\n    }\n\n    glk_window_get_stream(win: Window): Stream {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        return win.str\n    }\n\n    glk_window_get_type(win: Window): number {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        return win.typenum\n    }\n\n    glk_window_iterate(win?: Window, rockbox?: RefBoxArg): Window | null {\n        const next_window = win ? win.next : this.first_window\n        if (rockbox) {\n            rockbox?.set_value(next_window ? next_window.rock : 0)\n        }\n        return next_window\n    }\n\n    glk_window_move_cursor(win: Window, xpos: number, ypos: number) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type !== 'grid') {\n            throw new Error('Invalid Window: not a grid window')\n        }\n        win.x = Math.max(0, xpos)\n        win.y = Math.max(0, ypos)\n    }\n\n    glk_window_open(splitwin: Window | null, method: number, size: number, wintype: number, rock: number): Window | null {\n        // Check the parameters\n        if (!this.root_window) {\n            if (splitwin) {\n                throw new Error('Invalid splitwin: must be null for first window')\n            }\n        }\n        else {\n            if (!splitwin) {\n                throw new Error('Invalid splitwin')\n            }\n            if (splitwin.type === 'pair') {\n                throw new Error('Invalid splitwin: must not be a pair window')\n            }\n            const division = method & winmethod_DivisionMask\n            const direction = method & winmethod_DirMask\n            if (division !== winmethod_Fixed && division !== winmethod_Proportional) {\n                throw new Error('Invalid method: must be fixed or proportional')\n            }\n            if (division === winmethod_Fixed && splitwin.type === 'blank') {\n                throw new Error('Invalid method: blank windows cannot be only be split proportionally')\n            }\n            if (direction !== winmethod_Above && direction !== winmethod_Below && direction !== winmethod_Left && direction !== winmethod_Right) {\n                throw new Error('Invalid method: bad direction')\n            }\n        }\n\n        // Create the window\n        let win: Window\n        switch (wintype) {\n            case wintype_Blank:\n                win = new BlankWindow(rock)\n                break\n            case wintype_Graphics:\n                win = new GraphicsWindow(rock)\n                break\n            case wintype_TextBuffer:\n                win = new BufferWindow(rock, this.stylehints.buffer)\n                break\n            case wintype_TextGrid:\n                win = new GridWindow(rock, this.stylehints.grid)\n                break\n            default:\n                throw new Error('Invalid wintype')\n        }\n        this.register_window(win)\n\n        // Rearrange the windows for the new window\n        if (splitwin) {\n            const pairwin = new PairWindow(win, method, size)\n            this.register_window(pairwin)\n            // Set up the win relations\n            pairwin.child1 = splitwin\n            pairwin.child2 = win\n            const oldparent = splitwin.parent\n            splitwin.parent = pairwin\n            win.parent = pairwin\n            pairwin.parent = oldparent\n            if (oldparent) {\n                if (oldparent.child1 === splitwin) {\n                    oldparent.child1 = pairwin\n                }\n                else {\n                    oldparent.child2 = pairwin\n                }\n            }\n            else {\n                this.root_window = pairwin\n            }\n            this.rearrange_window(pairwin, splitwin.box)\n        }\n        else {\n            this.root_window = win\n            this.rearrange_window(win, {\n                bottom: this.metrics.height,\n                left: 0,\n                right: this.metrics.width,\n                top: 0,\n            })\n        }\n\n        return win\n    }\n\n    glk_window_set_arrangement(win: Window, method: number, size: number, keywin?: Window) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type !== 'pair') {\n            throw new Error('Invalid Window: not a pair window')\n        }\n\n        if (keywin) {\n            if (keywin.type === 'pair') {\n                throw new Error('Invalid keywin: cannot be a pair window')\n            }\n            let win_parent: Window | null = keywin\n            while ((win_parent = win_parent?.parent)) {\n                if (win_parent === win) {\n                    break\n                }\n            }\n            if (!win_parent) {\n                throw new Error('keywin must be a descendent')\n            }\n        }\n\n        const new_dir = method & winmethod_DirMask\n        const new_vertical = new_dir === winmethod_Left || new_dir === winmethod_Right\n        if (!keywin) {\n            keywin = win.key!\n        }\n        if (new_vertical && !win.vertical) {\n            throw new Error('Invalid method: split must stay horizontal')\n        }\n        if (!new_vertical && win.vertical) {\n            throw new Error('Invalid method: split must stay vertical')\n        }\n        const new_fixed = (method & winmethod_DivisionMask) === winmethod_Fixed\n        if (keywin.type === 'blank' && new_fixed) {\n            throw new Error('Invalid method: blank windows cannot be only be split proportionally')\n        }\n\n        const new_backward = new_dir === winmethod_Left || new_dir === winmethod_Above\n        if (new_backward !== win.backward) {\n            // Switch the children\n            const temp_win = win.child1\n            win.child1 = win.child2\n            win.child2 = temp_win\n        }\n\n        // Update the window\n        win.backward = new_backward\n        win.border = (method & winmethod_BorderMask) === winmethod_BorderMask\n        win.dir = new_dir\n        win.fixed = new_fixed\n        win.key = keywin\n        win.size = size\n        win.vertical = new_vertical\n\n        this.rearrange_window(win, win.box)\n    }\n\n    glk_window_set_background_color(win: Window, colour: number) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.type !== 'graphics') {\n            throw new Error('Invalid Window: not a graphics window')\n        }\n        win.draw.push({\n            color: colour_code_to_css(colour),\n            special: 'setcolor',\n        })\n    }\n\n    glk_window_set_echo_stream(win: Window, stream: Stream | null) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        win.echostr = stream\n    }\n\n    garglk_set_reversevideo(val: number) {\n        this.garglk_set_reversevideo_stream(this.current_stream!, val)\n    }\n\n    garglk_set_reversevideo_stream(str: Stream, val: number) {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.type === 'window') {\n            str.set_css('reverse', val ? 1 : undefined)\n        }\n    }\n\n    garglk_set_zcolors(fg: number, bg: number) {\n        this.garglk_set_zcolors_stream(this.current_stream!, fg, bg)\n    }\n\n    garglk_set_zcolors_stream(str: Stream, fg: number, bg: number) {\n        if (!str) {\n            throw new Error('Invalid Stream')\n        }\n        if (str.type === 'window') {\n            if (fg !== zcolor_Current) {\n                str.set_css('color', fg === zcolor_Default ? undefined : colour_code_to_css(fg))\n            }\n            if (bg !== zcolor_Current) {\n                str.set_css('background-color', bg === zcolor_Default ? undefined : colour_code_to_css(bg))\n            }\n        }\n    }\n\n    // Private internal functions\n\n    /** Process an input event */\n    private accept(ev: Protocol.Event) {\n        if (this.exited) {\n            return this.GlkOte.log('GlkApi has exited')\n        }\n\n        if (ev.gen !== this.gen) {\n            return this.GlkOte.log(`Input event has wrong generation number: expected ${this.gen}, received ${ev.gen}`)\n        }\n        this.gen++\n\n        if (!this.selectref && ev.type !== 'init' && ev.type !== 'specialresponse') {\n            return\n        }\n\n        this.partial_inputs = ev.partial\n\n        let type = evtype_None\n        let win: Window | null = null\n        let val1 = 0\n        let val2 = 0\n        let fref: FileRef | undefined\n\n        if ('window' in ev) {\n            for (win = this.first_window; win; win = win.next) {\n                if (win.disprock === ev.window) {\n                    break\n                }\n            }\n        }\n\n        switch (ev.type) {\n            case 'init':\n                this.metrics = normalise_metrics(ev.metrics)\n                this.support = ev.support\n                this.VM.start()\n                return\n            case 'arrange':\n                this.metrics = normalise_metrics(ev.metrics)\n                if (this.root_window) {\n                    this.rearrange_window(this.root_window, {\n                        bottom: this.metrics.height,\n                        left: 0,\n                        right: this.metrics.width,\n                        top: 0,\n                    })\n                }\n                type = evtype_Arrange\n                break\n            case 'char':\n                if (win?.input.type !== 'char') {\n                    return\n                }\n                delete win.input.type\n                type = evtype_CharInput\n                if (ev.value.length === 1) {\n                    val1 = ev.value.codePointAt(0)!\n                    if (!(win as TextWindow).uni_input) {\n                        val1 = val1 & 0xFF\n                    }\n                }\n                else {\n                    val1 = KEY_NAMES_TO_CODES[ev.value as Protocol.SpecialKeyCode] ?? keycode_Unknown\n                }\n                break\n            case 'hyperlink':\n                if (!win?.input.hyperlink) {\n                    return\n                }\n                type = evtype_Hyperlink\n                val1 = ev.value\n                break\n            case 'line':\n                if (win?.input.type !== 'line') {\n                    return\n                }\n                this.handle_line_input(win as TextWindow, ev.value, this.selectref, ev.terminator)\n                this.GiDispa?.prepare_resume(this.selectref!)\n                delete this.selectref\n                break\n            case 'mouse':\n                if (!win?.input.mouse) {\n                    return\n                }\n                type = evtype_MouseInput\n                val1 = ev.x\n                val2 = ev.y\n                break\n            case 'redraw':\n                type = evtype_Redraw\n                break\n            case 'specialresponse': {\n                if (ev.response !== 'fileref_prompt') {\n                    throw new Error('Unknown type of specialresponse event')\n                }\n                const dialog_fref = ev.value\n                if (typeof dialog_fref === 'string') {\n                    throw new Error('AsyncGlk no longer supports bare-string filenames from Dialog')\n                }\n                if (dialog_fref) {\n                    fref = this.create_fileref(dialog_fref.filename, this.special_data!.rock, this.special_data!.usage, dialog_fref)\n                }\n                break\n            }\n            case 'timer':\n                type = evtype_Timer\n                this.timer.started = Date.now()\n                break\n            default:\n                throw new Error(`Event type ${ev.type} not supported by AsyncGlk`)\n        }\n\n        if (this.selectref) {\n            set_event(this.selectref!, type, win, val1, val2)\n            this.GiDispa?.prepare_resume(this.selectref!)\n            delete this.selectref\n        }\n        this.VM.resume(fref)\n    }\n\n    private create_fileref(filename: string, rock: number, usage: number, dialog_fref?: DialogFileRef): FileRef {\n        if (!dialog_fref) {\n            const filetype = usage & fileusage_TypeMask\n            const signature = filetype === fileusage_SavedGame ? this.VM.get_signature() : undefined\n            dialog_fref = this.Dialog.file_construct_ref(filename, FILE_TYPES[filetype] ?? 'xxx', signature)\n        }\n        const fref = new FileRef(this.Dialog, filename, dialog_fref, rock, usage)\n        fref.next = this.first_fref\n        this.first_fref = fref\n        if (fref.next) {\n            fref.next.prev = fref\n        }\n        this.GiDispa?.class_register('fileref', fref)\n        return fref\n    }\n\n    private create_file_stream(fref: FileRef, mode: number, rock: number, unicode: boolean) {\n        if (!fref) {\n            throw new Error('Invalid Fileref')\n        }\n        if (mode !== filemode_Write && mode !== filemode_Read && mode !== filemode_ReadWrite && mode !== filemode_WriteAppend) {\n            throw new Error('Invalid filemode')\n        }\n        if (mode === filemode_Read && !fref.exists()) {\n            return null\n        }\n\n        // Now read in the data\n        let data: Uint8Array | null = null\n        if (mode !== filemode_Write) {\n            data = fref.read()\n        }\n        if (!data) {\n            data = new Uint8Array(0)\n            fref.write(data)\n        }\n        // Create an appropriate stream\n        const str = create_stream_from_buffer(data, fref.binary, mode, rock, unicode, fref)\n\n        if (mode === filemode_WriteAppend) {\n            str.set_position(seekmode_End, 0)\n        }\n        this.register_stream(str)\n        return str\n    }\n\n    private create_memory_stream(buf: GlkArray | null, mode: number, rock: number, typed_array: GlkTypedArrayConstructor) {\n        if (mode !== filemode_Read && mode !== filemode_Write && mode !== filemode_ReadWrite) {\n            throw new Error('Illegal filemode')\n        }\n        let str: Stream\n        if (buf) {\n            const common_cb = () => this.GiDispa?.unretain_array(buf)\n            if (Array.isArray(buf)) {\n                const new_arr = typed_array.from(buf)\n                if (mode === filemode_Read) {\n                    str = new ArrayBackedStream(new_arr, mode, rock, common_cb)\n                }\n                // When opening an Array in a write mode we must copy the values back\n                else {\n                    str = new ArrayBackedStream(new_arr, mode, rock, () => {\n                        copy_array(new_arr, buf, buf.length)\n                        common_cb()\n                    })\n                }\n            }\n            else {\n                str = new ArrayBackedStream(buf, mode, rock, common_cb)\n            }\n            this.GiDispa?.retain_array(buf)\n        }\n        else {\n            str = new NullStream(mode, rock)\n        }\n        this.register_stream(str)\n        return str\n    }\n\n    private create_resource_stream(filenum: number, rock: number, unicode: boolean) {\n        if (!this.Blorb) {\n            return null\n        }\n        const chunk = this.Blorb.get_data_chunk(filenum)\n        if (!chunk) {\n            return null\n        }\n        const str = create_stream_from_buffer(chunk.data, chunk.binary, filemode_Read, rock, unicode)\n        this.register_stream(str)\n        return str\n    }\n\n    private draw_image(win: Window, imginfo: ImageInfo, height: number, val1: number, val2: number, width: number) {\n        const data: Partial<BufferWindowImage & ImageOperation> = {\n            alttext: imginfo.alttext,\n            height,\n            image: imginfo.image,\n            special: 'image',\n            url: imginfo.url,\n            width,\n        }\n        switch (win.type) {\n            case 'buffer':\n                data.alignment = IMAGE_ALIGNMENTS[val1] ?? 'inlineup'\n                win.put_image(data as BufferWindowImage)\n                return 1\n            case 'graphics':\n                data.x = val1\n                data.y = val2\n                win.draw.push(data as ImageOperation)\n                return 1\n        }\n        return 0\n    }\n\n    private handle_line_input(win: TextWindow, input: string, ev?: RefStructArg, termkey?: TerminatorCode) {\n        // The Glk spec is a bit ambiguous here\n        // I'm going to echo first\n        if (win.request_echo_line_input) {\n            win.put_string(input + '\\n', 'input')\n            if (win.echostr) {\n                win.echostr.put_string(input + '\\n', 'input')\n            }\n        }\n\n        // Then trim and convert non-Latin1 characters\n        if (input.length > win.line_input_buf!.length) {\n            input = input.slice(0, win.line_input_buf!.length)\n        }\n        if (!win.uni_input) {\n            input = input.replace(/[^\\x00-\\xff]/g, '?')\n        }\n\n        const input_buf = Uint32Array.from(input, ch => ch.codePointAt(0)!)\n        if (Array.isArray(win.line_input_buf!)) {\n            copy_array(input_buf, win.line_input_buf!, input.length)\n        }\n        else {\n            win.line_input_buf?.set(input_buf)\n        }\n\n        const terminator = TERMINATOR_KEYS_TO_CODES[termkey as TerminatorCode] ?? 0\n\n        if (ev) {\n            set_event(ev, evtype_LineInput, win as Window, input.length, terminator)\n        }\n        this.GiDispa?.unretain_array(win.line_input_buf!)\n        delete win.input.type\n        delete win.line_input_buf\n    }\n\n    private rearrange_window(win: Window, box: WindowBox) {\n        const metrics = this.metrics\n        this.windows_changed = true\n        win.box = box\n        const boxheight = box.bottom - box.top\n        const boxwidth = box.right - box.left\n        switch (win.type) {\n            case 'graphics': {\n                win.height = normalise_window_dimension(boxheight - metrics.graphicsmarginy)\n                win.width = normalise_window_dimension(boxwidth - metrics.graphicsmarginx)\n                break\n            }\n            case 'grid': {\n                const height = normalise_window_dimension((boxheight - metrics.gridmarginy) / metrics.gridcharheight)\n                const width = normalise_window_dimension((boxwidth - metrics.gridmarginx) / metrics.gridcharwidth)\n                win.update_size(height, width)\n                break\n            }\n            case 'pair': {\n                let min, max, splitwidth\n                if (win.vertical) {\n                    min = box.left\n                    max = box.right\n                    splitwidth = metrics.inspacingx\n                }\n                else {\n                    min = box.top\n                    max = box.bottom\n                    splitwidth = metrics.inspacingy\n                }\n                if (!win.border) {\n                    splitwidth = 0\n                }\n                const diff = max - min\n\n                // Calculate the split size\n                let split = 0\n                if (win.fixed) {\n                    switch (win.key!.type) {\n                        case 'buffer':\n                            if (win.vertical) {\n                                split = win.size * metrics.buffercharwidth + metrics.buffermarginx\n                            }\n                            else {\n                                split = win.size * metrics.buffercharheight + metrics.buffermarginy\n                            }\n                            break\n                        case 'graphics':\n                            split = win.size + (win.vertical ? metrics.graphicsmarginx : metrics.graphicsmarginy)\n                            break\n                        case 'grid':\n                            if (win.vertical) {\n                                split = win.size * metrics.gridcharwidth + metrics.gridmarginx\n                            }\n                            else {\n                                split = win.size * metrics.gridcharheight + metrics.gridmarginy\n                            }\n                            break\n                    }\n                    split = Math.ceil(split)\n                }\n                else {\n                    split = Math.floor((diff * win.size) / 100)\n                }\n\n                // split is now a number between 0 and diff; now convert it to a number between min and max, and apply upside-down-ness\n                if (win.backward) {\n                    split = min + split\n                }\n                else {\n                    split = max - split - splitwidth\n                }\n\n                // Make sure it really is between min and max\n                if (min >= max) {\n                    split = min\n                }\n                else {\n                    split = Math.min(Math.max(split, min), max - splitwidth)\n                }\n\n                // The two child window boxes can now be constructed\n                let box1: WindowBox, box2: WindowBox\n                if (win.vertical) {\n                    box1 = {\n                        bottom: box.bottom,\n                        left: box.left,\n                        right: split,\n                        top: box.top,\n                    }\n                    box2 = {\n                        bottom: box.bottom,\n                        left: split + splitwidth,\n                        right: box.right,\n                        top: box.top,\n                    }\n                }\n                else {\n                    box1 = {\n                        bottom: split,\n                        left: box.left,\n                        right: box.right,\n                        top: box.top,\n                    }\n                    box2 = {\n                        bottom: box.bottom,\n                        left: box.left,\n                        right: box.right,\n                        top: split + splitwidth,\n                    }\n                }\n                this.rearrange_window(win.child1!, win.backward ? box2 : box1)\n                this.rearrange_window(win.child2!, win.backward ? box1 : box2)\n                break\n            }\n        }\n    }\n\n    private register_stream(str: Stream) {\n        str.next = this.first_stream\n        this.first_stream = str\n        if (str.next) {\n            str.next.prev = str\n        }\n        this.GiDispa?.class_register('stream', str)\n    }\n\n    private register_window(win: Window) {\n        this.windows_changed = true\n        win.next = this.first_window\n        this.first_window = win\n        if (win.next) {\n            win.next.prev = win\n        }\n        // A disprock must be assigned because it is used as the protocol ID\n        if (this.GiDispa) {\n            this.GiDispa?.class_register('window', win)\n        }\n        else {\n            win.disprock = this.disprock_counter++\n        }\n        win.input.id = win.disprock\n        this.register_stream(win.str)\n    }\n\n    private remove_window(win: Window, recurse: boolean) {\n        this.windows_changed = true\n\n        if (this.GiDispa && 'line_input_buf' in win && win.line_input_buf) {\n            this.GiDispa.unretain_array(win.line_input_buf!)\n            delete win.line_input_buf\n        }\n\n        if (win.type === 'pair') {\n            if (recurse) {\n                this.remove_window(win.child1!, true)\n                this.remove_window(win.child2!, true)\n            }\n            win.child1 = null\n            win.child2 = null\n            win.key = null\n        }\n\n        this.unregister_stream(win.str)\n        win.echostr = null\n        win.parent = null\n\n        this.GiDispa?.class_unregister('window', win)\n        const prev = win.prev\n        const next = win.next\n        win.prev = null\n        win.next = null\n        if (prev) {\n            prev.next = next\n        }\n        else {\n            this.first_window = next\n        }\n        if (next) {\n            next.prev = prev\n        }\n    }\n\n    private request_char_event(win: Window, uni: boolean) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.input.type) {\n            throw new Error('Window already has keyboard request')\n        }\n        if (win.type === 'blank' || win.type === 'pair') {\n            throw new Error('Window does not support character input')\n        }\n\n        win.input.gen = this.gen\n        win.input.type = 'char'\n        win.uni_input = uni\n    }\n\n    private request_line_event(win: Window, buf: GlkArray, uni: boolean, initlen?: number) {\n        if (!win) {\n            throw new Error('Invalid Window')\n        }\n        if (win.input.type) {\n            throw new Error('Window already has keyboard request')\n        }\n        if (win.type !== 'buffer' && win.type !== 'grid') {\n            throw new Error('Window does not support line input')\n        }\n\n        win.input.gen = this.gen\n        if (initlen) {\n            win.input.initial = String.fromCodePoint(...buf.slice(0, initlen))\n        }\n        win.input.type = 'line'\n        win.line_input_buf = buf\n        if (win.type === 'buffer') {\n            win.request_echo_line_input = win.echo_line_input\n        }\n        win.uni_input = uni\n        this.GiDispa?.retain_array(buf)\n    }\n\n    private unregister_stream(str: Stream) {\n        if (this.current_stream === str) {\n            this.current_stream = null\n        }\n        this.GiDispa?.class_unregister('stream', str)\n        const prev = str.prev\n        const next = str.next\n        str.prev = null\n        str.next = null\n        if (prev) {\n            prev.next = next\n        }\n        else {\n            this.first_stream = next\n        }\n        if (next) {\n            next.prev = prev\n        }\n    }\n}\n\nfunction buffer_transformer(buf: GlkWordArray, initlen: number, func: (str: string | Uint32Array) => string, dont_reduce?: boolean) {\n    const utf32_array = Array.isArray(buf) ? buf.slice(0, initlen) as any as Uint32Array : buf.subarray(0, initlen)\n    const data = dont_reduce ? utf32_array : utf32_array.reduce((prev, ch) => prev + String.fromCodePoint(ch), '')\n    const new_str = func(data)\n    const newbuf = Uint32Array.from(new_str, ch => ch.codePointAt(0)!)\n    const newlen = newbuf.length\n    if (Array.isArray(buf)) {\n        copy_array(newbuf, buf, newlen)\n    }\n    else {\n        buf.set(newbuf.subarray(0, Math.min(buf.length, newlen)))\n    }\n    return newlen\n}\n\nfunction colour_code_to_css(colour: number) {\n    // Uppercase colours are required by RegTest\n    return '#' + (colour & 0xFFFFFF).toString(16).toUpperCase().padStart(6, '0')\n}\n\nfunction create_stream_from_buffer(buf: Uint8Array, binary: boolean, mode: number, rock: number, unicode: boolean, fref?: FileRef) {\n    let data: GlkTypedArray\n    if (unicode) {\n        if (binary) {\n            data = BEBuffer_to_Array(buf)\n        }\n        else {\n            const text = utf8decoder.decode(buf)\n            data = Uint32Array.from(text, ch => ch.codePointAt(0)!)\n        }\n    }\n    else {\n        data = buf\n    }\n    if (mode === filemode_Read) {\n        return new ArrayBackedStream(data, mode, rock)\n    }\n    else {\n        return new FileStream(fref!, data, mode, rock)\n    }\n}\n\nfunction date_struct_to_timestamp_local(struct: RefStruct): number {\n    const date = new Date(\n        struct.get_field(0) as number,\n        struct.get_field(1) as number - 1,\n        struct.get_field(2) as number,\n        struct.get_field(4) as number,\n        struct.get_field(5) as number,\n        struct.get_field(6) as number,\n        struct.get_field(7) as number / 1000\n    )\n    return date.getTime()\n}\n\nfunction date_struct_to_timestamp_utc(struct: RefStruct): number {\n    const date = new Date(0)\n    date.setUTCFullYear(struct.get_field(0) as number)\n    date.setUTCMonth(struct.get_field(1) as number - 1)\n    date.setUTCDate(struct.get_field(2) as number)\n    date.setUTCHours(struct.get_field(4) as number)\n    date.setUTCMinutes(struct.get_field(5) as number)\n    date.setUTCSeconds(struct.get_field(6) as number)\n    date.setUTCMilliseconds(struct.get_field(7) as number / 1000)\n    return date.getTime()\n}\n\nfunction normalise_metrics(metrics: Protocol.Metrics) {\n    const normalised_metrics: Protocol.NormalisedMetrics = Object.assign({}, DEFAULT_METRICS)\n    let val: number | undefined\n\n    val = metrics.charheight\n    if (val !== undefined) {\n        normalised_metrics.buffercharheight= val\n        normalised_metrics.gridcharheight = val\n    }\n    val = metrics.charwidth\n    if (val !== undefined) {\n        normalised_metrics.buffercharwidth = val\n        normalised_metrics.gridcharwidth = val\n    }\n\n    val = metrics.margin\n    if (val !== undefined) {\n        normalised_metrics.buffermarginx = val\n        normalised_metrics.buffermarginy = val\n        normalised_metrics.graphicsmarginx = val\n        normalised_metrics.graphicsmarginy = val\n        normalised_metrics.gridmarginx = val\n        normalised_metrics.gridmarginy = val\n    }\n    val = metrics.buffermargin\n    if (val !== undefined) {\n        normalised_metrics.buffermarginx = val\n        normalised_metrics.buffermarginy = val\n    }\n    val = metrics.graphicsmargin\n    if (val !== undefined) {\n        normalised_metrics.graphicsmarginx = val\n        normalised_metrics.graphicsmarginy = val\n    }\n    val = metrics.gridmargin\n    if (val !== undefined) {\n        normalised_metrics.gridmarginx = val\n        normalised_metrics.gridmarginy = val\n    }\n    val = metrics.marginx\n    if (val !== undefined) {\n        normalised_metrics.buffermarginx = val\n        normalised_metrics.graphicsmarginx = val\n        normalised_metrics.gridmarginx = val\n    }\n    val = metrics.marginy\n    if (val !== undefined) {\n        normalised_metrics.buffermarginy = val\n        normalised_metrics.graphicsmarginy = val\n        normalised_metrics.gridmarginy = val\n    }\n\n    val = metrics.spacing\n    if (val !== undefined) {\n        normalised_metrics.inspacingx = val\n        normalised_metrics.inspacingy = val\n    }\n    val = metrics.inspacing\n    if (val !== undefined) {\n        normalised_metrics.inspacingx = val\n        normalised_metrics.inspacingy = val\n    }\n    val = metrics.spacingx\n    if (val !== undefined) {\n        normalised_metrics.inspacingx = val\n    }\n    val = metrics.spacingy\n    if (val !== undefined) {\n        normalised_metrics.inspacingy = val\n    }\n\n    Object.assign(normalised_metrics, metrics)\n\n    if (metrics.outspacing || normalised_metrics.outspacingx || normalised_metrics.outspacingy) {\n        throw new Error('AsyncGlk requires that outspacing metrics be 0')\n    }\n\n    return normalised_metrics\n}\n\nfunction normalise_window_dimension(val: number) {\n    return Math.max(0, Math.floor(val))\n}\n\nfunction set_event(ev: Interface.RefStruct, type: number = evtype_None, win: Window | null = null, val1 = 0, val2 = 0) {\n    ev.set_field(0, type)\n    ev.set_field(1, win)\n    ev.set_field(2, val1)\n    ev.set_field(3, val2)\n}\n\nfunction timestamp_to_date_struct_local(timestamp: number, struct: RefStruct) {\n    const date = new Date(timestamp)\n    struct.set_field(0, date.getFullYear())\n    struct.set_field(1, date.getMonth() + 1)\n    struct.set_field(2, date.getDate())\n    struct.set_field(3, date.getDay())\n    struct.set_field(4, date.getHours())\n    struct.set_field(5, date.getMinutes())\n    struct.set_field(6, date.getSeconds())\n    struct.set_field(7, date.getMilliseconds() * 1000)\n}\n\nfunction timestamp_to_date_struct_utc(timestamp: number, struct: RefStruct) {\n    const date = new Date(timestamp)\n    struct.set_field(0, date.getUTCFullYear())\n    struct.set_field(1, date.getUTCMonth() + 1)\n    struct.set_field(2, date.getUTCDate())\n    struct.set_field(3, date.getUTCDay())\n    struct.set_field(4, date.getUTCHours())\n    struct.set_field(5, date.getUTCMinutes())\n    struct.set_field(6, date.getUTCSeconds())\n    struct.set_field(7, date.getUTCMilliseconds() * 1000)\n}\n\nfunction timestamp_to_time_struct(timestamp: number, struct: RefStruct) {\n    struct.set_field(0, Math.floor(timestamp / 4294967296000))\n    struct.set_field(1, Math.floor(timestamp / 1000) >>> 0)\n    let microsecs = Math.floor((timestamp % 1000) * 1000)\n    if (microsecs < 0) {\n        microsecs += 1000000\n    }\n    struct.set_field(2, microsecs)\n}\n\nfunction time_struct_to_timestamp(struct: RefStruct): number {\n    return (struct.get_field(0) as number) * 4294967296000 +\n        (struct.get_field(1) as number) * 1000 +\n        (struct.get_field(2) as number) / 1000\n}\n\n/** Handle legacy non-typed arrays in functions which need to write to the array */\nfunction wrap_for_array(arr: number[], typed_array: GlkTypedArrayConstructor, func: (arr: GlkTypedArray) => number): number {\n    const new_arr = new typed_array(arr.length)\n    const res = func(new_arr)\n    copy_array(new_arr, arr, res)\n    return res\n}", "/*\n\nGeneric GlkOte implementation\n=============================\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {Blorb} from '../../blorb/blorb.js'\nimport * as Constants from '../../common/constants.js'\nimport * as protocol from '../../common/protocol.js'\nimport {Dialog} from '../../dialog/common/interface.js'\nimport {GlkApi} from '../../glkapi/interface.js'\n\nexport interface GlkOte {\n    classname: string,\n    error(msg: any): void,\n    extevent(val: any): void,\n    getdomcontext(): HTMLElement | undefined,\n    getdomid(name: string): string,\n    getinterface(): GlkOteOptions,\n    getlibrary(name: string): Blorb | Dialog | null | undefined,\n    init(options: GlkOteOptions): void,\n    inited(): boolean,\n    log(msg: string): void,\n    save_allstate(): any,\n    setdomcontext(val: HTMLElement): void,\n    update(data: protocol.Update): void,\n    version: string,\n    warning(msg: any): void,\n}\n\nexport interface GlkOteOptions {\n    accept(event: protocol.Event): void,\n    Blorb?: Blorb,\n    debug_commands?: boolean,\n    detect_external_links?: string | boolean,\n    Dialog?: Dialog,\n    dialog_dom_prefix?: string,\n    dom_prefix?: string,\n    errorcontent?: string,\n    errorpane?: string,\n    gameport?: string,\n    Glk?: GlkApi,\n    loadingpane?: string,\n    max_buffer_length?: number,\n    /** Cookie name to opt out of transcript recording. Default: `transcript_recording_opt_out` */\n    recording_cookie?: string,\n    /** Transcript recording service protocol format. Only `simple` is supported by AsyncGlk */\n    recording_format?: string,\n    /** Custom transcript recording handler function */\n    recording_handler?: (state: TranscriptRecordingData) => void,\n    /** Transcript recording label for this story */\n    recording_label?: string,\n    /** URL for the transcript recording service */\n    recording_url?: string,\n    regex_external_links?: RegExp,\n    /** Whether or not to set the <body> background colour to the page_margin_bg */\n    set_body_to_page_bg?: boolean | number,\n    windowport?: string,\n}\n\n/** Format of the transcript recorder data */\nexport interface TranscriptRecordingData {\n    /** The transcript record format is always 'simple */\n    format: 'simple',\n    /** Player input for char and line events */\n    input: string,\n    /** The label given to this story at the beginning */\n    label: string,\n    /** Combined output from buffer windows */\n    output: string,\n    /** Timestamp from when output returned to GlkOte (milliseconds) */\n    outtimestamp: number,\n    /** Session ID */\n    sessionId: string,\n    /** Timestamp from when GlkOte event was sent to VM (milliseconds) */\n    timestamp: number,\n}\n\nexport abstract class GlkOteBase implements GlkOte {\n    classname = 'GlkOte'\n    version = Constants.PACKAGE_VERSION\n\n    protected accept_func: (event: protocol.Event) => void = () => {}\n    protected autorestoring = false\n    protected Blorb?: Blorb\n    current_metrics = Object.assign({}, Constants.DEFAULT_METRICS)\n    protected Dialog?: Dialog\n    disabled = false\n    protected generation = 0\n    protected is_inited = false\n    protected options: GlkOteOptions = {} as GlkOteOptions\n    protected timer: ReturnType<typeof setTimeout> | null = null\n    protected waiting_for_update = false\n\n    async init(options: GlkOteOptions) {\n        if (!options) {\n            return this.error('no options provided')\n        }\n        if (!options.accept) {\n            return this.error('an accept function was not given to GlkOte')\n        }\n\n        this.options = options\n        this.accept_func = options.accept\n\n        if (options.Blorb) {\n            this.Blorb = options.Blorb\n        }\n        if (options.Dialog) {\n            this.Dialog = options.Dialog\n        }\n\n        this.is_inited = true\n\n        // Send an init event, which if is received by GlkApi, will then result in VM.start() being called\n        this.send_event({type: 'init'})\n    }\n\n    error(error: Error | string) {\n        throw (typeof error === 'string' ? new Error(error) : error)\n    }\n\n    extevent(value: any) {\n        this.send_event({\n            type: 'external',\n            value,\n        })\n    }\n\n    getdomcontext(): HTMLElement | undefined {\n        throw new Error('getdomcontext is not applicable to this GlkOte library')\n    }\n\n    getdomid(name: string): string {\n        throw new Error('getdomid is not applicable to this GlkOte library')\n    }\n\n    getinterface(): GlkOteOptions {\n        return this.options\n    }\n\n    getlibrary(name: string): Blorb | Dialog | null | undefined {\n        switch (name) {\n            case 'Blorb': return this.Blorb\n            case 'Dialog': return this.Dialog\n            default: return null\n        }\n    }\n\n    inited(): boolean {\n        return this.is_inited\n    }\n\n    log(msg: string) {\n        console.log(msg)\n    }\n\n    setdomcontext(val: HTMLElement) {\n        throw new Error('setdomcontext is not applicable to this GlkOte library')\n    }\n\n    update(data: protocol.Update) {\n        try {\n            this.autorestoring = false\n            this.waiting_for_update = false\n\n            if (data.type === 'error') {\n                return this.error(data.message)\n            }\n            if (data.type === 'pass') {\n                return\n            }\n            if (data.type === 'retry') {\n                setTimeout(() => this.send_event({type: 'refresh'}), 2000)\n                return\n            }\n            if (data.type !== 'update') {\n                return this.error(`Unknown update type: ${(data as any).type}`)\n            }\n\n            if (data.gen === this.generation) {\n                this.log(`Ignoring repeated generation number: ${data.gen}`)\n                return\n            }\n            this.generation = data.gen\n\n            if (this.disabled) {\n                this.disable(false)\n            }\n\n            // Now handle all the state updates\n            if (data.input) {\n                this.cancel_inputs(data.input)\n            }\n            if (data.windows) {\n                this.update_windows(data.windows)\n            }\n            if (data.content) {\n                this.update_content(data.content)\n            }\n            if (data.input) {\n                this.update_inputs(data.input)\n            }\n\n            if (data.timer !== undefined) {\n                if (this.timer) {\n                    clearInterval(this.timer)\n                    this.timer = null\n                }\n                if (data.timer) {\n                    this.timer = setInterval(() => this.ontimer(), data.timer)\n                }\n            }\n\n            if (data.specialinput) {\n                this.handle_specialinput(data.specialinput)\n            }\n\n            // Disable everything if requested\n            this.disabled = false\n            if (data.disable || data.specialinput) {\n                this.disable(true)\n            }\n\n            if (data.autorestore) {\n                this.autorestoring = true\n                this.autorestore(data.autorestore)\n            }\n\n            // Page background colour\n            if (typeof data.page_margin_bg !== 'undefined' && this.options.set_body_to_page_bg) {\n                this.set_page_bg(data.page_margin_bg)\n            }\n\n            if (data.disable) {\n                this.exit()\n            }\n        }\n        catch (err) {\n            this.error(err as Error)\n        }\n    }\n\n    warning(msg: any) {\n        console.warn(msg)\n    }\n\n    // AsyncGlk specific implementation methods\n    protected autorestore(data: any) {}\n\n    protected capabilities(): string[] {\n        return ['timer']\n    }\n\n    protected exit() {}\n\n    protected handle_specialinput(data: protocol.SpecialInput) {\n        if (data.type === 'fileref_prompt') {\n            const replyfunc = (ref: protocol.FileRef | null) => this.send_event({\n                type: 'specialresponse',\n                response: 'fileref_prompt',\n                value: ref,\n            })\n\n            try {\n                if (!this.Dialog) {\n                    setTimeout(() => replyfunc(null), 0)\n                }\n                else {\n                    this.Dialog.open(data.filemode !== 'read', data.filetype, data.gameid, replyfunc)\n                }\n            }\n            catch (ex) {\n                this.log(`Unable to open file dialog: ${ex}`)\n                /* Return a failure. But we don't want to call send_response before\n                glkote_update has finished, so we defer the reply slightly. */\n                setTimeout(() => replyfunc(null), 0)\n            }\n        }\n        else {\n            this.error( `Request for unknown special input type: ${data.type}` )\n        }\n    }\n\n    protected ontimer() {\n        if (!this.disabled) {\n            this.send_event({type: 'timer'})\n        }\n    }\n\n    save_allstate(): any {}\n\n    send_event(ev: Partial<protocol.Event>) {\n        if (this.disabled && ev.type !== 'specialresponse') {\n            return\n        }\n        if (this.waiting_for_update) {\n            console.log('Trying to send event when waiting for input', ev)\n            return\n        }\n        this.waiting_for_update = true\n        ev.gen = this.generation\n        switch (ev.type) {\n            case 'arrange':\n                ev.metrics = this.current_metrics\n                break\n            case 'init':\n                ev.metrics = this.current_metrics\n                ev.support = this.capabilities()\n                break\n            case 'specialresponse':\n                ev.response = 'fileref_prompt'\n                break\n        }\n        this.accept_func(ev as Required<protocol.Event>)\n    }\n\n    protected set_page_bg(colour: string) {}\n\n    // Functions to be implemented in a subclass\n    protected abstract cancel_inputs(windows: protocol.InputUpdate[]): void\n    protected abstract disable(disable: boolean): void\n    protected abstract update_content(content: protocol.ContentUpdate[]): void\n    protected abstract update_inputs(windows: protocol.InputUpdate[]): void\n    protected abstract update_windows(windows: protocol.WindowUpdate[]): void\n}", "/*\n\nWeb GlkOte shared things\n========================\n\nCopyright (c) 2022 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport * as protocol from '../../common/protocol.js'\n\n/** Create an element with specified classes */\nexport function create(tag: string, className:string): JQuery<HTMLElement> {\n    return $(`<${tag}>`, {'class': className})\n}\n\n/** Manage the DOM elements used by GlkOte */\nexport class DOM {\n    context_element?: HTMLElement\n    errorcontent_id: string\n    errorpane_id: string\n    gameport_id: string\n    loadingpane_id: string\n    prefix: string\n    windowport_id: string\n\n    constructor(options: {\n        context_element?: HTMLElement,\n        errorcontent_id: string,\n        errorpane_id: string,\n        gameport_id: string,\n        loadingpane_id: string,\n        prefix: string,\n        windowport_id: string,\n    }) {\n        this.context_element = options.context_element\n        this.errorcontent_id = options.errorcontent_id\n        this.errorpane_id = options.errorpane_id\n        this.gameport_id = options.gameport_id\n        this.loadingpane_id = options.loadingpane_id\n        this.prefix = options.prefix\n        this.windowport_id = options.windowport_id\n    }\n\n    /** Create an element, adding prefix to the ID */\n    create(tag: string, id: string, props?: string | any): JQuery<HTMLElement> {\n        props ??= {}\n        // Handle class name as props\n        if (typeof props === 'string') {\n            props = {\n                class: props,\n            }\n        }\n        props.id = this.prefix + id\n        return $(`<${tag}>`, props)\n    }\n\n    gameport(): JQuery<HTMLElement> {\n        return $(`#${this.gameport_id}`, this.context_element)\n    }\n\n    /** Return a jQuery search for an element ID, using prefix and context_element */\n    id(id: string): JQuery<HTMLElement> {\n        return $(`#${this.prefix}${id}`, this.context_element)\n    }\n\n    windowport(): JQuery<HTMLElement> {\n        return $(`#${this.windowport_id}`, this.context_element)\n    }\n}\n\nexport type EventFunc = (event: Partial<protocol.Event>) => void\n\n/** If we can determine that the browser is currently pinch zoomed */\nexport function is_pinch_zoomed() {\n    if (visualViewport) {\n        return (visualViewport.scale - 1) > 0.001\n    }\n    return false\n}", "/*\n\nMetrics and resize handlers\n===========================\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {throttle} from 'lodash-es'\n\nimport * as protocol from '../../common/protocol.js'\n\nimport {create, is_pinch_zoomed} from './shared.js'\nimport WebGlkOte from './web.js'\n\nfunction get_size(el: JQuery<HTMLElement>): {height: number, width: number} {\n    return {\n        height: el.outerHeight()!,\n        width: el.outerWidth()!,\n    }\n}\n\n/** Compare two metrics to see if they differ enough to send an arrange event */\nfunction metrics_differ(newmetrics: protocol.NormalisedMetrics, oldmetrics: protocol.NormalisedMetrics): boolean {\n    return (oldmetrics.buffercharheight !== newmetrics.buffercharheight ||\n        oldmetrics.buffercharwidth !== newmetrics.buffercharwidth ||\n        oldmetrics.gridcharheight !== newmetrics.gridcharheight ||\n        oldmetrics.gridcharwidth !== newmetrics.gridcharwidth ||\n        oldmetrics.height !== newmetrics.height ||\n        oldmetrics.width !== newmetrics.width)\n}\n\nconst ios15_0 = /(iPad; CPU|iPhone) OS 15_0/i.test(navigator.userAgent)\n\nexport default class Metrics {\n    // Shares the current_metrics and DOM of WebGlkOte\n    private metrics: protocol.NormalisedMetrics\n    private loaded: Promise<void>\n    private glkote: WebGlkOte\n    private observer?: ResizeObserver\n\n    constructor(glkote: WebGlkOte) {\n        this.glkote = glkote\n        this.metrics = glkote.current_metrics\n\n        // AsyncGlk may have started after a DOMContentLoaded event, but Metrics needs the page to be fully loaded so that the CSS and fonts are in use\n        // If the page is fast and already loaded by the time we get here (or, apparently, always for file: pages) then just use an auto-resolved promise\n        if (document.readyState === 'complete') {\n            this.loaded = Promise.resolve()\n        }\n        else {\n            this.loaded = new Promise((resolve: any) => {\n                window.addEventListener('load', resolve, {once: true})\n            })\n        }\n\n        // Use a resize observer on #gameport, or else a resize handler on window\n        if (window.ResizeObserver) {\n            this.observer = new ResizeObserver(this.on_gameport_resize)\n            this.observer.observe(this.glkote.dom.gameport()[0])\n        }\n        else {\n            $(window).on('resize', this.on_gameport_resize)\n        }\n        if (visualViewport) {\n            $(visualViewport).on('resize', this.on_visualViewport_resize)\n        }\n    }\n\n    destroy() {\n        if (this.observer) {\n            this.observer.disconnect()\n        }\n        else {\n            $(window).off('resize', this.on_gameport_resize)\n        }\n        if (visualViewport) {\n            $(visualViewport).off('resize', this.on_visualViewport_resize)\n        }\n    }\n\n    async measure() {\n        // Ensure #gameport exists\n        const dom = this.glkote.dom\n        const gameport = dom.gameport()\n        if (!gameport.length) {\n            throw new Error(`Cannot find gameport element #${dom.gameport_id}`)\n        }\n\n        // Old versions of GlkOte used a pre-existing #layouttestpane, remove it if it exists\n        dom.id('layouttestpane').remove()\n\n        // Create a layout test pane\n        const layout_test_pane = dom.create('div', 'layout_test_pane')\n        layout_test_pane.text('This should not be visible')\n\n        // Create the test windows\n        const line = $('<div>')\n        create('span', 'Style_normal').text('12345678').appendTo(line)\n\n        const bufwin = create('div', 'WindowFrame BufferWindow')\n        const bufinnerwin = create('div', 'BufferWindowInner').appendTo(bufwin)\n        const bufline1 = line.clone().addClass('BufferLine').appendTo(bufinnerwin)\n        const bufline2 = line.clone().addClass('BufferLine').appendTo(bufinnerwin)\n        create('span', 'InvisibleCursor').appendTo(bufline2)\n        const bufspan = bufline1.children('span')\n        layout_test_pane.append(bufwin)\n\n        const graphwin = create('div', 'WindowFrame GraphicsWindow')\n        const graphcanvas = $('<canvas>', {\n            height: 32,\n            width: 64,\n        }).appendTo(graphwin)\n        layout_test_pane.append(graphwin)\n\n        const gridwin = create('div', 'WindowFrame GridWindow')\n        const gridline1 = line.clone().addClass('GridLine').appendTo(gridwin)\n        const gridline2 = line.clone().addClass('GridLine').appendTo(gridwin)\n        const gridspan = gridline1.children('span')\n        layout_test_pane.append(gridwin)\n\n        gameport.append(layout_test_pane)\n\n        // Wait first for the load event for the CSS to be loaded\n        await this.loaded\n        // And then for the actual font(s) to be loaded\n        const font_family = getComputedStyle(gridwin[0]).getPropertyValue('--glkote-grid-mono-family').split(',')[0].replace(/\"/g, '')\n        await document.fonts.load(`14px ${font_family}`)\n\n        // Measure the gameport height/width, excluding border and padding\n        this.metrics.height = gameport.height()!\n        this.metrics.width = gameport.width()!\n\n        // Measure the buffer window\n        const bufwinsize = get_size(bufwin)\n        const bufspansize = get_size(bufspan)\n        const bufline1size = get_size(bufline1)\n        const bufline2size = get_size(bufline2)\n        // A minimum of 1, but not necessarily an integer\n        this.metrics.buffercharheight = Math.max(1, bufline2.position().top - bufline1.position().top)\n        this.metrics.buffercharwidth = Math.max(1, bufspan.width()! / 8)\n        this.metrics.buffermarginx = bufwinsize.width - bufspansize.width\n        this.metrics.buffermarginy = bufwinsize.height - (bufline1size.height + bufline2size.height)\n\n        // Measure the graphics window\n        const graphicswinsize = get_size(graphwin)\n        const canvassize = get_size(graphcanvas)\n        this.metrics.graphicsmarginx = graphicswinsize.width - canvassize.width\n        this.metrics.graphicsmarginy = graphicswinsize.height - canvassize.height\n\n        // Measure the grid window\n        const gridwinsize = get_size(gridwin)\n        const gridspansize = get_size(gridspan)\n        const gridline1size = get_size(gridline1)\n        const gridline2size = get_size(gridline2)\n        // A minimum of 1, but not necessarily an integer\n        this.metrics.gridcharheight = Math.max(1, gridline2.position().top - gridline1.position().top)\n        this.metrics.gridcharwidth = Math.max(1, gridspan.width()! / 8)\n        this.metrics.gridmarginx = gridwinsize.width - gridspansize.width\n        this.metrics.gridmarginy = gridwinsize.height - (gridline1size.height + gridline2size.height)\n\n        // Clean up\n        layout_test_pane.remove()\n    }\n\n    on_gameport_resize = throttle(async () => {\n        // Delay again if not yet inited or disabled\n        if (this.glkote.disabled || !this.glkote.inited()) {\n            this.on_gameport_resize()\n            return\n        }\n        const oldmetrics = Object.assign({}, this.metrics)\n        await this.measure()\n        if (metrics_differ(this.metrics, oldmetrics)) {\n            this.glkote.send_event({type: 'arrange'})\n        }\n    }, 200, {leading: false})\n\n    on_visualViewport_resize = () => {\n        // Don't do anything if the window is pinch zoomed\n        if (is_pinch_zoomed()){\n            return\n        }\n\n        // The iOS virtual keyboard does not change the gameport height, but it does change the viewport\n        // Try to account for this by setting the gameport to the viewport height\n        const gameport = this.glkote.dom.gameport()\n        const input_is_active = document.activeElement?.tagName === 'INPUT'\n\n        // But first...\n        // iOS 15: When the virtual keyboard is active, the URL bar is not correctly accounted for in visualViewport.height\n        // https://bugs.webkit.org/show_bug.cgi?id=229876\n        // Should be fixed in iOS 15.1\n        // Account for it by adding some padding to the #gameport\n        if (ios15_0) {\n            gameport.toggleClass('ios15fix', input_is_active)\n        }\n        // And then set the outer height to the viewport height, accounting for any padding or margin\n        gameport.outerHeight(visualViewport!.height, true)\n\n        // Safari might have scrolled weirdly, so try to put it right\n        window.scrollTo(0, 0)\n\n        // Measure and send the new metrics\n        this.on_gameport_resize()\n    }\n}", "/*\n\nGlkOte transcript recording handler\n===================================\n\nCopyright (c) 2022 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport * as protocol from '../../common/protocol.js'\nimport {GlkOteOptions, TranscriptRecordingData} from '../common/glkote.js'\n\nimport Windows from './windows.js'\n\nexport default class TranscriptRecorder {\n    enabled = false\n    handler: (state: TranscriptRecordingData) => void = state => this.web_handler(state)\n    event?: Partial<protocol.Event>\n    label = ''\n    session = Date.now() + Math.ceil(Math.random() * 10000).toString(16)\n    timestamp?: number\n    url = ''\n    private windows: Windows\n\n    constructor(options: GlkOteOptions, windows: Windows) {\n        this.windows = windows\n        if (options.recording_handler) {\n            this.enabled = true\n            this.handler = options.recording_handler\n            this.url = '(custom handler)'\n        }\n        if (options.recording_url) {\n            this.enabled = true\n            this.url = options.recording_url\n        }\n        this.label = options.recording_label ?? ''\n        if (this.enabled) {\n            console.log(`Transcript recording active: session ${this.session} \"${this.label}\", destination ${this.url}`)\n        }\n    }\n\n    // Store the event for later\n    record_event(ev: Partial<protocol.Event>) {\n        this.event = ev\n        this.timestamp = Date.now()\n    }\n\n    // Record an event-output pair\n    record_update(state: protocol.StateUpdate) {\n        if (!state.content) {\n            return\n        }\n\n        // Check the event type\n        const event = this.event!\n        const eventtype = event.type\n        let input = ''\n        if (eventtype === 'char' || eventtype === 'line') {\n            input = (event as protocol.CharEvent | protocol.LineEvent).value\n        }\n        else if (!(!eventtype || eventtype === 'external' || eventtype === 'init' || eventtype === 'specialresponse')) {\n            return\n        }\n\n        // Collect the buffer window outputs\n        let output = ''\n        for (const update of state.content) {\n            const win = this.windows.get(update.id)\n            if (!win || win.type !== 'buffer') {\n                continue\n            }\n            const textdata = (update as protocol.BufferWindowContentUpdate).text || []\n            for (const data of textdata) {\n                if (!data.append) {\n                    output += '\\n'\n                }\n                const content = data.content\n                if (!content?.length) {\n                    continue\n                }\n                for (let run_index = 0; run_index < content.length; run_index++) {\n                    const instruction = content[run_index]\n                    if (typeof instruction === 'string') {\n                        output += content[++run_index]\n                    }\n                    else if ('text' in instruction) {\n                        output += instruction.text\n                    }\n                }\n            }\n        }\n\n        this.handler({\n            format: 'simple',\n            input,\n            label: this.label,\n            output,\n            outtimestamp: Date.now(),\n            sessionId: this.session,\n            timestamp: this.timestamp!,\n        })\n    }\n\n    async web_handler(state: TranscriptRecordingData) {\n        try {\n            const response = await fetch(this.url, {\n                body: JSON.stringify(state),\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                method: 'POST',\n            })\n\n            if (!response.ok) {\n                throw new Error(`Could not submit transcript update, got ${response.status}`)\n            }\n        }\n        catch (err: any) {\n            this.enabled = false\n            console.log(`Transcript recording failed; disabling. Error: ${err as Error}`)\n        }\n    }\n}", "/*\n\nGlkOte input handlers\n=====================\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\nimport {throttle} from 'lodash-es'\n\nimport {KEY_CODE_DOWN, KEY_CODE_RETURN, KEY_CODE_UP, KEY_CODES_TO_NAMES, OFFSCREEN_OFFSET} from '../../common/constants.js'\nimport * as protocol from '../../common/protocol.js'\n\nimport {is_pinch_zoomed} from './shared.js'\nimport {apply_text_run_styles, Window} from './windows.js'\n\nconst MAX_HISTORY_LENGTH = 25\n\nexport class TextInput {\n    el: JQuery<HTMLElement>\n    history_index = 0\n    is_line = false\n    window: Window\n\n    constructor(window: Window) {\n        this.window = window\n\n        // We use a textarea rather than an input because mobile Chrome shows an extra bar which can't be removed\n        // See https://github.com/curiousdannii/asyncglk/issues/30\n        this.el = $('<textarea>', {\n            'aria-hidden': 'true',\n            autocapitalize: 'off',\n            class: 'Input',\n            data: {\n                window,\n            },\n            on: {\n                blur: () => this.onblur(),\n                focus: () => this.onfocus(),\n                input: (ev: any) => this.oninput(ev),\n                keydown: (ev: JQuery.KeyDownEvent) => this.onkeydown(ev),\n                keypress: (ev: JQuery.KeyPressEvent) => this.onkeypress(ev),\n            },\n            rows: 1,\n        })\n            .prop('disabled', true)\n            .appendTo(window.frameel)\n    }\n\n    destroy() {\n        this.el.remove()\n    }\n\n    private onblur() {\n        scroll_window()\n    }\n\n    private onfocus() {\n        // Ensure a buffer window is scrolled down\n        if (this.window.type === 'buffer' && !is_pinch_zoomed()) {\n            this.window.scroll_to_bottom()\n        }\n        // Scroll the browser window over the next 600ms\n        scroll_window()\n    }\n\n    /** The keydown and keypress inputs are unreliable in mobile browsers with virtual keyboards. This handler can handle character input for printable characters, but not function/arrow keys */\n    private oninput(ev: any) {\n        // This input shouldn't be active\n        if (!this.window.inputs?.type) {\n            this.el.trigger('blur')\n            return false\n        }\n\n        if (this.window.inputs.type === 'char') {\n            const char = ev.target.value[0]\n            this.submit_char(char)\n            // Even though we have reset and emptied the input, Android acts as though it still has spaces within it, and won't send backspace keydown events until the phantom spaces have all been deleted. Refocusing seems to fix it.\n            if (char === ' ') {\n                this.el.trigger('blur').trigger('focus')\n            }\n            return false\n        }\n    }\n\n    private onkeydown(ev: JQuery.KeyDownEvent) {\n        // This input shouldn't be active\n        if (!this.window.inputs?.type) {\n            this.el.trigger('blur')\n            return false\n        }\n\n        const keycode = ev.which\n        if (!keycode) {\n            return\n        }\n\n        if (this.is_line) {\n            // History\n            if (keycode === KEY_CODE_DOWN || keycode === KEY_CODE_UP) {\n                const history = this.window.manager.history\n                let changed\n                if (keycode === KEY_CODE_DOWN && this.history_index > 0) {\n                    this.history_index--\n                    changed = 1\n                }\n                else if (keycode === KEY_CODE_UP && this.history_index < history.length) {\n                    this.history_index++\n                    changed = 1\n                }\n                if (changed) {\n                    this.el.val(this.history_index === 0 ? '' : history[this.history_index - 1])\n                }\n                return false\n            }\n\n            // Terminator for this input\n            else if (this.window.inputs!.terminators) {\n                const terminator = KEY_CODES_TO_NAMES[keycode] as protocol.TerminatorCode\n                if (this.window.inputs!.terminators.includes(terminator)) {\n                    this.submit_line(ev.target.value, terminator)\n                    return false\n                }\n            }\n        }\n        // Character input\n        else {\n            const code = KEY_CODES_TO_NAMES[keycode]\n            if (code) {\n                this.submit_char(code)\n                return false\n            }\n        }\n\n        // Don't propagate, so that document.keydown doesn't trigger\n        ev.stopPropagation()\n    }\n\n    private onkeypress(ev: JQuery.KeyPressEvent) {\n        // This input shouldn't be active\n        if (!this.window.inputs?.type) {\n            this.el.trigger('blur')\n            return false\n        }\n\n        const keycode = ev.which\n        if (!keycode) {\n            return\n        }\n\n        // Submit line input\n        if (this.is_line) {\n            if (keycode === KEY_CODE_RETURN) {\n                this.submit_line(ev.target.value)\n                return false\n            }\n        }\n        // Character input\n        else {\n            const code = keycode === KEY_CODE_RETURN ? 'return' : String.fromCharCode(keycode)\n            this.submit_char(code)\n            return false\n        }\n    }\n\n    /** Refocus the input, if it wouldn't obscure part of the update */\n    // On Android this forces the window to be scrolled down to the bottom, so only refocus if the virtual keyboard doesn't make the window too small for the full update text to be seen\n    refocus() {\n        if (this.window.type === 'buffer') {\n            const updateheight = this.window.innerel.outerHeight()! - this.window.updatescrolltop\n            if (updateheight > this.window.height_above_keyboard) {\n                return\n            }\n        }\n        this.el[0].focus({preventScroll: true})\n    }\n\n    reset() {\n        this.history_index = 0\n        this.el\n            .attr({\n                'aria-hidden': 'true',\n                class: 'Input',\n            })\n            .css({\n                'background-color': '',\n                color: '',\n                left: OFFSCREEN_OFFSET,\n                top: '',\n                width: '',\n            })\n            .val('')\n        const inputparent = this.window.type === 'buffer' ? this.window.innerel : this.window.frameel\n        if (!this.el.parent().is(inputparent)) {\n            this.el.appendTo(inputparent)\n        }\n    }\n\n    private submit_char(val: string) {\n        this.window.send_text_event({\n            type: 'char',\n            value: val,\n        })\n    }\n\n    private submit_line(val: string, terminator?: protocol.TerminatorCode) {\n        // Insert a history item if it's not blank and also not the same as the last one\n        const history = this.window.manager.history\n        if (val && val !== history[0]) {\n            history.unshift(val)\n            if (history.length > MAX_HISTORY_LENGTH) {\n                history.length = MAX_HISTORY_LENGTH\n            }\n        }\n\n        this.window.send_text_event({\n            type: 'line',\n            terminator,\n            value: val,\n        })\n    }\n\n    update() {\n        // Start from a clean slate\n        this.reset()\n\n        const update = this.window.inputs!\n        if (update.type !== 'char' && update.type !== 'line') {\n            return\n        }\n        this.is_line = update.type === 'line'\n\n        // Common options for both character and line input\n        this.el\n            .attr({\n                'aria-hidden': 'false',\n                maxlength: this.is_line ? update.maxlen! : 1,\n            })\n            .prop('disabled', false)\n            .val(update.initial || '')\n\n        if (this.is_line) {\n            if (this.window.type === 'graphics') {\n                throw new Error(`Cannot request line input in graphics window ${this.window.id}`)\n            }\n            this.el.addClass('LineInput')\n        }\n\n        // Position the input element within the window\n        switch (this.window.type) {\n            case 'buffer':\n                (this.window.lastline || this.window.innerel).append(this.el)\n                break\n            case 'grid': {\n                const metrics = this.window.metrics\n                this.el.css({\n                    left: update.xpos! * metrics.gridcharwidth + (metrics.gridmarginx / 2),\n                    top: update.ypos! * metrics.gridcharheight + (metrics.gridmarginy / 2),\n                    width: (update.maxlen || 1) * metrics.gridcharwidth,\n                })\n                break\n            }\n        }\n\n        // Set text style\n        if (this.window.type !== 'graphics') {\n            const css_styles = this.window.last_run_styles\n            if (css_styles) {\n                const reverse = !!css_styles.reverse\n                this.el.toggleClass('reverse', reverse)\n                apply_text_run_styles(css_styles, reverse, this.el)\n            }\n        }\n    }\n}\n\n/* A little helper function to repeatedly scroll the window, because iOS sometimes scrolls badly\n   On iOS, when focusing the soft keyboard, the keyboard animates in over 500ms\n   This would normally cover up the focused input, so iOS cleverly tries to\n   scroll the top-level window down to bring the input into the view\n   But we know better: we want to scroll the input's window frame to the bottom,\n   without scrolling the top-level window at all. */\nconst scroll_window = throttle(() => {\n    function do_scroll(count: number) {\n        window.scrollTo(0, 0)\n        if (count > 0) {\n            setTimeout(do_scroll, 50, count - 1)\n        }\n    }\n    do_scroll(12)\n}, 1000)", "/*\n\nGlkOte windows\n==============\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {debounce} from 'lodash-es'\n\nimport {Blorb} from '../../blorb/blorb.js'\nimport {NBSP} from '../../common/constants.js'\nimport * as protocol from '../../common/protocol.js'\n\nimport {TextInput} from './input.js'\nimport {create, DOM, EventFunc, is_pinch_zoomed} from './shared.js'\nimport WebGlkOte from './web.js'\n\nexport type Window = BufferWindow | GraphicsWindow | GridWindow\ntype WindowCodes = 'buffer' | 'graphics' | 'grid'\n\nfunction no_text_selected(): boolean {\n    return (window.getSelection() + '') === ''\n}\n\ninterface WindowConstructorOptions {\n    blorb?: Blorb\n    dom: DOM,\n    id: number,\n    manager: Windows,\n    metrics: protocol.NormalisedMetrics,\n    rock: number,\n    styles?: protocol.WindowStyles,\n    type: WindowCodes,\n}\n\nabstract class WindowBase {\n    blorb?: Blorb\n    desired = true\n    dom: DOM\n    frameel: JQuery<HTMLElement>\n    id: number\n    inputs?: protocol.InputUpdate\n    manager: Windows\n    metrics: protocol.NormalisedMetrics\n    textinput: TextInput\n    type: WindowCodes\n\n    constructor(options: WindowConstructorOptions) {\n        this.blorb = options.blorb\n        this.dom = options.dom\n        this.id = options.id\n        this.manager = options.manager\n        this.metrics = options.metrics\n        this.type = options.type\n\n        this.frameel = this.dom.create('div', `window${options.id}`, {\n            class: `WindowFrame ${window_types[this.type]} WindowRock_${options.rock}`,\n            click: (ev: JQuery.ClickEvent) => this.onclick(ev),\n        })\n            .appendTo(this.dom.windowport())\n\n        // (this as any as Window) is a silly hack to work around Typescript's abstract class rules\n        this.textinput = new TextInput(this as any as Window)\n    }\n\n    destroy(remove_frame: boolean) {\n        this.textinput.destroy()\n        if (remove_frame) {\n            this.frameel.remove()\n        }\n        else {\n            this.inputs = undefined\n        }\n    }\n\n    // Dummy function which is only needed for buffer windows\n    measure_height() {}\n\n    protected onclick(ev: JQuery.ClickEvent) {\n        if (this.inputs?.type && no_text_selected()) {\n            this.textinput.el.trigger('focus')\n            return false\n        }\n    }\n\n    send_text_event(ev: Partial<protocol.CharEvent | protocol.LineEvent>) {\n        // Measure the height of the window, which should account for a virtual keyboard\n        this.measure_height()\n        this.textinput.reset()\n        // Clear the input type so we won't accidentally send it again\n        this.inputs!.type = undefined\n        // We're the last active window\n        this.manager.active_window = this as any as Window\n        // Set the event's window prop and send it\n        ev.window = this.id\n        this.manager.send_event(ev)\n    }\n}\n\n// Apply text run styles, accounting for reverse mode\nexport function apply_text_run_styles(orig_styles: protocol.CSSProperties, reverse: boolean, el: JQuery<HTMLElement>) {\n    // Make a copy of the styles, I'm not sure this is strictly necessary but better to be safe\n    const styles = Object.assign({}, orig_styles)\n    // Swap colours if reverse mode\n    if (reverse) {\n        const bg = styles['background-color']\n        const fg = styles.color\n        if (bg) {\n            styles.color = bg\n        }\n        else {\n            delete styles.color\n        }\n        if (fg) {\n            styles['background-color'] = fg\n        }\n        else {\n            delete styles['background-color']\n        }\n        delete styles.reverse\n    }\n    el.css(styles)\n}\n\n// Split a string into words, with whitespace included after the words it follows\nfunction split_after_spaces(text: string): string[] {\n    const res: string[] = ['']\n    const whitespace = /\\s/\n    let prev_whitespace = false\n    for (const c of text) {\n        const is_whitespace = whitespace.test(c)\n        if (!is_whitespace && prev_whitespace) {\n            res.unshift('')\n        }\n        res[0] += c\n        prev_whitespace = is_whitespace\n    }\n    res.reverse()\n    return res\n}\n\nabstract class TextualWindow extends WindowBase {\n    bg?: string\n    fg?: string\n    last_run_styles?: protocol.CSSProperties\n    styles?: protocol.WindowStyles\n\n    constructor(options: WindowConstructorOptions) {\n        super(options)\n\n        // We need the `this` object provided by jQuery, so we can't use an arrow function handler like we normally do\n        const onlink = (target: HTMLElement) => this.onlink(target)\n        this.frameel.on('click', 'a', function() {onlink(this)})\n\n        // Add stylehints\n        if (options.styles) {\n            this.styles = options.styles\n            this.add_stylehints()\n        }\n    }\n\n    /** Format CSS rules and add to the window */\n    add_stylehints() {\n        const windowid = `#window${this.id}`\n        const styles: protocol.WindowStyles = {}\n        if (this.styles) {\n            // Copy all the styles\n            for (const [selector, original_styles] of Object.entries(this.styles)) {\n                const full_selector = `${windowid} ${selector}`.trim()\n                const css_styles = styles[full_selector] = Object.assign({}, original_styles)\n\n                // Create a .reverse rule for when text runs are reverse mode\n                if (selector) {\n                    const bg = css_styles['background-color']\n                    const fg = css_styles.color\n                    if (bg || fg) {\n                        const reverse_styles: protocol.CSSProperties = styles[`${full_selector}.reverse`] = {}\n                        if (bg) {\n                            reverse_styles.color = bg\n                        }\n                        if (fg) {\n                            reverse_styles['background-color'] = fg\n                        }\n                    }\n\n                    // Monospace mode - handled in create_text_run\n                    delete css_styles.monospace\n\n                    // In reverse mode don't set colour styles\n                    if (css_styles.reverse) {\n                        delete css_styles['background-color']\n                        delete css_styles.color\n                    }\n                    delete css_styles.reverse\n\n                    // Check if we have any properties left\n                    if (Object.keys(css_styles).length === 0) {\n                        delete styles[full_selector]\n                    }\n                }\n            }\n\n            // Copy styles for the <input>\n            // May not play nice with reverse\n            if (styles[`${windowid} span.Style_input`]) {\n                styles[`${windowid} .LineInput`] = styles[`${windowid} span.Style_input`]\n            }\n        }\n\n        // Set window background colour, for normal and reverse mode\n        const normal_styles = styles[`${windowid} span.Style_normal`]\n        const bg = this.bg || normal_styles?.['background-color']\n        const fg = this.fg || normal_styles?.color\n        if (bg || fg) {\n            if (!styles[windowid]) {\n                styles[windowid] = {}\n            }\n            styles[windowid]['background-color'] = bg || `var(--glkote-${this.type}-bg)`\n            styles[`${windowid}.reverse`] = {\n                'background-color': fg || `var(--glkote-${this.type}-reverse-bg)`,\n            }\n        }\n\n        // Finally output the styles\n        if (Object.keys(styles).length) {\n            this.frameel.children('style').remove()\n            this.frameel.prepend(`<style>${Object.entries(styles).map(rule => {\n                const [selector, properties] = rule\n                return `${selector} {${Object.entries(properties).map(property => {\n                    const [name, value] = property\n                    return `${name}: ${value}`\n                }).join('; ')}}`\n            }).join('\\n')}</style>`)\n        }\n    }\n\n    create_text_run(run: protocol.TextRun, split_words?: boolean): JQuery<HTMLElement> {\n        const run_style = run.style\n        // Is this run or this style monospace mode?\n        const monospace_val = run.css_styles?.monospace ?? this.styles?.[`span.Style_${run_style}`]?.monospace\n        let monospace_class = ''\n        // Only add the class if we're changing the default font-family for this style\n        if (typeof monospace_val !== 'undefined') {\n            if (run_style === 'preformatted') {\n                if (!monospace_val) {\n                    monospace_class = ' proportional'\n                }\n            }\n            else if (monospace_val) {\n                monospace_class = ' monospace'\n            }\n        }\n        // Is this run or this style reverse mode?\n        const reverse = run.css_styles?.reverse ?? this.styles?.[`span.Style_${run_style}`]?.reverse\n        // Create a template span and apply classes and styles\n        const el = create('span', `Style_${run_style}${reverse ? ' reverse' : ''}${monospace_class}`)\n        if (run.css_styles) {\n            apply_text_run_styles(run.css_styles, !!reverse, el)\n        }\n        // Split words if instructed to, or if this text run is monospaced\n        if (typeof split_words === 'undefined') {\n            split_words = !!monospace_val || run_style === 'preformatted'\n        }\n        const els = split_words\n            ? $(split_after_spaces(run.text).map(text => el.clone().text(text)[0]))\n            : el.text(run.text)\n        // Wrap in a link\n        if (run.hyperlink) {\n            return $('<a>', {\n                data: {\n                    glklink: run.hyperlink,\n                },\n                href: '#',\n            })\n                .append(els)\n        }\n        return els\n    }\n\n    onlink(target: HTMLElement) {\n        const linkval = $(target).data('glklink')\n        if (linkval) {\n            if (this.inputs?.hyperlink) {\n                this.manager.send_event({\n                    type: 'hyperlink',\n                    value: linkval,\n                    window: this.id,\n                })\n            }\n            return false\n        }\n    }\n\n    /** Refresh styles after a cleared window */\n    refresh_styles(bg?: string, fg?: string) {\n        let styles_need_refreshing\n        if (typeof bg !== 'undefined' && bg !== this.bg) {\n            this.bg = bg\n            styles_need_refreshing = 1\n        }\n        if (typeof fg !== 'undefined' && fg !== this.fg) {\n            this.fg = fg\n            styles_need_refreshing = 1\n        }\n        if (styles_need_refreshing) {\n            this.add_stylehints()\n        }\n    }\n}\n\nconst inline_alignment_classes: Record<string, string> = {\n    inlinecenter: 'ImageInlineCenter',\n    inlinedown: 'ImageInlineDown',\n    inlineup: 'ImageInlineUp',\n    marginleft: 'ImageMarginLeft',\n    marginright: 'ImageMarginRight',\n}\n\nexport class BufferWindow extends TextualWindow {\n    type = 'buffer' as const\n    /** How much height is available with the keyboard active */\n    height_above_keyboard: number\n    innerel: JQuery<HTMLElement>\n    private is_scrolled_down = true\n    lastline?: JQuery<HTMLElement>\n    updatescrolltop = 0\n\n    constructor(options: WindowConstructorOptions) {\n        super(options)\n        this.frameel.attr({\n            'aria-live': 'polite',\n            role: 'log',\n            tabindex: -1,\n        })\n            .on('scroll', this.onscroll)\n        this.innerel = create('div', 'BufferWindowInner')\n            .append(this.textinput.el)\n            .appendTo(this.frameel)\n        this.height_above_keyboard = this.frameel.height()!\n    }\n\n    /** Measure the height of the window that is currently visible (excluding virtual keyboards for example) */\n    measure_height() {\n        this.height_above_keyboard = this.frameel.height()!\n    }\n\n    protected onclick(_: JQuery.ClickEvent) {\n        if (this.inputs?.type && no_text_selected()) {\n            // Check that we've scrolled to the bottom (if there is actually text in this window)\n            if (this.lastline && this.height_above_keyboard) {\n                const rect = this.lastline[0].getBoundingClientRect()\n                if (rect.bottom < 0 || rect.top > document.documentElement.clientHeight) {\n                    return false\n                }\n            }\n            this.textinput.el.trigger('focus')\n            return false\n        }\n    }\n\n    // When the frame element is scrolled, update whether it's scrolled to the bottom\n    private onscroll = () => {\n        const frameel = this.frameel[0]\n        this.is_scrolled_down = frameel.scrollHeight - frameel.scrollTop - frameel.clientHeight < 1\n    }\n\n    // Scroll to the bottom, unless `after_metrics_change` is set, in which case only scroll if we *should* be at the bottom (used after updating metrics)\n    scroll_to_bottom(after_metrics_change?: boolean) {\n        if (!after_metrics_change || this.is_scrolled_down) {\n            this.frameel.scrollTop(this.innerel.height()!)\n            this.is_scrolled_down = true\n        }\n    }\n\n    update(data: protocol.BufferWindowContentUpdate) {\n        if (data.clear) {\n            // Reset the text input before removing the window's buffer lines so that it won't be detached from the document (which would then remove its event handlers)\n            this.textinput.reset()\n            this.innerel.children('.BufferLine').remove()\n            this.is_scrolled_down = true\n            this.lastline = undefined\n            this.last_run_styles = undefined\n            this.refresh_styles(data.bg, data.fg)\n        }\n\n        // If the text field is missing, just do nothing\n        if (!data.text) {\n            return\n        }\n\n        // Tell ARIA that we're busy while we're updating the window\n        this.frameel.attr('aria-busy', 'true')\n\n        // Get the scrolltop for this update\n        this.updatescrolltop = Math.max(0, (this.lastline?.position().top || 0) - 20)\n\n        let line_index = 0\n        while (line_index < data.text.length) {\n            const line = data.text[line_index++]\n            const content = line.content\n            let divel: JQuery<HTMLElement> | undefined\n            let line_has_style\n            if (line.append && this.lastline) {\n                divel = this.lastline\n                line_has_style = 1\n            }\n            else {\n                divel = create('div', 'BufferLine')\n                this.innerel.append(divel)\n                this.lastline = divel\n                if (!content?.length) {\n                    divel.addClass('BlankPara')\n                    divel.append(create('span', 'BlankLineSpace').text(NBSP))\n                    continue\n                }\n            }\n            if (line.flowbreak) {\n                divel.addClass('FlowBreak')\n            }\n\n            if (!content?.length) {\n                continue\n            }\n            for (let run_index = 0; run_index < content.length; run_index++) {\n                let run: protocol.TextRun\n                const instruction = content[run_index]\n                if (typeof instruction === 'string') {\n                    run = {\n                        style: content[run_index++] as string,\n                        text: content[run_index] as string,\n                    }\n                }\n                else if ('special' in instruction && instruction.special === 'image') {\n                    const el = $('<img>', {\n                        alt: instruction.alttext || `Image ${instruction.image}`,\n                        class: inline_alignment_classes[instruction.alignment || 'inlineup'],\n                        height: instruction.height,\n                        src: this.blorb && this.blorb.get_image_url(instruction.image!) || instruction.url!,\n                        width: instruction.width,\n                    })\n                    if (instruction.hyperlink) {\n                        $('<a>', {\n                            data: {\n                                glklink: instruction.hyperlink,\n                            },\n                            href: '#',\n                        })\n                            .append(el)\n                            .appendTo(divel)\n                        continue\n                    }\n                    divel.append(el)\n                    continue\n                }\n                else {\n                    run = instruction as protocol.TextRun\n                }\n                if (!line_has_style) {\n                    line_has_style = 1\n                    divel.addClass(`Style_${run.style}`)\n                }\n                divel.append(this.create_text_run(run, line_index === data.text.length ? true : undefined))\n                // Store the last text run for setting styles in the input\n                this.last_run_styles = run.css_styles\n            }\n        }\n\n        // Scroll down\n        if (!is_pinch_zoomed()) {\n            this.frameel.scrollTop(this.updatescrolltop)\n        }\n\n        // TODO: Trim log?\n\n        this.frameel.attr('aria-busy', 'false')\n    }\n}\n\nexport class GraphicsWindow extends WindowBase {\n    type = 'graphics' as const\n    buffer: JQuery<HTMLCanvasElement>\n    canvas: JQuery<HTMLCanvasElement>\n    fillcolour = ''\n    framequeue: protocol.GraphicsWindowOperation[][] = []\n    /** Height in CSS pixels */\n    height = 0\n    image_cache: Map<number | string, HTMLImageElement> = new Map()\n    /** Width in CSS pixels */\n    width = 0\n\n    constructor(options: WindowConstructorOptions) {\n        super(options)\n        // Create the canvas\n        this.canvas = this.dom.create('canvas', `win${options.id}_canvas`, {\n            data: {\n                window: this,\n            },\n        }) as JQuery<HTMLCanvasElement>\n        this.frameel.append(this.canvas)\n        this.manager.canvasResizeObserver?.observe(this.canvas[0])\n\n        // And a buffer canvas to reduce flicker\n        this.buffer = this.dom.create('canvas', `win${options.id}_buffer`) as JQuery<HTMLCanvasElement>\n    }\n\n    // Clear the image cache 5 seconds after the last frame, so that the cache can be useful for animations, but we don't waste memory for images which are only updated each turn\n    clear_cache = debounce(() => {\n        this.image_cache.clear()\n    }, 5000)\n\n    // Decode and cache an image\n    decode_image(key: number | string, url: string): Promise<void> {\n        const image = new Image()\n        image.src = url\n        return image.decode()\n            .then(() => {\n                this.image_cache.set(key, image)\n            })\n            .catch(() => {})\n    }\n\n    destroy(remove_frame: boolean) {\n        this.manager.canvasResizeObserver?.unobserve(this.canvas[0])\n        super.destroy(remove_frame)\n    }\n\n    onclick(ev: JQuery.ClickEvent) {\n        if (this.inputs?.mouse && ev.button === 0) {\n            this.inputs.mouse = false\n            this.manager.send_event({\n                type: 'mouse',\n                window: this.id,\n                x: Math.floor(ev.offsetX - this.metrics.graphicsmarginx / 2),\n                y: Math.floor(ev.offsetY - this.metrics.graphicsmarginy / 2),\n            })\n            return false\n        }\n        return super.onclick(ev)\n    }\n\n    set_dimensions(height: number, width: number) {\n        // First set the things which use CSS pixels\n        this.canvas.css({height, width})\n        this.height = height\n        this.width = width\n        // Then the canvas dimensions using devicePixelRatio\n        const dPR = devicePixelRatio\n        height = height * dPR\n        width = width * dPR\n        this.buffer.attr({height, width})\n        this.canvas.attr({height, width})\n        // The resize observer will handle setting true pixel sizes if supported\n    }\n\n    // This function is async because images must be loaded asynchrounously, and each operation painted in sequence, but the rest of GlkOte doesn't need to await it\n    async update() {\n        const buffercontext = this.buffer[0].getContext('2d')!\n\n        // If we're slow loading images then more than one frame may have arrived, so go through the queue now\n        for (let i = 0; i < this.framequeue.length; i++) {\n            const frame = this.framequeue[i]\n\n            // Stop if the window is collapsed\n            if (!this.height || !this.width) {\n                break\n            }\n            // There shouldn't be any empty frames, but check just in case\n            if (!frame.length) {\n                continue\n            }\n\n            // Preload images\n            const loading_images = []\n            for (const op of frame) {\n                if (op.special === 'image') {\n                    const key = op.url || op.image!\n                    if (this.image_cache.has(key)) {\n                        continue\n                    }\n                    const url = op.url || this.blorb && this.blorb.get_image_url(op.image!)\n                    if (url) {\n                        loading_images.push(this.decode_image(key, url))\n                    }\n                }\n            }\n            await Promise.all(loading_images)\n\n            const dPR = devicePixelRatio\n            for (const op of frame) {\n                switch (op.special) {\n                    case 'fill':\n                        buffercontext.fillStyle = op.color || this.fillcolour\n                        if (Number.isFinite(op.x)) {\n                            buffercontext.fillRect(op.x! * dPR, op.y! * dPR, op.width! * dPR, op.height! * dPR)\n                        }\n                        else {\n                            buffercontext.fillRect(0, 0, parseInt(this.buffer.attr('width')!), parseInt(this.buffer.attr('height')!))\n                        }\n                        break\n                    case 'image': {\n                        const image = this.image_cache.get(op.url || op.image!)\n                        if (image) {\n                            buffercontext.drawImage(image, op.x * dPR, op.y * dPR, op.width * dPR, op.height * dPR)\n                        }\n                        break\n                    }\n                    case 'setcolor':\n                        this.fillcolour = op.color\n                        break\n                }\n            }\n        }\n        // Now that all operations/frames are finished, draw the buffer to the main canvas (as long as it hasn't been collapsed)\n        if (this.height && this.width) {\n            this.canvas[0].getContext('2d')!.drawImage(this.buffer[0], 0, 0)\n        }\n\n        // Empty the queue\n        this.framequeue.length = 0\n        // And queue the cache to be cleared, if more frames don't arrive soon\n        this.clear_cache()\n    }\n}\n\nclass GridWindow extends TextualWindow {\n    type = 'grid' as const\n    height = 0\n    lines: JQuery<HTMLElement>[] = []\n    width = 0\n\n    constructor(options: WindowConstructorOptions) {\n        super(options)\n        this.frameel.attr({\n            'aria-atomic': 'true',\n            'aria-live': 'off',\n            role: 'status',\n        })\n    }\n\n    onclick(ev: JQuery.ClickEvent) {\n        if (this.inputs?.mouse && ev.button === 0 && no_text_selected()) {\n            this.inputs.mouse = false\n            this.manager.send_event({\n                type: 'mouse',\n                window: this.id,\n                x: Math.floor((ev.offsetX - this.metrics.gridmarginx / 2) / this.metrics.gridcharwidth),\n                y: Math.floor((ev.offsetY - this.metrics.gridmarginy / 2) / this.metrics.gridcharheight),\n            })\n            return false\n        }\n        return super.onclick(ev)\n    }\n\n    update(data: protocol.GridWindowContentUpdate) {\n        if (data.clear) {\n            this.last_run_styles = undefined\n            this.refresh_styles(data.bg, data.fg)\n        }\n\n        // Tell ARIA that we're busy while we're updating the window\n        this.frameel.attr('aria-busy', 'true')\n\n        for (const line of data.lines) {\n            const lineel = this.lines[line.line]\n            if (!lineel.length) {\n                throw new Error(`Got content for nonexistent line ${line.line} of window ${this.id}`)\n            }\n\n            const content = line.content\n            if (!content || !content.length) {\n                lineel.text(NBSP)\n            }\n            else {\n                lineel.empty()\n                for (let i = 0; i < content.length; i++) {\n                    let run: protocol.TextRun\n                    if (typeof content[i] === 'string') {\n                        run = {\n                            style: content[i++] as string,\n                            text: content[i] as string,\n                        }\n                    }\n                    else {\n                        run = content[i] as protocol.TextRun\n                    }\n                    lineel.append(this.create_text_run(run, false))\n                    // Store the last text run for setting styles in the input\n                    this.last_run_styles = run.css_styles\n                }\n            }\n        }\n\n        // Apply the class of 'reverse' to the window if all the text in it is reversed\n        this.frameel.toggleClass('reverse', $(`#window${this.id} span:not(.reverse)`).length === 0)\n\n        // If there are more than 4 lines, set aria-live to polite\n            .attr({\n                'aria-busy': 'false',\n                'aria-live': this.lines.length > 3 ? 'polite' : 'off',\n            })\n    }\n}\n\nconst window_classes: Record<string, new (opt: WindowConstructorOptions) => Window> = {\n    buffer: BufferWindow,\n    graphics: GraphicsWindow,\n    grid: GridWindow,\n}\n\nconst window_types: Record<string, string> = {\n    buffer: 'BufferWindow',\n    graphics: 'GraphicsWindow',\n    grid: 'GridWindow',\n}\n\nexport default class Windows extends Map<number, Window> {\n    active_window?: Window\n    blorb?: Blorb // Note will be set after this is constructed, in WebGlkOte.init\n    canvasResizeObserver?: ResizeObserver // Will only be created if the browser's ResizeObserver supports devicePixelContentBoxSize\n    private dom: DOM\n    private glkote: WebGlkOte\n    history: string[] = []\n    private metrics: protocol.NormalisedMetrics\n    send_event: EventFunc\n\n    constructor(glkote: WebGlkOte) {\n        super()\n        this.dom = glkote.dom\n        this.glkote = glkote\n        this.metrics = glkote.current_metrics\n        if (window.ResizeObserver) {\n            // We can use a ResizeObserver to get true pixel dimensions for canvases, but it's not supported in all browsers, so test\n            const testRO = new ResizeObserver((entries) => {\n                if (typeof entries?.[0].devicePixelContentBoxSize?.[0].blockSize !== 'undefined') {\n                    this.canvasResizeObserver = new ResizeObserver((entries: ResizeObserverEntry[]) => this.oncanvasresize(entries))\n                }\n                testRO.disconnect()\n            })\n            testRO.observe(document.body)\n        }\n        this.send_event = ev => glkote.send_event(ev)\n\n        $(document).on('keydown', this.onkeydown)\n        this.dom.gameport().on('click', () => this.onclick())\n    }\n\n    // Clean up after a GlkOte.exit() call, but don't empty the HTML\n    destroy() {\n        for (const win of this.values()) {\n            win.destroy(false)\n            this.delete(win.id)\n        }\n        $(document).off('keydown', this.onkeydown)\n    }\n\n    cancel_inputs(windows: protocol.InputUpdate[]) {\n        const newinputs: Record<number, protocol.InputUpdate> = {}\n        for (const window of windows) {\n            newinputs[window.id] = window\n        }\n\n        for (const win of this.values()) {\n            const update = newinputs[win.id]\n            if (!update && win.inputs) {\n                if (win.textinput.el.is(':focus')) {\n                    this.active_window = win\n                }\n                win.textinput.el.prop('disabled', true)\n                delete win.inputs\n            }\n        }\n    }\n\n    // Use a resize observer to set true pixel sizes on graphics windows\n    private oncanvasresize(entries: ResizeObserverEntry[]) {\n        for (const entry of entries) {\n            const box = entry.devicePixelContentBoxSize![0]\n            const height = box.blockSize\n            const width = box.inlineSize\n            const win: GraphicsWindow = $(entry.target).data('window')\n            win.buffer.attr({height, width})\n            win.canvas.attr({height, width})\n        }\n        this.send_event({type: 'redraw'})\n    }\n\n    // If the gameport receives a click event, then find one window with active text input to focus\n    private onclick() {\n        if (!this.glkote.disabled && no_text_selected()) {\n            for (const window of this.values()) {\n                if (window.inputs?.type) {\n                    window.frameel.trigger('click')\n                    break\n                }\n            }\n        }\n    }\n\n    // On document.keypress events, redirect to a window\n    private onkeydown = (ev: JQuery.KeyDownEvent) => {\n        // Don't fire on inputs or focused buffer windows\n        if (!this.glkote.disabled && ev.target.nodeName !== 'input' && !(ev.target.nodeName === 'div' && $(ev.target).is('.BufferWindow:focus'))) {\n            // Look first for a window with active text input, but as a fallback any buffer window\n            const windows = [...this.values()]\n            const window = windows.filter(win => win.inputs?.type)[0] || windows.filter(win => win.type === 'buffer')[0]\n            if (window) {\n                window.frameel.trigger('click')\n                // After focusing, the keypress event will fire, but not the keydown, meaning that function keys won't be recognised\n                // So manually trigger the keydown event in the input (as long as it is actually focused)\n                if (window.textinput.el.is(':focus')) {\n                    window.textinput.el.trigger(ev)\n                }\n                // Otherwise focus the window so that nav keys will work\n                else if (window.type === 'buffer') {\n                    window.frameel.trigger('focus')\n                }\n            }\n        }\n    }\n\n    update(windows: protocol.WindowUpdate[]) {\n        // Mark all windows as non-desired\n        for (const win of this.values()) {\n            win.desired = false\n        }\n\n        // Go through each window in this update\n        for (const update of windows) {\n            const id = update.id\n            const type = update.type\n\n            // Is there an existing window?\n            let win = this.get(id)\n\n            // Create it if not\n            if (!win) {\n                win = new (window_classes[type])({\n                    blorb: this.blorb,\n                    dom: this.dom,\n                    id,\n                    manager: this,\n                    metrics: this.metrics,\n                    rock: update.rock,\n                    styles: update.styles,\n                    type,\n                })\n                this.set(id, win)\n            }\n            else {\n                if (win.type !== type) {\n                    throw new Error(`Window ${id} was created with type ${win.type}, but now is described as type ${type}`)\n                }\n            }\n            win.desired = true\n\n            // Ensure graphics windows are the right size\n            if (win.type === 'graphics') {\n                if (win.height !== update.graphheight || win.width !== update.graphwidth) {\n                    win.set_dimensions(update.graphheight!, update.graphwidth!)\n                }\n            }\n\n            // Ensure grid windows have the right number of lines\n            if (win.type === 'grid') {\n                if (update.gridheight! > win.height) {\n                    for (let i = win.height; i < update.gridheight!; i++) {\n                        const line = this.dom.create('div', `win${win.id}_ln${i}`, 'GridLine')\n                        line.append(NBSP)\n                        win.frameel.append(line)\n                        win.lines[i] = line\n                    }\n                }\n                if (update.gridheight! < win.height) {\n                    for (let i = update.gridheight!; i < win.height; i++) {\n                        this.dom.id(`win${win.id}_ln${i}`).remove()\n                    }\n                }\n                win.height = update.gridheight!\n                win.lines.length = win.height\n                win.width = update.gridwidth!\n            }\n\n            // Update the position of the window\n            win.frameel.css({\n                height: update.height,\n                left: update.left,\n                top: update.top,\n                width: update.width,\n            })\n            if (win.type === 'buffer') {\n                win.scroll_to_bottom(true)\n            }\n        }\n\n        const windowstoclose: Window[] = []\n        for (const win of this.values()) {\n            if (!win.desired) {\n                windowstoclose.push(win)\n            }\n        }\n        for (const win of windowstoclose) {\n            win.destroy(true)\n            this.delete(win.id)\n        }\n    }\n\n    update_content(content: protocol.ContentUpdate[]) {\n        for (const update of content) {\n            const win = this.get(update.id)\n            if (!win) {\n                throw new Error(`Got content update for window ${update.id}, which does not exist`)\n            }\n            // TODO: check for pending line input\n\n            switch (win.type) {\n                case 'buffer': win.update(update as protocol.BufferWindowContentUpdate); break\n                case 'graphics':\n                    // Queue this frame, but only run the update function if this is the only frame\n                    win.framequeue.push((update as protocol.GraphicsWindowContentUpdate).draw)\n                    if (win.framequeue.length === 1) {\n                        win.update()\n                    }\n                    break\n                case 'grid': win.update(update as protocol.GridWindowContentUpdate); break\n            }\n        }\n    }\n\n    update_inputs(windows: protocol.InputUpdate[]) {\n        for (const update of windows) {\n            const win = this.get(update.id)\n            if (!win) {\n                throw new Error(`Got input update for window ${update.id}, which does not exist`)\n            }\n\n            const oldgen = win.inputs?.gen\n            win.inputs = update\n            if (update.type){\n                if (update.gen !== oldgen) {\n                    win.textinput.update()\n                }\n            }\n        }\n\n        // Refocus an <input>\n        // On Android this forces the window to be scrolled down to the bottom, so only refocus if the virtual keyboard doesn't make the window too small for the full update text to be seen\n        if (this.active_window) {\n            // Refocus the same window if it hasn't been deleted and still wants input\n            if (this.has(this.active_window.id) && this.active_window.inputs?.type) {\n                this.active_window.textinput.refocus()\n            }\n            // Look for any window with text input\n            else {\n                [...this.values()].filter(win => win.inputs?.type)[0]?.textinput.refocus()\n            }\n        }\n    }\n}", "/*\n\nWeb GlkOte implementation\n=========================\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/asyncglk\n\n*/\n\nimport {throttle} from 'lodash-es'\n\nimport * as GlkOte from '../common/glkote.js'\nimport * as protocol from '../../common/protocol.js'\n\nimport Metrics from './metrics.js'\nimport {DOM} from './shared.js'\nimport TranscriptRecorder from './transcript-recorder.js'\nimport Windows, {GraphicsWindow} from './windows.js'\n\ninterface AutosaveState {\n    graphics_bg?: Array<[number, string]>,\n    history?: Array<string>,\n    transcript_recorder_session?: string,\n}\n\n/** A GlkOte implementation for the web\n * \n * WebGlkOte requires the following HTML divs to be present (though the id names can be varied through the options):\n * \n * ```\n *     <div id=\"gameport\">\n *         <div id=\"windowport\"></div>\n *         <div id=\"loadingpane\">Loading...</div>\n *         <div id=\"errorpane\" style=\"display:none;\"><div id=\"errorcontent\"></div></div>\n *     </div>\n * ```\n */\nexport default class WebGlkOte extends GlkOte.GlkOteBase implements GlkOte.GlkOte {\n    dom: DOM = new DOM({\n        context_element: undefined,\n        errorcontent_id: 'errorcontent',\n        errorpane_id: 'errorpane',\n        gameport_id: 'gameport',\n        loadingpane_id: 'loadingpane',\n        prefix: '',\n        windowport_id: 'windowport',\n    })\n    private metrics_calculator: Metrics\n    private showing_error = false\n    private showing_loading = true\n    private transcript_recorder?: TranscriptRecorder\n    private windows: Windows\n\n    constructor() {\n        super()\n\n        this.metrics_calculator = new Metrics(this)\n        this.windows = new Windows(this)\n    }\n\n    async init(options: GlkOte.GlkOteOptions) {\n        try {\n            if (!options) {\n                throw new Error('no options provided')\n            }\n\n            if (typeof jQuery === 'undefined') {\n                throw new Error('jQuery is not loaded')\n            }\n\n            // Set DOM IDs\n            if (options.dom_prefix) {\n                this.dom.prefix = options.dom_prefix\n            }\n            if (options.errorcontent) {\n                this.dom.errorcontent_id = options.errorcontent\n            }\n            if (options.errorpane) {\n                this.dom.errorpane_id = options.errorpane\n            }\n            if (options.gameport) {\n                this.dom.gameport_id = options.gameport\n            }\n            if (options.loadingpane) {\n                this.dom.loadingpane_id = options.loadingpane\n            }\n            if (options.windowport) {\n                this.dom.windowport_id = options.windowport\n            }\n\n            if (options.Blorb) {\n                this.windows.blorb = options.Blorb\n            }\n\n            // The windowport is required to already exist\n            const windowport = this.dom.windowport()\n            if (!windowport.length) {\n                throw new Error(`Cannot find windowport element #${this.dom.windowport_id}`)\n            }\n            windowport.empty()\n\n            $(document).on('scroll', this.on_document_scroll)\n\n            // Augment the viewport meta tag\n            // Rather than requiring all users to update their HTML we will add new properties here\n            // The properties we want are initial-scale, minimum-scale, width, and the new interactive-widget\n            // See https://developer.chrome.com/blog/viewport-resize-behavior\n            let viewport_meta_tag_content = 'initial-scale=1,interactive-widget=resizes-content,minimum-scale=1,width=device-width'\n\n            // Prevent iOS from zooming in when focusing input, but allow Android to still pinch zoom\n            // As they handle the maximum-scale viewport meta option differently, we will conditionally add it only in iOS\n            // Idea from https://stackoverflow.com/a/62750441/2854284\n            if (/iPhone OS/i.test(navigator.userAgent)) {\n                viewport_meta_tag_content += ',maximum-scale=1'\n            }\n\n            (document.head.querySelector('meta[name=\"viewport\"]')! as HTMLMetaElement).content = viewport_meta_tag_content\n\n            await this.metrics_calculator.measure()\n\n            // Set up transcript recording\n            if (options.recording_url || options.recording_handler) {\n                if (options.recording_format && options.recording_format !== 'simple') {\n                    console.warn('GlkOte: only the \"simple\" recording_format is supported')\n                }\n                else {\n                    // Check if the user has opted out\n                    const query_feedback = (new URLSearchParams(document.location.search)).get('feedback')\n                    const cookie_name = options.recording_cookie || 'transcript_recording_opt_out'\n                    if ((query_feedback && query_feedback !== '1') || document.cookie.includes(`${cookie_name}=1`)) {\n                        console.log('User has opted out of transcript recording.')\n                    }\n                    else {\n                        this.transcript_recorder = new TranscriptRecorder(options, this.windows)\n                    }\n                }\n            }\n\n            // Note that this must be called last as it will result in VM.start() being called\n            return super.init(options)\n        }\n        catch (err) {\n            this.error(err as Error)\n        }\n    }\n\n    protected autorestore(data: AutosaveState) {\n        // erkyrath/glkote history is an object rather than an array\n        if (Array.isArray(data.history)) {\n            this.windows.history = data.history\n        }\n\n        for (const win of this.windows.values()) {\n            // Scroll all buffer windows\n            if (win.type === 'buffer') {\n                win.scroll_to_bottom()\n            }\n        }\n\n        if (data.graphics_bg) {\n            for (const [winid, colour] of data.graphics_bg) {\n                (this.windows.get(winid) as GraphicsWindow).fillcolour = colour\n            }\n        }\n\n        if (data.transcript_recorder_session && this.transcript_recorder) {\n            this.transcript_recorder.session = data.transcript_recorder_session\n            console.log(`Resuming autosaved transcript recording session: ${data.transcript_recorder_session}`)\n        }\n\n        // Always send a rearrange event after autorestoring\n        setTimeout(() => this.send_event({type: 'arrange'}), 0)\n    }\n\n    protected cancel_inputs(windows: protocol.InputUpdate[]) {\n        this.windows.cancel_inputs(windows)\n    }\n\n    protected capabilities(): string[] {\n        return [\n            'garglktext',\n            'graphics',\n            'graphicswin',\n            'hyperlinks',\n            'timer',\n        ]\n    }\n\n    protected disable(disable: boolean) {\n        for (const win of this.windows.values()) {\n            win.textinput.el.prop('disabled', disable || !win.inputs?.type)\n        }\n        this.disabled = disable\n    }\n\n    private embellish_error() {\n        if (typeof $ === 'undefined') {\n            return\n        }\n\n        const errorpane = $(`#${this.dom.errorpane_id}`)\n\n        // Add close button\n        if (!errorpane.find('#errorclose').length) {\n            $('<button>', {\n                'aria-label': 'Close',\n                click: () => {\n                    errorpane.hide()\n                },\n                id: 'errorclose',\n                text: '\u2716',\n                type: 'button',\n            })\n                .appendTo(errorpane)\n        }\n\n        // If autorestoring, add a link to restart after clearing the autosave\n        if (this.autorestoring && this.Dialog?.autosave_clear) {\n            const link = $('<a>', {\n                click: async () => {\n                    await this.Dialog!.autosave_clear!()\n                    location.reload()\n                },\n                text: 'Clear autosave and restart',\n            })\n            $('<div>')\n                .append(link)\n                .appendTo(errorpane)\n        }\n    }\n\n    error(error: Error | string) {\n        error ??= '???'\n        let msg: string\n        if (typeof error === 'string') {\n            msg = error\n            error = new Error(error)\n        }\n        else {\n            msg = error.toString()\n        }\n\n        // Don't use jQuery, because this is called if jQuery isn't present\n        const errorcontent = document.getElementById(this.dom.errorcontent_id)\n        if (!errorcontent) {\n            throw new Error(msg)\n        }\n        errorcontent.innerHTML = msg\n\n        const errorpane = document.getElementById(this.dom.errorpane_id)!\n        if (errorpane.className === 'WarningPane') {\n            errorpane.className = ''\n        }\n\n        this.embellish_error()\n\n        errorpane.style.display = ''\n        this.showing_error = true\n        this.hide_loading()\n        console.error(error)\n    }\n\n    protected exit() {\n        // Try to clean up and remove any event handlers\n        this.metrics_calculator.destroy()\n        this.windows.destroy()\n    }\n\n    getdomcontext(): HTMLElement | undefined {\n        return this.dom.context_element\n    }\n\n    getdomid(name: string): string {\n        switch (name) {\n            case 'errorcontent': return this.dom.errorcontent_id\n            case 'errorpane': return this.dom.errorpane_id\n            case 'gameport': return this.dom.gameport_id\n            case 'loadingpane': return this.dom.loadingpane_id\n            case 'windowport': return this.dom.windowport_id\n            default: return name\n        }\n    }\n\n    private hide_loading() {\n        if (!this.showing_loading) {\n            return\n        }\n        this.showing_loading = false\n\n        // Don't use jQuery because this could be called from error()\n        const loadingpane = document.getElementById(this.dom.loadingpane_id)\n        if (loadingpane) {\n            loadingpane.style.display = 'none'\n        }\n    }\n\n    // iOS devices can scroll the window even though body/#gameport are set to height 100%\n    // Scroll back to the top if they try\n    on_document_scroll = throttle(async () => {\n        window.scrollTo(0, 0)\n    }, 500, {leading: false})\n\n    save_allstate(): AutosaveState {\n        const graphics_bg: Array<[number, string]> = []\n        for (const win of this.windows.values()) {\n            if (win.type === 'graphics') {\n                graphics_bg.push([win.id, win.fillcolour])\n            }\n        }\n\n        return {\n            graphics_bg,\n            history: this.windows.history,\n            transcript_recorder_session: this.transcript_recorder?.session,\n        }\n    }\n\n    // Send partial line input values\n    send_event(ev: Partial<protocol.Event>) {\n        if (ev.type !== 'init' && ev.type !== 'refresh' && ev.type !== 'specialresponse') {\n            for (const win of this.windows.values()) {\n                if (win.inputs?.type) {\n                    const val = win.textinput.el.val() as string\n                    if (val) {\n                        if (!ev.partial) {\n                            ev.partial = {}\n                        }\n                        ev.partial[win.id] = val\n                    }\n                }\n            }\n        }\n        if (this.transcript_recorder?.enabled) {\n            this.transcript_recorder.record_event(ev)\n        }\n        super.send_event(ev)\n    }\n\n    setdomcontext(val: HTMLElement) {\n        this.dom.context_element = val\n    }\n\n    protected set_page_bg(colour: string) {\n        $('body').css('background-color', colour)\n    }\n\n    update(data: protocol.Update) {\n        if (this.showing_loading) {\n            this.hide_loading()\n        }\n        super.update(data)\n        if (this.transcript_recorder?.enabled && data.type === 'update' && !data.autorestore) {\n            this.transcript_recorder.record_update(data)\n        }\n    }\n\n    protected update_content(content: protocol.ContentUpdate[]) {\n        this.windows.update_content(content)\n    }\n\n    protected update_inputs(windows: protocol.InputUpdate[]) {\n        this.windows.update_inputs(windows)\n    }\n\n    protected update_windows(windows: protocol.WindowUpdate[]) {\n        this.windows.update(windows)\n    }\n\n    warning(msg: any) {\n        // Don't show warnings if an error is already being shown\n        if (this.showing_error) {\n            return\n        }\n\n        const errorpane = $(`#${this.dom.errorpane_id}`)\n\n        // Hide a warning\n        if (!msg) {\n            errorpane.hide()\n            return\n        }\n\n        const errorcontent = document.getElementById(this.dom.errorcontent_id)\n        if (!errorcontent) {\n            console.warn(msg)\n            return\n        }\n        errorcontent.innerHTML = msg\n\n        this.embellish_error()\n\n        errorpane.addClass('WarningPane')\n        errorpane.show()\n        this.hide_loading()\n    }\n}", "/**\r\n  Base32768 is a binary-to-text encoding optimised for UTF-16-encoded text.\r\n  (e.g. Windows, Java, JavaScript)\r\n*/\r\n\r\n// Z is a number, usually a uint15 but sometimes a uint7\r\n\r\nconst BITS_PER_CHAR = 15 // Base32768 is a 15-bit encoding\r\nconst BITS_PER_BYTE = 8\r\n\r\nconst pairStrings = [\r\n  '\u04A0\u04BF\u0500\u051F\u0680\u06BF\u0760\u079F\u07C0\u07DF\u1000\u101F\u10A0\u10BF\u1100\u115F\u1180\u119F\u11E0\u123F\u1260\u127F\u12E0\u12FF\u1320\u133F\u13A0\u13DF\u1420\u165F\u16A0\u16DF\u1780\u179F\u1820\u185F\u18C0\u18DF\u1980\u199F\u19E0\u19FF\u1A20\u1A3F\u1BC0\u1BDF\u1C00\u1C1F\u1D00\u1D1F\u21E0\u21FF\u22C0\u22DF\u2340\u23DF\u2400\u241F\u2500\u275F\u2780\u27BF\u2800\u297F\u29A0\u29BF\u2A20\u2A5F\u2A80\u2ABF\u2AE0\u2B5F\u2C00\u2C1F\u2C80\u2CDF\u2D00\u2D1F\u2D40\u2D5F\u2EA0\u2EDF\u31C0\u31DF\u3400\u4D9F\u4DC0\u9FBF\uA000\uA47F\uA4A0\uA4BF\uA500\uA5FF\uA640\uA65F\uA6A0\uA6DF\uA700\uA75F\uA780\uA79F\uA840\uA85F',\r\n  '\u0180\u019F\u0240\u029F'\r\n]\r\n\r\nconst lookupE = {}\r\nconst lookupD = {}\r\npairStrings.forEach((pairString, r) => {\r\n  // Decompression\r\n  const encodeRepertoire = []\r\n  pairString.match(/../gu).forEach(pair => {\r\n    const first = pair.codePointAt(0)\r\n    const last = pair.codePointAt(1)\r\n    for (let codePoint = first; codePoint <= last; codePoint++) {\r\n      encodeRepertoire.push(String.fromCodePoint(codePoint))\r\n    }\r\n  })\r\n\r\n  const numZBits = BITS_PER_CHAR - BITS_PER_BYTE * r // 0 -> 15, 1 -> 7\r\n  lookupE[numZBits] = encodeRepertoire\r\n  encodeRepertoire.forEach((chr, z) => {\r\n    lookupD[chr] = [numZBits, z]\r\n  })\r\n})\r\n\r\nconst encode = uint8Array => {\r\n  const length = uint8Array.length\r\n\r\n  let str = ''\r\n  let z = 0\r\n  let numZBits = 0\r\n\r\n  for (let i = 0; i < length; i++) {\r\n    const uint8 = uint8Array[i]\r\n\r\n    // Take most significant bit first\r\n    for (let j = BITS_PER_BYTE - 1; j >= 0; j--) {\r\n      const bit = (uint8 >> j) & 1\r\n\r\n      z = (z << 1) + bit\r\n      numZBits++\r\n\r\n      if (numZBits === BITS_PER_CHAR) {\r\n        str += lookupE[numZBits][z]\r\n        z = 0\r\n        numZBits = 0\r\n      }\r\n    }\r\n  }\r\n\r\n  if (numZBits !== 0) {\r\n    // Final bits require special treatment.\r\n\r\n    // z = bbbbbbcccccccc, numZBits = 14, padBits = 1\r\n    // z = bbbbbcccccccc, numZBits = 13, padBits = 2\r\n    // z = bbbbcccccccc, numZBits = 12, padBits = 3\r\n    // z = bbbcccccccc, numZBits = 11, padBits = 4\r\n    // z = bbcccccccc, numZBits = 10, padBits = 5\r\n    // z = bcccccccc, numZBits = 9, padBits = 6\r\n    // z = cccccccc, numZBits = 8, padBits = 7\r\n    // => Pad `z` out to 15 bits using 1s, then encode as normal (r = 0)\r\n\r\n    // z = ccccccc, numZBits = 7, padBits = 0\r\n    // z = cccccc, numZBits = 6, padBits = 1\r\n    // z = ccccc, numZBits = 5, padBits = 2\r\n    // z = cccc, numZBits = 4, padBits = 3\r\n    // z = ccc, numZBits = 3, padBits = 4\r\n    // z = cc, numZBits = 2, padBits = 5\r\n    // z = c, numZBits = 1, padBits = 6\r\n    // => Pad `z` out to 7 bits using 1s, then encode specially (r = 1)\r\n\r\n    while (!(numZBits in lookupE)) {\r\n      z = (z << 1) + 1\r\n      numZBits++\r\n    }\r\n\r\n    str += lookupE[numZBits][z]\r\n  }\r\n\r\n  return str\r\n}\r\n\r\nconst decode = str => {\r\n  const length = str.length\r\n\r\n  // This length is a guess. There's a chance we allocate one more byte here\r\n  // than we actually need. But we can count and slice it off later\r\n  const uint8Array = new Uint8Array(Math.floor(length * BITS_PER_CHAR / BITS_PER_BYTE))\r\n  let numUint8s = 0\r\n  let uint8 = 0\r\n  let numUint8Bits = 0\r\n\r\n  for (let i = 0; i < length; i++) {\r\n    const chr = str.charAt(i)\r\n\r\n    if (!(chr in lookupD)) {\r\n      throw new Error(`Unrecognised Base32768 character: ${chr}`)\r\n    }\r\n\r\n    const [numZBits, z] = lookupD[chr]\r\n\r\n    if (numZBits !== BITS_PER_CHAR && i !== length - 1) {\r\n      throw new Error('Secondary character found before end of input at position ' + String(i))\r\n    }\r\n\r\n    // Take most significant bit first\r\n    for (let j = numZBits - 1; j >= 0; j--) {\r\n      const bit = (z >> j) & 1\r\n\r\n      uint8 = (uint8 << 1) + bit\r\n      numUint8Bits++\r\n\r\n      if (numUint8Bits === BITS_PER_BYTE) {\r\n        uint8Array[numUint8s] = uint8\r\n        numUint8s++\r\n        uint8 = 0\r\n        numUint8Bits = 0\r\n      }\r\n    }\r\n  }\r\n\r\n  // Final padding bits! Requires special consideration!\r\n  // Remember how we always pad with 1s?\r\n  // Note: there could be 0 such bits, check still works though\r\n  if (uint8 !== ((1 << numUint8Bits) - 1)) {\r\n    throw new Error('Padding mismatch')\r\n  }\r\n\r\n  return new Uint8Array(uint8Array.buffer, 0, numUint8s)\r\n}\r\n\r\nexport { encode, decode }\r\n", "/* Dialog -- a Javascript load/save library for IF interfaces\n * Designed by Andrew Plotkin <erkyrath@eblong.com>\n * <http://eblong.com/zarf/glk/glkote.html>\n * \n * This Javascript library is copyright 2010-20 by Andrew Plotkin.\n * It is distributed under the MIT license; see the \"LICENSE\" file.\n *\n * This library lets you open a modal dialog box to select a \"file\" for saving\n * or loading data. The web page must have a <div> with id \"windowport\" (this\n * will be greyed out during the selection process, with the dialog box as a\n * child of the div). It should also have the dialog.css stylesheet loaded.\n *\n * This library also contains utility routines to manage \"files\", which are\n * actually entries in the browser's localStorage object.\n *\n * If you are in the Electron.io environment, you want to include electrofs.js\n * instead of this module. To distinguish this from electrofs.js, look at\n * Dialog.streaming, which will be true for electrofs.js and false for\n * dialog.js.\n *\n * The primary function to call:\n *\n * Dialog.open(tosave, usage, gameid, callback) -- open a file-choosing dialog\n *\n * The rest of the API concerns file reference objects. A fileref encodes a\n * usage and gameid (as above), along with a filename (which can be any string\n * at all). This trio specifies a \"file\", that is, a chunk of data in browser\n * local storage.\n *\n * (These fileref objects are not the same as the filerefs used in the Glk API.\n * A Glk fileref contains one of these filerefs, however.)\n *\n * Dialog.file_clean_fixed_name(filename, usage) -- clean up a filename\n * Dialog.file_construct_ref(filename, usage, gameid) -- create a fileref\n * Dialog.file_construct_temp_ref(usage) -- create a temporary fileref\n * Dialog.file_write(ref, content, israw) -- write data to the file\n * Dialog.file_read(ref, israw) -- read data from the file\n * Dialog.file_ref_exists(ref) -- returns whether the file exists\n * Dialog.file_remove_ref(ref) -- delete the file, if it exists\n *\n *\n * The localStorage format is as follows. Each file is represented as two\n * storage keys: \"dirent:usage:gameid:filename\" and\n * \"content:usage:gameid:filename\". (The filename is last so that it can\n * validly contain colons. Since this is a user-entered string, it can contain\n * *any* typeable character.)\n *\n * The \"content:\" key contains the file content, as a string. (The HTML5\n * browser storage spec says that you can store any serializable data, but the\n * browsers have not yet implemented this. Thus the \"israw\" option in the read\n * and write functions.)\n *\n * The \"dirent:\" key contains directory information. Currently this looks like\n * \"created:TIMESTAMP,modified:TIMESTAMP\". Future version of this library may\n * add a human-readable game name, a text/binary flag, or other data.\n */\n\n//### accept \"return\" keystroke for load-select box (already works in Chrome)\n\nimport {decode as base32768_decode, encode as base32768_encode} from 'base32768'\n\nconst utf_decoder = new TextDecoder()\nconst utf_encoder = new TextEncoder()\n\nfunction String_to_Uint8Array(str) {\n    return Uint8Array.from(str, ch => ch.charCodeAt(0))\n}\n\n/* Put everything inside the Dialog namespace. */\n\nvar Dialog = function() {\n\nvar dialog_el_id = 'dialog';\n\nvar is_open = false;\nvar dialog_callback = null;\nvar will_save; /* is this a save dialog? */\nvar confirming; /* are we in a \"confirm\" sub-dialog? */\nvar editing; /* have we flipped to \"edit\" mode? */\nvar editing_dirent; /* null for the edit selection screen, or a dirent to\n                       display */\nvar cur_usage; /* a string representing the file's category */\nvar cur_usage_name; /* the file's category as a human-readable string */\nvar cur_gameid; /* a string representing the game */\nvar cur_filelist; /* the files currently on display */\n\n// Handle updating the `dialog_storage_version`\nfunction dialog_init() {\n    try {\n        const version = parseInt(localStorage.getItem('dialog_storage_version'), 10)\n        if (version > 1) {\n            throw new Error('dialog_storage_version is newer than this library supports')\n        }\n        if (!version) {\n            console.log('Dialog: updating storage version')\n            for (const [key, value] of Object.entries(localStorage)) {\n                if (key.startsWith('content:')) {\n                    if (value !== '') {\n                        localStorage.setItem(key, base32768_encode(/\\[[,\\d]*\\]/.test(value) ? JSON.parse(value) : String_to_Uint8Array(value)))\n                    }\n                }\n                if (key.startsWith('autosave:')) {\n                    localStorage.removeItem(key)\n                    const data = JSON.parse(value)\n                    if (data.ram) {\n                        localStorage.setItem(key + '.ram', base32768_encode(data.ram))\n                        delete data.ram\n                    }\n                    localStorage.setItem(key, base32768_encode(utf_encoder.encode(JSON.stringify(data))))\n                    localStorage.setItem(key + '.meta', base32768_encode(utf_encoder.encode(JSON.stringify({modified: Date.now()}))))\n                }\n            }\n            localStorage.setItem('dialog_storage_version', '1')\n        }\n    }\n    catch (_) {}\n}\n\n/* Dialog.open(tosave, usage, gameid, callback) -- open a file-choosing dialog\n *\n * The \"tosave\" flag should be true for a save dialog, false for a load\n * dialog.\n *\n * The \"usage\" and \"gameid\" arguments are arbitrary strings which describe the\n * file. These filter the list of files displayed; the dialog will only list\n * files that match the arguments. Pass null to either argument (or both) to\n * skip filtering.\n *\n * The \"callback\" should be a function. This will be called with a fileref\n * argument (see below) when the user selects a file. If the user cancels the\n * selection, the callback will be called with a null argument.\n*/\nfunction dialog_open(tosave, usage, gameid, callback) {\n    if (is_open)\n        throw new Error('Dialog: dialog box is already open.');\n\n    if (!Storage)\n        throw new Error('Dialog: no storage API is available.');\n\n    dialog_callback = callback;\n    will_save = tosave;\n    confirming = false;\n    editing = false;\n    editing_dirent = null;\n    cur_usage = usage;\n    cur_gameid = gameid;\n    cur_usage_name = label_for_usage(cur_usage);\n\n    /* Figure out what the root div is called. The dialog box will be\n       positioned in this div; also, the div will be greyed out by a \n       translucent rectangle. We use the same default as GlkOte: \n       \"windowport\". We also try to interrogate GlkOte to see if that\n       default has been changed. */\n    var root_el_id = 'windowport';\n    var iface = window.Game;\n    if (window.GlkOte) \n        iface = window.GlkOte.getinterface();\n    if (iface && iface.windowport)\n        root_el_id = iface.windowport;\n\n    var rootel = $('#'+root_el_id);\n    if (!rootel.length)\n        throw new Error('Dialog: unable to find root element #' + root_el_id + '.');\n\n    /* Create the grey-out screen. */\n    var screen = $('#'+dialog_el_id+'_screen');\n    if (!screen.length) {\n        screen = $('<div>',\n            { id: dialog_el_id+'_screen' });\n        rootel.append(screen);\n    }\n\n    /* And now, a lot of DOM creation for the dialog box. */\n\n    var frame = $('#'+dialog_el_id+'_frame');\n    if (!frame.length) {\n        frame = $('<div>',\n            { id: dialog_el_id+'_frame' });\n        rootel.append(frame);\n    }\n\n    var dia = $('#'+dialog_el_id);\n    if (dia.length)\n        dia.remove();\n\n    dia = $('<div>', { id: dialog_el_id });\n\n    var form, el, row;\n\n    form = $('<form>');\n    form.on('submit', \n        (will_save ? evhan_accept_save_button : evhan_accept_load_button));\n    dia.append(form);\n\n    row = $('<div>', { 'class': 'DiaButtonsFloat' });\n    el = $('<button>', { id: dialog_el_id+'_edit', type: 'button' });\n    el.append('Edit');\n    el.on('click', evhan_edit_button);\n    row.append(el);\n    form.append(row);\n\n    row = $('<div>', { id: dialog_el_id+'_cap', 'class': 'DiaCaption' });\n    row.append('XXX'); // the caption will be replaced momentarily.\n    form.append(row);\n\n    if (will_save) {\n        row = $('<div>', { id: dialog_el_id+'_input', 'class': 'DiaInput' });\n        form.append(row);\n        el = $('<input>', { id: dialog_el_id+'_infield', type: 'text', name: 'filename' });\n        row.append(el);\n\n        /* This was spurred by the Safari seven-day expiration policy (March 2020), but the general fragility of local storage has been a bother for years. */\n        row = $('<div>', { id: dialog_el_id+'_warning', 'class': 'DiaWarning' });\n        row.text('Warning: data may be erased by clearing cookies or browser privacy policies.');\n        form.append(row);\n    }\n\n    row = $('<div>', { id: dialog_el_id+'_body', 'class': 'DiaBody' });\n    form.append(row);\n\n    row = $('<div>', { id: dialog_el_id+'_cap2', 'class': 'DiaCaption' });\n    row.hide();\n    form.append(row);\n\n    row = $('<div>', { id: dialog_el_id+'_buttonrow', 'class': 'DiaButtons' });\n    {\n        /* Row of buttons */\n        el = $('<button>', { id: dialog_el_id+'_cancel', type: 'button' });\n        el.append('Cancel');\n        el.on('click', evhan_cancel_button);\n        row.append(el);\n\n        el = $('<button>', { id: dialog_el_id+'_delete', type: 'button' });\n        el.append('Delete');\n        el.on('click', evhan_delete_button);\n        el.hide();\n        row.append(el);\n\n        el = $('<button>', { id: dialog_el_id+'_display', type: 'button' });\n        el.append('Display');\n        el.on('click', evhan_display_button);\n        el.hide();\n        row.append(el);\n\n        el = $('<button>', { id: dialog_el_id+'_accept', type: 'submit' });\n        el.append(will_save ? 'Save' : 'Load');\n        el.on('click', \n            (will_save ? evhan_accept_save_button : evhan_accept_load_button));\n        row.append(el);\n    }\n    form.append(row);\n\n    frame.append(dia);\n    is_open = true;\n\n    evhan_storage_changed();\n\n    /* Set the input focus to the input field or the selection box.\n\n       MSIE is weird about when you can call focus(). The element has just been\n       added to the DOM, and MSIE balks at giving it the focus right away. So\n       we defer the call until after the javascript context has yielded control\n       to the browser. \n    */\n    var focusfunc;\n    if (will_save) {\n        focusfunc = function() {\n            var el = $('#'+dialog_el_id+'_infield');\n            if (el.length) \n                el.focus();\n        };\n    }\n    else {\n        focusfunc = function() {\n            var el = $('#'+dialog_el_id+'_select');\n            if (el.length) \n                el.focus();\n        };\n    }\n    defer_func(focusfunc);\n}\n\n/* Close the dialog and remove the grey-out screen.\n*/\nfunction dialog_close() {\n    var dia = $('#'+dialog_el_id);\n    if (dia.length)\n        dia.remove();\n    var frame = $('#'+dialog_el_id+'_frame');\n    if (frame.length)\n        frame.remove();\n    var screen = $('#'+dialog_el_id+'_screen');\n    if (screen.length)\n        screen.remove();\n\n    is_open = false;\n    dialog_callback = null;\n    cur_filelist = null;\n    editing = false;\n    editing_dirent = null;\n}\n\n/* Set the text caption in the dialog. (There are two, actually, above\n   and below the selection box.)\n*/\nfunction set_caption(msg, isupper) {\n    var elid = (isupper ? dialog_el_id+'_cap' : dialog_el_id+'_cap2');\n    var el = $('#'+elid);\n    if (!el.length)\n        return;\n\n    if (!msg) {\n        el.hide();\n    }\n    else {\n        el.text(msg);\n        el.show();\n    }\n}\n\n/* Pick a human-readable label for the usage. This will be displayed in the\n   dialog prompts. (Possibly pluralized, with an \"s\".) \n*/\nfunction label_for_usage(val) {\n    switch (val) {\n    case 'data': \n        return 'data file';\n    case 'save': \n        return 'save file';\n    case 'transcript': \n        return 'transcript';\n    case 'command': \n        return 'command script';\n    default:\n        return 'file';\n    }\n}\n\n/* Decide whether a given file is likely to contain text data. \n   ### really this should rely on a text/binary metadata field.\n*/\nfunction usage_is_textual(val) {\n    return (val == 'transcript' || val == 'command');\n}\n\n/* Run a function (no arguments) \"soon\". */\nfunction defer_func(func)\n{\n  return window.setTimeout(func, 0.01*1000);\n}\n\n/* Event handler: The user has changed which entry in the selection box is\n   highlighted. \n\n   This is used only in save dialogs; the highlighted filename is copied to the\n   input field.\n*/\nfunction evhan_select_change() {\n    if (!is_open)\n        return false;\n    if (confirming)\n        return false;\n\n    //GlkOte.log('### select changed');\n    var selel = $('#'+dialog_el_id+'_select');\n    if (!selel.length)\n        return false;\n    var pos = selel.prop('selectedIndex');\n    if (!cur_filelist || pos < 0 || pos >= cur_filelist.length)\n        return false;\n    var file = cur_filelist[pos];\n    var fel = $('#'+dialog_el_id+'_infield');\n    if (!fel.length)\n        return false;\n    fel.val(file.dirent.filename);\n    return false;\n}\n\n/* Event handler: The user has changed which entry in the selection box is\n   highlighted. (Also called manually, when we enter edit mode.)\n\n   This is only used in edit mode.\n*/\nfunction evhan_select_change_editing() {\n    if (!is_open)\n        return false;\n    if (!editing || editing_dirent)\n        return false;\n\n    var butel = $('#'+dialog_el_id+'_delete');\n    butel.prop('disabled', true);\n    butel = $('#'+dialog_el_id+'_display');\n    butel.prop('disabled', true);\n\n    var selel = $('#'+dialog_el_id+'_select');\n    if (!selel.length)\n        return false;\n    var pos = selel.prop('selectedIndex');\n    if (!cur_filelist || pos < 0 || pos >= cur_filelist.length)\n        return false;\n    var file = cur_filelist[pos];\n    if (!file || !file.dirent || !file_ref_exists(file.dirent))\n        return false;\n\n    butel = $('#'+dialog_el_id+'_delete');\n    butel.prop('disabled', false);\n    butel = $('#'+dialog_el_id+'_display');\n    butel.prop('disabled', false);\n}\n\n/* Event handler: The \"Load\" button.\n*/\nfunction evhan_accept_load_button(ev) {\n    ev.preventDefault();\n    if (!is_open)\n        return false;\n    if (editing)\n        return false;\n\n    //GlkOte.log('### accept load');\n    var selel = $('#'+dialog_el_id+'_select');\n    if (!selel.length)\n        return false;\n    var pos = selel.prop('selectedIndex');\n    if (!cur_filelist || pos < 0 || pos >= cur_filelist.length)\n        return false;\n    var file = cur_filelist[pos];\n    if (!file || !file.dirent || !file_ref_exists(file.dirent))\n        return false;\n\n    var callback = dialog_callback;\n    //GlkOte.log('### selected ' + file.dirent.dirent);\n    dialog_close();\n    if (callback)\n        callback(file.dirent);\n\n    return false;\n}\n\n/* Event handler: The \"Save\" or \"Replace\" button.\n*/\nfunction evhan_accept_save_button(ev) {\n    ev.preventDefault();\n    if (!is_open)\n        return false;\n    if (editing)\n        return false;\n\n    //GlkOte.log('### accept save');\n    var fel = $('#'+dialog_el_id+'_infield');\n    if (!fel.length)\n        return false;\n    var filename = fel.val();\n    filename = jQuery.trim(filename);\n    if (!filename.length)\n        return false;\n    var dirent = file_construct_ref(filename, cur_usage, cur_gameid);\n\n    if (file_ref_exists(dirent) && !confirming) {\n        /* If the file exists, and we are not already in confirm mode, go into\n           confirm mode. Yes, this is logistically messy. We change the button\n           label to \"Replace\"; if the user really meant it, we'll wind up back\n           in this event handler. */\n        confirming = true;\n        set_caption('You already have a ' + cur_usage_name + ' \"' \n            + dirent.filename + '\". Do you want to replace it?', false);\n        fel.prop('disabled', true);\n        var butel = $('#'+dialog_el_id+'_accept');\n        butel.text('Replace');\n        return false;\n    }\n\n    var callback = dialog_callback;\n    //GlkOte.log('### selected ' + dirent.dirent);\n    dialog_close();\n    if (callback)\n        callback(dirent);\n\n    return false;\n}\n\n/* Event handler: The \"Edit\" (or \"Done\") button.\n\n   This toggles edit mode.\n*/\nfunction evhan_edit_button(ev) {\n    ev.preventDefault();\n    if (!is_open)\n        return false;\n\n    if (!editing) {\n        editing = true;\n        editing_dirent = null;\n\n        if (confirming) {\n            /* Cancel the confirmation, first */\n            confirming = false;\n            set_caption(null, false);\n            const fel = $('#'+dialog_el_id+'_infield');\n            fel.prop('disabled', false);\n            const butel = $('#'+dialog_el_id+'_accept');\n            butel.prop('disabled', false);\n            butel.text('Save');\n        }\n\n        const fel = $('#'+dialog_el_id+'_input');\n        if (fel.length) {\n            fel.hide();\n        }\n\n        let butel = $('#'+dialog_el_id+'_edit');\n        butel.text('Done');\n\n        butel = $('#'+dialog_el_id+'_delete');\n        butel.show();\n        butel = $('#'+dialog_el_id+'_display');\n        butel.show();\n        butel = $('#'+dialog_el_id+'_accept');\n        butel.hide();\n\n        evhan_storage_changed();\n        return false;\n    }\n    else if (!editing_dirent) {\n        editing = false;\n        editing_dirent = null;\n\n        const fel = $('#'+dialog_el_id+'_input');\n        if (fel.length) {\n            fel.show();\n        }\n\n        let butel = $('#'+dialog_el_id+'_edit');\n        butel.text('Edit');\n\n        butel = $('#'+dialog_el_id+'_delete');\n        butel.hide();\n        butel = $('#'+dialog_el_id+'_display');\n        butel.hide();\n        butel = $('#'+dialog_el_id+'_accept');\n        butel.show();\n\n        evhan_storage_changed();\n        return false;\n    }\n    else {\n        /* Stop displaying a file, return to normal edit mode. */\n        editing = true;\n        editing_dirent = null;\n\n        $('#'+dialog_el_id+'_buttonrow').show();\n\n        const butel = $('#'+dialog_el_id+'_edit');\n        butel.text('Done');\n\n        evhan_storage_changed();\n        return false;\n    }\n}\n\n/* Event handler: The \"Delete\" button (for edit mode).\n*/\nfunction evhan_delete_button(ev) {\n    ev.preventDefault();\n    if (!is_open)\n        return false;\n    if (!editing || editing_dirent)\n        return false;\n\n    //GlkOte.log('### delete');\n    var selel = $('#'+dialog_el_id+'_select');\n    if (!selel.length)\n        return false;\n    var pos = selel.prop('selectedIndex');\n    if (!cur_filelist || pos < 0 || pos >= cur_filelist.length)\n        return false;\n    var file = cur_filelist[pos];\n    if (!file || !file.dirent)\n        return false;\n\n    file_remove_ref(file.dirent);\n    /* Force reload of display */\n    evhan_storage_changed();\n\n    return false;\n}\n\n/* Event handler: The \"Display\" button (for edit mode).\n*/\nfunction evhan_display_button(ev) {\n    ev.preventDefault();\n    if (!is_open)\n        return false;\n    if (!editing || editing_dirent)\n        return false;\n\n    //GlkOte.log('### display');\n    var selel = $('#'+dialog_el_id+'_select');\n    if (!selel.length)\n        return false;\n    var pos = selel.prop('selectedIndex');\n    if (!cur_filelist || pos < 0 || pos >= cur_filelist.length)\n        return false;\n    var file = cur_filelist[pos];\n    if (!file || !file.dirent || !file_ref_exists(file.dirent))\n        return false;\n\n    $('#'+dialog_el_id+'_buttonrow').hide();\n\n    var butel = $('#'+dialog_el_id+'_edit');\n    butel.text('Close');\n\n    editing_dirent = file.dirent;\n    /* Force reload of display */\n    evhan_storage_changed();\n\n    return false;\n}\n\n/* Event handler: The \"Cancel\" button.\n\n   This can mean either cancelling the dialog, or cancelling confirm mode on a\n   \"do you want to replace that?\" query.\n*/\nfunction evhan_cancel_button(ev) {\n    ev.preventDefault();\n    if (!is_open)\n        return false;\n\n    if (confirming) {\n        confirming = false;\n        set_caption(null, false);\n        var fel = $('#'+dialog_el_id+'_infield');\n        fel.prop('disabled', false);\n        var butel = $('#'+dialog_el_id+'_accept');\n        butel.prop('disabled', false);\n        butel.text('Save');\n        return false;\n    }\n\n    var callback = dialog_callback;\n    //GlkOte.log('### cancel');\n    dialog_close();\n    if (callback)\n        callback(null);\n\n    return false;\n}\n\n/* Event handler: Browser local storage has been updated. When this happens, we\n   re-check the list of files, because a new one might have been added from\n   another browser window.\n\n   This function is called manually when the dialog box is created,\n   to set up the list of files in the first place. We also call it manually\n   when switching in and out of edit mode -- it's the easiest way to redraw\n   everything.\n*/\nfunction evhan_storage_changed(/*ev*/) {\n    if (!is_open)\n        return false;\n\n    var butel, el;\n\n    //var changedkey = null;\n    //if (ev)\n    //    changedkey = ev.key;\n    //GlkOte.log('### noticed storage: key ' + changedkey);\n    /* We could use the changedkey to decide whether it's worth redrawing \n       the field here. */\n\n    const bodyel = $('#'+dialog_el_id+'_body');\n    if (!bodyel.length)\n        return false;\n\n    if (editing && editing_dirent) {\n        /* If the file was deleted out from under us, return to the editing\n           display. */\n        if (!file_ref_exists(editing_dirent)) {\n            editing_dirent = null;\n            $('#'+dialog_el_id+'_buttonrow').show();\n            butel = $('#'+dialog_el_id+'_edit');\n            butel.text('Done');\n        }\n    }\n\n    /* There are several editing modes, which means several things we might\n       display here. */\n\n    if (editing && editing_dirent) {\n        /* We want to display the selected file's contents. */\n        bodyel.empty();\n\n        /* ### Make the unjustified assumption that this is an array of\n           character values (as ints). */\n        let dat = file_read(editing_dirent);\n        /* ### This doesn't correctly handle Unicode characters outside the\n           16-bit range. */\n        dat = String.fromCharCode.apply(this, dat);\n          \n        //### use binary flag?\n        if (usage_is_textual(editing_dirent.usage)) {\n          var textel = $('<pre>', { 'class': 'DiaDisplayText' });\n          textel.text(dat);\n          bodyel.append(textel);\n          set_caption('Displaying file contents...', true);\n        }\n        else {\n          var b64dat = window.btoa(dat);\n          /*### the download link should really be the filename, escaped\n            for attribute safety, with the proper file suffix attached. */\n          var linkel = $('<a>', { 'href': 'data:application/octet-stream;base64,'+b64dat, 'target': '_blank', 'download': 'data' });\n          linkel.text(editing_dirent.filename);\n          bodyel.append(linkel);\n          set_caption('Use \"Save As\" option in your browser to download this link.', true);\n        }\n\n        return false;\n    }\n\n    if (editing) {\n        /* We want to display both game-specific files and general ones (but\n           not files specific to other games, i.e., save files for different\n           games). \n        */\n        let ls = files_list(null, cur_gameid);\n        if (cur_gameid != '') {\n            ls = ls.concat(files_list(null, ''));\n        }\n        /* Sort by usage, then date modified */\n        ls.sort(function(f1, f2) {\n                if (f1.dirent.usage < f2.dirent.usage) \n                    return -1;\n                else if (f1.dirent.usage > f2.dirent.usage) \n                    return 1;\n                return f2.modified.getTime() - f1.modified.getTime(); \n            });\n\n        if (ls.length == 0) {\n            bodyel.empty();\n            butel = $('#'+dialog_el_id+'_delete');\n            butel.prop('disabled', true);\n            butel = $('#'+dialog_el_id+'_display');\n            butel.prop('disabled', true);\n            set_caption('You have no stored files. Press Done to continue.', true);\n            return false;\n        }\n\n        cur_filelist = [];\n        let lastusage = '';\n        for (let ix=0; ix<ls.length; ix++) {\n            const file = ls[ix];\n            if (file.dirent.usage != lastusage) {\n                lastusage = file.dirent.usage;\n                cur_filelist.push({ label:lastusage });\n            }\n            cur_filelist.push(file);\n        }\n        ls = cur_filelist;\n\n        bodyel.empty();\n        \n        const selel = $('<select>', { id: dialog_el_id+'_select', name:'files' });\n        selel.prop('size', '5'); /* firefox doesn't like this being set in the constructor */\n        let anyselected = false;\n        for (let ix=0; ix<ls.length; ix++) {\n            const file = ls[ix];\n            if (!file.dirent) {\n                el = $('<option>', { name:'f'+ix } );\n                el.prop('disabled', true);\n                el.text('-- ' + label_for_usage(file.label) + 's --');\n                selel.append(el);\n                continue;\n            }\n\n            el = $('<option>', { name:'f'+ix } );\n            if (!anyselected) {\n                anyselected = true;\n                el.selected = true;\n            }\n            const datestr = format_date(file.modified);\n            el.text(file.dirent.filename + ' -- ' + datestr);\n            selel.append(el);\n        }\n        bodyel.append(selel);\n\n        selel.on('change', evhan_select_change_editing);\n        evhan_select_change_editing();\n\n        set_caption('All stored files are now visible. You may delete them, and display files containing text. Press Done when finished.', true);\n        return false;\n    }\n\n    /* Basic display mode: the list of available files, plus an input field\n       if this is for saving. */\n\n    const ls = files_list(cur_usage, cur_gameid);\n    /* Sort by date modified */\n    ls.sort(function(f1, f2) { return f2.modified.getTime() - f1.modified.getTime(); });\n    cur_filelist = ls;\n\n    /* Adjust the contents of the selection box. */\n    \n    if (ls.length == 0) {\n        bodyel.empty();\n    }\n    else {\n        bodyel.empty();\n        \n        const selel = $('<select>', { id: dialog_el_id+'_select', name:'files' });\n        selel.prop('size', '5'); /* firefox doesn't like this being set in the constructor */\n        let file, datestr;\n        for (let ix=0; ix<ls.length; ix++) {\n            file = ls[ix];\n            el = $('<option>', { name:'f'+ix } );\n            if (ix == 0)\n                el.selected = true;\n            datestr = format_date(file.modified);\n            el.text(file.dirent.filename + ' -- ' + datestr);\n            selel.append(el);\n        }\n        bodyel.append(selel);\n\n        if (will_save)\n            selel.on('change', evhan_select_change);\n    }\n\n    if (will_save) {\n        set_caption('Name this ' + cur_usage_name + '.', true);\n        el = $('#'+dialog_el_id+'_accept');\n        el.prop('disabled', false);\n    }\n    else {\n        if (ls.length == 0) {\n            set_caption('You have no ' + cur_usage_name + 's for this game.', true);\n            el = $('#'+dialog_el_id+'_accept');\n            el.prop('disabled', true);\n        }\n        else {\n            set_caption('Select a ' + cur_usage_name + ' to load.', true);\n            el = $('#'+dialog_el_id+'_accept');\n            el.prop('disabled', false);\n        }\n    }\n}\n\n/* Dialog.file_clean_fixed_name(filename, usage) -- clean up a filename\n *\n * Take an arbitrary string and convert it into a filename that can\n * validly be stored in the user's directory. This is called for filenames\n * that come from the game file, but not for filenames selected directly\n * by the user (i.e. from a file selection dialog).\n *\n * Because we store everything in browser local storage, we have no\n * filename restrictions.\n */\nfunction file_clean_fixed_name(filename /*, usage*/) {\n    return filename;\n}\n\n/* Dialog.file_construct_ref(filename, usage, gameid) -- create a fileref\n *\n * Create a fileref. This does not create a file; it's just a thing you can use\n * to read an existing file or create a new one. Any unspecified arguments are\n * assumed to be the empty string.\n */\nfunction file_construct_ref(filename, usage, gameid) {\n    if (!filename)\n        filename = '';\n    if (!usage)\n        usage = '';\n    if (!gameid)\n        gameid = '';\n    var key = usage + ':' + gameid + ':' + filename;\n    var ref = { dirent: 'dirent:'+key, content: 'content:'+key,\n                filename: filename, usage: usage, gameid: gameid };\n    return ref;\n}\n\n/* Dialog.file_construct_temp_ref(usage)\n *\n * Create a fileref in a temporary directory. Every time this is called\n * it should create a completely new fileref.\n */\nfunction file_construct_temp_ref(usage) {\n    var timestamp = new Date().getTime();\n    var filename = \"_temp_\" + timestamp + \"_\" + Math.random();\n    filename = filename.replace('.', '');\n    return file_construct_ref(filename, usage);\n}\n\n/* Create a fileref from a browser storage key (string). If the key does not\n   begin with \"dirent:\" (ie, this key does not represent a directory entry),\n   this returns null.\n*/\nfunction file_decode_ref(dirkey) {\n    if (dirkey.slice(0,7) != 'dirent:')\n        return null;\n\n    var oldpos = 7;\n    var pos = dirkey.indexOf(':', oldpos);\n    if (pos < 0)\n        return null;\n    var usage = dirkey.slice(oldpos, pos);\n    oldpos = pos+1;\n    \n    pos = dirkey.indexOf(':', oldpos);\n    if (pos < 0)\n        return null;\n    var gameid = dirkey.slice(oldpos, pos);\n    oldpos = pos+1;\n\n    var filename = dirkey.slice(oldpos);\n    var conkey = 'cont'+dirkey.slice(3);\n\n    var ref = { dirent: dirkey, content: conkey, \n                filename: filename, usage: usage, gameid: gameid };\n    return ref;\n}\n\n/* Load directory entry information for a fileref (or key denoting a fileref).\n\n   The dirent information includes when the file was created, and when it was\n   last modified. It does not include the file content.\n*/\nfunction file_load_dirent(dirent) {\n    if (typeof(dirent) != 'object') {\n        dirent = file_decode_ref(dirent);\n        if (!dirent)\n            return null;\n    }\n\n    var statstring = Storage.getItem(dirent.dirent);\n    if (!statstring)\n        return null;\n\n    var file = { dirent: dirent };\n\n    var ix, pos, key, val;\n\n    var ls = statstring.toString().split(',');\n    for (ix=0; ix<ls.length; ix++) {\n        val = ls[ix];\n        pos = val.indexOf(':');\n        if (pos < 0)\n            continue;\n        key = val.slice(0, pos);\n        val = val.slice(pos+1);\n\n        switch (key) {\n        case 'created':\n            file.created = new Date(Number(val));\n            break;\n        case 'modified':\n            file.modified = new Date(Number(val));\n            break;\n        }\n    }\n\n    //### binary\n    //### game name?\n\n    return file;\n}\n\n/* Dialog.file_ref_exists(ref) -- returns whether the file exists\n */\nfunction file_ref_exists(ref) {\n    var statstring = Storage.getItem(ref.dirent);\n    if (!statstring)\n        return false;\n    else\n        return true;\n}\n\n/* Dialog.file_remove_ref(ref) -- delete the file, if it exists\n */\nfunction file_remove_ref(ref) {\n    Storage.removeItem(ref.dirent);\n    Storage.removeItem(ref.content);\n}\n\n/* Dialog.file_write(dirent, content, israw) -- write data to the file\n *\n * The \"content\" argument is stored to the file. If \"israw\" is true, the\n * content must be a string. Otherwise, the content is converted to JSON (using\n * JSON.stringify) before being stored.\n *\n * HTML's localStorage mechanism has no incremental storage API; you have to\n * store the entire chunk of data at once. Therefore, the given content\n * replaces the existing contents of the file (if any).\n */\nfunction file_write(dirent, content, israw) {\n    if (israw && content !== '') {\n        throw new Error('Dialog raw mode is no longer supported')\n    }\n\n    var val, ls;\n    var err1, err2;\n\n    var file = file_load_dirent(dirent);\n    if (!file) {\n        /* Newly-created file. */\n        file = { dirent: dirent, created: new Date() };\n    }\n\n    file.modified = new Date();\n\n    content = base32768_encode(content)\n\n    ls = [];\n\n    if (file.created)\n        ls.push('created:' + file.created.getTime());\n    if (file.modified)\n        ls.push('modified:' + file.modified.getTime());\n\n    //### binary\n    //### game name?\n\n    val = ls.join(',');\n    err1 = Storage.setItem(file.dirent.dirent, val);\n    err2 = Storage.setItem(file.dirent.content, content);\n\n    if (err1 || err2)\n        return false;\n\n    return true;\n}\n\n/* Dialog.file_read(dirent, israw) -- read data from the file\n *\n * Read the (entire) content of the file. If \"israw\" is true, this returns the\n * string that was stored. Otherwise, the content is converted from JSON (using\n * JSON.parse) before being returned.\n *\n * As a special case, the empty string is converted to an empty array (when not\n * in israw mode).\n */\nfunction file_read(dirent, israw) {\n    if (israw) {\n        throw new Error('Dialog raw mode is no longer supported')\n    }\n    var file = file_load_dirent(dirent);\n    if (!file)\n        return null;\n\n    var content = Storage.getItem(dirent.content);\n    if (content == null)\n        return null;\n\n    return base32768_decode(content)\n}\n\nfunction file_notimplemented() {\n    throw new Error('streaming function not implemented in Dialog');\n}\n\n/* Check whether a given fileref matches the given usage and gameid strings. If\n   you don't want to check one attribute or the other, pass null for that\n   argument.\n*/\nfunction file_ref_matches(ref, usage, gameid) {\n    if (usage != null) {\n        if (ref.usage != usage)\n            return false;\n    }\n\n    if (gameid != null) {\n        if (ref.gameid != gameid)\n            return false;\n    }\n\n    return true;\n}\n\n/* Return the list of files (actually directory entries) matching the given\n   given usage and gameid strings. If you don't want to check one attribute or\n   the other, pass null for that argument.\n*/\nfunction files_list(usage, gameid) {\n    var ix;\n    var ls = [];\n\n    if (!Storage)\n        return ls;\n\n    var keyls = Storage.getKeys();\n    for (ix=0; ix<keyls.length; ix++) {\n        var key = keyls[ix];\n        if (!key)\n            continue;\n        var dirent = file_decode_ref(key.toString());\n        if (!dirent)\n            continue;\n        if (!file_ref_matches(dirent, usage, gameid))\n            continue;\n        var file = file_load_dirent(dirent);\n        ls.push(file);\n    }\n\n    //GlkOte.log('### files_list found ' + ls.length + ' files.');\n    return ls;\n}\n\n/* Convert a date object to a (short) string.\n*/\nfunction format_date(date) {\n    if (!date)\n        return '???';\n    //### display relative dates?\n    var day = (date.getMonth()+1) + '/' + date.getDate();\n    var time = date.getHours() + ':' + (date.getMinutes() < 10 ? '0' : '') + date.getMinutes();\n    return day + ' ' + time;\n}\n\n/* Store a snapshot (a JSONable object) in a signature-dependent location.\n   If snapshot is null, delete the snapshot instead.\n\n   We rely on JSON.stringify() and JSON.parse(); autosave is primarily\n   for the Electron environment.\n*/\nfunction autosave_write(signature, snapshot) {\n    const key = 'autosave:' + signature\n    const key_meta = key + '.meta'\n    const key_ram = key + '.ram'\n    if (!snapshot) {\n        Storage.removeItem(key)\n        Storage.removeItem(key_meta)\n        Storage.removeItem(key_ram)\n    }\n    else {\n        if (snapshot.ram) {\n            Storage.setItem(key_ram, base32768_encode(snapshot.ram))\n            delete snapshot.ram\n        }\n        Storage.setItem(key, base32768_encode(utf_encoder.encode(JSON.stringify(snapshot))))\n        Storage.setItem(key_meta, base32768_encode(utf_encoder.encode(JSON.stringify({modified: Date.now()}))))\n    }\n}\n\n/* Load a snapshot (a JSONable object) from a signature-dependent location.\n*/\nlet saved_signature\nfunction autosave_read(signature) {\n    saved_signature = signature\n    const key = 'autosave:' + signature\n    const key_ram = key + '.ram'\n    const val = Storage.getItem(key)\n    if (val) {\n        try {\n            const data = JSON.parse(utf_decoder.decode(base32768_decode(val)))\n            const ram = Storage.getItem(key_ram)\n            if (ram) {\n                data.ram = base32768_decode(ram)\n            }\n            return data\n        }\n        catch (_) {\n            return null\n        }\n    }\n    return null\n}\n\nasync function autosave_clear() {\n    if (!saved_signature) {\n        throw new Error('Dialog.autosave_clear must be called after Dialog.autosave_read')\n    }\n    autosave_write(saved_signature, null)\n}\n\n/* Locate the storage object, and set up the storage event handler, at load\n   time (but after all the handlers are defined).\n\n   We wrap the HTML localStorage object in a simplified wrapper (Storage),\n   which supports just four calls: getItem, setItem, removeItem, and getKeys.\n   This lets us catch storage-quota errors, which turns out to be a good\n   idea. It also makes it easier to substitute a different storage back-end.\n*/\n\nvar Storage = null;\ntry {\n    var htmlLocalStorage = null;\n    /* Accessing window.localStorage might throw a security exception. */\n    if (window.localStorage != null) {\n        /* This is the API object for HTML5 browser storage. */\n        htmlLocalStorage = window.localStorage;\n    }\n    else if (window.globalStorage != null) {\n        /* This is a non-standard API used in Firefox 3.0 (but not 3.5). */\n        htmlLocalStorage = window.globalStorage[location.hostname];\n    }\n\n    if (htmlLocalStorage) {\n        /* First, test to make sure we can write at all. (In a private\n           window, localStorage quota may be zero.) */\n        try {\n            htmlLocalStorage.setItem('_dialogtest', 'xyzzy');\n            if (htmlLocalStorage.getItem('_dialogtest') != 'xyzzy')\n                throw new Error('localStorage test did not match');\n            htmlLocalStorage.removeItem('_dialogtest');\n\n            Storage = {\n                getItem: function(key) {\n                    try {\n                        return htmlLocalStorage.getItem(key);\n                    }\n                    catch (ex) {\n                        return null;\n                    }\n                },\n                removeItem: function(key) {\n                    try {\n                        htmlLocalStorage.removeItem(key);\n                    }\n                    catch (ex) {\n                        return null;\n                    }\n                },\n                setItem: function(key, val) {\n                    try {\n                        htmlLocalStorage.setItem(key, val);\n                    }\n                    catch (ex) {\n                        //GlkOte.log('Dialog: localStorage failed! ' + ex);\n                        return true; /* error */\n                    }\n                },\n                getKeys: function() {\n                    var ls = [];\n                    for (var ix=0; ix<htmlLocalStorage.length; ix++)\n                        ls.push(htmlLocalStorage.key(ix));\n                    return ls;\n                }\n            };\n        }\n        catch (ex) {\n            //GlkOte.log('Dialog: localStorage not available: ' + ex);\n            //GlkOte.log('Dialog: falling back to window memory');\n        }\n    }\n}\n/*eslint no-empty: \"off\"*/\ncatch (ex) { }\n\nif (Storage == null) {\n    /* This browser doesn't support storage at all. We'll whip up a\n       simple implementation. It will only last as long as the window\n       does, but that's good enough for a game. */\n    Storage = {\n        data: {},\n        keys: [],\n        getItem: function(key) {\n            return Storage.data[key];\n        },\n        setItem: function(key, val) {\n            if (Storage.keys.indexOf(key) < 0) {\n                Storage.keys.push(key);\n            }\n            Storage.data[key] = val;\n        },\n        removeItem: function(key) {\n            var pos = Storage.keys.indexOf(key);\n            if (pos >= 0) {\n                Storage.keys.splice(pos, 1);\n                delete Storage.data[key];\n            }\n        },\n        getKeys: function() {\n            return Storage.keys.slice(0);\n        }\n    }\n}\n\n$(window).on('storage', evhan_storage_changed);\n\n/* End of Dialog namespace function. Return the object which will\n   become the Dialog global. */\nreturn {\n    streaming: false,\n    init: dialog_init,\n\n    open: dialog_open,\n\n    file_clean_fixed_name: file_clean_fixed_name,\n    file_construct_ref: file_construct_ref,\n    file_construct_temp_ref: file_construct_temp_ref,\n    file_ref_exists: file_ref_exists,\n    file_remove_ref: file_remove_ref,\n    file_write: file_write,\n    file_read: file_read,\n\n    /* stubs for not-implemented functions */\n    file_fopen: file_notimplemented,\n\n    /* support for the autosave hook */\n    autosave_clear,\n    autosave_write: autosave_write,\n    autosave_read: autosave_read\n};\n\n}();\n\nexport default Dialog;\n\n/* End of Dialog library. */\n", "/* GlkAPI -- a Javascript Glk API for IF interfaces\n * GlkOte Library: version 2.2.5.\n * Glk API which this implements: version 0.7.4.\n * Designed by Andrew Plotkin <erkyrath@eblong.com>\n * <http://eblong.com/zarf/glk/glkote.html>\n * \n * This Javascript library is copyright 2010-20 by Andrew Plotkin.\n * It is distributed under the MIT license; see the \"LICENSE\" file.\n *\n * This file is a Glk API compatibility layer for glkote.js. It offers a \n * set of Javascript calls which closely match the original C Glk API;\n * these work by means of glkote.js operations.\n *\n * This API was built for Quixe, which is a pure-Javascript Glulx\n * interpreter. Therefore, the API is a little strange. Notably, it\n * accepts text buffers in the form of arrays of integers, not\n * Javascript strings. Only the Glk calls that explicitly use strings\n * (glk_put_string, etc) accept Javascript native strings.\n *\n * If you are writing an application in pure Javascript, you can use\n * this layer (along with glkote.js). If you are writing a web app which\n * is the front face of a server-side Glk app, ignore this file -- use\n * glkote.js directly.\n */\n\n/* Known problems:\n\n   Some places in the library get confused about Unicode characters\n   beyond 0xFFFF. They are handled correctly by streams, but grid windows\n   will think they occupy two characters rather than one, which will\n   throw off the grid spacing. \n\n   Also, the glk_put_jstring() function can't handle them at all. Quixe\n   printing operations that funnel through glk_put_jstring() -- meaning, \n   most native string printing -- will break up three-byte characters \n   into a UTF-16-encoded pair of two-byte characters. This will come\n   out okay in a buffer window, but it will again mess up grid windows,\n   and will also double the write-count in a stream.\n*/\n\n/* Put everything inside the Glk namespace. */\n\nvar Glk = function() {\n\n/* The VM interface object. */\nvar VM = null;\n\n// References to external libraries\nlet Blorb = null;\nlet Dialog = null;\nlet GiDispa = null;\nlet GlkOte = null;\n\n/* Environment capabilities. (Checked at init time.) */\nconst support = {};\n\n/* Options from the vm_options object. */\nvar option_exit_warning;\nvar option_do_vm_autosave;\nvar option_before_select_hook;\nvar option_extevent_hook;\nvar option_glk_gestalt_hook;\n\n/* Library display state. */\nvar has_exited = false;\nvar ui_disabled = false;\nvar ui_specialinput = null;\nvar ui_specialcallback = null;\nvar event_generation = 0;\nvar current_partial_inputs = null;\nvar current_partial_outputs = null;\n\n/* Initialize the library, initialize the VM, and set it running. (It will \n   run until the first glk_select() or glk_exit() call.)\n\n   The vm_options argument must have a vm_options.vm field, which must be an\n   appropriate VM interface object. (For example, Quixe.) This must have\n   init() and resume() methods.\n\n   The vm_options argument is also passed through to GlkOte as the game\n   interface object. It can be used to affect some GlkOte display options,\n   such as window spacing.\n\n   (You do not need to provide a vm_options.accept() function. The Glk\n   library sets that up for you.)\n*/\nfunction init(vm_options) {\n    if (vm_options.Dialog)\n    {\n        Dialog = vm_options.Dialog;\n    }\n    else\n    {\n        throw new Error('No reference to Dialog');\n    }\n\n    if (vm_options.GiDispa)\n    {\n        GiDispa = vm_options.GiDispa;\n    }\n\n    if (vm_options.Blorb)\n    {\n        Blorb = vm_options.Blorb;\n    }\n\n    if (vm_options.GlkOte)\n    {\n        GlkOte = vm_options.GlkOte;\n    }\n    else\n    {\n        throw new Error('No reference to GlkOte');\n    }\n\n    VM = vm_options.vm;\n    if (GiDispa) {\n        if (GiDispa.set_vm) {\n            GiDispa.set_vm(VM)\n        }\n        else {\n            GiDispa.init({\n                io: this,\n                vm: VM,\n            })\n        }\n    }\n\n    vm_options.accept = accept_ui_event;\n\n    GlkOte.init(vm_options);\n\n    option_exit_warning = vm_options.exit_warning;\n    option_do_vm_autosave = vm_options.do_vm_autosave;\n    option_before_select_hook = vm_options.before_select_hook;\n    option_extevent_hook = vm_options.extevent_hook;\n    option_glk_gestalt_hook = vm_options.glk_gestalt_hook;\n\n    if (option_before_select_hook) {\n        option_before_select_hook();\n    }\n}\n\nfunction accept_ui_event(obj) {\n    var box;\n\n    //qlog(\"### accept_ui_event: \" + obj.type + \", gen \" + obj.gen);\n    if (ui_disabled) {\n        /* We've hit glk_exit() or a VM fatal error, or just blocked the UI for\n           some modal dialog. */\n        qlog(\"### ui is disabled, ignoring event\");\n        return;\n    }\n\n    if (obj.gen != event_generation) {\n      GlkOte.log('Input event had wrong generation number: got ' + obj.gen + ', currently at ' + event_generation);\n      return;\n    }\n    event_generation += 1;\n\n    /* Note any partial inputs; we'll need them if the game cancels a line\n       input. This may be undef. */\n    current_partial_inputs = obj.partial;\n\n    switch (obj.type) {\n    case 'init':\n        content_metrics = obj.metrics;\n        // Process the support array\n        if (obj.support) {\n            obj.support.forEach(item => support[item] = 1);\n        }\n        // New Quixe API (was VM.init())\n        VM.start();\n        break;\n\n    case 'external': {\n        let res = null;\n        if (option_extevent_hook) {\n            res = option_extevent_hook(obj.value);\n        }\n        if (!res && obj.value == 'timer') {\n            /* Timer events no longer come in this way, but we'll still\n               accept them. */\n            gli_timer_started = Date.now();\n            res = { type: Const.evtype_Timer };\n        }\n        if (res && res.type) {\n            handle_external_input(res);\n        }\n        break;\n    }\n\n    case 'timer': {\n        gli_timer_started = Date.now();\n        const res = { type: Const.evtype_Timer };\n        handle_external_input(res);\n        break;\n    }\n\n    case 'hyperlink':\n        handle_hyperlink_input(obj.window, obj.value);\n        break;\n\n    case 'mouse':\n        handle_mouse_input(obj.window, obj.x, obj.y);\n        break;\n\n    case 'char':\n        handle_char_input(obj.window, obj.value);\n        break;\n\n    case 'line':\n        handle_line_input(obj.window, obj.value, obj.terminator);\n        break;\n\n    case 'arrange':\n        content_metrics = obj.metrics;\n        box = {\n            left: content_metrics.outspacingx,\n            top: content_metrics.outspacingy,\n            right: content_metrics.width-content_metrics.outspacingx,\n            bottom: content_metrics.height-content_metrics.outspacingy\n        };\n        if (gli_rootwin)\n            gli_window_rearrange(gli_rootwin, box);\n        handle_arrange_input();\n        break;\n\n    case 'redraw':\n        handle_redraw_input();\n        break;\n\n    case 'specialresponse':\n        if (obj.response == 'fileref_prompt') {\n            gli_fileref_create_by_prompt_callback(obj);\n        }\n        break;\n    }\n}\n\nfunction handle_arrange_input() {\n    if (!gli_selectref)\n        return;\n\n    gli_selectref.set_field(0, Const.evtype_Arrange);\n    gli_selectref.set_field(1, null);\n    gli_selectref.set_field(2, 0);\n    gli_selectref.set_field(3, 0);\n\n    if (GiDispa)\n        GiDispa.prepare_resume(gli_selectref);\n    gli_selectref = null;\n    VM.resume();\n}\n\nfunction handle_redraw_input() {\n    if (!gli_selectref)\n        return;\n\n    gli_selectref.set_field(0, Const.evtype_Redraw);\n    gli_selectref.set_field(1, null);\n    gli_selectref.set_field(2, 0);\n    gli_selectref.set_field(3, 0);\n\n    if (GiDispa)\n        GiDispa.prepare_resume(gli_selectref);\n    gli_selectref = null;\n    VM.resume();\n}\n\nfunction handle_external_input(res) {\n    if (!gli_selectref)\n        return;\n\n    /* This also handles timer input. */\n    var val1 = 0;\n    var val2 = 0;\n    if (res.val1)\n        val1 = res.val1;\n    if (res.val2)\n        val2 = res.val2;\n\n    gli_selectref.set_field(0, res.type);\n    gli_selectref.set_field(1, null);\n    gli_selectref.set_field(2, val1);\n    gli_selectref.set_field(3, val2);\n\n    if (GiDispa)\n        GiDispa.prepare_resume(gli_selectref);\n    gli_selectref = null;\n    VM.resume();\n}\n\nfunction handle_hyperlink_input(disprock, val) {\n    if (!gli_selectref)\n        return;\n\n    var win = null;\n    for (win=gli_windowlist; win; win=win.next) {\n        if (win.disprock == disprock) \n            break;\n    }\n    if (!win || !win.hyperlink_request)\n        return;\n\n    gli_selectref.set_field(0, Const.evtype_Hyperlink);\n    gli_selectref.set_field(1, win);\n    gli_selectref.set_field(2, val);\n    gli_selectref.set_field(3, 0);\n\n    win.hyperlink_request = false;\n\n    if (GiDispa)\n        GiDispa.prepare_resume(gli_selectref);\n    gli_selectref = null;\n    VM.resume();\n}\n\nfunction handle_mouse_input(disprock, xpos, ypos) {\n    if (!gli_selectref)\n        return;\n\n    var win = null;\n    for (win=gli_windowlist; win; win=win.next) {\n        if (win.disprock == disprock) \n            break;\n    }\n    if (!win || !win.mouse_request)\n        return;\n\n    gli_selectref.set_field(0, Const.evtype_MouseInput);\n    gli_selectref.set_field(1, win);\n    gli_selectref.set_field(2, xpos);\n    gli_selectref.set_field(3, ypos);\n\n    win.mouse_request = false;\n\n    if (GiDispa)\n        GiDispa.prepare_resume(gli_selectref);\n    gli_selectref = null;\n    VM.resume();\n}\n\nfunction handle_char_input(disprock, input) {\n    var charval;\n\n    if (!gli_selectref)\n        return;\n\n    var win = null;\n    for (win=gli_windowlist; win; win=win.next) {\n        if (win.disprock == disprock) \n            break;\n    }\n    if (!win || !win.char_request)\n        return;\n\n    if (input.length == 1) {\n        charval = input.charCodeAt(0);\n        if (!win.char_request_uni)\n            charval = charval & 0xFF;\n    }\n    else {\n        charval = KeystrokeNameMap[input];\n        if (!charval)\n            charval = Const.keycode_Unknown;\n    }\n\n    gli_selectref.set_field(0, Const.evtype_CharInput);\n    gli_selectref.set_field(1, win);\n    gli_selectref.set_field(2, charval);\n    gli_selectref.set_field(3, 0);\n\n    win.char_request = false;\n    win.char_request_uni = false;\n    win.input_generation = null;\n\n    if (GiDispa)\n        GiDispa.prepare_resume(gli_selectref);\n    gli_selectref = null;\n    VM.resume();\n}\n\nfunction handle_line_input(disprock, input, termkey) {\n    var ix;\n\n    if (!gli_selectref)\n        return;\n\n    var win = null;\n    for (win=gli_windowlist; win; win=win.next) {\n        if (win.disprock == disprock) \n            break;\n    }\n    if (!win || !win.line_request)\n        return;\n\n    if (input.length > win.linebuf.length)\n        input = input.slice(0, win.linebuf.length);\n\n    if (win.request_echo_line_input) {\n        ix = win.style;\n        gli_set_style(win.str, Const.style_Input);\n        gli_window_put_string(win, input);\n        if (win.echostr)\n            glk_put_jstring_stream(win.echostr, input);\n        gli_set_style(win.str, ix);\n        gli_window_put_string(win, \"\\n\");\n        if (win.echostr)\n            glk_put_jstring_stream(win.echostr, \"\\n\");\n    }\n\n    for (ix=0; ix<input.length; ix++)\n        win.linebuf[ix] = input.charCodeAt(ix);\n\n    var termcode = 0;\n    if (termkey && KeystrokeNameMap[termkey]) \n        termcode = KeystrokeNameMap[termkey];\n\n    gli_selectref.set_field(0, Const.evtype_LineInput);\n    gli_selectref.set_field(1, win);\n    gli_selectref.set_field(2, input.length);\n    gli_selectref.set_field(3, termcode);\n\n    if (GiDispa)\n        GiDispa.unretain_array(win.linebuf);\n    win.line_request = false;\n    win.line_request_uni = false;\n    win.request_echo_line_input = null;\n    win.input_generation = null;\n    win.linebuf = null;\n\n    if (GiDispa)\n        GiDispa.prepare_resume(gli_selectref);\n    gli_selectref = null;\n    VM.resume();\n}\n\nfunction update() {\n    var dataobj = { type: 'update', gen: event_generation };\n    var winarray = null;\n    var contentarray = null;\n    var inputarray = null;\n    var win, obj, robj, useobj, lineobj, ls, val, ix, cx;\n    var initial, lastpos;\n\n    if (geometry_changed) {\n        geometry_changed = false;\n        winarray = [];\n        for (win=gli_windowlist; win; win=win.next) {\n            if (win.type == Const.wintype_Pair)\n                continue;\n\n            obj = { id: win.disprock, rock: win.rock };\n            winarray.push(obj);\n\n            switch (win.type) {\n            case Const.wintype_TextBuffer:\n                obj.type = 'buffer';\n                obj.styles = clone_stylehints(win.stylehints)\n                break;\n            case Const.wintype_TextGrid:\n                obj.type = 'grid';\n                obj.gridwidth = win.gridwidth;\n                obj.gridheight = win.gridheight;\n                obj.styles = clone_stylehints(win.stylehints)\n                break;\n            case Const.wintype_Graphics:\n                obj.type = 'graphics';\n                obj.graphwidth = win.graphwidth;\n                obj.graphheight = win.graphheight;\n                break;\n            }\n\n            obj.left = win.bbox.left;\n            obj.top = win.bbox.top;\n            obj.width = win.bbox.right - win.bbox.left;\n            obj.height = win.bbox.bottom - win.bbox.top;\n        }\n    }\n\n    for (win=gli_windowlist; win; win=win.next) {\n        useobj = false;\n        obj = { id: win.disprock };\n        if (contentarray == null)\n            contentarray = [];\n\n        switch (win.type) {\n        case Const.wintype_TextBuffer:\n            gli_window_buffer_deaccumulate(win);\n            if (win.content.length) {\n                obj.text = win.content.slice(0);\n                win.content.length = 0;\n                useobj = true;\n            }\n            if (win.clearcontent) {\n                obj.clear = true;\n                obj.bg = win.cleared_bg;\n                obj.fg = win.cleared_fg;\n                win.clearcontent = false;\n                useobj = true;\n                if (!obj.text) {\n                    obj.text = [];\n                }\n                win.reserve.length = 0;\n            }\n            if (obj.text && obj.text.length) {\n                for (ix=0; ix<obj.text.length; ix++) {\n                    win.reserve.push(obj.text[ix]);\n                }\n            }\n            if (win.reserve.length > 100) {\n                win.reserve.splice(0, win.reserve.length-100);\n            }\n            break;\n        case Const.wintype_TextGrid:\n            if (win.gridwidth == 0 || win.gridheight == 0)\n                break;\n            obj.lines = [];\n            for (ix=0; ix<win.gridheight; ix++) {\n                lineobj = win.lines[ix];\n                if (!lineobj.dirty)\n                    continue;\n                lineobj.dirty = false;\n                ls = [];\n                lastpos = 0;\n                for (cx=0; cx<win.gridwidth; ) {\n                    const laststyle = lineobj.styles[cx];\n                    const lasthyperlink = lineobj.hyperlinks[cx];\n                    const lastfg = lineobj.fgs[cx];\n                    const lastbg = lineobj.bgs[cx];\n                    const lastreverse = lineobj.reverses[cx];\n                    for (; cx<win.gridwidth \n                             && lineobj.styles[cx] === laststyle\n                             && lineobj.hyperlinks[cx] === lasthyperlink\n                             && lineobj.fgs[cx] === lastfg\n                             && lineobj.bgs[cx] === lastbg\n                             && lineobj.reverses[cx] === lastreverse;\n                         cx++) {\n                             continue;\n                         }\n                    if (lastpos < cx) {\n                        if (!lasthyperlink && lastfg == null && lastbg == null && !lastreverse) {\n                            ls.push(StyleNameMap[laststyle]);\n                            ls.push(lineobj.chars.slice(lastpos, cx).join(''));\n                        }\n                        else {\n                            robj = {\n                                style: StyleNameMap[laststyle],\n                                text: lineobj.chars.slice(lastpos, cx).join(''),\n                                hyperlink: lasthyperlink,\n                            };\n                            if (lastbg || lastfg || lastreverse) {\n                                robj.css_styles = {}\n                                if (lastbg) {\n                                    robj.css_styles['background-color'] = lastbg\n                                }\n                                if (lastfg) {\n                                    robj.css_styles.color = lastfg\n                                }\n                                if (lastreverse) {\n                                    robj.css_styles.reverse = lastreverse\n                                }\n                            }\n                            ls.push(robj);\n                        }\n                        lastpos = cx;\n                    }\n                }\n                obj.lines.push({ line:ix, content:ls });\n            }\n            if (win.clearcontent) {\n                obj.clear = true;\n                obj.bg = win.cleared_bg;\n                obj.fg = win.cleared_fg;\n                win.clearcontent = false;\n            }\n            useobj = obj.lines.length;\n            break;\n        case Const.wintype_Graphics:\n            if (win.content.length) {\n                obj.draw = win.content.slice(0);\n                win.content.length = 0;\n                useobj = true;\n            }\n            /* Copy new drawing commands over to the reserve. Keep track\n               of the last (whole-window) fill command. */\n            var clearedat = -1;\n            if (obj.draw && obj.draw.length) {\n                for (ix=0; ix<obj.draw.length; ix++) {\n                    var drawel = obj.draw[ix];\n                    if (drawel.special == 'fill' \n                        && drawel.x === undefined && drawel.y === undefined \n                        && drawel.width === undefined && drawel.height === undefined) {\n                        clearedat = win.reserve.length;\n                    }\n                    win.reserve.push(drawel);\n                }\n            }\n            if (clearedat >= 0) {\n                /* We're going to delete every command before the\n                   fill, except that we save the last setcolor. */\n                var setcol = null;\n                for (let ix=0; ix<win.reserve.length && ix<clearedat; ix++) {\n                    const drawel = win.reserve[ix];\n                    if (drawel.special == 'setcolor')\n                        setcol = drawel;\n                }\n                win.reserve.splice(0, clearedat);\n                if (setcol)\n                    win.reserve.unshift(setcol);\n            }\n            break;\n        }\n\n        if (useobj)\n            contentarray.push(obj);\n    }\n\n    inputarray = [];\n    for (win=gli_windowlist; win; win=win.next) {\n        obj = null;\n        if (win.char_request) {\n            obj = { id: win.disprock, type: 'char', gen: win.input_generation };\n            if (win.type == Const.wintype_TextGrid) {\n                if (gli_window_grid_canonicalize(win)) {\n                    obj.xpos = win.gridwidth;\n                    obj.ypos = win.gridheight-1;\n                }\n                else {\n                    obj.xpos = win.cursorx;\n                    obj.ypos = win.cursory;\n                }\n            }\n        }\n        if (win.line_request) {\n            initial = '';\n            if (current_partial_outputs) {\n                val = current_partial_outputs[win.disprock];\n                if (val)\n                    initial = val;\n            }\n            /* Note that the initial and terminators fields will be ignored\n               if this is a continued (old) input request. So it doesn't\n               matter if they're wrong. */\n            obj = { id: win.disprock, type: 'line', gen: win.input_generation,\n                    maxlen: win.linebuf.length, initial: initial };\n            if (win.line_input_terminators.length) {\n                obj.terminators = win.line_input_terminators;\n            }\n            if (win.type == Const.wintype_TextGrid) {\n                if (gli_window_grid_canonicalize(win)) {\n                    obj.xpos = win.gridwidth;\n                    obj.ypos = win.gridheight-1;\n                }\n                else {\n                    obj.xpos = win.cursorx;\n                    obj.ypos = win.cursory;\n                }\n            }\n        }\n        if (win.hyperlink_request) {\n            if (!obj)\n                obj = { id: win.disprock };\n            obj.hyperlink = true;\n        }\n        if (win.mouse_request) {\n            if (!obj)\n                obj = { id: win.disprock };\n            obj.mouse = true;\n        }\n        if (obj)\n            inputarray.push(obj);\n    }\n\n    dataobj.windows = winarray;\n    dataobj.content = contentarray;\n    dataobj.input = inputarray;\n\n    if (gli_timer_lastsent != gli_timer_interval) {\n        //qlog(\"### timer update: \" + gli_timer_interval);\n        dataobj.timer = gli_timer_interval;\n        gli_timer_lastsent = gli_timer_interval;\n    }\n\n    if (ui_specialinput) {\n        //qlog(\"### special input: \" + ui_specialinput.type);\n        dataobj.specialinput = ui_specialinput;\n    }\n\n    if (ui_disabled) {\n        //qlog(\"### disabling ui\");\n        dataobj.disable = true;\n    }\n\n    // Send a live-updated bage background colour\n    const current_page_pg = stylehints.buffer['span.Style_normal']?.['background-color']\n    if (last_page_bg != current_page_pg)\n    {\n        last_page_bg = current_page_pg\n        dataobj.page_margin_bg = current_page_pg || ''\n    }\n\n    /* Clean this up; it's only meaningful within one run/update cycle. */\n    current_partial_outputs = null;\n\n    /* If we're doing an autorestore, gli_autorestore_glkstate will \n       contain additional setup information for the first update()\n       call only. */\n    if (gli_autorestore_glkstate)\n        dataobj.autorestore = gli_autorestore_glkstate;\n    gli_autorestore_glkstate = null;\n\n    GlkOte.update(dataobj, gli_autorestore_glkstate);\n\n    if (option_before_select_hook) {\n        option_before_select_hook();\n    }\n    if (option_do_vm_autosave) {\n        if (has_exited) {\n            /* On quit or fatal error, delete the autosave. */\n            VM.do_autosave(-1);\n        }\n        else if (GiDispa) {\n            /* If this is a good time, autosave. */\n            var eventarg = GiDispa.check_autosave();\n            if (eventarg)\n                VM.do_autosave(eventarg);\n        }\n    }\n}\n\n/* Return the library interface object that we were passed or created.\n   Call this if you want to use, e.g., the same Dialog object that GlkOte\n   is using.\n*/\nfunction get_library(val) {\n    switch (val) {\n        case 'VM': return VM;\n        case 'GlkOte': return GlkOte;\n        case 'GiDispa': return GiDispa;\n        case 'Blorb': return Blorb;\n        case 'Dialog': return GlkOte.getlibrary('Dialog');\n    }\n    /* Unrecognized library name. */\n    return null;\n}\n\n/* Wrap up the current display state as a (JSONable) object. This is\n   called from Quixe.vm_autosave.\n*/\nfunction save_allstate() {\n    var res = {};\n\n    if (gli_rootwin)\n        res.rootwin = gli_rootwin.disprock;\n\n    if (gli_currentstr)\n        res.currentstr = gli_currentstr.disprock;\n\n    if (gli_timer_interval)\n        res.timer_interval = gli_timer_interval;\n\n    res.windows = [];\n    for (var win = gli_windowlist; win; win = win.next) {\n        var obj = {\n            type: win.type, rock: win.rock, disprock: win.disprock,\n            style: win.style, hyperlink: win.hyperlink,\n            bg: win.bg, fg: win.fg, reverse: win.reverse,\n            cleared_bg: win.cleared_bg, cleared_fg: win.cleared_fg,\n        };\n        if (win.parent)\n            obj.parent = win.parent.disprock;\n        obj.str = win.str.disprock;\n        if (win.echostr)\n            obj.echostr = win.echostr.disprock;\n\n        obj.bbox = { \n            left: win.bbox.left, right: win.bbox.right,\n            top: win.bbox.top, bottom: win.bbox.bottom \n        };\n\n        if (win.linebuf !== null) {\n            var info = GiDispa.get_retained_array(win.linebuf);\n            obj.linebuf = {\n                addr: info.addr,\n                len: info.len,\n                arr: info.arr.slice(0),\n                arg: info.arg.serialize()\n            };\n        }\n        obj.char_request = win.char_request;\n        obj.line_request = win.line_request;\n        obj.char_request_uni = win.char_request_uni;\n        obj.line_request_uni = win.line_request_uni;\n        obj.hyperlink_request = win.hyperlink_request;\n        obj.mouse_request = win.mouse_request;\n        obj.echo_line_input = win.echo_line_input;\n        obj.request_echo_line_input = win.request_echo_line_input;\n        obj.line_input_terminators = win.line_input_terminators.slice(0);\n        //### should have a request_line_input_terminators as well\n\n        switch (win.type) {\n        case Const.wintype_TextBuffer:\n            obj.reserve = win.reserve.slice(0);\n            obj.stylehints = win.stylehints\n            break;\n        case Const.wintype_TextGrid:\n            obj.gridwidth = win.gridwidth;\n            obj.gridheight = win.gridheight;\n            obj.lines = [];\n            for (var ix=0; ix<win.lines.length; ix++) {\n                var ln = win.lines[ix];\n                obj.lines.push({\n                        chars: ln.chars.slice(0),\n                        styles: ln.styles.slice(0),\n                        hyperlinks: ln.hyperlinks.slice(0),\n                        fgs: ln.fgs.slice(0),\n                        bgs: ln.bgs.slice(0),\n                        reverses: ln.reverses.slice(0),\n                    });\n            }\n            obj.cursorx = win.cursorx;\n            obj.cursory = win.cursory;\n            obj.stylehints = win.stylehints\n            break;\n        case Const.wintype_Graphics:\n            obj.graphwidth = win.graphwidth;\n            obj.graphheight = win.graphheight;\n            obj.reserve = win.reserve.slice(0);\n            break;\n        case Const.wintype_Pair:\n            obj.pair_dir = win.pair_dir;\n            obj.pair_division = win.pair_division;\n            obj.pair_key = win.pair_key.disprock;\n            obj.pair_keydamage = false;\n            obj.pair_size = win.pair_size;\n            obj.pair_hasborder = win.pair_hasborder;\n            obj.pair_vertical = win.pair_vertical;\n            obj.pair_backward = win.pair_backward;\n            obj.child1 = win.child1.disprock;\n            obj.child2 = win.child2.disprock;\n            break;\n        }\n\n        res.windows.push(obj);\n    }\n\n    res.streams = [];\n    for (let str = gli_streamlist; str; str = str.next) {\n        const obj = {\n            type: str.type, rock: str.rock, disprock: str.disprock,\n            unicode: str.unicode, isbinary: str.isbinary,\n            readcount: str.readcount, writecount: str.writecount,\n            readable: str.readable, writable: str.writable,\n            streaming: str.streaming\n        };\n\n        switch (str.type) {\n\n        case strtype_Window:\n            if (str.win)\n                obj.win = str.win.disprock;\n            break;\n\n        case strtype_Memory:\n            if (str.buf !== null) {\n                const info = GiDispa.get_retained_array(str.buf);\n                obj.buf = {\n                    addr: info.addr,\n                    len: info.len,\n                    arr: info.arr.slice(0),\n                    arg: info.arg.serialize()\n                };\n            }\n            obj.buflen = str.buflen;\n            obj.bufpos = str.bufpos;\n            obj.bufeof = str.bufeof;\n            break;\n\n        case strtype_Resource:\n            obj.resfilenum = str.resfilenum;\n            // Don't need str.buf\n            obj.buflen = str.buflen;\n            obj.bufpos = str.bufpos;\n            obj.bufeof = str.bufeof;\n            break;\n\n        case strtype_File:\n            obj.origfmode = str.origfmode;\n            if (!Dialog.streaming) {\n                obj.ref = str.ref;\n                gli_stream_flush_file(str);\n                // Don't need str.buf\n                obj.buflen = str.buflen;\n                obj.bufpos = str.bufpos;\n                obj.bufeof = str.bufeof;\n            }\n            else {\n                str.fstream.fflush();\n                obj.ref = str.ref;\n                obj.filepos = str.fstream.ftell();\n            }\n            break;\n\n        }\n\n        res.streams.push(obj);\n    }\n\n    res.filerefs = [];\n    for (let fref = gli_filereflist; fref; fref = fref.next) {\n        const obj = {\n            type: fref.type, rock: fref.rock, disprock: fref.disprock,\n            filename: fref.filename, textmode: fref.textmode,\n            filetype: fref.filetype, filetypename: fref.filetypename\n        };\n\n        obj.ref = fref.ref;\n\n        res.filerefs.push(obj);\n    }\n\n    // Ignore gli_schannellist, as it's currently always empty.\n\n    // Save the in-progress stylehints\n    res.stylehints = stylehints;\n\n    /* Save GlkOte-level information. This includes the overall metrics. */\n    res.glkote = GlkOte.save_allstate();\n\n    return res;\n}\n\n/* Take display information (created by save_allstate) and set up our\n   state to match it. Called from vm_autorestore.\n*/\nfunction restore_allstate(res)\n{\n    if (gli_windowlist || gli_streamlist || gli_filereflist)\n        throw('restore_allstate: glkapi module has already been launched');\n\n    /* We build and register all the bare objects first. (In reverse\n       order so that the linked lists come out right way around.) */\n\n    for (let ix=res.windows.length-1; ix>=0; ix--) {\n        const obj = res.windows[ix];\n        const win = {\n            type: obj.type, rock: obj.rock, disprock: obj.disprock,\n            style: obj.style, hyperlink: obj.hyperlink,\n            bg: obj.bg, fg: obj.fg, reverse: obj.reverse,\n            cleared_bg: obj.cleared_bg, cleared_fg: obj.cleared_fg,\n        };\n        GiDispa.class_register('window', win, win.disprock);\n\n        win.prev = null;\n        win.next = gli_windowlist;\n        gli_windowlist = win;\n        if (win.next)\n            win.next.prev = win;\n    }\n\n    for (let ix=res.streams.length-1; ix>=0; ix--) {\n        const obj = res.streams[ix];\n        const str = {\n            type: obj.type, rock: obj.rock, disprock: obj.disprock,\n            unicode: obj.unicode, isbinary: obj.isbinary,\n            readcount: obj.readcount, writecount: obj.writecount,\n            readable: obj.readable, writable: obj.writable,\n            streaming: obj.streaming\n        };\n        GiDispa.class_register('stream', str, str.disprock);\n\n        str.prev = null;\n        str.next = gli_streamlist;\n        gli_streamlist = str;\n        if (str.next)\n            str.next.prev = str;\n    }\n\n    for (let ix=res.filerefs.length-1; ix>=0; ix--) {\n        const obj = res.filerefs[ix];\n        const fref = {\n            type: obj.type, rock: obj.rock, disprock: obj.disprock,\n            filename: obj.filename, textmode: obj.textmode,\n            filetype: obj.filetype, filetypename: obj.filetypename\n        };\n        GiDispa.class_register('fileref', fref, fref.disprock);\n\n        fref.prev = null;\n        fref.next = gli_filereflist;\n        gli_filereflist = fref;\n        if (fref.next)\n            fref.next.prev = fref;\n    }\n\n    /* ...Now we fill in the cross-references. */\n\n    for (let ix=0; ix<res.windows.length; ix++) {\n        const obj = res.windows[ix];\n        const win = GiDispa.class_obj_from_id('window', obj.disprock);\n\n        win.parent = GiDispa.class_obj_from_id('window', obj.parent);\n        win.str = GiDispa.class_obj_from_id('stream', obj.str);\n        win.echostr = GiDispa.class_obj_from_id('stream', obj.echostr);\n\n        win.bbox = { \n            left: obj.bbox.left, right: obj.bbox.right,\n            top: obj.bbox.top, bottom: obj.bbox.bottom \n        };\n\n        win.input_generation = null;\n        if (obj.char_request || obj.line_request)\n            win.input_generation = event_generation;\n        win.linebuf = null;\n        if (obj.linebuf !== undefined) {\n            // should clone that object\n            win.linebuf = obj.linebuf.arr;\n            GiDispa.retain_array(win.linebuf, obj.linebuf);\n        }\n        win.char_request = obj.char_request;\n        win.line_request = obj.line_request;\n        win.char_request_uni = obj.char_request_uni;\n        win.line_request_uni = obj.line_request_uni;\n        win.hyperlink_request = obj.hyperlink_request;\n        win.mouse_request = obj.mouse_request;\n        win.echo_line_input = obj.echo_line_input;\n        win.request_echo_line_input = obj.request_echo_line_input;\n        win.line_input_terminators = obj.line_input_terminators.slice(0);\n        //### should have a request_line_input_terminators as well\n\n        switch (win.type) {\n        case Const.wintype_TextBuffer:\n            win.accum = [];\n            win.accumstyle = win.style;\n            win.accumhyperlink = win.hyperlink;\n            win.accum_fg = win.fg\n            win.accum_bg = win.bg\n            win.accum_reverse = win.reverse\n            win.content = obj.reserve.slice(0);\n            win.clearcontent = true;\n            win.reserve = [];\n            win.stylehints = restore_stylehints(obj.stylehints);\n            break;\n        case Const.wintype_TextGrid:\n            win.gridwidth = obj.gridwidth;\n            win.gridheight = obj.gridheight;\n            win.lines = [];\n            for (var jx=0; jx<obj.lines.length; jx++) {\n                var ln = obj.lines[jx];\n                win.lines.push({\n                        dirty: true,\n                        chars: ln.chars.slice(0),\n                        styles: ln.styles.slice(0),\n                        hyperlinks: ln.hyperlinks.slice(0),\n                        fgs: ln.fgs.slice(0),\n                        bgs: ln.bgs.slice(0),\n                        reverses: ln.reverses.slice(0),\n                    });\n            }\n            win.cursorx = obj.cursorx;\n            win.cursory = obj.cursory;\n            win.clearcontent = true;\n            win.stylehints = restore_stylehints(obj.stylehints);\n            break;\n        case Const.wintype_Graphics:\n            win.graphwidth = obj.graphwidth;\n            win.graphheight = obj.graphheight;\n            win.content = obj.reserve.slice(0);\n            win.reserve = [];\n            break;\n        case Const.wintype_Pair:\n            win.pair_dir = obj.pair_dir;\n            win.pair_division = obj.pair_division;\n            win.pair_key = GiDispa.class_obj_from_id('window', obj.pair_key);\n            win.pair_keydamage = false;\n            win.pair_size = obj.pair_size;\n            win.pair_hasborder = obj.pair_hasborder;\n            win.pair_vertical = obj.pair_vertical;\n            win.pair_backward = obj.pair_backward;\n            win.child1 = GiDispa.class_obj_from_id('window', obj.child1);\n            win.child2 = GiDispa.class_obj_from_id('window', obj.child2);\n            break;\n        }\n    }\n\n    for (let ix=0; ix<res.streams.length; ix++) {\n        const obj = res.streams[ix];\n        const str = GiDispa.class_obj_from_id('stream', obj.disprock);\n\n        /* Defaults first... */\n        str.win = null;\n        str.ref = null;\n        str.file = null;\n\n        str.buf = null;\n        str.bufpos = 0;\n        str.buflen = 0;\n        str.bufeof = 0;\n        str.timer_id = null;\n        str.flush_func = null;\n        str.fstream = null;\n\n        switch (str.type) {\n\n        case strtype_Window:\n            str.win = GiDispa.class_obj_from_id('window', obj.win);\n            break;\n\n        case strtype_Memory:\n            if (obj.buf !== undefined) {\n                // should clone that object\n                str.buf = obj.buf.arr;\n                GiDispa.retain_array(str.buf, obj.buf);\n            }\n            str.buflen = obj.buflen;\n            str.bufpos = obj.bufpos;\n            str.bufeof = obj.bufeof;\n            break;\n\n        case strtype_Resource:\n            str.resfilenum = obj.resfilenum;\n            var el = Blorb.find_data_chunk(str.resfilenum);\n            if (el) {\n                str.buf = el.data;\n            }\n            str.buflen = obj.buflen;\n            str.bufpos = obj.bufpos;\n            str.bufeof = obj.bufeof;\n            break;\n\n        case strtype_File:\n            str.origfmode = obj.origfmode;\n            if (!Dialog.streaming) {\n                str.ref = obj.ref;\n                str.buflen = obj.buflen;\n                str.bufpos = obj.bufpos;\n                str.bufeof = obj.bufeof;\n\n                var content = Dialog.file_read(str.ref);\n                if (content == null) {\n                    /* The file was somehow deleted. Create an empty\n                       file (even in read mode). */\n                    content = [];\n                    Dialog.file_write(str.ref, '', true);\n                }\n                str.buf = content;\n\n                /* If the file has been shortened, we might have to\n                   trim bufeof to fit within it. The game might see\n                   the file pos mysteriously move; sorry. */\n                str.bufeof = content.length;\n                if (str.bufpos > str.bufeof)\n                    str.bufpos = str.bufeof;\n            }\n            else {\n                str.ref = obj.ref;\n                str.fstream = Dialog.file_fopen(str.origfmode, str.ref);\n                if (!str.fstream) {\n                    /* This is the panic case. We can't reopen the stream,\n                       but the game expects an open stream! We'll just\n                       have to open a temporary file; the user will never\n                       get their data, but at least the game won't crash.\n                       (Better policy would be to prompt the user for\n                       a new file location...) */\n                    var tempref = Dialog.file_construct_temp_ref(str.ref.usage);\n                    str.fstream = Dialog.file_fopen(str.origfmode, tempref);\n                    if (!str.fstream)\n                        throw('restore_allstate: could not reopen even a temp stream for: ' + str.ref.filename);\n                }\n\n                if (str.origfmode != Const.filemode_WriteAppend) {\n                    /* Jump to the last known filepos. */\n                    str.fstream.fseek(obj.filepos, Const.seekmode_Start);\n                }\n\n                str.buffer4 = str.fstream.BufferClass.alloc(4);\n            }\n            break;\n\n        }\n    }\n\n    for (let ix=0; ix<res.filerefs.length; ix++) {\n        const obj = res.filerefs[ix];\n        const fref = GiDispa.class_obj_from_id('fileref', obj.disprock);\n\n        fref.ref = obj.ref; // should deep clone\n    }\n\n    gli_rootwin = GiDispa.class_obj_from_id('window', res.rootwin);\n    gli_currentstr = GiDispa.class_obj_from_id('stream', res.currentstr);\n\n    if (res.timer_interval)\n        glk_request_timer_events(res.timer_interval);\n\n    stylehints.buffer = restore_stylehints(res.stylehints.buffer);\n    stylehints.grid = restore_stylehints(res.stylehints.grid);\n\n    /* Stash this for the next (first) GlkOte.update call. */\n    gli_autorestore_glkstate = res.glkote;\n}\n\n/* This is the handler for a VM fatal error. (Not for an error in our own\n   library!) We display the error message, and then push a final display\n   update, which kills all input fields in all windows.\n*/\nfunction fatal_error(msg) {\n    has_exited = true;\n    ui_disabled = true;\n    if (!GlkOte) {\n        // We haven't been initialized yet, so we can only try to log the error and hope someone sees it.\n        console.log('Fatal error:', msg);\n        return;\n    }\n    GlkOte.error(msg);\n    var dataobj = { type: 'update', gen: event_generation, disable: true };\n    dataobj.input = [];\n    GlkOte.update(dataobj);\n}\n\n/* All the numeric constants used by the Glk interface. We push these into\n   an object, for tidiness. */\n\nvar Const = {\n    gestalt_Version : 0,\n    gestalt_CharInput : 1,\n    gestalt_LineInput : 2,\n    gestalt_CharOutput : 3,\n      gestalt_CharOutput_CannotPrint : 0,\n      gestalt_CharOutput_ApproxPrint : 1,\n      gestalt_CharOutput_ExactPrint : 2,\n    gestalt_MouseInput : 4,\n    gestalt_Timer : 5,\n    gestalt_Graphics : 6,\n    gestalt_DrawImage : 7,\n    gestalt_Sound : 8,\n    gestalt_SoundVolume : 9,\n    gestalt_SoundNotify : 10,\n    gestalt_Hyperlinks : 11,\n    gestalt_HyperlinkInput : 12,\n    gestalt_SoundMusic : 13,\n    gestalt_GraphicsTransparency : 14,\n    gestalt_Unicode : 15,\n    gestalt_UnicodeNorm : 16,\n    gestalt_LineInputEcho : 17,\n    gestalt_LineTerminators : 18,\n    gestalt_LineTerminatorKey : 19,\n    gestalt_DateTime : 20,\n    gestalt_Sound2 : 21,\n    gestalt_ResourceStream : 22,\n    gestalt_GraphicsCharInput : 23,\n    gestalt_GarglkText: 0x1100,\n\n    keycode_Unknown  : 0xffffffff,\n    keycode_Left     : 0xfffffffe,\n    keycode_Right    : 0xfffffffd,\n    keycode_Up       : 0xfffffffc,\n    keycode_Down     : 0xfffffffb,\n    keycode_Return   : 0xfffffffa,\n    keycode_Delete   : 0xfffffff9,\n    keycode_Escape   : 0xfffffff8,\n    keycode_Tab      : 0xfffffff7,\n    keycode_PageUp   : 0xfffffff6,\n    keycode_PageDown : 0xfffffff5,\n    keycode_Home     : 0xfffffff4,\n    keycode_End      : 0xfffffff3,\n    keycode_Func1    : 0xffffffef,\n    keycode_Func2    : 0xffffffee,\n    keycode_Func3    : 0xffffffed,\n    keycode_Func4    : 0xffffffec,\n    keycode_Func5    : 0xffffffeb,\n    keycode_Func6    : 0xffffffea,\n    keycode_Func7    : 0xffffffe9,\n    keycode_Func8    : 0xffffffe8,\n    keycode_Func9    : 0xffffffe7,\n    keycode_Func10   : 0xffffffe6,\n    keycode_Func11   : 0xffffffe5,\n    keycode_Func12   : 0xffffffe4,\n    /* The last keycode is always (0x100000000 - keycode_MAXVAL) */\n    keycode_MAXVAL   : 28,\n\n    evtype_None : 0,\n    evtype_Timer : 1,\n    evtype_CharInput : 2,\n    evtype_LineInput : 3,\n    evtype_MouseInput : 4,\n    evtype_Arrange : 5,\n    evtype_Redraw : 6,\n    evtype_SoundNotify : 7,\n    evtype_Hyperlink : 8,\n    evtype_VolumeNotify : 9,\n\n    style_Normal : 0,\n    style_Emphasized : 1,\n    style_Preformatted : 2,\n    style_Header : 3,\n    style_Subheader : 4,\n    style_Alert : 5,\n    style_Note : 6,\n    style_BlockQuote : 7,\n    style_Input : 8,\n    style_User1 : 9,\n    style_User2 : 10,\n    style_NUMSTYLES : 11,\n\n    wintype_AllTypes : 0,\n    wintype_Pair : 1,\n    wintype_Blank : 2,\n    wintype_TextBuffer : 3,\n    wintype_TextGrid : 4,\n    wintype_Graphics : 5,\n\n    winmethod_Left  : 0x00,\n    winmethod_Right : 0x01,\n    winmethod_Above : 0x02,\n    winmethod_Below : 0x03,\n    winmethod_DirMask : 0x0f,\n\n    winmethod_Fixed : 0x10,\n    winmethod_Proportional : 0x20,\n    winmethod_DivisionMask : 0xf0,\n\n    winmethod_Border : 0x000,\n    winmethod_NoBorder : 0x100,\n    winmethod_BorderMask : 0x100,\n\n    fileusage_Data : 0x00,\n    fileusage_SavedGame : 0x01,\n    fileusage_Transcript : 0x02,\n    fileusage_InputRecord : 0x03,\n    fileusage_TypeMask : 0x0f,\n\n    fileusage_TextMode   : 0x100,\n    fileusage_BinaryMode : 0x000,\n\n    filemode_Write : 0x01,\n    filemode_Read : 0x02,\n    filemode_ReadWrite : 0x03,\n    filemode_WriteAppend : 0x05,\n\n    seekmode_Start : 0,\n    seekmode_Current : 1,\n    seekmode_End : 2,\n\n    stylehint_Indentation : 0,\n    stylehint_ParaIndentation : 1,\n    stylehint_Justification : 2,\n    stylehint_Size : 3,\n    stylehint_Weight : 4,\n    stylehint_Oblique : 5,\n    stylehint_Proportional : 6,\n    stylehint_TextColor : 7,\n    stylehint_BackColor : 8,\n    stylehint_ReverseColor : 9,\n    stylehint_NUMHINTS : 10,\n\n      stylehint_just_LeftFlush : 0,\n      stylehint_just_LeftRight : 1,\n      stylehint_just_Centered : 2,\n      stylehint_just_RightFlush : 3,\n\n    imagealign_InlineUp : 1,\n    imagealign_InlineDown : 2,\n    imagealign_InlineCenter : 3,\n    imagealign_MarginLeft : 4,\n    imagealign_MarginRight : 5,\n\n    zcolor_Default: -1,\n    zcolor_Current: -2,\n\n};\n\nvar KeystrokeNameMap = {\n    /* The key values are taken from GlkOte's \"char\" event. A couple of them\n       are Javascript keywords, so they're in quotes, but that doesn't affect\n       the final structure. */\n    left : Const.keycode_Left,\n    right : Const.keycode_Right,\n    up : Const.keycode_Up,\n    down : Const.keycode_Down,\n    'return' : Const.keycode_Return,\n    'delete' : Const.keycode_Delete,\n    escape : Const.keycode_Escape,\n    tab : Const.keycode_Tab,\n    pageup : Const.keycode_PageUp,\n    pagedown : Const.keycode_PageDown,\n    home : Const.keycode_Home,\n    end : Const.keycode_End,\n    func1 : Const.keycode_Func1,\n    func2 : Const.keycode_Func2,\n    func3 : Const.keycode_Func3,\n    func4 : Const.keycode_Func4,\n    func5 : Const.keycode_Func5,\n    func6 : Const.keycode_Func6,\n    func7 : Const.keycode_Func7,\n    func8 : Const.keycode_Func8,\n    func9 : Const.keycode_Func9,\n    func10 : Const.keycode_Func10,\n    func11 : Const.keycode_Func11,\n    func12 : Const.keycode_Func12\n};\n\n/* The inverse of KeystrokeNameMap. We'll fill this in if needed. (It \n   generally isn't.) */\nvar KeystrokeValueMap = null;\n\nvar StyleNameMap = {\n    0 : 'normal',\n    1 : 'emphasized',\n    2 : 'preformatted',\n    3 : 'header',\n    4 : 'subheader',\n    5 : 'alert',\n    6 : 'note',\n    7 : 'blockquote',\n    8 : 'input',\n    9 : 'user1',\n    10 : 'user2'\n};\n\nvar FileTypeMap = {\n    0: 'data',\n    1: 'save',\n    2: 'transcript',\n    3: 'command'\n};\n\n/* These tables were generated by casemap.py. */\n/* Derived from Unicode data files, Unicode version 4.0.1. */\n\n/* list all the special cases in unicode_upper_table */\nvar unicode_upper_table = {\n181: 924, 223: [ 83,83 ], 255: 376, 305: 73, 329: [ 700,78 ],\n383: 83, 405: 502, 414: 544, 447: 503, 454: 452,\n457: 455, 460: 458, 477: 398, 496: [ 74,780 ], 499: 497,\n595: 385, 596: 390, 598: 393, 599: 394, 601: 399,\n603: 400, 608: 403, 611: 404, 616: 407, 617: 406,\n623: 412, 626: 413, 629: 415, 640: 422, 643: 425,\n648: 430, 650: 433, 651: 434, 658: 439, 837: 921,\n912: [ 921,776,769 ], 940: 902, 941: 904, 942: 905, 943: 906,\n944: [ 933,776,769 ], 962: 931, 972: 908, 973: 910, 974: 911,\n976: 914, 977: 920, 981: 934, 982: 928, 1008: 922,\n1010: 1017, 1013: 917, 1415: [ 1333,1362 ], 7830: [ 72,817 ], 7831: [ 84,776 ],\n7832: [ 87,778 ], 7833: [ 89,778 ], 7834: [ 65,702 ], 7835: 7776, 8016: [ 933,787 ],\n8018: [ 933,787,768 ], 8020: [ 933,787,769 ], 8022: [ 933,787,834 ], 8048: 8122, 8049: 8123,\n8050: 8136, 8051: 8137, 8052: 8138, 8053: 8139, 8054: 8154,\n8055: 8155, 8056: 8184, 8057: 8185, 8058: 8170, 8059: 8171,\n8060: 8186, 8061: 8187, 8064: [ 7944,921 ], 8065: [ 7945,921 ], 8066: [ 7946,921 ],\n8067: [ 7947,921 ], 8068: [ 7948,921 ], 8069: [ 7949,921 ], 8070: [ 7950,921 ], 8071: [ 7951,921 ],\n8072: [ 7944,921 ], 8073: [ 7945,921 ], 8074: [ 7946,921 ], 8075: [ 7947,921 ], 8076: [ 7948,921 ],\n8077: [ 7949,921 ], 8078: [ 7950,921 ], 8079: [ 7951,921 ], 8080: [ 7976,921 ], 8081: [ 7977,921 ],\n8082: [ 7978,921 ], 8083: [ 7979,921 ], 8084: [ 7980,921 ], 8085: [ 7981,921 ], 8086: [ 7982,921 ],\n8087: [ 7983,921 ], 8088: [ 7976,921 ], 8089: [ 7977,921 ], 8090: [ 7978,921 ], 8091: [ 7979,921 ],\n8092: [ 7980,921 ], 8093: [ 7981,921 ], 8094: [ 7982,921 ], 8095: [ 7983,921 ], 8096: [ 8040,921 ],\n8097: [ 8041,921 ], 8098: [ 8042,921 ], 8099: [ 8043,921 ], 8100: [ 8044,921 ], 8101: [ 8045,921 ],\n8102: [ 8046,921 ], 8103: [ 8047,921 ], 8104: [ 8040,921 ], 8105: [ 8041,921 ], 8106: [ 8042,921 ],\n8107: [ 8043,921 ], 8108: [ 8044,921 ], 8109: [ 8045,921 ], 8110: [ 8046,921 ], 8111: [ 8047,921 ],\n8114: [ 8122,921 ], 8115: [ 913,921 ], 8116: [ 902,921 ], 8118: [ 913,834 ], 8119: [ 913,834,921 ],\n8124: [ 913,921 ], 8126: 921, 8130: [ 8138,921 ], 8131: [ 919,921 ], 8132: [ 905,921 ],\n8134: [ 919,834 ], 8135: [ 919,834,921 ], 8140: [ 919,921 ], 8146: [ 921,776,768 ], 8147: [ 921,776,769 ],\n8150: [ 921,834 ], 8151: [ 921,776,834 ], 8162: [ 933,776,768 ], 8163: [ 933,776,769 ], 8164: [ 929,787 ],\n8165: 8172, 8166: [ 933,834 ], 8167: [ 933,776,834 ], 8178: [ 8186,921 ], 8179: [ 937,921 ],\n8180: [ 911,921 ], 8182: [ 937,834 ], 8183: [ 937,834,921 ], 8188: [ 937,921 ], 64256: [ 70,70 ],\n64257: [ 70,73 ], 64258: [ 70,76 ], 64259: [ 70,70,73 ], 64260: [ 70,70,76 ], 64261: [ 83,84 ],\n64262: [ 83,84 ], 64275: [ 1348,1350 ], 64276: [ 1348,1333 ], 64277: [ 1348,1339 ], 64278: [ 1358,1350 ],\n64279: [ 1348,1341 ]\n};\n/* add all the regular cases to unicode_upper_table */\n(function() {\n  var ls, ix, val;\n  var map = unicode_upper_table;\n  ls = [\n7936, 7937, 7938, 7939, 7940, 7941, 7942, 7943,\n7952, 7953, 7954, 7955, 7956, 7957, 7968, 7969,\n7970, 7971, 7972, 7973, 7974, 7975, 7984, 7985,\n7986, 7987, 7988, 7989, 7990, 7991, 8000, 8001,\n8002, 8003, 8004, 8005, 8017, 8019, 8021, 8023,\n8032, 8033, 8034, 8035, 8036, 8037, 8038, 8039,\n8112, 8113, 8144, 8145, 8160, 8161,\n  ];\n  for (ix=0; ix<54; ix++) {\n    val = ls[ix];\n    map[val] = val+8;\n  }\n  for (val=257; val<=303; val+=2) {\n    map[val] = val-1;\n  }\n  for (val=331; val<=375; val+=2) {\n    map[val] = val-1;\n  }\n  for (val=505; val<=543; val+=2) {\n    map[val] = val-1;\n  }\n  for (val=1121; val<=1153; val+=2) {\n    map[val] = val-1;\n  }\n  for (val=1163; val<=1215; val+=2) {\n    map[val] = val-1;\n  }\n  for (val=1233; val<=1269; val+=2) {\n    map[val] = val-1;\n  }\n  for (val=7681; val<=7829; val+=2) {\n    map[val] = val-1;\n  }\n  for (val=7841; val<=7929; val+=2) {\n    map[val] = val-1;\n  }\n  ls = [\n307, 309, 311, 314, 316, 318, 320, 322,\n324, 326, 328, 378, 380, 382, 387, 389,\n392, 396, 402, 409, 417, 419, 421, 424,\n429, 432, 436, 438, 441, 445, 453, 456,\n459, 462, 464, 466, 468, 470, 472, 474,\n476, 479, 481, 483, 485, 487, 489, 491,\n493, 495, 498, 501, 547, 549, 551, 553,\n555, 557, 559, 561, 563, 985, 987, 989,\n991, 993, 995, 997, 999, 1001, 1003, 1005,\n1007, 1016, 1019, 1218, 1220, 1222, 1224, 1226,\n1228, 1230, 1273, 1281, 1283, 1285, 1287, 1289,\n1291, 1293, 1295,\n  ];\n  for (ix=0; ix<91; ix++) {\n    val = ls[ix];\n    map[val] = val-1;\n  }\n  for (val=8560; val<=8575; val+=1) {\n    map[val] = val-16;\n  }\n  for (val=9424; val<=9449; val+=1) {\n    map[val] = val-26;\n  }\n  for (val=97; val<=122; val+=1) {\n    map[val] = val-32;\n  }\n  for (val=224; val<=246; val+=1) {\n    map[val] = val-32;\n  }\n  for (val=945; val<=961; val+=1) {\n    map[val] = val-32;\n  }\n  for (val=1072; val<=1103; val+=1) {\n    map[val] = val-32;\n  }\n  for (val=65345; val<=65370; val+=1) {\n    map[val] = val-32;\n  }\n  ls = [\n248, 249, 250, 251, 252, 253, 254, 963,\n964, 965, 966, 967, 968, 969, 970, 971,\n  ];\n  for (ix=0; ix<16; ix++) {\n    val = ls[ix];\n    map[val] = val-32;\n  }\n  for (val=66600; val<=66639; val+=1) {\n    map[val] = val-40;\n  }\n  for (val=1377; val<=1414; val+=1) {\n    map[val] = val-48;\n  }\n  for (val=1104; val<=1119; val+=1) {\n    map[val] = val-80;\n  }\n  map[1009] = 929;\n})();\n\n/* list all the special cases in unicode_lower_table */\nvar unicode_lower_table = {\n304: [ 105,775 ], 376: 255, 385: 595, 390: 596, 393: 598,\n394: 599, 398: 477, 399: 601, 400: 603, 403: 608,\n404: 611, 406: 617, 407: 616, 412: 623, 413: 626,\n415: 629, 422: 640, 425: 643, 430: 648, 433: 650,\n434: 651, 439: 658, 452: 454, 455: 457, 458: 460,\n497: 499, 502: 405, 503: 447, 544: 414, 902: 940,\n904: 941, 905: 942, 906: 943, 908: 972, 910: 973,\n911: 974, 1012: 952, 1017: 1010, 8122: 8048, 8123: 8049,\n8124: 8115, 8136: 8050, 8137: 8051, 8138: 8052, 8139: 8053,\n8140: 8131, 8154: 8054, 8155: 8055, 8170: 8058, 8171: 8059,\n8172: 8165, 8184: 8056, 8185: 8057, 8186: 8060, 8187: 8061,\n8188: 8179, 8486: 969, 8490: 107, 8491: 229\n};\n/* add all the regular cases to unicode_lower_table */\n(function() {\n  var ls, ix, val;\n  var map = unicode_lower_table;\n  for (val=1024; val<=1039; val+=1) {\n    map[val] = val+80;\n  }\n  for (val=1329; val<=1366; val+=1) {\n    map[val] = val+48;\n  }\n  for (val=66560; val<=66599; val+=1) {\n    map[val] = val+40;\n  }\n  for (val=65; val<=90; val+=1) {\n    map[val] = val+32;\n  }\n  for (val=192; val<=214; val+=1) {\n    map[val] = val+32;\n  }\n  for (val=913; val<=929; val+=1) {\n    map[val] = val+32;\n  }\n  for (val=1040; val<=1071; val+=1) {\n    map[val] = val+32;\n  }\n  for (val=65313; val<=65338; val+=1) {\n    map[val] = val+32;\n  }\n  ls = [\n216, 217, 218, 219, 220, 221, 222, 931,\n932, 933, 934, 935, 936, 937, 938, 939,\n  ];\n  for (ix=0; ix<16; ix++) {\n    val = ls[ix];\n    map[val] = val+32;\n  }\n  for (val=9398; val<=9423; val+=1) {\n    map[val] = val+26;\n  }\n  for (val=8544; val<=8559; val+=1) {\n    map[val] = val+16;\n  }\n  for (val=256; val<=302; val+=2) {\n    map[val] = val+1;\n  }\n  for (val=330; val<=374; val+=2) {\n    map[val] = val+1;\n  }\n  for (val=504; val<=542; val+=2) {\n    map[val] = val+1;\n  }\n  for (val=1120; val<=1152; val+=2) {\n    map[val] = val+1;\n  }\n  for (val=1162; val<=1214; val+=2) {\n    map[val] = val+1;\n  }\n  for (val=1232; val<=1268; val+=2) {\n    map[val] = val+1;\n  }\n  for (val=7680; val<=7828; val+=2) {\n    map[val] = val+1;\n  }\n  for (val=7840; val<=7928; val+=2) {\n    map[val] = val+1;\n  }\n  ls = [\n306, 308, 310, 313, 315, 317, 319, 321,\n323, 325, 327, 377, 379, 381, 386, 388,\n391, 395, 401, 408, 416, 418, 420, 423,\n428, 431, 435, 437, 440, 444, 453, 456,\n459, 461, 463, 465, 467, 469, 471, 473,\n475, 478, 480, 482, 484, 486, 488, 490,\n492, 494, 498, 500, 546, 548, 550, 552,\n554, 556, 558, 560, 562, 984, 986, 988,\n990, 992, 994, 996, 998, 1000, 1002, 1004,\n1006, 1015, 1018, 1217, 1219, 1221, 1223, 1225,\n1227, 1229, 1272, 1280, 1282, 1284, 1286, 1288,\n1290, 1292, 1294,\n  ];\n  for (ix=0; ix<91; ix++) {\n    val = ls[ix];\n    map[val] = val+1;\n  }\n  ls = [\n7944, 7945, 7946, 7947, 7948, 7949, 7950, 7951,\n7960, 7961, 7962, 7963, 7964, 7965, 7976, 7977,\n7978, 7979, 7980, 7981, 7982, 7983, 7992, 7993,\n7994, 7995, 7996, 7997, 7998, 7999, 8008, 8009,\n8010, 8011, 8012, 8013, 8025, 8027, 8029, 8031,\n8040, 8041, 8042, 8043, 8044, 8045, 8046, 8047,\n8072, 8073, 8074, 8075, 8076, 8077, 8078, 8079,\n8088, 8089, 8090, 8091, 8092, 8093, 8094, 8095,\n8104, 8105, 8106, 8107, 8108, 8109, 8110, 8111,\n8120, 8121, 8152, 8153, 8168, 8169,\n  ];\n  for (ix=0; ix<78; ix++) {\n    val = ls[ix];\n    map[val] = val-8;\n  }\n})();\n\n/* list all the special cases in unicode_title_table */\nvar unicode_title_table = {\n223: [ 83,115 ], 452: 453, 453: 453, 454: 453, 455: 456,\n456: 456, 457: 456, 458: 459, 459: 459, 460: 459,\n497: 498, 498: 498, 499: 498, 1415: [ 1333,1410 ], 8114: [ 8122,837 ],\n8115: 8124, 8116: [ 902,837 ], 8119: [ 913,834,837 ], 8124: 8124, 8130: [ 8138,837 ],\n8131: 8140, 8132: [ 905,837 ], 8135: [ 919,834,837 ], 8140: 8140, 8178: [ 8186,837 ],\n8179: 8188, 8180: [ 911,837 ], 8183: [ 937,834,837 ], 8188: 8188, 64256: [ 70,102 ],\n64257: [ 70,105 ], 64258: [ 70,108 ], 64259: [ 70,102,105 ], 64260: [ 70,102,108 ], 64261: [ 83,116 ],\n64262: [ 83,116 ], 64275: [ 1348,1398 ], 64276: [ 1348,1381 ], 64277: [ 1348,1387 ], 64278: [ 1358,1398 ],\n64279: [ 1348,1389 ]\n};\n/* add all the regular cases to unicode_title_table */\n(function() {\n  var ls, ix, val;\n  var map = unicode_title_table;\n  ls = [\n8072, 8073, 8074, 8075, 8076, 8077, 8078, 8079,\n8072, 8073, 8074, 8075, 8076, 8077, 8078, 8079,\n8088, 8089, 8090, 8091, 8092, 8093, 8094, 8095,\n8088, 8089, 8090, 8091, 8092, 8093, 8094, 8095,\n8104, 8105, 8106, 8107, 8108, 8109, 8110, 8111,\n8104, 8105, 8106, 8107, 8108, 8109, 8110, 8111,\n  ];\n  for (ix=0; ix<48; ix++) {\n    val = ls[ix];\n    map[ix+8064] = val;\n  }\n})();\n\n/* list all the special cases in unicode_decomp_table */\nvar unicode_decomp_table = {\n192: [ 65,768 ], 193: [ 65,769 ], 194: [ 65,770 ], 195: [ 65,771 ], 196: [ 65,776 ],\n197: [ 65,778 ], 199: [ 67,807 ], 200: [ 69,768 ], 201: [ 69,769 ], 202: [ 69,770 ],\n203: [ 69,776 ], 204: [ 73,768 ], 205: [ 73,769 ], 206: [ 73,770 ], 207: [ 73,776 ],\n209: [ 78,771 ], 210: [ 79,768 ], 211: [ 79,769 ], 212: [ 79,770 ], 213: [ 79,771 ],\n214: [ 79,776 ], 217: [ 85,768 ], 218: [ 85,769 ], 219: [ 85,770 ], 220: [ 85,776 ],\n221: [ 89,769 ], 224: [ 97,768 ], 225: [ 97,769 ], 226: [ 97,770 ], 227: [ 97,771 ],\n228: [ 97,776 ], 229: [ 97,778 ], 231: [ 99,807 ], 232: [ 101,768 ], 233: [ 101,769 ],\n234: [ 101,770 ], 235: [ 101,776 ], 236: [ 105,768 ], 237: [ 105,769 ], 238: [ 105,770 ],\n239: [ 105,776 ], 241: [ 110,771 ], 242: [ 111,768 ], 243: [ 111,769 ], 244: [ 111,770 ],\n245: [ 111,771 ], 246: [ 111,776 ], 249: [ 117,768 ], 250: [ 117,769 ], 251: [ 117,770 ],\n252: [ 117,776 ], 253: [ 121,769 ], 296: [ 73,771 ], 297: [ 105,771 ], 298: [ 73,772 ],\n299: [ 105,772 ], 300: [ 73,774 ], 301: [ 105,774 ], 302: [ 73,808 ], 303: [ 105,808 ],\n304: [ 73,775 ], 308: [ 74,770 ], 309: [ 106,770 ], 310: [ 75,807 ], 311: [ 107,807 ],\n313: [ 76,769 ], 314: [ 108,769 ], 315: [ 76,807 ], 316: [ 108,807 ], 317: [ 76,780 ],\n318: [ 108,780 ], 323: [ 78,769 ], 324: [ 110,769 ], 325: [ 78,807 ], 326: [ 110,807 ],\n327: [ 78,780 ], 328: [ 110,780 ], 332: [ 79,772 ], 333: [ 111,772 ], 334: [ 79,774 ],\n335: [ 111,774 ], 336: [ 79,779 ], 337: [ 111,779 ], 416: [ 79,795 ], 417: [ 111,795 ],\n431: [ 85,795 ], 432: [ 117,795 ], 478: [ 65,776,772 ], 479: [ 97,776,772 ], 480: [ 65,775,772 ],\n481: [ 97,775,772 ], 482: [ 198,772 ], 483: [ 230,772 ], 486: [ 71,780 ], 487: [ 103,780 ],\n488: [ 75,780 ], 489: [ 107,780 ], 490: [ 79,808 ], 491: [ 111,808 ], 492: [ 79,808,772 ],\n493: [ 111,808,772 ], 494: [ 439,780 ], 495: [ 658,780 ], 496: [ 106,780 ], 500: [ 71,769 ],\n501: [ 103,769 ], 542: [ 72,780 ], 543: [ 104,780 ], 550: [ 65,775 ], 551: [ 97,775 ],\n552: [ 69,807 ], 553: [ 101,807 ], 554: [ 79,776,772 ], 555: [ 111,776,772 ], 556: [ 79,771,772 ],\n557: [ 111,771,772 ], 558: [ 79,775 ], 559: [ 111,775 ], 560: [ 79,775,772 ], 561: [ 111,775,772 ],\n562: [ 89,772 ], 563: [ 121,772 ], 832: 768, 833: 769, 835: 787,\n836: [ 776,769 ], 884: 697, 894: 59, 901: [ 168,769 ], 902: [ 913,769 ],\n903: 183, 904: [ 917,769 ], 905: [ 919,769 ], 906: [ 921,769 ], 908: [ 927,769 ],\n910: [ 933,769 ], 911: [ 937,769 ], 912: [ 953,776,769 ], 938: [ 921,776 ], 939: [ 933,776 ],\n940: [ 945,769 ], 941: [ 949,769 ], 942: [ 951,769 ], 943: [ 953,769 ], 944: [ 965,776,769 ],\n970: [ 953,776 ], 971: [ 965,776 ], 972: [ 959,769 ], 973: [ 965,769 ], 974: [ 969,769 ],\n979: [ 978,769 ], 980: [ 978,776 ], 1024: [ 1045,768 ], 1025: [ 1045,776 ], 1027: [ 1043,769 ],\n1031: [ 1030,776 ], 1036: [ 1050,769 ], 1037: [ 1048,768 ], 1038: [ 1059,774 ], 1049: [ 1048,774 ],\n1081: [ 1080,774 ], 1104: [ 1077,768 ], 1105: [ 1077,776 ], 1107: [ 1075,769 ], 1111: [ 1110,776 ],\n1116: [ 1082,769 ], 1117: [ 1080,768 ], 1118: [ 1091,774 ], 1142: [ 1140,783 ], 1143: [ 1141,783 ],\n1217: [ 1046,774 ], 1218: [ 1078,774 ], 1232: [ 1040,774 ], 1233: [ 1072,774 ], 1234: [ 1040,776 ],\n1235: [ 1072,776 ], 1238: [ 1045,774 ], 1239: [ 1077,774 ], 1242: [ 1240,776 ], 1243: [ 1241,776 ],\n1244: [ 1046,776 ], 1245: [ 1078,776 ], 1246: [ 1047,776 ], 1247: [ 1079,776 ], 1250: [ 1048,772 ],\n1251: [ 1080,772 ], 1252: [ 1048,776 ], 1253: [ 1080,776 ], 1254: [ 1054,776 ], 1255: [ 1086,776 ],\n1258: [ 1256,776 ], 1259: [ 1257,776 ], 1260: [ 1069,776 ], 1261: [ 1101,776 ], 1262: [ 1059,772 ],\n1263: [ 1091,772 ], 1264: [ 1059,776 ], 1265: [ 1091,776 ], 1266: [ 1059,779 ], 1267: [ 1091,779 ],\n1268: [ 1063,776 ], 1269: [ 1095,776 ], 1272: [ 1067,776 ], 1273: [ 1099,776 ], 1570: [ 1575,1619 ],\n1571: [ 1575,1620 ], 1572: [ 1608,1620 ], 1573: [ 1575,1621 ], 1574: [ 1610,1620 ], 1728: [ 1749,1620 ],\n1730: [ 1729,1620 ], 1747: [ 1746,1620 ], 2345: [ 2344,2364 ], 2353: [ 2352,2364 ], 2356: [ 2355,2364 ],\n2392: [ 2325,2364 ], 2393: [ 2326,2364 ], 2394: [ 2327,2364 ], 2395: [ 2332,2364 ], 2396: [ 2337,2364 ],\n2397: [ 2338,2364 ], 2398: [ 2347,2364 ], 2399: [ 2351,2364 ], 2507: [ 2503,2494 ], 2508: [ 2503,2519 ],\n2524: [ 2465,2492 ], 2525: [ 2466,2492 ], 2527: [ 2479,2492 ], 2611: [ 2610,2620 ], 2614: [ 2616,2620 ],\n2649: [ 2582,2620 ], 2650: [ 2583,2620 ], 2651: [ 2588,2620 ], 2654: [ 2603,2620 ], 2888: [ 2887,2902 ],\n2891: [ 2887,2878 ], 2892: [ 2887,2903 ], 2908: [ 2849,2876 ], 2909: [ 2850,2876 ], 2964: [ 2962,3031 ],\n3018: [ 3014,3006 ], 3019: [ 3015,3006 ], 3020: [ 3014,3031 ], 3144: [ 3142,3158 ], 3264: [ 3263,3285 ],\n3271: [ 3270,3285 ], 3272: [ 3270,3286 ], 3274: [ 3270,3266 ], 3275: [ 3270,3266,3285 ], 3402: [ 3398,3390 ],\n3403: [ 3399,3390 ], 3404: [ 3398,3415 ], 3546: [ 3545,3530 ], 3548: [ 3545,3535 ], 3549: [ 3545,3535,3530 ],\n3550: [ 3545,3551 ], 3907: [ 3906,4023 ], 3917: [ 3916,4023 ], 3922: [ 3921,4023 ], 3927: [ 3926,4023 ],\n3932: [ 3931,4023 ], 3945: [ 3904,4021 ], 3955: [ 3953,3954 ], 3957: [ 3953,3956 ], 3958: [ 4018,3968 ],\n3960: [ 4019,3968 ], 3969: [ 3953,3968 ], 3987: [ 3986,4023 ], 3997: [ 3996,4023 ], 4002: [ 4001,4023 ],\n4007: [ 4006,4023 ], 4012: [ 4011,4023 ], 4025: [ 3984,4021 ], 4134: [ 4133,4142 ], 7835: [ 383,775 ],\n7960: [ 917,787 ], 7961: [ 917,788 ], 7962: [ 917,787,768 ], 7963: [ 917,788,768 ], 7964: [ 917,787,769 ],\n7965: [ 917,788,769 ], 8008: [ 927,787 ], 8009: [ 927,788 ], 8010: [ 927,787,768 ], 8011: [ 927,788,768 ],\n8012: [ 927,787,769 ], 8013: [ 927,788,769 ], 8016: [ 965,787 ], 8017: [ 965,788 ], 8018: [ 965,787,768 ],\n8019: [ 965,788,768 ], 8020: [ 965,787,769 ], 8021: [ 965,788,769 ], 8022: [ 965,787,834 ], 8023: [ 965,788,834 ],\n8025: [ 933,788 ], 8027: [ 933,788,768 ], 8029: [ 933,788,769 ], 8118: [ 945,834 ], 8119: [ 945,834,837 ],\n8120: [ 913,774 ], 8121: [ 913,772 ], 8122: [ 913,768 ], 8123: [ 913,769 ], 8124: [ 913,837 ],\n8126: 953, 8129: [ 168,834 ], 8130: [ 951,768,837 ], 8131: [ 951,837 ], 8132: [ 951,769,837 ],\n8134: [ 951,834 ], 8135: [ 951,834,837 ], 8136: [ 917,768 ], 8137: [ 917,769 ], 8138: [ 919,768 ],\n8139: [ 919,769 ], 8140: [ 919,837 ], 8141: [ 8127,768 ], 8142: [ 8127,769 ], 8143: [ 8127,834 ],\n8144: [ 953,774 ], 8145: [ 953,772 ], 8146: [ 953,776,768 ], 8147: [ 953,776,769 ], 8150: [ 953,834 ],\n8151: [ 953,776,834 ], 8152: [ 921,774 ], 8153: [ 921,772 ], 8154: [ 921,768 ], 8155: [ 921,769 ],\n8178: [ 969,768,837 ], 8179: [ 969,837 ], 8180: [ 969,769,837 ], 8182: [ 969,834 ], 8183: [ 969,834,837 ],\n8184: [ 927,768 ], 8185: [ 927,769 ], 8186: [ 937,768 ], 8187: [ 937,769 ], 8188: [ 937,837 ],\n8189: 180, 8192: 8194, 8193: 8195, 8486: 937, 8490: 75,\n8491: [ 65,778 ], 8602: [ 8592,824 ], 8603: [ 8594,824 ], 8622: [ 8596,824 ], 8653: [ 8656,824 ],\n8654: [ 8660,824 ], 8655: [ 8658,824 ], 8708: [ 8707,824 ], 8713: [ 8712,824 ], 8716: [ 8715,824 ],\n8740: [ 8739,824 ], 8742: [ 8741,824 ], 8769: [ 8764,824 ], 8772: [ 8771,824 ], 8775: [ 8773,824 ],\n8777: [ 8776,824 ], 8800: [ 61,824 ], 8802: [ 8801,824 ], 8813: [ 8781,824 ], 8814: [ 60,824 ],\n8815: [ 62,824 ], 8816: [ 8804,824 ], 8817: [ 8805,824 ], 8820: [ 8818,824 ], 8821: [ 8819,824 ],\n8824: [ 8822,824 ], 8825: [ 8823,824 ], 8832: [ 8826,824 ], 8833: [ 8827,824 ], 8836: [ 8834,824 ],\n8837: [ 8835,824 ], 8840: [ 8838,824 ], 8841: [ 8839,824 ], 8876: [ 8866,824 ], 8877: [ 8872,824 ],\n8878: [ 8873,824 ], 8879: [ 8875,824 ], 8928: [ 8828,824 ], 8929: [ 8829,824 ], 8930: [ 8849,824 ],\n8931: [ 8850,824 ], 8938: [ 8882,824 ], 8939: [ 8883,824 ], 8940: [ 8884,824 ], 8941: [ 8885,824 ],\n9001: 12296, 9002: 12297, 10972: [ 10973,824 ], 12364: [ 12363,12441 ], 12366: [ 12365,12441 ],\n12368: [ 12367,12441 ], 12370: [ 12369,12441 ], 12372: [ 12371,12441 ], 12374: [ 12373,12441 ], 12376: [ 12375,12441 ],\n12378: [ 12377,12441 ], 12380: [ 12379,12441 ], 12382: [ 12381,12441 ], 12384: [ 12383,12441 ], 12386: [ 12385,12441 ],\n12389: [ 12388,12441 ], 12391: [ 12390,12441 ], 12393: [ 12392,12441 ], 12400: [ 12399,12441 ], 12401: [ 12399,12442 ],\n12403: [ 12402,12441 ], 12404: [ 12402,12442 ], 12406: [ 12405,12441 ], 12407: [ 12405,12442 ], 12409: [ 12408,12441 ],\n12410: [ 12408,12442 ], 12412: [ 12411,12441 ], 12413: [ 12411,12442 ], 12436: [ 12358,12441 ], 12446: [ 12445,12441 ],\n12460: [ 12459,12441 ], 12462: [ 12461,12441 ], 12464: [ 12463,12441 ], 12466: [ 12465,12441 ], 12468: [ 12467,12441 ],\n12470: [ 12469,12441 ], 12472: [ 12471,12441 ], 12474: [ 12473,12441 ], 12476: [ 12475,12441 ], 12478: [ 12477,12441 ],\n12480: [ 12479,12441 ], 12482: [ 12481,12441 ], 12485: [ 12484,12441 ], 12487: [ 12486,12441 ], 12489: [ 12488,12441 ],\n12496: [ 12495,12441 ], 12497: [ 12495,12442 ], 12499: [ 12498,12441 ], 12500: [ 12498,12442 ], 12502: [ 12501,12441 ],\n12503: [ 12501,12442 ], 12505: [ 12504,12441 ], 12506: [ 12504,12442 ], 12508: [ 12507,12441 ], 12509: [ 12507,12442 ],\n12532: [ 12454,12441 ], 12535: [ 12527,12441 ], 12536: [ 12528,12441 ], 12537: [ 12529,12441 ], 12538: [ 12530,12441 ],\n12542: [ 12541,12441 ], 64016: 22618, 64018: 26228, 64021: 20958, 64022: 29482,\n64023: 30410, 64024: 31036, 64025: 31070, 64026: 31077, 64027: 31119,\n64028: 38742, 64029: 31934, 64030: 32701, 64032: 34322, 64034: 35576,\n64037: 36920, 64038: 37117, 64042: 39151, 64043: 39164, 64044: 39208,\n64045: 40372, 64285: [ 1497,1460 ], 64287: [ 1522,1463 ], 64298: [ 1513,1473 ], 64299: [ 1513,1474 ],\n64300: [ 1513,1468,1473 ], 64301: [ 1513,1468,1474 ], 64302: [ 1488,1463 ], 64303: [ 1488,1464 ], 64304: [ 1488,1468 ],\n64305: [ 1489,1468 ], 64306: [ 1490,1468 ], 64307: [ 1491,1468 ], 64308: [ 1492,1468 ], 64309: [ 1493,1468 ],\n64310: [ 1494,1468 ], 64312: [ 1496,1468 ], 64313: [ 1497,1468 ], 64314: [ 1498,1468 ], 64315: [ 1499,1468 ],\n64316: [ 1500,1468 ], 64318: [ 1502,1468 ], 64320: [ 1504,1468 ], 64321: [ 1505,1468 ], 64323: [ 1507,1468 ],\n64324: [ 1508,1468 ], 64326: [ 1510,1468 ], 64327: [ 1511,1468 ], 64328: [ 1512,1468 ], 64329: [ 1513,1468 ],\n64330: [ 1514,1468 ], 64331: [ 1493,1465 ], 64332: [ 1489,1471 ], 64333: [ 1499,1471 ], 64334: [ 1508,1471 ],\n119134: [ 119127,119141 ], 119135: [ 119128,119141 ], 119136: [ 119128,119141,119150 ], 119137: [ 119128,119141,119151 ], 119138: [ 119128,119141,119152 ],\n119139: [ 119128,119141,119153 ], 119140: [ 119128,119141,119154 ], 119227: [ 119225,119141 ], 119228: [ 119226,119141 ], 119229: [ 119225,119141,119150 ],\n119230: [ 119226,119141,119150 ], 119231: [ 119225,119141,119151 ], 119232: [ 119226,119141,119151 ]\n};\n/* add all the regular cases to unicode_decomp_table */\n(function() {\n  var ls, ix, val;\n  var map = unicode_decomp_table;\n  ls = [\n[121,776], [65,772], [97,772], [65,774], [97,774], [65,808], [97,808], [67,769],\n[99,769], [67,770], [99,770], [67,775], [99,775], [67,780], [99,780], [68,780],\n[100,780],\n  ];\n  for (ix=0; ix<17; ix++) {\n    val = ls[ix];\n    map[ix+255] = val;\n  }\n  ls = [\n[69,772], [101,772], [69,774], [101,774], [69,775], [101,775], [69,808], [101,808],\n[69,780], [101,780], [71,770], [103,770], [71,774], [103,774], [71,775], [103,775],\n[71,807], [103,807], [72,770], [104,770],\n  ];\n  for (ix=0; ix<20; ix++) {\n    val = ls[ix];\n    map[ix+274] = val;\n  }\n  ls = [\n[82,769], [114,769], [82,807], [114,807], [82,780], [114,780], [83,769], [115,769],\n[83,770], [115,770], [83,807], [115,807], [83,780], [115,780], [84,807], [116,807],\n[84,780], [116,780],\n  ];\n  for (ix=0; ix<18; ix++) {\n    val = ls[ix];\n    map[ix+340] = val;\n  }\n  ls = [\n[85,771], [117,771], [85,772], [117,772], [85,774], [117,774], [85,778], [117,778],\n[85,779], [117,779], [85,808], [117,808], [87,770], [119,770], [89,770], [121,770],\n[89,776], [90,769], [122,769], [90,775], [122,775], [90,780], [122,780],\n  ];\n  for (ix=0; ix<23; ix++) {\n    val = ls[ix];\n    map[ix+360] = val;\n  }\n  ls = [\n[65,780], [97,780], [73,780], [105,780], [79,780], [111,780], [85,780], [117,780],\n[85,776,772], [117,776,772], [85,776,769], [117,776,769], [85,776,780], [117,776,780], [85,776,768], [117,776,768],\n  ];\n  for (ix=0; ix<16; ix++) {\n    val = ls[ix];\n    map[ix+461] = val;\n  }\n  ls = [\n[78,768], [110,768], [65,778,769], [97,778,769], [198,769], [230,769], [216,769], [248,769],\n[65,783], [97,783], [65,785], [97,785], [69,783], [101,783], [69,785], [101,785],\n[73,783], [105,783], [73,785], [105,785], [79,783], [111,783], [79,785], [111,785],\n[82,783], [114,783], [82,785], [114,785], [85,783], [117,783], [85,785], [117,785],\n[83,806], [115,806], [84,806], [116,806],\n  ];\n  for (ix=0; ix<36; ix++) {\n    val = ls[ix];\n    map[ix+504] = val;\n  }\n  ls = [\n[65,805], [97,805], [66,775], [98,775], [66,803], [98,803], [66,817], [98,817],\n[67,807,769], [99,807,769], [68,775], [100,775], [68,803], [100,803], [68,817], [100,817],\n[68,807], [100,807], [68,813], [100,813], [69,772,768], [101,772,768], [69,772,769], [101,772,769],\n[69,813], [101,813], [69,816], [101,816], [69,807,774], [101,807,774], [70,775], [102,775],\n[71,772], [103,772], [72,775], [104,775], [72,803], [104,803], [72,776], [104,776],\n[72,807], [104,807], [72,814], [104,814], [73,816], [105,816], [73,776,769], [105,776,769],\n[75,769], [107,769], [75,803], [107,803], [75,817], [107,817], [76,803], [108,803],\n[76,803,772], [108,803,772], [76,817], [108,817], [76,813], [108,813], [77,769], [109,769],\n[77,775], [109,775], [77,803], [109,803], [78,775], [110,775], [78,803], [110,803],\n[78,817], [110,817], [78,813], [110,813], [79,771,769], [111,771,769], [79,771,776], [111,771,776],\n[79,772,768], [111,772,768], [79,772,769], [111,772,769], [80,769], [112,769], [80,775], [112,775],\n[82,775], [114,775], [82,803], [114,803], [82,803,772], [114,803,772], [82,817], [114,817],\n[83,775], [115,775], [83,803], [115,803], [83,769,775], [115,769,775], [83,780,775], [115,780,775],\n[83,803,775], [115,803,775], [84,775], [116,775], [84,803], [116,803], [84,817], [116,817],\n[84,813], [116,813], [85,804], [117,804], [85,816], [117,816], [85,813], [117,813],\n[85,771,769], [117,771,769], [85,772,776], [117,772,776], [86,771], [118,771], [86,803], [118,803],\n[87,768], [119,768], [87,769], [119,769], [87,776], [119,776], [87,775], [119,775],\n[87,803], [119,803], [88,775], [120,775], [88,776], [120,776], [89,775], [121,775],\n[90,770], [122,770], [90,803], [122,803], [90,817], [122,817], [104,817], [116,776],\n[119,778], [121,778],\n  ];\n  for (ix=0; ix<154; ix++) {\n    val = ls[ix];\n    map[ix+7680] = val;\n  }\n  ls = [\n[65,803], [97,803], [65,777], [97,777], [65,770,769], [97,770,769], [65,770,768], [97,770,768],\n[65,770,777], [97,770,777], [65,770,771], [97,770,771], [65,803,770], [97,803,770], [65,774,769], [97,774,769],\n[65,774,768], [97,774,768], [65,774,777], [97,774,777], [65,774,771], [97,774,771], [65,803,774], [97,803,774],\n[69,803], [101,803], [69,777], [101,777], [69,771], [101,771], [69,770,769], [101,770,769],\n[69,770,768], [101,770,768], [69,770,777], [101,770,777], [69,770,771], [101,770,771], [69,803,770], [101,803,770],\n[73,777], [105,777], [73,803], [105,803], [79,803], [111,803], [79,777], [111,777],\n[79,770,769], [111,770,769], [79,770,768], [111,770,768], [79,770,777], [111,770,777], [79,770,771], [111,770,771],\n[79,803,770], [111,803,770], [79,795,769], [111,795,769], [79,795,768], [111,795,768], [79,795,777], [111,795,777],\n[79,795,771], [111,795,771], [79,795,803], [111,795,803], [85,803], [117,803], [85,777], [117,777],\n[85,795,769], [117,795,769], [85,795,768], [117,795,768], [85,795,777], [117,795,777], [85,795,771], [117,795,771],\n[85,795,803], [117,795,803], [89,768], [121,768], [89,803], [121,803], [89,777], [121,777],\n[89,771], [121,771],\n  ];\n  for (ix=0; ix<90; ix++) {\n    val = ls[ix];\n    map[ix+7840] = val;\n  }\n  ls = [\n[945,787], [945,788], [945,787,768], [945,788,768], [945,787,769], [945,788,769], [945,787,834], [945,788,834],\n[913,787], [913,788], [913,787,768], [913,788,768], [913,787,769], [913,788,769], [913,787,834], [913,788,834],\n[949,787], [949,788], [949,787,768], [949,788,768], [949,787,769], [949,788,769],\n  ];\n  for (ix=0; ix<22; ix++) {\n    val = ls[ix];\n    map[ix+7936] = val;\n  }\n  ls = [\n[951,787], [951,788], [951,787,768], [951,788,768], [951,787,769], [951,788,769], [951,787,834], [951,788,834],\n[919,787], [919,788], [919,787,768], [919,788,768], [919,787,769], [919,788,769], [919,787,834], [919,788,834],\n[953,787], [953,788], [953,787,768], [953,788,768], [953,787,769], [953,788,769], [953,787,834], [953,788,834],\n[921,787], [921,788], [921,787,768], [921,788,768], [921,787,769], [921,788,769], [921,787,834], [921,788,834],\n[959,787], [959,788], [959,787,768], [959,788,768], [959,787,769], [959,788,769],\n  ];\n  for (ix=0; ix<38; ix++) {\n    val = ls[ix];\n    map[ix+7968] = val;\n  }\n  ls = [\n[933,788,834], [969,787], [969,788], [969,787,768], [969,788,768], [969,787,769], [969,788,769], [969,787,834],\n[969,788,834], [937,787], [937,788], [937,787,768], [937,788,768], [937,787,769], [937,788,769], [937,787,834],\n[937,788,834], [945,768], [945,769], [949,768], [949,769], [951,768], [951,769], [953,768],\n[953,769], [959,768], [959,769], [965,768], [965,769], [969,768], [969,769],\n  ];\n  for (ix=0; ix<31; ix++) {\n    val = ls[ix];\n    map[ix+8031] = val;\n  }\n  ls = [\n[945,787,837], [945,788,837], [945,787,768,837], [945,788,768,837], [945,787,769,837], [945,788,769,837], [945,787,834,837], [945,788,834,837],\n[913,787,837], [913,788,837], [913,787,768,837], [913,788,768,837], [913,787,769,837], [913,788,769,837], [913,787,834,837], [913,788,834,837],\n[951,787,837], [951,788,837], [951,787,768,837], [951,788,768,837], [951,787,769,837], [951,788,769,837], [951,787,834,837], [951,788,834,837],\n[919,787,837], [919,788,837], [919,787,768,837], [919,788,768,837], [919,787,769,837], [919,788,769,837], [919,787,834,837], [919,788,834,837],\n[969,787,837], [969,788,837], [969,787,768,837], [969,788,768,837], [969,787,769,837], [969,788,769,837], [969,787,834,837], [969,788,834,837],\n[937,787,837], [937,788,837], [937,787,768,837], [937,788,768,837], [937,787,769,837], [937,788,769,837], [937,787,834,837], [937,788,834,837],\n[945,774], [945,772], [945,768,837], [945,837], [945,769,837],\n  ];\n  for (ix=0; ix<53; ix++) {\n    val = ls[ix];\n    map[ix+8064] = val;\n  }\n  ls = [\n[8190,768], [8190,769], [8190,834], [965,774], [965,772], [965,776,768], [965,776,769], [961,787],\n[961,788], [965,834], [965,776,834], [933,774], [933,772], [933,768], [933,769], [929,788],\n[168,768], [168,769], 96,\n  ];\n  for (ix=0; ix<19; ix++) {\n    val = ls[ix];\n    map[ix+8157] = val;\n  }\n  ls = [\n35912, 26356, 36554, 36040, 28369, 20018, 21477, 40860,\n40860, 22865, 37329, 21895, 22856, 25078, 30313, 32645,\n34367, 34746, 35064, 37007, 27138, 27931, 28889, 29662,\n33853, 37226, 39409, 20098, 21365, 27396, 29211, 34349,\n40478, 23888, 28651, 34253, 35172, 25289, 33240, 34847,\n24266, 26391, 28010, 29436, 37070, 20358, 20919, 21214,\n25796, 27347, 29200, 30439, 32769, 34310, 34396, 36335,\n38706, 39791, 40442, 30860, 31103, 32160, 33737, 37636,\n40575, 35542, 22751, 24324, 31840, 32894, 29282, 30922,\n36034, 38647, 22744, 23650, 27155, 28122, 28431, 32047,\n32311, 38475, 21202, 32907, 20956, 20940, 31260, 32190,\n33777, 38517, 35712, 25295, 27138, 35582, 20025, 23527,\n24594, 29575, 30064, 21271, 30971, 20415, 24489, 19981,\n27852, 25976, 32034, 21443, 22622, 30465, 33865, 35498,\n27578, 36784, 27784, 25342, 33509, 25504, 30053, 20142,\n20841, 20937, 26753, 31975, 33391, 35538, 37327, 21237,\n21570, 22899, 24300, 26053, 28670, 31018, 38317, 39530,\n40599, 40654, 21147, 26310, 27511, 36706, 24180, 24976,\n25088, 25754, 28451, 29001, 29833, 31178, 32244, 32879,\n36646, 34030, 36899, 37706, 21015, 21155, 21693, 28872,\n35010, 35498, 24265, 24565, 25467, 27566, 31806, 29557,\n20196, 22265, 23527, 23994, 24604, 29618, 29801, 32666,\n32838, 37428, 38646, 38728, 38936, 20363, 31150, 37300,\n38584, 24801, 20102, 20698, 23534, 23615, 26009, 27138,\n29134, 30274, 34044, 36988, 40845, 26248, 38446, 21129,\n26491, 26611, 27969, 28316, 29705, 30041, 30827, 32016,\n39006, 20845, 25134, 38520, 20523, 23833, 28138, 36650,\n24459, 24900, 26647, 29575, 38534, 21033, 21519, 23653,\n26131, 26446, 26792, 27877, 29702, 30178, 32633, 35023,\n35041, 37324, 38626, 21311, 28346, 21533, 29136, 29848,\n34298, 38563, 40023, 40607, 26519, 28107, 33256, 31435,\n31520, 31890, 29376, 28825, 35672, 20160, 33590, 21050,\n20999, 24230, 25299, 31958, 23429, 27934, 26292, 36667,\n34892, 38477, 35211, 24275, 20800, 21952,\n  ];\n  for (ix=0; ix<270; ix++) {\n    val = ls[ix];\n    map[ix+63744] = val;\n  }\n  ls = [\n20398, 20711, 20813, 21193, 21220, 21329, 21917, 22022,\n22120, 22592, 22696, 23652, 23662, 24724, 24936, 24974,\n25074, 25935, 26082, 26257, 26757, 28023, 28186, 28450,\n29038, 29227, 29730, 30865, 31038, 31049, 31048, 31056,\n31062, 31069, 31117, 31118, 31296, 31361, 31680, 32244,\n32265, 32321, 32626, 32773, 33261, 33401, 33401, 33879,\n35088, 35222, 35585, 35641, 36051, 36104, 36790, 36920,\n38627, 38911, 38971,\n  ];\n  for (ix=0; ix<59; ix++) {\n    val = ls[ix];\n    map[ix+64048] = val;\n  }\n  ls = [\n20029, 20024, 20033, 131362, 20320, 20398, 20411, 20482,\n20602, 20633, 20711, 20687, 13470, 132666, 20813, 20820,\n20836, 20855, 132380, 13497, 20839, 20877, 132427, 20887,\n20900, 20172, 20908, 20917, 168415, 20981, 20995, 13535,\n21051, 21062, 21106, 21111, 13589, 21191, 21193, 21220,\n21242, 21253, 21254, 21271, 21321, 21329, 21338, 21363,\n21373, 21375, 21375, 21375, 133676, 28784, 21450, 21471,\n133987, 21483, 21489, 21510, 21662, 21560, 21576, 21608,\n21666, 21750, 21776, 21843, 21859, 21892, 21892, 21913,\n21931, 21939, 21954, 22294, 22022, 22295, 22097, 22132,\n20999, 22766, 22478, 22516, 22541, 22411, 22578, 22577,\n22700, 136420, 22770, 22775, 22790, 22810, 22818, 22882,\n136872, 136938, 23020, 23067, 23079, 23000, 23142, 14062,\n14076, 23304, 23358, 23358, 137672, 23491, 23512, 23527,\n23539, 138008, 23551, 23558, 24403, 23586, 14209, 23648,\n23662, 23744, 23693, 138724, 23875, 138726, 23918, 23915,\n23932, 24033, 24034, 14383, 24061, 24104, 24125, 24169,\n14434, 139651, 14460, 24240, 24243, 24246, 24266, 172946,\n24318, 140081, 140081, 33281, 24354, 24354, 14535, 144056,\n156122, 24418, 24427, 14563, 24474, 24525, 24535, 24569,\n24705, 14650, 14620, 24724, 141012, 24775, 24904, 24908,\n24910, 24908, 24954, 24974, 25010, 24996, 25007, 25054,\n25074, 25078, 25104, 25115, 25181, 25265, 25300, 25424,\n142092, 25405, 25340, 25448, 25475, 25572, 142321, 25634,\n25541, 25513, 14894, 25705, 25726, 25757, 25719, 14956,\n25935, 25964, 143370, 26083, 26360, 26185, 15129, 26257,\n15112, 15076, 20882, 20885, 26368, 26268, 32941, 17369,\n26391, 26395, 26401, 26462, 26451, 144323, 15177, 26618,\n26501, 26706, 26757, 144493, 26766, 26655, 26900, 15261,\n26946, 27043, 27114, 27304, 145059, 27355, 15384, 27425,\n145575, 27476, 15438, 27506, 27551, 27578, 27579, 146061,\n138507, 146170, 27726, 146620, 27839, 27853, 27751, 27926,\n27966, 28023, 27969, 28009, 28024, 28037, 146718, 27956,\n28207, 28270, 15667, 28363, 28359, 147153, 28153, 28526,\n147294, 147342, 28614, 28729, 28702, 28699, 15766, 28746,\n28797, 28791, 28845, 132389, 28997, 148067, 29084, 148395,\n29224, 29237, 29264, 149000, 29312, 29333, 149301, 149524,\n29562, 29579, 16044, 29605, 16056, 16056, 29767, 29788,\n29809, 29829, 29898, 16155, 29988, 150582, 30014, 150674,\n30064, 139679, 30224, 151457, 151480, 151620, 16380, 16392,\n30452, 151795, 151794, 151833, 151859, 30494, 30495, 30495,\n30538, 16441, 30603, 16454, 16534, 152605, 30798, 30860,\n30924, 16611, 153126, 31062, 153242, 153285, 31119, 31211,\n16687, 31296, 31306, 31311, 153980, 154279, 154279, 31470,\n16898, 154539, 31686, 31689, 16935, 154752, 31954, 17056,\n31976, 31971, 32000, 155526, 32099, 17153, 32199, 32258,\n32325, 17204, 156200, 156231, 17241, 156377, 32634, 156478,\n32661, 32762, 32773, 156890, 156963, 32864, 157096, 32880,\n144223, 17365, 32946, 33027, 17419, 33086, 23221, 157607,\n157621, 144275, 144284, 33281, 33284, 36766, 17515, 33425,\n33419, 33437, 21171, 33457, 33459, 33469, 33510, 158524,\n33509, 33565, 33635, 33709, 33571, 33725, 33767, 33879,\n33619, 33738, 33740, 33756, 158774, 159083, 158933, 17707,\n34033, 34035, 34070, 160714, 34148, 159532, 17757, 17761,\n159665, 159954, 17771, 34384, 34396, 34407, 34409, 34473,\n34440, 34574, 34530, 34681, 34600, 34667, 34694, 17879,\n34785, 34817, 17913, 34912, 34915, 161383, 35031, 35038,\n17973, 35066, 13499, 161966, 162150, 18110, 18119, 35488,\n35565, 35722, 35925, 162984, 36011, 36033, 36123, 36215,\n163631, 133124, 36299, 36284, 36336, 133342, 36564, 36664,\n165330, 165357, 37012, 37105, 37137, 165678, 37147, 37432,\n37591, 37592, 37500, 37881, 37909, 166906, 38283, 18837,\n38327, 167287, 18918, 38595, 23986, 38691, 168261, 168474,\n19054, 19062, 38880, 168970, 19122, 169110, 38923, 38923,\n38953, 169398, 39138, 19251, 39209, 39335, 39362, 39422,\n19406, 170800, 39698, 40000, 40189, 19662, 19693, 40295,\n172238, 19704, 172293, 172558, 172689, 40635, 19798, 40697,\n40702, 40709, 40719, 40726, 40763, 173568,\n  ];\n  for (ix=0; ix<542; ix++) {\n    val = ls[ix];\n    map[ix+194560] = val;\n  }\n})();\n\n/* list all the special cases in unicode_combin_table */\nvar unicode_combin_table = {\n768: 230, 769: 230, 770: 230, 771: 230, 772: 230,\n773: 230, 774: 230, 775: 230, 776: 230, 777: 230,\n778: 230, 779: 230, 780: 230, 781: 230, 782: 230,\n783: 230, 784: 230, 785: 230, 786: 230, 787: 230,\n788: 230, 789: 232, 790: 220, 791: 220, 792: 220,\n793: 220, 794: 232, 795: 216, 796: 220, 797: 220,\n798: 220, 799: 220, 800: 220, 801: 202, 802: 202,\n803: 220, 804: 220, 805: 220, 806: 220, 807: 202,\n808: 202, 809: 220, 810: 220, 811: 220, 812: 220,\n813: 220, 814: 220, 815: 220, 816: 220, 817: 220,\n818: 220, 819: 220, 820: 1, 821: 1, 822: 1,\n823: 1, 824: 1, 825: 220, 826: 220, 827: 220,\n828: 220, 829: 230, 830: 230, 831: 230, 832: 230,\n833: 230, 834: 230, 835: 230, 836: 230, 837: 240,\n838: 230, 839: 220, 840: 220, 841: 220, 842: 230,\n843: 230, 844: 230, 845: 220, 846: 220, 848: 230,\n849: 230, 850: 230, 851: 220, 852: 220, 853: 220,\n854: 220, 855: 230, 861: 234, 862: 234, 863: 233,\n864: 234, 865: 234, 866: 233, 867: 230, 868: 230,\n869: 230, 870: 230, 871: 230, 872: 230, 873: 230,\n874: 230, 875: 230, 876: 230, 877: 230, 878: 230,\n879: 230, 1155: 230, 1156: 230, 1157: 230, 1158: 230,\n1425: 220, 1426: 230, 1427: 230, 1428: 230, 1429: 230,\n1430: 220, 1431: 230, 1432: 230, 1433: 230, 1434: 222,\n1435: 220, 1436: 230, 1437: 230, 1438: 230, 1439: 230,\n1440: 230, 1441: 230, 1443: 220, 1444: 220, 1445: 220,\n1446: 220, 1447: 220, 1448: 230, 1449: 230, 1450: 220,\n1451: 230, 1452: 230, 1453: 222, 1454: 228, 1455: 230,\n1456: 10, 1457: 11, 1458: 12, 1459: 13, 1460: 14,\n1461: 15, 1462: 16, 1463: 17, 1464: 18, 1465: 19,\n1467: 20, 1468: 21, 1469: 22, 1471: 23, 1473: 24,\n1474: 25, 1476: 230, 1552: 230, 1553: 230, 1554: 230,\n1555: 230, 1556: 230, 1557: 230, 1611: 27, 1612: 28,\n1613: 29, 1614: 30, 1615: 31, 1616: 32, 1617: 33,\n1618: 34, 1619: 230, 1620: 230, 1621: 220, 1622: 220,\n1623: 230, 1624: 230, 1648: 35, 1750: 230, 1751: 230,\n1752: 230, 1753: 230, 1754: 230, 1755: 230, 1756: 230,\n1759: 230, 1760: 230, 1761: 230, 1762: 230, 1763: 220,\n1764: 230, 1767: 230, 1768: 230, 1770: 220, 1771: 230,\n1772: 230, 1773: 220, 1809: 36, 1840: 230, 1841: 220,\n1842: 230, 1843: 230, 1844: 220, 1845: 230, 1846: 230,\n1847: 220, 1848: 220, 1849: 220, 1850: 230, 1851: 220,\n1852: 220, 1853: 230, 1854: 220, 1855: 230, 1856: 230,\n1857: 230, 1858: 220, 1859: 230, 1860: 220, 1861: 230,\n1862: 220, 1863: 230, 1864: 220, 1865: 230, 1866: 230,\n2364: 7, 2381: 9, 2385: 230, 2386: 220, 2387: 230,\n2388: 230, 2492: 7, 2509: 9, 2620: 7, 2637: 9,\n2748: 7, 2765: 9, 2876: 7, 2893: 9, 3021: 9,\n3149: 9, 3157: 84, 3158: 91, 3260: 7, 3277: 9,\n3405: 9, 3530: 9, 3640: 103, 3641: 103, 3642: 9,\n3656: 107, 3657: 107, 3658: 107, 3659: 107, 3768: 118,\n3769: 118, 3784: 122, 3785: 122, 3786: 122, 3787: 122,\n3864: 220, 3865: 220, 3893: 220, 3895: 220, 3897: 216,\n3953: 129, 3954: 130, 3956: 132, 3962: 130, 3963: 130,\n3964: 130, 3965: 130, 3968: 130, 3970: 230, 3971: 230,\n3972: 9, 3974: 230, 3975: 230, 4038: 220, 4151: 7,\n4153: 9, 5908: 9, 5940: 9, 6098: 9, 6109: 230,\n6313: 228, 6457: 222, 6458: 230, 6459: 220, 8400: 230,\n8401: 230, 8402: 1, 8403: 1, 8404: 230, 8405: 230,\n8406: 230, 8407: 230, 8408: 1, 8409: 1, 8410: 1,\n8411: 230, 8412: 230, 8417: 230, 8421: 1, 8422: 1,\n8423: 230, 8424: 220, 8425: 230, 8426: 1, 12330: 218,\n12331: 228, 12332: 232, 12333: 222, 12334: 224, 12335: 224,\n12441: 8, 12442: 8, 64286: 26, 65056: 230, 65057: 230,\n65058: 230, 65059: 230, 119141: 216, 119142: 216, 119143: 1,\n119144: 1, 119145: 1, 119149: 226, 119150: 216, 119151: 216,\n119152: 216, 119153: 216, 119154: 216, 119163: 220, 119164: 220,\n119165: 220, 119166: 220, 119167: 220, 119168: 220, 119169: 220,\n119170: 220, 119173: 230, 119174: 230, 119175: 230, 119176: 230,\n119177: 230, 119178: 220, 119179: 220, 119210: 230, 119211: 230,\n119212: 230, 119213: 230\n};\n\n/* list all of unicode_compo_table */\nvar unicode_compo_table = {\n 60: { 824:8814 },\n 61: { 824:8800 },\n 62: { 824:8815 },\n 65: { 768:192, 769:193, 770:194, 771:195, 772:256, 774:258, 775:550, 776:196, 777:7842, 778:197, 780:461, 783:512, 785:514, 803:7840, 805:7680, 808:260 },\n 66: { 775:7682, 803:7684, 817:7686 },\n 67: { 769:262, 770:264, 775:266, 780:268, 807:199 },\n 68: { 775:7690, 780:270, 803:7692, 807:7696, 813:7698, 817:7694 },\n 69: { 768:200, 769:201, 770:202, 771:7868, 772:274, 774:276, 775:278, 776:203, 777:7866, 780:282, 783:516, 785:518, 803:7864, 807:552, 808:280, 813:7704, 816:7706 },\n 70: { 775:7710 },\n 71: { 769:500, 770:284, 772:7712, 774:286, 775:288, 780:486, 807:290 },\n 72: { 770:292, 775:7714, 776:7718, 780:542, 803:7716, 807:7720, 814:7722 },\n 73: { 768:204, 769:205, 770:206, 771:296, 772:298, 774:300, 775:304, 776:207, 777:7880, 780:463, 783:520, 785:522, 803:7882, 808:302, 816:7724 },\n 74: { 770:308 },\n 75: { 769:7728, 780:488, 803:7730, 807:310, 817:7732 },\n 76: { 769:313, 780:317, 803:7734, 807:315, 813:7740, 817:7738 },\n 77: { 769:7742, 775:7744, 803:7746 },\n 78: { 768:504, 769:323, 771:209, 775:7748, 780:327, 803:7750, 807:325, 813:7754, 817:7752 },\n 79: { 768:210, 769:211, 770:212, 771:213, 772:332, 774:334, 775:558, 776:214, 777:7886, 779:336, 780:465, 783:524, 785:526, 795:416, 803:7884, 808:490 },\n 80: { 769:7764, 775:7766 },\n 82: { 769:340, 775:7768, 780:344, 783:528, 785:530, 803:7770, 807:342, 817:7774 },\n 83: { 769:346, 770:348, 775:7776, 780:352, 803:7778, 806:536, 807:350 },\n 84: { 775:7786, 780:356, 803:7788, 806:538, 807:354, 813:7792, 817:7790 },\n 85: { 768:217, 769:218, 770:219, 771:360, 772:362, 774:364, 776:220, 777:7910, 778:366, 779:368, 780:467, 783:532, 785:534, 795:431, 803:7908, 804:7794, 808:370, 813:7798, 816:7796 },\n 86: { 771:7804, 803:7806 },\n 87: { 768:7808, 769:7810, 770:372, 775:7814, 776:7812, 803:7816 },\n 88: { 775:7818, 776:7820 },\n 89: { 768:7922, 769:221, 770:374, 771:7928, 772:562, 775:7822, 776:376, 777:7926, 803:7924 },\n 90: { 769:377, 770:7824, 775:379, 780:381, 803:7826, 817:7828 },\n 97: { 768:224, 769:225, 770:226, 771:227, 772:257, 774:259, 775:551, 776:228, 777:7843, 778:229, 780:462, 783:513, 785:515, 803:7841, 805:7681, 808:261 },\n 98: { 775:7683, 803:7685, 817:7687 },\n 99: { 769:263, 770:265, 775:267, 780:269, 807:231 },\n 100: { 775:7691, 780:271, 803:7693, 807:7697, 813:7699, 817:7695 },\n 101: { 768:232, 769:233, 770:234, 771:7869, 772:275, 774:277, 775:279, 776:235, 777:7867, 780:283, 783:517, 785:519, 803:7865, 807:553, 808:281, 813:7705, 816:7707 },\n 102: { 775:7711 },\n 103: { 769:501, 770:285, 772:7713, 774:287, 775:289, 780:487, 807:291 },\n 104: { 770:293, 775:7715, 776:7719, 780:543, 803:7717, 807:7721, 814:7723, 817:7830 },\n 105: { 768:236, 769:237, 770:238, 771:297, 772:299, 774:301, 776:239, 777:7881, 780:464, 783:521, 785:523, 803:7883, 808:303, 816:7725 },\n 106: { 770:309, 780:496 },\n 107: { 769:7729, 780:489, 803:7731, 807:311, 817:7733 },\n 108: { 769:314, 780:318, 803:7735, 807:316, 813:7741, 817:7739 },\n 109: { 769:7743, 775:7745, 803:7747 },\n 110: { 768:505, 769:324, 771:241, 775:7749, 780:328, 803:7751, 807:326, 813:7755, 817:7753 },\n 111: { 768:242, 769:243, 770:244, 771:245, 772:333, 774:335, 775:559, 776:246, 777:7887, 779:337, 780:466, 783:525, 785:527, 795:417, 803:7885, 808:491 },\n 112: { 769:7765, 775:7767 },\n 114: { 769:341, 775:7769, 780:345, 783:529, 785:531, 803:7771, 807:343, 817:7775 },\n 115: { 769:347, 770:349, 775:7777, 780:353, 803:7779, 806:537, 807:351 },\n 116: { 775:7787, 776:7831, 780:357, 803:7789, 806:539, 807:355, 813:7793, 817:7791 },\n 117: { 768:249, 769:250, 770:251, 771:361, 772:363, 774:365, 776:252, 777:7911, 778:367, 779:369, 780:468, 783:533, 785:535, 795:432, 803:7909, 804:7795, 808:371, 813:7799, 816:7797 },\n 118: { 771:7805, 803:7807 },\n 119: { 768:7809, 769:7811, 770:373, 775:7815, 776:7813, 778:7832, 803:7817 },\n 120: { 775:7819, 776:7821 },\n 121: { 768:7923, 769:253, 770:375, 771:7929, 772:563, 775:7823, 776:255, 777:7927, 778:7833, 803:7925 },\n 122: { 769:378, 770:7825, 775:380, 780:382, 803:7827, 817:7829 },\n 168: { 768:8173, 769:901, 834:8129 },\n 194: { 768:7846, 769:7844, 771:7850, 777:7848 },\n 196: { 772:478 },\n 197: { 769:506 },\n 198: { 769:508, 772:482 },\n 199: { 769:7688 },\n 202: { 768:7872, 769:7870, 771:7876, 777:7874 },\n 207: { 769:7726 },\n 212: { 768:7890, 769:7888, 771:7894, 777:7892 },\n 213: { 769:7756, 772:556, 776:7758 },\n 214: { 772:554 },\n 216: { 769:510 },\n 220: { 768:475, 769:471, 772:469, 780:473 },\n 226: { 768:7847, 769:7845, 771:7851, 777:7849 },\n 228: { 772:479 },\n 229: { 769:507 },\n 230: { 769:509, 772:483 },\n 231: { 769:7689 },\n 234: { 768:7873, 769:7871, 771:7877, 777:7875 },\n 239: { 769:7727 },\n 244: { 768:7891, 769:7889, 771:7895, 777:7893 },\n 245: { 769:7757, 772:557, 776:7759 },\n 246: { 772:555 },\n 248: { 769:511 },\n 252: { 768:476, 769:472, 772:470, 780:474 },\n 258: { 768:7856, 769:7854, 771:7860, 777:7858 },\n 259: { 768:7857, 769:7855, 771:7861, 777:7859 },\n 274: { 768:7700, 769:7702 },\n 275: { 768:7701, 769:7703 },\n 332: { 768:7760, 769:7762 },\n 333: { 768:7761, 769:7763 },\n 346: { 775:7780 },\n 347: { 775:7781 },\n 352: { 775:7782 },\n 353: { 775:7783 },\n 360: { 769:7800 },\n 361: { 769:7801 },\n 362: { 776:7802 },\n 363: { 776:7803 },\n 383: { 775:7835 },\n 416: { 768:7900, 769:7898, 771:7904, 777:7902, 803:7906 },\n 417: { 768:7901, 769:7899, 771:7905, 777:7903, 803:7907 },\n 431: { 768:7914, 769:7912, 771:7918, 777:7916, 803:7920 },\n 432: { 768:7915, 769:7913, 771:7919, 777:7917, 803:7921 },\n 439: { 780:494 },\n 490: { 772:492 },\n 491: { 772:493 },\n 550: { 772:480 },\n 551: { 772:481 },\n 552: { 774:7708 },\n 553: { 774:7709 },\n 558: { 772:560 },\n 559: { 772:561 },\n 658: { 780:495 },\n 776: { 769:836 },\n 913: { 768:8122, 769:902, 772:8121, 774:8120, 787:7944, 788:7945, 837:8124 },\n 917: { 768:8136, 769:904, 787:7960, 788:7961 },\n 919: { 768:8138, 769:905, 787:7976, 788:7977, 837:8140 },\n 921: { 768:8154, 769:906, 772:8153, 774:8152, 776:938, 787:7992, 788:7993 },\n 927: { 768:8184, 769:908, 787:8008, 788:8009 },\n 929: { 788:8172 },\n 933: { 768:8170, 769:910, 772:8169, 774:8168, 776:939, 788:8025 },\n 937: { 768:8186, 769:911, 787:8040, 788:8041, 837:8188 },\n 940: { 837:8116 },\n 942: { 837:8132 },\n 945: { 768:8048, 769:940, 772:8113, 774:8112, 787:7936, 788:7937, 834:8118, 837:8115 },\n 949: { 768:8050, 769:941, 787:7952, 788:7953 },\n 951: { 768:8052, 769:942, 787:7968, 788:7969, 834:8134, 837:8131 },\n 953: { 768:8054, 769:943, 772:8145, 774:8144, 776:970, 787:7984, 788:7985, 834:8150 },\n 959: { 768:8056, 769:972, 787:8000, 788:8001 },\n 961: { 787:8164, 788:8165 },\n 965: { 768:8058, 769:973, 772:8161, 774:8160, 776:971, 787:8016, 788:8017, 834:8166 },\n 969: { 768:8060, 769:974, 787:8032, 788:8033, 834:8182, 837:8179 },\n 970: { 768:8146, 769:912, 834:8151 },\n 971: { 768:8162, 769:944, 834:8167 },\n 974: { 837:8180 },\n 978: { 769:979, 776:980 },\n 1030: { 776:1031 },\n 1040: { 774:1232, 776:1234 },\n 1043: { 769:1027 },\n 1045: { 768:1024, 774:1238, 776:1025 },\n 1046: { 774:1217, 776:1244 },\n 1047: { 776:1246 },\n 1048: { 768:1037, 772:1250, 774:1049, 776:1252 },\n 1050: { 769:1036 },\n 1054: { 776:1254 },\n 1059: { 772:1262, 774:1038, 776:1264, 779:1266 },\n 1063: { 776:1268 },\n 1067: { 776:1272 },\n 1069: { 776:1260 },\n 1072: { 774:1233, 776:1235 },\n 1075: { 769:1107 },\n 1077: { 768:1104, 774:1239, 776:1105 },\n 1078: { 774:1218, 776:1245 },\n 1079: { 776:1247 },\n 1080: { 768:1117, 772:1251, 774:1081, 776:1253 },\n 1082: { 769:1116 },\n 1086: { 776:1255 },\n 1091: { 772:1263, 774:1118, 776:1265, 779:1267 },\n 1095: { 776:1269 },\n 1099: { 776:1273 },\n 1101: { 776:1261 },\n 1110: { 776:1111 },\n 1140: { 783:1142 },\n 1141: { 783:1143 },\n 1240: { 776:1242 },\n 1241: { 776:1243 },\n 1256: { 776:1258 },\n 1257: { 776:1259 },\n 1488: { 1463:64302, 1464:64303, 1468:64304 },\n 1489: { 1468:64305, 1471:64332 },\n 1490: { 1468:64306 },\n 1491: { 1468:64307 },\n 1492: { 1468:64308 },\n 1493: { 1465:64331, 1468:64309 },\n 1494: { 1468:64310 },\n 1496: { 1468:64312 },\n 1497: { 1460:64285, 1468:64313 },\n 1498: { 1468:64314 },\n 1499: { 1468:64315, 1471:64333 },\n 1500: { 1468:64316 },\n 1502: { 1468:64318 },\n 1504: { 1468:64320 },\n 1505: { 1468:64321 },\n 1507: { 1468:64323 },\n 1508: { 1468:64324, 1471:64334 },\n 1510: { 1468:64326 },\n 1511: { 1468:64327 },\n 1512: { 1468:64328 },\n 1513: { 1468:64329, 1473:64298, 1474:64299 },\n 1514: { 1468:64330 },\n 1522: { 1463:64287 },\n 1575: { 1619:1570, 1620:1571, 1621:1573 },\n 1608: { 1620:1572 },\n 1610: { 1620:1574 },\n 1729: { 1620:1730 },\n 1746: { 1620:1747 },\n 1749: { 1620:1728 },\n 2325: { 2364:2392 },\n 2326: { 2364:2393 },\n 2327: { 2364:2394 },\n 2332: { 2364:2395 },\n 2337: { 2364:2396 },\n 2338: { 2364:2397 },\n 2344: { 2364:2345 },\n 2347: { 2364:2398 },\n 2351: { 2364:2399 },\n 2352: { 2364:2353 },\n 2355: { 2364:2356 },\n 2465: { 2492:2524 },\n 2466: { 2492:2525 },\n 2479: { 2492:2527 },\n 2503: { 2494:2507, 2519:2508 },\n 2582: { 2620:2649 },\n 2583: { 2620:2650 },\n 2588: { 2620:2651 },\n 2603: { 2620:2654 },\n 2610: { 2620:2611 },\n 2616: { 2620:2614 },\n 2849: { 2876:2908 },\n 2850: { 2876:2909 },\n 2887: { 2878:2891, 2902:2888, 2903:2892 },\n 2962: { 3031:2964 },\n 3014: { 3006:3018, 3031:3020 },\n 3015: { 3006:3019 },\n 3142: { 3158:3144 },\n 3263: { 3285:3264 },\n 3270: { 3266:3274, 3285:3271, 3286:3272 },\n 3274: { 3285:3275 },\n 3398: { 3390:3402, 3415:3404 },\n 3399: { 3390:3403 },\n 3545: { 3530:3546, 3535:3548, 3551:3550 },\n 3548: { 3530:3549 },\n 3904: { 4021:3945 },\n 3906: { 4023:3907 },\n 3916: { 4023:3917 },\n 3921: { 4023:3922 },\n 3926: { 4023:3927 },\n 3931: { 4023:3932 },\n 3953: { 3954:3955, 3956:3957, 3968:3969 },\n 3984: { 4021:4025 },\n 3986: { 4023:3987 },\n 3996: { 4023:3997 },\n 4001: { 4023:4002 },\n 4006: { 4023:4007 },\n 4011: { 4023:4012 },\n 4018: { 3968:3958 },\n 4019: { 3968:3960 },\n 4133: { 4142:4134 },\n 7734: { 772:7736 },\n 7735: { 772:7737 },\n 7770: { 772:7772 },\n 7771: { 772:7773 },\n 7778: { 775:7784 },\n 7779: { 775:7785 },\n 7840: { 770:7852, 774:7862 },\n 7841: { 770:7853, 774:7863 },\n 7864: { 770:7878 },\n 7865: { 770:7879 },\n 7884: { 770:7896 },\n 7885: { 770:7897 },\n 7936: { 768:7938, 769:7940, 834:7942, 837:8064 },\n 7937: { 768:7939, 769:7941, 834:7943, 837:8065 },\n 7938: { 837:8066 },\n 7939: { 837:8067 },\n 7940: { 837:8068 },\n 7941: { 837:8069 },\n 7942: { 837:8070 },\n 7943: { 837:8071 },\n 7944: { 768:7946, 769:7948, 834:7950, 837:8072 },\n 7945: { 768:7947, 769:7949, 834:7951, 837:8073 },\n 7946: { 837:8074 },\n 7947: { 837:8075 },\n 7948: { 837:8076 },\n 7949: { 837:8077 },\n 7950: { 837:8078 },\n 7951: { 837:8079 },\n 7952: { 768:7954, 769:7956 },\n 7953: { 768:7955, 769:7957 },\n 7960: { 768:7962, 769:7964 },\n 7961: { 768:7963, 769:7965 },\n 7968: { 768:7970, 769:7972, 834:7974, 837:8080 },\n 7969: { 768:7971, 769:7973, 834:7975, 837:8081 },\n 7970: { 837:8082 },\n 7971: { 837:8083 },\n 7972: { 837:8084 },\n 7973: { 837:8085 },\n 7974: { 837:8086 },\n 7975: { 837:8087 },\n 7976: { 768:7978, 769:7980, 834:7982, 837:8088 },\n 7977: { 768:7979, 769:7981, 834:7983, 837:8089 },\n 7978: { 837:8090 },\n 7979: { 837:8091 },\n 7980: { 837:8092 },\n 7981: { 837:8093 },\n 7982: { 837:8094 },\n 7983: { 837:8095 },\n 7984: { 768:7986, 769:7988, 834:7990 },\n 7985: { 768:7987, 769:7989, 834:7991 },\n 7992: { 768:7994, 769:7996, 834:7998 },\n 7993: { 768:7995, 769:7997, 834:7999 },\n 8000: { 768:8002, 769:8004 },\n 8001: { 768:8003, 769:8005 },\n 8008: { 768:8010, 769:8012 },\n 8009: { 768:8011, 769:8013 },\n 8016: { 768:8018, 769:8020, 834:8022 },\n 8017: { 768:8019, 769:8021, 834:8023 },\n 8025: { 768:8027, 769:8029, 834:8031 },\n 8032: { 768:8034, 769:8036, 834:8038, 837:8096 },\n 8033: { 768:8035, 769:8037, 834:8039, 837:8097 },\n 8034: { 837:8098 },\n 8035: { 837:8099 },\n 8036: { 837:8100 },\n 8037: { 837:8101 },\n 8038: { 837:8102 },\n 8039: { 837:8103 },\n 8040: { 768:8042, 769:8044, 834:8046, 837:8104 },\n 8041: { 768:8043, 769:8045, 834:8047, 837:8105 },\n 8042: { 837:8106 },\n 8043: { 837:8107 },\n 8044: { 837:8108 },\n 8045: { 837:8109 },\n 8046: { 837:8110 },\n 8047: { 837:8111 },\n 8048: { 837:8114 },\n 8052: { 837:8130 },\n 8060: { 837:8178 },\n 8118: { 837:8119 },\n 8127: { 768:8141, 769:8142, 834:8143 },\n 8134: { 837:8135 },\n 8182: { 837:8183 },\n 8190: { 768:8157, 769:8158, 834:8159 },\n 8592: { 824:8602 },\n 8594: { 824:8603 },\n 8596: { 824:8622 },\n 8656: { 824:8653 },\n 8658: { 824:8655 },\n 8660: { 824:8654 },\n 8707: { 824:8708 },\n 8712: { 824:8713 },\n 8715: { 824:8716 },\n 8739: { 824:8740 },\n 8741: { 824:8742 },\n 8764: { 824:8769 },\n 8771: { 824:8772 },\n 8773: { 824:8775 },\n 8776: { 824:8777 },\n 8781: { 824:8813 },\n 8801: { 824:8802 },\n 8804: { 824:8816 },\n 8805: { 824:8817 },\n 8818: { 824:8820 },\n 8819: { 824:8821 },\n 8822: { 824:8824 },\n 8823: { 824:8825 },\n 8826: { 824:8832 },\n 8827: { 824:8833 },\n 8828: { 824:8928 },\n 8829: { 824:8929 },\n 8834: { 824:8836 },\n 8835: { 824:8837 },\n 8838: { 824:8840 },\n 8839: { 824:8841 },\n 8849: { 824:8930 },\n 8850: { 824:8931 },\n 8866: { 824:8876 },\n 8872: { 824:8877 },\n 8873: { 824:8878 },\n 8875: { 824:8879 },\n 8882: { 824:8938 },\n 8883: { 824:8939 },\n 8884: { 824:8940 },\n 8885: { 824:8941 },\n 10973: { 824:10972 },\n 12358: { 12441:12436 },\n 12363: { 12441:12364 },\n 12365: { 12441:12366 },\n 12367: { 12441:12368 },\n 12369: { 12441:12370 },\n 12371: { 12441:12372 },\n 12373: { 12441:12374 },\n 12375: { 12441:12376 },\n 12377: { 12441:12378 },\n 12379: { 12441:12380 },\n 12381: { 12441:12382 },\n 12383: { 12441:12384 },\n 12385: { 12441:12386 },\n 12388: { 12441:12389 },\n 12390: { 12441:12391 },\n 12392: { 12441:12393 },\n 12399: { 12441:12400, 12442:12401 },\n 12402: { 12441:12403, 12442:12404 },\n 12405: { 12441:12406, 12442:12407 },\n 12408: { 12441:12409, 12442:12410 },\n 12411: { 12441:12412, 12442:12413 },\n 12445: { 12441:12446 },\n 12454: { 12441:12532 },\n 12459: { 12441:12460 },\n 12461: { 12441:12462 },\n 12463: { 12441:12464 },\n 12465: { 12441:12466 },\n 12467: { 12441:12468 },\n 12469: { 12441:12470 },\n 12471: { 12441:12472 },\n 12473: { 12441:12474 },\n 12475: { 12441:12476 },\n 12477: { 12441:12478 },\n 12479: { 12441:12480 },\n 12481: { 12441:12482 },\n 12484: { 12441:12485 },\n 12486: { 12441:12487 },\n 12488: { 12441:12489 },\n 12495: { 12441:12496, 12442:12497 },\n 12498: { 12441:12499, 12442:12500 },\n 12501: { 12441:12502, 12442:12503 },\n 12504: { 12441:12505, 12442:12506 },\n 12507: { 12441:12508, 12442:12509 },\n 12527: { 12441:12535 },\n 12528: { 12441:12536 },\n 12529: { 12441:12537 },\n 12530: { 12441:12538 },\n 12541: { 12441:12542 },\n 64329: { 1473:64300, 1474:64301 },\n 119127: { 119141:119134 },\n 119128: { 119141:119135 },\n 119135: { 119150:119136, 119151:119137, 119152:119138, 119153:119139, 119154:119140 },\n 119225: { 119141:119227 },\n 119226: { 119141:119228 },\n 119227: { 119150:119229, 119151:119231 },\n 119228: { 119150:119230, 119151:119232 }\n};\n/* End of tables generated by casemap.py. */\n\n\n/* Convert a 32-bit Unicode value to a JS string. */\nfunction CharToString(val) {\n    if (val < 0x10000) {\n        return String.fromCharCode(val);\n    }\n    else {\n        val -= 0x10000;\n        return String.fromCharCode(0xD800 + (val >> 10), 0xDC00 + (val & 0x3FF));\n    }\n}\n\n/* Given an array, return an array of the same length with all the values\n   trimmed to the range 0-255. This may be the same array. */\nfunction TrimArrayToBytes(arr) {\n    var ix, newarr;\n    var len = arr.length;\n    for (ix=0; ix<len; ix++) {\n        if (arr[ix] < 0 || arr[ix] >= 0x100) \n            break;\n    }\n    if (ix == len) {\n        return arr;\n    }\n    newarr = Array(len);\n    for (ix=0; ix<len; ix++) {\n        if (arr[ix] < 0 || arr[ix] >= 0x100) \n            newarr[ix] = 63;  // '?'\n        else\n            newarr[ix] = arr[ix];\n    }\n    return newarr;\n}\n\n/* Convert an array of 8-bit values to a JS string, trimming if\n   necessary. */\nfunction ByteArrayToString(arr) {\n    var ix, newarr;\n    var len = arr.length;\n    if (len == 0)\n        return '';\n    for (ix=0; ix<len; ix++) {\n        if (arr[ix] < 0 || arr[ix] >= 0x100) \n            break;\n    }\n    if (ix == len) {\n        return String.fromCharCode.apply(this, arr);\n    }\n    newarr = Array(len);\n    for (ix=0; ix<len; ix++) {\n        newarr[ix] = String.fromCharCode(arr[ix] & 0xFF);\n    }\n    return newarr.join('');\n}\n\n/* Convert an array of 32-bit Unicode values to a JS string. If they're\n   all in the 16-bit range, this is easy; otherwise we have to do\n   some munging. */\nfunction UniArrayToString(arr) {\n    var ix, val, newarr;\n    var len = arr.length;\n    if (len == 0)\n        return '';\n    for (ix=0; ix<len; ix++) {\n        if (arr[ix] >= 0x10000) \n            break;\n    }\n    if (ix == len) {\n        return String.fromCharCode.apply(this, arr);\n    }\n    newarr = Array(len);\n    for (ix=0; ix<len; ix++) {\n        val = arr[ix];\n        if (val < 0x10000) {\n            newarr[ix] = String.fromCharCode(val);\n        }\n        else {\n            val -= 0x10000;\n            newarr[ix] = String.fromCharCode(0xD800 + (val >> 10), 0xDC00 + (val & 0x3FF));\n        }\n    }\n    return newarr.join('');\n}\n\n/* Convert an array of 32-bit Unicode values to an array of 8-bit byte\n   values, encoded UTF-8. If all the values are 0-127, this returns the\n   same array. Otherwise it returns a new (longer) array. */\nfunction UniArrayToUTF8(arr) {\n    var count = 0;\n\n    for (let ix=0; ix<arr.length; ix++) {\n        const val = arr[ix];\n        if (val < 0x80) {\n            count += 1;\n        }\n        else if (val < 0x800) {\n            count += 2;\n        }\n        else if (val < 0x10000) {\n            count += 3;\n        }\n        else if (val < 0x200000) {\n            count += 4;\n        }\n        else {\n            count += 1;\n        }\n    }\n\n    if (count == arr.length)\n        return arr;\n\n    const res = [];\n    for (let ix=0; ix<arr.length; ix++) {\n        const val = arr[ix];\n        if (val < 0x80) {\n            res.push(val);\n        }\n        else if (val < 0x800) {\n            res.push(0xC0 | ((val & 0x7C0) >> 6));\n            res.push(0x80 |  (val & 0x03F)     );\n        }\n        else if (val < 0x10000) {\n            res.push(0xE0 | ((val & 0xF000) >> 12));\n            res.push(0x80 | ((val & 0x0FC0) >>  6));\n            res.push(0x80 |  (val & 0x003F)      );\n        }\n        else if (val < 0x200000) {\n            res.push(0xF0 | ((val & 0x1C0000) >> 18));\n            res.push(0x80 | ((val & 0x03F000) >> 12));\n            res.push(0x80 | ((val & 0x000FC0) >>  6));\n            res.push(0x80 |  (val & 0x00003F)      );\n        }\n        else {\n            res.push(63);  // '?'\n        }\n    }\n\n    return res;\n}\n\n/* Convert an array of 32-bit Unicode values to an array of 8-bit byte\n   values, encoded as big-endian words. */\nfunction UniArrayToBE32(arr) {\n    var res = new Array(4*arr.length);\n    for (var ix=0; ix<arr.length; ix++) {\n        var val = arr[ix];\n        res[4*ix]   = (val >> 24) & 0xFF;\n        res[4*ix+1] = (val >> 16) & 0xFF;\n        res[4*ix+2] = (val >> 8) & 0xFF;\n        res[4*ix+3] = (val) & 0xFF;\n    }\n    return res;\n}\n\n/* Log the message in the browser's error log, if it has one. (This shows\n   up in Safari, in Opera, and in Firefox if you have Firebug installed.)\n*/\nfunction qlog(msg) {\n    if (window.console && console.log)\n        console.log(msg);\n}\n\n/* RefBox: Simple class used for \"call-by-reference\" Glk arguments. The object\n   is just a box containing a single value, which can be written and read.\n*/\nfunction RefBox() {\n    this.value = undefined;\n    this.set_value = function(val) {\n        this.value = val;\n    }\n    this.get_value = function() {\n        return this.value;\n    }\n}\n\n/* RefStruct: Used for struct-type Glk arguments. After creating the\n   object, you should call push_field() the appropriate number of times,\n   to set the initial field values. Then set_field() can be used to\n   change them, and get_fields() retrieves the list of all fields.\n\n   (The usage here is loose, since Javascript is forgiving about arrays.\n   Really the caller could call set_field() instead of push_field() --\n   or skip that step entirely, as long as the Glk function later calls\n   set_field() for each field. Which it should.)\n*/\nfunction RefStruct(/*numels*/) {\n    this.fields = [];\n    this.push_field = function(val) {\n        this.fields.push(val);\n    }\n    this.set_field = function(pos, val) {\n        this.fields[pos] = val;\n    }\n    this.get_field = function(pos) {\n        return this.fields[pos];\n    }\n    this.get_fields = function() {\n        return this.fields;\n    }\n}\n\n/* Dummy return value, which means that the Glk call is still in progress,\n   or will never return at all. This is used by glk_exit(), glk_select(),\n   and glk_fileref_create_by_prompt().\n*/\nvar DidNotReturn = { dummy: 'Glk call has not yet returned' };\n\n/* This returns a hint for whether the Glk call (by selector number)\n   might block or never return. True for glk_exit(), glk_select(),\n   and glk_fileref_create_by_prompt().\n*/\nfunction call_may_not_return(id) {\n    if (id == 0x001 || id == 0x0C0 || id == 0x062)\n        return true;\n    else\n        return false;\n}\n\nvar strtype_File = 1;\nvar strtype_Window = 2;\nvar strtype_Memory = 3;\nvar strtype_Resource = 4;\n\n/* Extra update information -- autorestore only. */\nvar gli_autorestore_glkstate = null;\n\n/* Beginning of linked list of windows. */\nvar gli_windowlist = null;\nvar gli_rootwin = null;\n/* Set when any window is created, destroyed, or resized. */\nvar geometry_changed = true; \n/* Received from GlkOte; describes the window size. */\nvar content_metrics = null;\n\n/* Beginning of linked list of streams. */\nvar gli_streamlist = null;\n/* Beginning of linked list of filerefs. */\nvar gli_filereflist = null;\n/* Beginning of linked list of schannels. */\nvar gli_schannellist = null;\n\n/* The current output stream. */\nvar gli_currentstr = null;\n\n/* During a glk_select() block, this is the RefStruct which will contain\n   the result. */\nvar gli_selectref = null;\n\n/* This is used to assigned disprock values to windows, when there is\n   no GiDispa layer to provide them. */\nvar gli_api_display_rocks = 1;\n\n/* A positive number if the timer is set. */\nvar gli_timer_interval = null; \nvar gli_timer_started = null; /* when the setTimeout began */\nvar gli_timer_lastsent = null; /* last interval sent to GlkOte */\n\nfunction gli_new_window(type, rock) {\n    var win = {};\n    win.type = type;\n    win.rock = rock;\n    win.disprock = undefined;\n\n    win.parent = null;\n    win.str = gli_stream_open_window(win);\n    win.echostr = null;\n    win.style = Const.style_Normal;\n    win.hyperlink = 0;\n\n    win.input_generation = null;\n    win.linebuf = null;\n    win.char_request = false;\n    win.line_request = false;\n    win.char_request_uni = false;\n    win.line_request_uni = false;\n    win.hyperlink_request = false;\n    win.mouse_request = false;\n    win.echo_line_input = true;\n    win.line_input_terminators = [];\n    win.request_echo_line_input = null; /* only used during a request */\n\n    /* window-type-specific info is set up in glk_window_open */\n\n    win.prev = null;\n    win.next = gli_windowlist;\n    gli_windowlist = win;\n    if (win.next)\n        win.next.prev = win;\n\n    if (GiDispa)\n        GiDispa.class_register('window', win);\n    else\n        win.disprock = gli_api_display_rocks++;\n    /* We need to assign a disprock even if there's no GiDispa layer,\n       because GlkOte differentiates windows by their disprock. */\n    geometry_changed = true;\n\n    return win;\n}\n\nfunction gli_delete_window(win) {\n    var prev, next;\n\n    if (GiDispa)\n        GiDispa.class_unregister('window', win);\n    geometry_changed = true;\n    \n    win.echostr = null;\n    if (win.str) {\n        gli_delete_stream(win.str);\n        win.str = null;\n    }\n\n    prev = win.prev;\n    next = win.next;\n    win.prev = null;\n    win.next = null;\n\n    if (prev)\n        prev.next = next;\n    else\n        gli_windowlist = next;\n    if (next)\n        next.prev = prev;\n\n    win.parent = null;\n    win.rock = null;\n    win.disprock = null;\n}\n\nfunction gli_windows_unechostream(str) {\n    var win;\n    \n    for (win=gli_windowlist; win; win=win.next) {\n        if (win.echostr === str)\n            win.echostr = null;\n    }\n}\n\n/* Add a (Javascript) string to the given window's display. */\nfunction gli_window_put_string(win, val) {\n    var ix, ch;\n\n    //### might be efficient to split the implementation up into\n    //### gli_window_buffer_put_string(), etc, since many functions\n    //### know the window type when they call this\n    switch (win.type) {\n    case Const.wintype_TextBuffer:\n        if (win.style != win.accumstyle\n            || win.hyperlink != win.accumhyperlink\n            || win.fg != win.accum_fg\n            || win.bg != win.accum_bg\n            || win.reverse != win.accum_reverse)\n        {\n            gli_window_buffer_deaccumulate(win);\n        }\n        win.accum.push(val);\n        break;\n    case Const.wintype_TextGrid:\n        for (ix=0; ix<val.length; ix++) {\n            ch = val.charAt(ix);\n\n            /* Canonicalize the cursor position. This is like calling\n               gli_window_grid_canonicalize(), but I've inlined it. */\n            if (win.cursorx < 0)\n                win.cursorx = 0;\n            else if (win.cursorx >= win.gridwidth) {\n                win.cursorx = 0;\n                win.cursory++;\n            }\n            if (win.cursory < 0)\n                win.cursory = 0;\n            else if (win.cursory >= win.gridheight)\n                break; /* outside the window */\n\n            if (ch == \"\\n\") {\n                /* a newline just moves the cursor. */\n                win.cursory++;\n                win.cursorx = 0;\n                continue;\n            }\n\n            var lineobj = win.lines[win.cursory];\n            lineobj.dirty = true;\n            lineobj.chars[win.cursorx] = ch;\n            lineobj.styles[win.cursorx] = win.style;\n            lineobj.hyperlinks[win.cursorx] = win.hyperlink;\n            lineobj.fgs[win.cursorx] = win.fg;\n            lineobj.bgs[win.cursorx] = win.bg;\n            lineobj.reverses[win.cursorx] = win.reverse;\n\n            win.cursorx++;\n            /* We can leave the cursor outside the window, since it will be\n               canonicalized next time a character is printed. */\n        }\n        break;\n    }\n}\n\n/* Canonicalize the cursor position. That is, the cursor may have\n   been left outside the window area; wrap it if necessary.\n\n   Returns true if the cursor winds up wrapped outside the window entirely;\n   false if the cursor winds up at a legal printing position.\n*/\nfunction gli_window_grid_canonicalize(win) {\n    if (win.cursorx < 0)\n        win.cursorx = 0;\n    else if (win.cursorx >= win.gridwidth) {\n        win.cursorx = 0;\n        win.cursory++;\n    }\n    if (win.cursory < 0)\n        win.cursory = 0;\n    else if (win.cursory >= win.gridheight)\n        return true; /* outside the window */\n    return false;\n}\n\n/* Take the accumulation of strings (since the last style change) and\n   assemble them into a buffer window update. This must be called\n   after each style change; it must also be called right before \n   GlkOte.update(). (Actually we call it right before win.accum.push\n   if the style has changed -- there's no need to call for *every* style\n   change if no text is being pushed out in between.)\n*/\nfunction gli_window_buffer_deaccumulate(win) {\n    var conta = win.content;\n    var stylename = StyleNameMap[win.accumstyle];\n    var text, ls, ix, obj, arr;\n\n    if (win.accum.length) {\n        text = win.accum.join('');\n        ls = text.split('\\n');\n        for (ix=0; ix<ls.length; ix++) {\n            arr = undefined;\n            if (ix == 0) {\n                if (ls[ix]) {\n                    if (conta.length == 0) {\n                        arr = [];\n                        conta.push({ content: arr, append: true });\n                    }\n                    else {\n                        obj = conta[conta.length-1];\n                        if (!obj.content) {\n                            arr = [];\n                            obj.content = arr;\n                        }\n                        else {\n                            arr = obj.content;\n                        }\n                    }\n                }\n            }\n            else {\n                if (ls[ix]) {\n                    arr = [];\n                    conta.push({ content: arr });\n                }\n                else {\n                    conta.push({ });\n                }\n            }\n            if (arr !== undefined) {\n                if (!win.accumhyperlink && !win.accum_fg && !win.accum_bg && !win.accum_reverse) {\n                    arr.push(stylename);\n                    arr.push(ls[ix]);\n                }\n                else {\n                    const content = {\n                        style: stylename,\n                        text: ls[ix],\n                    }\n                    if (win.accumhyperlink)\n                    {\n                        content.hyperlink = win.accumhyperlink\n                    }\n                    if (win.accum_fg)\n                    {\n                        if (!content.css_styles) {\n                            content.css_styles = {}\n                        }\n                        content.css_styles.color = win.accum_fg\n                    }\n                    if (win.accum_bg)\n                    {\n                        if (!content.css_styles) {\n                            content.css_styles = {}\n                        }\n                        content.css_styles['background-color'] = win.accum_bg\n                    }\n                    if (win.accum_reverse)\n                    {\n                        if (!content.css_styles) {\n                            content.css_styles = {}\n                        }\n                        content.css_styles.reverse = 1\n                    }\n                    arr.push(content)\n                }\n            }\n        }\n    }\n\n    win.accum.length = 0;\n    win.accumstyle = win.style;\n    win.accumhyperlink = win.hyperlink;\n    win.accum_fg = win.fg\n    win.accum_bg = win.bg\n    win.accum_reverse = win.reverse\n}\n\n/* Add a special object onto a buffer window update. This resets the\n   accumulator.\n*/\nfunction gli_window_buffer_put_special(win, special, flowbreak) {\n    gli_window_buffer_deaccumulate(win);\n\n    var conta = win.content;\n    var arr = undefined;\n    var obj;\n\n    /* The next bit is a simplified version of the array-append code \n       from deaccumulate(). It's simpler because we have exactly one\n       item to add. */\n\n    if (conta.length == 0) {\n        arr = [];\n        obj = { content: arr, append: true };\n        if (flowbreak)\n            obj.flowbreak = true;\n        conta.push(obj);\n    }\n    else {\n        obj = conta[conta.length-1];\n        if (flowbreak)\n            obj.flowbreak = true;\n        if (!obj.content) {\n            arr = [];\n            obj.content = arr;\n        }\n        else {\n            arr = obj.content;\n        }\n    }\n    \n    if (arr !== undefined && special !== undefined) {\n        arr.push(special);\n    }\n}\n\nfunction gli_window_close(win, recurse) {\n    var wx;\n    \n    for (wx=win.parent; wx; wx=wx.parent) {\n        if (wx.type == Const.wintype_Pair) {\n            if (wx.pair_key === win) {\n                wx.pair_key = null;\n                wx.pair_keydamage = true;\n            }\n        }\n    }\n\n    if (GiDispa && win.linebuf) {\n        GiDispa.unretain_array(win.linebuf);\n        win.linebuf = null;\n    }\n    \n    switch (win.type) {\n        case Const.wintype_Pair: \n            if (recurse) {\n                if (win.child1)\n                    gli_window_close(win.child1, true);\n                if (win.child2)\n                    gli_window_close(win.child2, true);\n            }\n            win.child1 = null;\n            win.child2 = null;\n            win.pair_key = null;\n            break;\n        case Const.wintype_TextBuffer: \n            win.accum = null;\n            win.content = null;\n            win.reserve = null;\n            break;\n        case Const.wintype_TextGrid: \n            win.lines = null;\n            break;\n        case Const.wintype_Graphics:\n            win.content = null;\n            win.reserve = null;\n            break;\n    }\n    \n    gli_delete_window(win);\n}\n\nfunction gli_window_rearrange(win, box) {\n    var width, height, oldwidth, oldheight;\n    var min, max, diff, split, splitwid, ix, cx, lineobj;\n    var box1, box2, ch1, ch2;\n\n    geometry_changed = true;\n    win.bbox = box;\n\n    switch (win.type) {\n\n    case Const.wintype_TextGrid:\n        /* Compute the new grid size. */\n        width = box.right - box.left;\n        height = box.bottom - box.top;\n        oldheight = win.gridheight;\n        win.gridwidth = Math.max(0, Math.floor((width-content_metrics.gridmarginx) / content_metrics.gridcharwidth));\n        win.gridheight = Math.max(0, Math.floor((height-content_metrics.gridmarginy) / content_metrics.gridcharheight));\n\n        /* Now we have to resize the win.lines array, in two dimensions. */\n        if (oldheight > win.gridheight) {\n            win.lines.length = win.gridheight;\n        }\n        else if (oldheight < win.gridheight) {\n            for (ix=oldheight; ix<win.gridheight; ix++) {\n                win.lines[ix] = { chars:[], styles:[], hyperlinks:[], fgs:[], bgs:[], reverses:[],\n                                  dirty:true };\n            }\n        }\n        for (ix=0; ix<win.gridheight; ix++) {\n            lineobj = win.lines[ix];\n            oldwidth = lineobj.chars.length;\n            if (oldwidth > win.gridwidth) {\n                lineobj.dirty = true;\n                lineobj.chars.length = win.gridwidth;\n                lineobj.styles.length = win.gridwidth;\n                lineobj.hyperlinks.length = win.gridwidth;\n                lineobj.fgs.length = win.gridwidth;\n                lineobj.bgs.length = win.gridwidth;\n                lineobj.reverses.length = win.gridwidth;\n            }\n            else if (oldwidth < win.gridwidth) {\n                lineobj.dirty = true;\n                for (cx=oldwidth; cx<win.gridwidth; cx++) {\n                    lineobj.chars[cx] = ' ';\n                    lineobj.styles[cx] = Const.style_Normal;\n                    lineobj.hyperlinks[cx] = 0;\n                    lineobj.fgs[cx] = null\n                    lineobj.bgs[cx] = null\n                    lineobj.reverses[cx] = 0\n                }\n            }\n        }\n        break;\n\n    case Const.wintype_Graphics:\n        /* Compute the new canvas size. */\n        width = box.right - box.left;\n        height = box.bottom - box.top;\n        win.graphwidth = Math.max(0, width - content_metrics.graphicsmarginx);\n        win.graphheight = Math.max(0, height - content_metrics.graphicsmarginy);\n        break;\n\n    case Const.wintype_Pair:\n        if (win.pair_vertical) {\n            min = win.bbox.left;\n            max = win.bbox.right;\n            splitwid = content_metrics.inspacingx;\n        }\n        else {\n            min = win.bbox.top;\n            max = win.bbox.bottom;\n            splitwid = content_metrics.inspacingy;\n        }\n        if (!win.pair_hasborder)\n            splitwid = 0;\n        diff = max - min;\n\n        if (win.pair_division == Const.winmethod_Proportional) {\n            split = Math.floor((diff * win.pair_size) / 100);\n        }\n        else if (win.pair_division == Const.winmethod_Fixed) {\n            split = 0;\n            if (win.pair_key && win.pair_key.type == Const.wintype_TextBuffer) {\n                if (!win.pair_vertical) \n                    split = (win.pair_size * content_metrics.buffercharheight + content_metrics.buffermarginy);\n                else\n                    split = (win.pair_size * content_metrics.buffercharwidth + content_metrics.buffermarginx);\n            }\n            if (win.pair_key && win.pair_key.type == Const.wintype_TextGrid) {\n                if (!win.pair_vertical) \n                    split = (win.pair_size * content_metrics.gridcharheight + content_metrics.gridmarginy);\n                else\n                    split = (win.pair_size * content_metrics.gridcharwidth + content_metrics.gridmarginx);\n            }\n            if (win.pair_key && win.pair_key.type == Const.wintype_Graphics) {\n                if (!win.pair_vertical) \n                    split = win.pair_size + content_metrics.graphicsmarginy;\n                else\n                    split = win.pair_size + content_metrics.graphicsmarginx;\n            }\n            split = Math.ceil(split);\n        }\n        else {\n            /* default behavior for unknown division method */\n            split = Math.floor(diff / 2);\n        }\n\n        /* Split is now a number between 0 and diff. Convert that to a number\n           between min and max; also apply upside-down-ness. */\n        if (!win.pair_backward) {\n            split = max-split-splitwid;\n        }\n        else {\n            split = min+split;\n        }\n\n        /* Make sure it's really between min and max. */\n        if (min >= max) {\n            split = min;\n        }\n        else {\n            split = Math.min(Math.max(split, min), max-splitwid);\n        }\n\n        win.pair_splitpos = split;\n        win.pair_splitwidth = splitwid;\n        if (win.pair_vertical) {\n            box1 = {\n                left: win.bbox.left,\n                right: win.pair_splitpos,\n                top: win.bbox.top,\n                bottom: win.bbox.bottom\n            };\n            box2 = {\n                left: box1.right + win.pair_splitwidth,\n                right: win.bbox.right,\n                top: win.bbox.top,\n                bottom: win.bbox.bottom\n            };\n        }\n        else {\n            box1 = {\n                top: win.bbox.top,\n                bottom: win.pair_splitpos,\n                left: win.bbox.left,\n                right: win.bbox.right\n            };\n            box2 = {\n                top: box1.bottom + win.pair_splitwidth,\n                bottom: win.bbox.bottom,\n                left: win.bbox.left,\n                right: win.bbox.right\n            };\n        }\n        if (!win.pair_backward) {\n            ch1 = win.child1;\n            ch2 = win.child2;\n        }\n        else {\n            ch1 = win.child2;\n            ch2 = win.child1;\n        }\n\n        gli_window_rearrange(ch1, box1);\n        gli_window_rearrange(ch2, box2);\n        break;\n\n    }\n}\n\nfunction gli_new_stream(type, readable, writable, rock) {\n    var str = {};\n    str.type = type;\n    str.rock = rock;\n    str.disprock = undefined;\n\n    str.unicode = false;\n    /* isbinary is only meaningful for Resource and streaming-File streams */\n    str.isbinary = false;\n    str.streaming = false;\n    str.ref = null;\n    str.win = null;\n    str.file = null;\n\n    /* for buffer mode */\n    str.buf = null;\n    str.bufpos = 0;\n    str.buflen = 0;\n    str.bufeof = 0;\n    str.timer_id = null;\n    str.flush_func = null;\n\n    /* for streaming mode */\n    str.fstream = null;\n\n    str.readcount = 0;\n    str.writecount = 0;\n    str.readable = readable;\n    str.writable = writable;\n\n    str.prev = null;\n    str.next = gli_streamlist;\n    gli_streamlist = str;\n    if (str.next)\n        str.next.prev = str;\n\n    if (GiDispa)\n        GiDispa.class_register('stream', str);\n\n    return str;\n}\n\nfunction gli_delete_stream(str) {\n    var prev, next;\n    \n    if (str === gli_currentstr) {\n        gli_currentstr = null;\n    }\n\n    gli_windows_unechostream(str);\n\n    if (str.type == strtype_Memory) {\n        if (GiDispa)\n            GiDispa.unretain_array(str.buf);\n    }\n    else if (str.type == strtype_File) {\n        if (str.fstream) {\n            str.fstream.fclose();\n            str.fstream = null;\n        }\n    }\n\n    if (GiDispa)\n        GiDispa.class_unregister('stream', str);\n\n    prev = str.prev;\n    next = str.next;\n    str.prev = null;\n    str.next = null;\n\n    if (prev)\n        prev.next = next;\n    else\n        gli_streamlist = next;\n    if (next)\n        next.prev = prev;\n\n    str.fstream = null;\n    str.buf = null;\n    str.readable = false;\n    str.writable = false;\n    str.ref = null;\n    str.win = null;\n    str.file = null;\n    str.rock = null;\n    str.disprock = null;\n}\n\nfunction gli_stream_open_window(win) {\n    var str;\n    str = gli_new_stream(strtype_Window, false, true, 0);\n    str.unicode = true;\n    str.win = win;\n    return str;\n}\n\n/* This is called on every write to a file stream. If a file is being\n   written intermittently (a transcript file, for example) we'd like to\n   flush the output every few seconds, in case the user closes the\n   browser without closing the file (\"script off\").\n\n   We do this by setting a ten-second timer (if there isn't one set already).\n   The timer calls a flush method on the stream.\n\n   (If autosave is on, we'll wind up flushing on most glk_select calls,\n   which isn't quite as nicely paced. But it's a minor problem.)\n*/\nfunction gli_stream_dirty_file(str) {\n    if (str.streaming)\n        GlkOte.log('### gli_stream_dirty_file called for streaming file!');\n    if (str.timer_id === null) {\n        if (str.flush_func === null) {\n            /* Bodge together a closure to act as a stream method. */\n            str.flush_func = function() { gli_stream_flush_file(str); };\n        }\n        str.timer_id = setTimeout(str.flush_func, 10000);\n    }\n}\n\n/* Write out the contents of a file stream to the \"disk file\". Because\n   localStorage doesn't support appending, we have to dump the entire\n   buffer out.\n*/\nfunction gli_stream_flush_file(str) {\n    if (str.streaming)\n        GlkOte.log('### gli_stream_flush_file called for streaming file!');\n    if (!(str.timer_id === null)) {\n        clearTimeout(str.timer_id);\n    }\n    str.timer_id = null;\n    Dialog.file_write(str.ref, str.buf);\n}\n\nfunction gli_new_fileref(filename, usage, rock, ref) {\n    var fref = {};\n    fref.filename = filename;\n    fref.rock = rock;\n    fref.disprock = undefined;\n\n    fref.textmode = ((usage & Const.fileusage_TextMode) != 0);\n    fref.filetype = (usage & Const.fileusage_TypeMask);\n    fref.filetypename = FileTypeMap[fref.filetype];\n    if (!fref.filetypename) {\n        fref.filetypename = 'xxx';\n    }\n\n    if (!ref) {\n        var gameid = '';\n        if (fref.filetype == Const.fileusage_SavedGame)\n            gameid = VM.get_signature();\n        ref = Dialog.file_construct_ref(fref.filename, fref.filetypename, gameid);\n    }\n    fref.ref = ref;\n\n    fref.prev = null;\n    fref.next = gli_filereflist;\n    gli_filereflist = fref;\n    if (fref.next)\n        fref.next.prev = fref;\n\n    if (GiDispa)\n        GiDispa.class_register('fileref', fref);\n\n    return fref;\n}\n\nfunction gli_delete_fileref(fref) {\n    var prev, next;\n    \n    if (GiDispa)\n        GiDispa.class_unregister('fileref', fref);\n\n    prev = fref.prev;\n    next = fref.next;\n    fref.prev = null;\n    fref.next = null;\n\n    if (prev)\n        prev.next = next;\n    else\n        gli_filereflist = next;\n    if (next)\n        next.prev = prev;\n\n    fref.filename = null;\n    fref.ref = null;\n    fref.rock = null;\n    fref.disprock = null;\n}\n\n/* Write one character (given as a Unicode value) to a stream.\n   This is called by both the one-byte and four-byte character APIs.\n*/\nfunction gli_put_char(str, ch) {\n    if (!str || !str.writable)\n        throw('gli_put_char: invalid stream');\n\n    if (!str.unicode) {\n        if (ch < 0 || ch >= 0x100)\n            ch = 63;  // '?'\n    }\n\n    str.writecount += 1;\n    \n    switch (str.type) {\n    case strtype_File:\n        if (str.streaming) {\n            if (!str.unicode) {\n                str.buffer4[0] = ch;\n                str.fstream.fwrite(str.buffer4, 1);\n            }\n            else {\n                if (!str.isbinary) {\n                    /* cheap UTF-8 stream */\n                    var len;\n                    if (ch < 0x10000) {\n                        len = str.buffer4.write(String.fromCharCode(ch));\n                        str.fstream.fwrite(str.buffer4, len); // utf8\n                    }\n                    else {\n                        /* String.fromCharCode chokes on astral characters;\n                           do it the hard way */\n                        var arr8 = UniArrayToUTF8([ch]);\n                        var buf = str.fstream.BufferClass.from(arr8);\n                        str.fstream.fwrite(buf);\n                    }\n                }\n                else {\n                    /* cheap big-endian stream */\n                    str.buffer4.writeUInt32BE(ch, 0, true);\n                    str.fstream.fwrite(str.buffer4, 4);\n                }\n            }\n        }\n        else {\n            /* non-streaming... */\n            gli_stream_dirty_file(str);\n            if (!str.unicode || (ch < 0x80 && !str.isbinary)) {\n                if (str.bufpos < str.buflen) {\n                    str.buf[str.bufpos] = ch;\n                    str.bufpos += 1;\n                    if (str.bufpos > str.bufeof)\n                        str.bufeof = str.bufpos;\n                }\n            }\n            else {\n                let arr;\n                if (!str.isbinary)\n                    arr = UniArrayToUTF8([ch]);\n                else\n                    arr = UniArrayToBE32([ch]);\n                let len = arr.length;\n                if (len > str.buflen-str.bufpos)\n                    len = str.buflen-str.bufpos;\n                for (let ix=0; ix<len; ix++)\n                    str.buf[str.bufpos+ix] = arr[ix];\n                str.bufpos += len;\n                if (str.bufpos > str.bufeof)\n                    str.bufeof = str.bufpos;\n            }\n        }\n        break;\n    case strtype_Memory:\n        if (str.bufpos < str.buflen) {\n            str.buf[str.bufpos] = ch;\n            str.bufpos += 1;\n            if (str.bufpos > str.bufeof)\n                str.bufeof = str.bufpos;\n        }\n        break;\n    case strtype_Window:\n        if (str.win.line_request)\n            throw('gli_put_char: window has pending line request');\n        gli_window_put_string(str.win, CharToString(ch));\n        if (str.win.echostr)\n            gli_put_char(str.win.echostr, ch);\n        break;\n    }\n}\n\n/* Write characters (given as an array of Unicode values) to a stream.\n   This is called by both the one-byte and four-byte character APIs.\n   The \"allbytes\" argument is a hint that all the array values are\n   already in the range 0-255.\n*/\nfunction gli_put_array(str, arr, allbytes) {\n    var len, val;\n\n    if (!str || !str.writable)\n        throw('gli_put_array: invalid stream');\n\n    if (!str.unicode && !allbytes) {\n        arr = TrimArrayToBytes(arr);\n        allbytes = true;\n    }\n\n    str.writecount += arr.length;\n    \n    switch (str.type) {\n    case strtype_File:\n        if (str.streaming) {\n            if (!str.unicode) {\n                const buf = str.fstream.BufferClass.from(arr);\n                str.fstream.fwrite(buf);\n            }\n            else {\n                if (!str.isbinary) {\n                    /* cheap UTF-8 stream */\n                    const arr8 = UniArrayToUTF8(arr);\n                    const buf = str.fstream.BufferClass.from(arr8);\n                    str.fstream.fwrite(buf);\n                }\n                else {\n                    /* cheap big-endian stream */\n                    const buf = str.fstream.BufferClass.alloc(4*arr.length);\n                    for (let ix=0; ix<arr.length; ix++) {\n                        buf.writeUInt32BE(arr[ix], 4*ix, true);\n                    }\n                    str.fstream.fwrite(buf);\n                }\n            }\n        }\n        else {\n            /* non-streaming... */\n            gli_stream_dirty_file(str);\n            var arr8;\n            if (!str.unicode) {\n                arr8 = arr;\n            }\n            else {\n                if (!str.isbinary)\n                    arr8 = UniArrayToUTF8(arr);\n                else\n                    arr8 = UniArrayToBE32(arr);\n            }\n            let len = arr8.length;\n            if (len > str.buflen-str.bufpos)\n                len = str.buflen-str.bufpos;\n            for (let ix=0; ix<len; ix++)\n                str.buf[str.bufpos+ix] = arr8[ix];\n            str.bufpos += len;\n            if (str.bufpos > str.bufeof)\n                str.bufeof = str.bufpos;\n        }\n        break;\n    case strtype_Memory:\n        len = arr.length;\n        if (len > str.buflen-str.bufpos)\n            len = str.buflen-str.bufpos;\n        for (let ix=0; ix<len; ix++)\n            str.buf[str.bufpos+ix] = arr[ix];\n        str.bufpos += len;\n        if (str.bufpos > str.bufeof)\n            str.bufeof = str.bufpos;\n        break;\n    case strtype_Window:\n        if (str.win.line_request)\n            throw('gli_put_array: window has pending line request');\n        if (allbytes)\n            val = String.fromCharCode.apply(this, arr);\n        else\n            val = UniArrayToString(arr);\n        gli_window_put_string(str.win, val);\n        if (str.win.echostr)\n            gli_put_array(str.win.echostr, arr, allbytes);\n        break;\n    }\n}\n\nfunction gli_get_char(str, want_unicode) {\n    var ch;\n\n    if (!str || !str.readable)\n        return -1;\n    \n    switch (str.type) {\n    case strtype_File:\n        if (str.streaming) {\n            if (!str.unicode) {\n                const len = str.fstream.fread(str.buffer4, 1);\n                if (!len)\n                    return -1;\n                str.readcount++;\n                return str.buffer4[0];\n            }\n            else {\n                if (!str.isbinary) {\n                    /* slightly less cheap UTF8 stream */\n                    let val0, val1, val2, val3;\n                    const len = str.fstream.fread(str.buffer4, 1);\n                    if (!len)\n                        return -1;\n                    val0 = str.buffer4[0];\n                    if (val0 < 0x80) {\n                        ch = val0;\n                    }\n                    else {\n                        const len = str.fstream.fread(str.buffer4, 1);\n                        if (!len)\n                            return -1;\n                        val1 = str.buffer4[0];\n                        if ((val1 & 0xC0) != 0x80)\n                            return -1;\n                        if ((val0 & 0xE0) == 0xC0) {\n                            ch = (val0 & 0x1F) << 6;\n                            ch |= (val1 & 0x3F);\n                        }\n                        else {\n                            const len = str.fstream.fread(str.buffer4, 1);\n                            if (!len)\n                                return -1;\n                            val2 = str.buffer4[0];\n                            if ((val2 & 0xC0) != 0x80)\n                                return -1;\n                            if ((val0 & 0xF0) == 0xE0) {\n                                ch = (((val0 & 0xF)<<12)  & 0x0000F000);\n                                ch |= (((val1 & 0x3F)<<6) & 0x00000FC0);\n                                ch |= (((val2 & 0x3F))    & 0x0000003F);\n                            }\n                            else if ((val0 & 0xF0) == 0xF0) {\n                                const len = str.fstream.fread(str.buffer4, 1);\n                                if (!len)\n                                    return -1;\n                                val3 = str.buffer4[0];\n                                if ((val3 & 0xC0) != 0x80)\n                                    return -1;\n                                ch = (((val0 & 0x7)<<18)   & 0x1C0000);\n                                ch |= (((val1 & 0x3F)<<12) & 0x03F000);\n                                ch |= (((val2 & 0x3F)<<6)  & 0x000FC0);\n                                ch |= (((val3 & 0x3F))     & 0x00003F);\n                            }\n                            else {\n                                return -1;\n                            }\n                        }\n                    }\n                }\n                else {\n                    /* cheap big-endian stream */\n                    const len = str.fstream.fread(str.buffer4, 4);\n                    if (len < 4)\n                        return -1;\n                    /*### or buf.readUInt32BE(0, true) */\n                    ch = (str.buffer4[0] << 24);\n                    ch |= (str.buffer4[1] << 16);\n                    ch |= (str.buffer4[2] << 8);\n                    ch |= str.buffer4[3];\n                }\n                str.readcount++;\n                ch >>>= 0;\n                if (!want_unicode && ch >= 0x100)\n                    return 63; // return '?'\n                return ch;\n            }\n        }\n        /* non-streaming, fall through to resource... */\n    case strtype_Resource:\n        if (str.unicode) {\n            if (str.isbinary) {\n                /* cheap big-endian stream */\n                if (str.bufpos >= str.bufeof)\n                    return -1;\n                ch = str.buf[str.bufpos];\n                str.bufpos++;\n                if (str.bufpos >= str.bufeof)\n                    return -1;\n                ch = (ch << 8) | (str.buf[str.bufpos] & 0xFF);\n                str.bufpos++;\n                if (str.bufpos >= str.bufeof)\n                    return -1;\n                ch = (ch << 8) | (str.buf[str.bufpos] & 0xFF);\n                str.bufpos++;\n                if (str.bufpos >= str.bufeof)\n                    return -1;\n                ch = (ch << 8) | (str.buf[str.bufpos] & 0xFF);\n                str.bufpos++;\n            }\n            else {\n                /* slightly less cheap UTF8 stream */\n                let val0, val1, val2, val3;\n                if (str.bufpos >= str.bufeof)\n                    return -1;\n                val0 = str.buf[str.bufpos];\n                str.bufpos++;\n                if (val0 < 0x80) {\n                    ch = val0;\n                }\n                else {\n                    if (str.bufpos >= str.bufeof)\n                        return -1;\n                    val1 = str.buf[str.bufpos];\n                    str.bufpos++;\n                    if ((val1 & 0xC0) != 0x80)\n                        return -1;\n                    if ((val0 & 0xE0) == 0xC0) {\n                        ch = (val0 & 0x1F) << 6;\n                        ch |= (val1 & 0x3F);\n                    }\n                    else {\n                        if (str.bufpos >= str.bufeof)\n                            return -1;\n                        val2 = str.buf[str.bufpos];\n                        str.bufpos++;\n                        if ((val2 & 0xC0) != 0x80)\n                            return -1;\n                        if ((val0 & 0xF0) == 0xE0) {\n                            ch = (((val0 & 0xF)<<12)  & 0x0000F000);\n                            ch |= (((val1 & 0x3F)<<6) & 0x00000FC0);\n                            ch |= (((val2 & 0x3F))    & 0x0000003F);\n                        }\n                        else if ((val0 & 0xF0) == 0xF0) {\n                            if (str.bufpos >= str.bufeof)\n                                return -1;\n                            val3 = str.buf[str.bufpos];\n                            str.bufpos++;\n                            if ((val3 & 0xC0) != 0x80)\n                                return -1;\n                            ch = (((val0 & 0x7)<<18)   & 0x1C0000);\n                            ch |= (((val1 & 0x3F)<<12) & 0x03F000);\n                            ch |= (((val2 & 0x3F)<<6)  & 0x000FC0);\n                            ch |= (((val3 & 0x3F))     & 0x00003F);\n                        }\n                        else {\n                            return -1;\n                        }\n                    }\n                }\n            }\n            str.readcount++;\n            ch >>>= 0;\n            if (!want_unicode && ch >= 0x100)\n                return 63; // return '?'\n            return ch;\n        }\n        /* non-unicode file/resource, fall through to memory... */\n    case strtype_Memory:\n        if (str.bufpos < str.bufeof) {\n            ch = str.buf[str.bufpos];\n            str.bufpos++;\n            str.readcount++;\n            if (!want_unicode && ch >= 0x100)\n                return 63; // return '?'\n            return ch;\n        }\n        else {\n            return -1; // end of stream \n        }\n    default:\n        return -1;\n    }\n}\n\nfunction gli_get_line(str, buf, want_unicode) {\n    if (!str || !str.readable)\n        return 0;\n\n    var len = buf.length;\n    var lx, ch;\n    var gotnewline;\n\n    switch (str.type) {\n    case strtype_File:\n        if (str.streaming) {\n            if (len == 0)\n                return 0;\n            len -= 1; /* for the terminal null */\n            gotnewline = false;\n            for (lx=0; lx<len && !gotnewline; lx++) {\n                ch = gli_get_char(str, want_unicode);\n                if (ch == -1)\n                    break;\n                buf[lx] = ch;\n                gotnewline = (ch == 10);\n            }\n            return lx;\n        }\n        /* non-streaming, fall through to resource... */\n    case strtype_Resource:\n        if (str.unicode) {\n            if (len == 0)\n                return 0;\n            len -= 1; /* for the terminal null */\n            gotnewline = false;\n            for (lx=0; lx<len && !gotnewline; lx++) {\n                ch = gli_get_char(str, want_unicode);\n                if (ch == -1)\n                    break;\n                buf[lx] = ch;\n                gotnewline = (ch == 10);\n            }\n            return lx;\n        }\n        /* non-unicode file/resource, fall through to memory... */\n    case strtype_Memory:\n        if (len == 0)\n            return 0;\n        len -= 1; /* for the terminal null */\n        if (str.bufpos >= str.bufeof) {\n            len = 0;\n        }\n        else {\n            if (str.bufpos + len > str.bufeof) {\n                len = str.bufeof - str.bufpos;\n            }\n        }\n        gotnewline = false;\n        if (!want_unicode) {\n            for (lx=0; lx<len && !gotnewline; lx++) {\n                ch = str.buf[str.bufpos++];\n                if (!want_unicode && ch >= 0x100)\n                    ch = 63; // ch = '?'\n                buf[lx] = ch;\n                gotnewline = (ch == 10);\n            }\n        }\n        else {\n            for (lx=0; lx<len && !gotnewline; lx++) {\n                ch = str.buf[str.bufpos++];\n                buf[lx] = ch;\n                gotnewline = (ch == 10);\n            }\n        }\n        str.readcount += lx;\n        return lx;\n    default:\n        return 0;\n    }\n}\n\nfunction gli_get_buffer(str, buf, want_unicode) {\n    if (!str || !str.readable)\n        return 0;\n\n    var len = buf.length;\n    var lx, ch;\n    \n    switch (str.type) {\n    case strtype_File:\n        if (str.streaming) {\n            for (lx=0; lx<len; lx++) {\n                ch = gli_get_char(str, want_unicode);\n                if (ch == -1)\n                    break;\n                buf[lx] = ch;\n            }\n            return lx;\n        }\n        /* non-streaming, fall through to resource... */\n    case strtype_Resource:\n        if (str.unicode) {\n            for (lx=0; lx<len; lx++) {\n                ch = gli_get_char(str, want_unicode);\n                if (ch == -1)\n                    break;\n                buf[lx] = ch;\n            }\n            return lx;\n        }\n        /* non-unicode file/resource, fall through to memory... */\n    case strtype_Memory:\n        if (str.bufpos >= str.bufeof) {\n            len = 0;\n        }\n        else {\n            if (str.bufpos + len > str.bufeof) {\n                len = str.bufeof - str.bufpos;\n            }\n        }\n        if (!want_unicode) {\n            for (lx=0; lx<len; lx++) {\n                ch = str.buf[str.bufpos++];\n                if (!want_unicode && ch >= 0x100)\n                    ch = 63; // ch = '?'\n                buf[lx] = ch;\n            }\n        }\n        else {\n            for (lx=0; lx<len; lx++) {\n                buf[lx] = str.buf[str.bufpos++];\n            }\n        }\n        str.readcount += len;\n        return len;\n    default:\n        return 0;\n    }\n}\n\nfunction gli_stream_fill_result(str, result) {\n    if (!result)\n        return;\n    result.set_field(0, str.readcount);\n    result.set_field(1, str.writecount);\n}\n\nfunction glk_put_jstring(val, allbytes) {\n    glk_put_jstring_stream(gli_currentstr, val, allbytes);\n}\n\nfunction glk_put_jstring_stream(str, val, allbytes) {\n    var len;\n\n    if (!str || !str.writable)\n        throw('glk_put_jstring: invalid stream');\n\n    str.writecount += val.length;\n    \n    switch (str.type) {\n    case strtype_File:\n        if (str.streaming) {\n            if (!str.unicode) {\n                // if !allbytes, we just give up on non-Latin-1 characters\n                const buf = str.fstream.BufferClass.from(val, 'binary');\n                str.fstream.fwrite(buf);\n            }\n            else {\n                if (!str.isbinary) {\n                    /* cheap UTF-8 stream */\n                    const buf = str.fstream.BufferClass.from(val); // utf8\n                    str.fstream.fwrite(buf);\n                }\n                else {\n                    /* cheap big-endian stream */\n                    const buf = str.fstream.BufferClass.alloc(4*val.length);\n                    for (let ix=0; ix<val.length; ix++) {\n                        buf.writeUInt32BE(val.charCodeAt(ix), 4*ix, true);\n                    }\n                    str.fstream.fwrite(buf);\n                }\n            }\n        }\n        else {\n            /* non-streaming... */\n            gli_stream_dirty_file(str);\n            const arr = [];\n            for (let ix=0; ix<val.length; ix++)\n                arr.push(val.charCodeAt(ix));\n            let arr8;\n            if (!str.unicode) {\n                arr8 = arr;\n            }\n            else {\n                if (!str.isbinary)\n                    arr8 = UniArrayToUTF8(arr);\n                else\n                    arr8 = UniArrayToBE32(arr);\n            }\n            let len = arr8.length;\n            if (len > str.buflen-str.bufpos)\n                len = str.buflen-str.bufpos;\n            for (let ix=0; ix<len; ix++)\n                str.buf[str.bufpos+ix] = arr8[ix];\n            str.bufpos += len;\n            if (str.bufpos > str.bufeof)\n                str.bufeof = str.bufpos;\n        }\n        break;\n    case strtype_Memory:\n        len = val.length;\n        if (len > str.buflen-str.bufpos)\n            len = str.buflen-str.bufpos;\n        if (str.unicode || allbytes) {\n            for (let ix=0; ix<len; ix++)\n                str.buf[str.bufpos+ix] = val.charCodeAt(ix);\n        }\n        else {\n            for (let ix=0; ix<len; ix++) {\n                var ch = val.charCodeAt(ix);\n                if (ch < 0 || ch >= 0x100)\n                    ch = 63;  // '?'\n                str.buf[str.bufpos+ix] = ch;\n            }\n        }\n        str.bufpos += len;\n        if (str.bufpos > str.bufeof)\n            str.bufeof = str.bufpos;\n        break;\n    case strtype_Window:\n        if (str.win.line_request)\n            throw('glk_put_jstring: window has pending line request');\n        gli_window_put_string(str.win, val);\n        if (str.win.echostr)\n            glk_put_jstring_stream(str.win.echostr, val, allbytes);\n        break;\n    }\n}\n\nfunction gli_set_style(str, val) {\n    if (!str || !str.writable)\n        throw('gli_set_style: invalid stream');\n\n    if (val >= Const.style_NUMSTYLES)\n        val = 0;\n\n    if (str.type == strtype_Window) {\n        str.win.style = val;\n        if (str.win.echostr)\n            gli_set_style(str.win.echostr, val);\n    }\n}\n\nfunction gli_set_hyperlink(str, val) {\n    if (!str || !str.writable)\n        throw('gli_set_hyperlink: invalid stream');\n\n    if (str.type == strtype_Window) {\n        str.win.hyperlink = val;\n        if (str.win.echostr)\n            gli_set_hyperlink(str.win.echostr, val);\n    }\n}\n\n/* The catalog of Glk API functions. */\n\nfunction glk_exit() {\n    /* For safety, this is fast and idempotent. */\n    has_exited = true;\n    ui_disabled = true;\n    gli_selectref = null;\n    if (option_exit_warning)\n        GlkOte.warning(option_exit_warning);\n    return DidNotReturn;\n}\n\nfunction glk_tick() {\n    /* Do nothing. */\n}\n\nfunction glk_gestalt(sel, val) {\n    return glk_gestalt_ext(sel, val, null);\n}\n\nfunction glk_gestalt_ext(sel, val, arr) {\n    switch (sel) {\n\n    case 0: // gestalt_Version\n        /* This implements Glk spec version 0.7.4. */\n        return 0x00000704;\n\n    case 1: // gestalt_CharInput\n        /* This is not a terrific approximation. Return false for function\n           keys, control keys, and the high-bit non-printables. For\n           everything else in the Unicode range, return true. */\n        if (val <= Const.keycode_Left && val >= Const.keycode_End)\n            return 1;\n        if (val >= 0x100000000-Const.keycode_MAXVAL)\n            return 0;\n        if (val > 0x10FFFF)\n            return 0;\n        if ((val >= 0 && val < 32) || (val >= 127 && val < 160))\n            return 0;\n        return 1;\n\n    case 2: // gestalt_LineInput\n        /* Same as the above, except no special keys. */\n        if (val > 0x10FFFF)\n            return 0;\n        if ((val >= 0 && val < 32) || (val >= 127 && val < 160))\n            return 0;\n        return 1;\n\n    case 3: // gestalt_CharOutput\n        /* Same thing again. We assume that all printable characters,\n           as well as the placeholders for nonprintables, are one character\n           wide. */\n        if ((val > 0x10FFFF) \n            || (val >= 0 && val < 32) \n            || (val >= 127 && val < 160)) {\n            if (arr)\n                arr[0] = 1;\n            return 0; // gestalt_CharOutput_CannotPrint\n        }\n        if (arr)\n            arr[0] = 1;\n        return 2; // gestalt_CharOutput_ExactPrint\n\n    case 4: // gestalt_MouseInput\n        if (val == Const.wintype_TextGrid)\n            return 1;\n        if (support.graphics && val == Const.wintype_Graphics)\n            return 1;\n        return 0;\n\n    case 5: // gestalt_Timer\n        return support.timer || 0;\n\n    case 6: // gestalt_Graphics\n        return support.graphics || 0;\n\n    case 7: // gestalt_DrawImage\n        if (support.graphics && (val === Const.wintype_TextBuffer || val === Const.wintype_Graphics))\n        {\n            return 1;\n        }\n        return 0;\n\n    case 8: // gestalt_Sound\n        return 0;\n\n    case 9: // gestalt_SoundVolume\n        return 0;\n\n    case 10: // gestalt_SoundNotify\n        return 0;\n\n    case 11: // gestalt_Hyperlinks\n        return support.hyperlinks || 0;\n\n    case 12: // gestalt_HyperlinkInput\n        if (support.hyperlinks && (val === Const.wintype_TextBuffer || val === Const.wintype_TextGrid))\n            return 1;\n        else\n            return 0;\n\n    case 13: // gestalt_SoundMusic\n        return 0;\n\n    case 14: // gestalt_GraphicsTransparency\n        return support.graphics || 0;\n\n    case 15: // gestalt_Unicode\n        return 1;\n\n    case 16: // gestalt_UnicodeNorm\n        return 1;\n\n    case 17: // gestalt_LineInputEcho\n        return 1;\n\n    case 18: // gestalt_LineTerminators\n        return 1;\n\n    case 19: // gestalt_LineTerminatorKey\n        /* Really this result should be inspected from glkote.js. Since it\n           isn't, be sure to keep these values in sync with \n           terminator_key_names. */\n        if (val == Const.keycode_Escape)\n            return 1;\n        if (val >= Const.keycode_Func12 && val <= Const.keycode_Func1)\n            return 1;\n        return 0;\n\n    case 20: // gestalt_DateTime\n        return 1;\n\n    case 21: // gestalt_Sound2\n        return 0;\n\n    case 22: // gestalt_ResourceStream\n        return 1;\n\n    case 23: // gestalt_GraphicsCharInput\n        return 0;\n\n    case 0x1100: // gestalt_GarglkText\n        return support.garglktext || 0\n    }\n\n    if (option_glk_gestalt_hook) {\n        var res = option_glk_gestalt_hook(sel, val, arr);\n        if (res !== undefined)\n            return res;\n    }\n\n    return 0;\n}\n\nfunction glk_window_iterate(win, rockref) {\n    if (!win)\n        win = gli_windowlist;\n    else\n        win = win.next;\n\n    if (win) {\n        if (rockref)\n            rockref.set_value(win.rock);\n        return win;\n    }\n\n    if (rockref)\n        rockref.set_value(0);\n    return null;\n}\n\nfunction glk_window_get_rock(win) {\n    if (!win)\n        throw('glk_window_get_rock: invalid window');\n    return win.rock;\n}\n\nfunction glk_window_get_root() {\n    return gli_rootwin;\n}\n\nfunction glk_window_open(splitwin, method, size, wintype, rock) {\n    var oldparent, box, val;\n    var pairwin, newwin;\n\n    if (!gli_rootwin) {\n        if (splitwin)\n            throw('glk_window_open: splitwin must be null for first window');\n\n        oldparent = null;\n        box = {\n            left: content_metrics.outspacingx,\n            top: content_metrics.outspacingy,\n            right: content_metrics.width-content_metrics.outspacingx,\n            bottom: content_metrics.height-content_metrics.outspacingy\n        };\n    }\n    else {\n        if (!splitwin)\n            throw('glk_window_open: splitwin must not be null');\n\n        val = (method & Const.winmethod_DivisionMask);\n        if (val != Const.winmethod_Fixed && val != Const.winmethod_Proportional)\n            throw('glk_window_open: invalid method (not fixed or proportional)');\n\n        val = (method & Const.winmethod_DirMask);\n        if (val != Const.winmethod_Above && val != Const.winmethod_Below \n            && val != Const.winmethod_Left && val != Const.winmethod_Right) \n            throw('glk_window_open: invalid method (bad direction)');\n        \n        box = splitwin.bbox;\n\n        oldparent = splitwin.parent;\n        if (oldparent && oldparent.type != Const.wintype_Pair) \n            throw('glk_window_open: parent window is not Pair');\n    }\n\n    newwin = gli_new_window(wintype, rock);\n\n    switch (newwin.type) {\n    case Const.wintype_TextBuffer:\n        /* accum is a list of strings of a given style; newly-printed text\n           is pushed onto the list. accumstyle is the style of that text.\n           Anything printed in a different style (or hyperlink value)\n           triggers a call to gli_window_buffer_deaccumulate, which cleans\n           out accum and adds the results to the content array. The content\n           is in GlkOte format.\n        */\n        newwin.accum = [];\n        newwin.accumstyle = null;\n        newwin.accumhyperlink = 0;\n        newwin.accum_fg = null\n        newwin.accum_bg = null\n        newwin.accum_reverse = null\n        newwin.content = [];\n        newwin.clearcontent = false;\n        newwin.reserve = []; /* autosave of recent content */\n        newwin.stylehints = clone_stylehints(stylehints.buffer)\n        break;\n    case Const.wintype_TextGrid:\n        /* lines is a list of line objects. A line looks like\n           { chars: [...], styles: [...], hyperlinks: [...], dirty: bool, fgs: [], bgs: [], reverses: [] }.\n        */\n        newwin.gridwidth = 0;\n        newwin.gridheight = 0;\n        newwin.lines = [];\n        newwin.cursorx = 0;\n        newwin.cursory = 0;\n        newwin.clearcontent = false;\n        newwin.stylehints = clone_stylehints(stylehints.grid)\n        break;\n    case Const.wintype_Graphics:\n        if (!support.graphics) {\n            /* Graphics windows not supported; silently return null */\n            gli_delete_window(newwin);\n            return null;\n        }\n        newwin.content = [];\n        newwin.reserve = []; /* autosave of recent content */\n        break;\n    case Const.wintype_Blank:\n        break;\n    case Const.wintype_Pair:\n        throw('glk_window_open: cannot open pair window directly')\n    default:\n        /* Silently return null */\n        gli_delete_window(newwin);\n        return null;\n    }\n\n    if (!splitwin) {\n        gli_rootwin = newwin;\n        gli_window_rearrange(newwin, box);\n    }\n    else {\n        /* create pairwin, with newwin as the key */\n        pairwin = gli_new_window(Const.wintype_Pair, 0);\n        pairwin.pair_dir = method & Const.winmethod_DirMask;\n        pairwin.pair_division = method & Const.winmethod_DivisionMask;\n        pairwin.pair_key = newwin;\n        pairwin.pair_keydamage = false;\n        pairwin.pair_size = size;\n        pairwin.pair_hasborder = ((method & Const.winmethod_BorderMask) == Const.winmethod_Border);\n        pairwin.pair_vertical = (pairwin.pair_dir == Const.winmethod_Left || pairwin.pair_dir == Const.winmethod_Right);\n        pairwin.pair_backward = (pairwin.pair_dir == Const.winmethod_Left || pairwin.pair_dir == Const.winmethod_Above);\n\n        pairwin.child1 = splitwin;\n        pairwin.child2 = newwin;\n        splitwin.parent = pairwin;\n        newwin.parent = pairwin;\n        pairwin.parent = oldparent;\n\n        if (oldparent) {\n            if (oldparent.child1 == splitwin)\n                oldparent.child1 = pairwin;\n            else\n                oldparent.child2 = pairwin;\n        }\n        else {\n            gli_rootwin = pairwin;\n        }\n\n        gli_window_rearrange(pairwin, box);\n    }\n\n    return newwin;\n}\n\nfunction glk_window_close(win, statsref) {\n    if (!win)\n        throw('glk_window_close: invalid window');\n\n    if (win === gli_rootwin || !win.parent) {\n        /* close the root window, which means all windows. */\n        \n        gli_rootwin = null;\n        \n        /* begin (simpler) closation */\n        \n        gli_stream_fill_result(win.str, statsref);\n        gli_window_close(win, true); \n    }\n    else {\n        /* have to jigger parent */\n        var pairwin, grandparwin, sibwin, box, wx, keydamage_flag;\n\n        pairwin = win.parent;\n        if (win === pairwin.child1)\n            sibwin = pairwin.child2;\n        else if (win === pairwin.child2)\n            sibwin = pairwin.child1;\n        else\n            throw('glk_window_close: window tree is corrupted');\n\n        box = pairwin.bbox;\n\n        grandparwin = pairwin.parent;\n        if (!grandparwin) {\n            gli_rootwin = sibwin;\n            sibwin.parent = null;\n        }\n        else {\n            if (grandparwin.child1 === pairwin)\n                grandparwin.child1 = sibwin;\n            else\n                grandparwin.child2 = sibwin;\n            sibwin.parent = grandparwin;\n        }\n        \n        /* Begin closation */\n        \n        gli_stream_fill_result(win.str, statsref);\n\n        /* Close the child window (and descendants), so that key-deletion can\n            crawl up the tree to the root window. */\n        gli_window_close(win, true); \n\n        /* This probably isn't necessary, but the child *is* gone, so just\n            in case. */\n        if (win === pairwin.child1) {\n            pairwin.child1 = null;\n        }\n        else if (win === pairwin.child2) {\n            pairwin.child2 = null;\n        }\n        \n        /* Now we can delete the parent pair. */\n        gli_window_close(pairwin, false);\n\n        keydamage_flag = false;\n        for (wx=sibwin; wx; wx=wx.parent) {\n            if (wx.type == Const.wintype_Pair) {\n                if (wx.pair_keydamage) {\n                    keydamage_flag = true;\n                    wx.pair_keydamage = false;\n                }\n            }\n        }\n        \n        if (keydamage_flag) {\n            // Zarf: what was this meant to be?\n            //box = content_box;\n            gli_window_rearrange(gli_rootwin, box);\n        }\n        else {\n            gli_window_rearrange(sibwin, box);\n        }\n    }\n}\n\nfunction glk_window_get_size(win, widthref, heightref) {\n    if (!win)\n        throw('glk_window_get_size: invalid window');\n\n    var wid = 0;\n    var hgt = 0;\n    var boxwidth, boxheight;\n\n    switch (win.type) {\n\n    case Const.wintype_TextGrid:\n        boxwidth = win.bbox.right - win.bbox.left;\n        boxheight = win.bbox.bottom - win.bbox.top;\n        wid = Math.max(0, Math.floor((boxwidth-content_metrics.gridmarginx) / content_metrics.gridcharwidth));\n        hgt = Math.max(0, Math.floor((boxheight-content_metrics.gridmarginy) / content_metrics.gridcharheight));        \n        break;\n\n    case Const.wintype_TextBuffer:\n        boxwidth = win.bbox.right - win.bbox.left;\n        boxheight = win.bbox.bottom - win.bbox.top;\n        wid = Math.max(0, Math.floor((boxwidth-content_metrics.buffermarginx) / content_metrics.buffercharwidth));\n        hgt = Math.max(0, Math.floor((boxheight-content_metrics.buffermarginy) / content_metrics.buffercharheight));        \n        break;\n\n    case Const.wintype_Graphics:\n        boxwidth = win.bbox.right - win.bbox.left;\n        boxheight = win.bbox.bottom - win.bbox.top;\n        wid = boxwidth - content_metrics.graphicsmarginx;\n        hgt = boxheight - content_metrics.graphicsmarginy;\n        break;\n    }\n\n    if (widthref)\n        widthref.set_value(wid);\n    if (heightref)\n        heightref.set_value(hgt);\n}\n\nfunction glk_window_set_arrangement(win, method, size, keywin) {\n    var wx, newdir, newvertical, newbackward;\n\n    if (!win)\n        throw('glk_window_set_arrangement: invalid window');\n    if (win.type != Const.wintype_Pair) \n        throw('glk_window_set_arrangement: not a pair window');\n\n    if (keywin) {\n        if (keywin.type == Const.wintype_Pair)\n            throw('glk_window_set_arrangement: keywin cannot be a pair window');\n        for (wx=keywin; wx; wx=wx.parent) {\n            if (wx == win)\n                break;\n        }\n        if (!wx)\n            throw('glk_window_set_arrangement: keywin must be a descendant');\n    }\n\n    newdir = method & Const.winmethod_DirMask;\n    newvertical = (newdir == Const.winmethod_Left || newdir == Const.winmethod_Right);\n    newbackward = (newdir == Const.winmethod_Left || newdir == Const.winmethod_Above);\n    if (!keywin)\n        keywin = win.pair_key;\n\n    if (newvertical && !win.pair_vertical)\n        throw('glk_window_set_arrangement: split must stay horizontal');\n    if (!newvertical && win.pair_vertical)\n        throw('glk_window_set_arrangement: split must stay vertical');\n\n    if (keywin && keywin.type == Const.wintype_Blank\n        && (method & Const.winmethod_DivisionMask) == Const.winmethod_Fixed) \n        throw('glk_window_set_arrangement: a blank window cannot have a fixed size');\n\n    if ((newbackward && !win.pair_backward) || (!newbackward && win.pair_backward)) {\n        /* switch the children */\n        wx = win.child1;\n        win.child1 = win.child2;\n        win.child2 = wx;\n    }\n\n    /* set up everything else */\n    win.pair_dir = newdir;\n    win.pair_division = (method & Const.winmethod_DivisionMask);\n    win.pair_key = keywin;\n    win.pair_size = size;\n\n    win.pair_hasborder = ((method & Const.winmethod_BorderMask) == Const.winmethod_Border);\n    win.pair_vertical = (win.pair_dir == Const.winmethod_Left || win.pair_dir == Const.winmethod_Right);\n    win.pair_backward = (win.pair_dir == Const.winmethod_Left || win.pair_dir == Const.winmethod_Above);\n\n    gli_window_rearrange(win, win.bbox);\n}\n\nfunction glk_window_get_arrangement(win, methodref, sizeref, keywinref) {\n    if (!win)\n        throw('glk_window_get_arrangement: invalid window');\n    if (win.type != Const.wintype_Pair) \n        throw('glk_window_get_arrangement: not a pair window');\n\n    if (sizeref)\n        sizeref.set_value(win.pair_size);\n    if (keywinref)\n        keywinref.set_value(win.pair_key);\n    if (methodref)\n        methodref.set_value(win.pair_dir | win.pair_division | (win.pair_hasborder ? Const.winmethod_Border : Const.winmethod_NoBorder));\n}\n\nfunction glk_window_get_type(win) {\n    if (!win)\n        throw('glk_window_get_type: invalid window');\n    return win.type;\n}\n\nfunction glk_window_get_parent(win) {\n    if (!win)\n        throw('glk_window_get_parent: invalid window');\n    return win.parent;\n}\n\nfunction glk_window_clear(win) {\n    if (!win)\n        throw('glk_window_clear: invalid window');\n    \n    if (win.line_request) {\n        throw('glk_window_clear: window has pending line request');\n    }\n\n    let setcol = null;\n    switch (win.type) {\n    case Const.wintype_TextBuffer:\n        win.accum.length = 0;\n        win.accumstyle = null;\n        win.accumhyperlink = 0;\n        win.accum_fg = null\n        win.accum_bg = null\n        win.accum_reverse = null\n        win.content.length = 0;\n        win.clearcontent = true;\n        win.cleared_bg = win.bg\n        win.cleared_fg = win.fg\n        break;\n    case Const.wintype_TextGrid:\n        win.cursorx = 0;\n        win.cursory = 0;\n        for (let ix=0; ix<win.gridheight; ix++) {\n            const lineobj = win.lines[ix];\n            lineobj.dirty = true;\n            for (let cx=0; cx<win.gridwidth; cx++) {\n                lineobj.chars[cx] = ' ';\n                lineobj.styles[cx] = Const.style_Normal;\n                lineobj.hyperlinks[cx] = 0;\n                lineobj.fgs[cx] = win.fg;\n                lineobj.bgs[cx] = win.bg;\n                lineobj.reverses[cx] = win.reverse;\n            }\n        }\n        win.clearcontent = true;\n        win.cleared_bg = win.bg\n        win.cleared_fg = win.fg\n        break;\n    case Const.wintype_Graphics:\n        /* If the background color has been set, we must retain that entry.\n           (The last setcolor, if there are several.) */\n        for (let ix=0; ix<win.content.length; ix++) {\n            if (win.content[ix].special == 'setcolor')\n                setcol = win.content[ix];\n        }\n        win.content.length = 0;\n        if (setcol !== null)\n            win.content.push(setcol);\n        win.content.push({ special: 'fill' }); /* clear to background color */\n        break;\n    }\n}\n\nfunction glk_window_move_cursor(win, xpos, ypos) {\n    if (!win)\n        throw('glk_window_move_cursor: invalid window');\n    \n    if (win.type == Const.wintype_TextGrid) {\n        /* No bounds-checking; we canonicalize when we print. */\n        win.cursorx = xpos;\n        win.cursory = ypos;\n    }\n    else {\n        throw('glk_window_move_cursor: not a grid window');\n    }\n}\n\nfunction glk_window_get_stream(win) {\n    if (!win)\n        throw('glk_window_get_stream: invalid window');\n    return win.str;\n}\n\nfunction glk_window_set_echo_stream(win, str) {\n    if (!win)\n        throw('glk_window_set_echo_stream: invalid window');\n    win.echostr = str;\n}\n\nfunction glk_window_get_echo_stream(win) {\n    if (!win)\n        throw('glk_window_get_echo_stream: invalid window');\n    return win.echostr;\n}\n\nfunction glk_set_window(win) {\n    if (!win)\n        gli_currentstr = null;\n    else\n        gli_currentstr = win.str;\n}\n\nfunction glk_window_get_sibling(win) {\n    if (!win)\n        throw('glk_window_get_sibling: invalid window');\n    const parent = win.parent;\n    if (!parent)\n        return null;\n    if (win === parent.child1)\n        return parent.child2;\n    else if (win === parent.child2)\n        return parent.child1;\n    else\n        throw('glk_window_get_sibling: window tree is corrupted');\n}\n\nfunction glk_stream_iterate(str, rockref) {\n    if (!str)\n        str = gli_streamlist;\n    else\n        str = str.next;\n\n    if (str) {\n        if (rockref)\n            rockref.set_value(str.rock);\n        return str;\n    }\n\n    if (rockref)\n        rockref.set_value(0);\n    return null;\n}\n\nfunction glk_stream_get_rock(str) {\n    if (!str)\n        throw('glk_stream_get_rock: invalid stream');\n    return str.rock;\n}\n\nfunction glk_stream_open_file(fref, fmode, rock) {\n    if (!fref)\n        throw('glk_stream_open_file: invalid fileref');\n\n    var str;\n    var fstream;\n\n    if (fmode != Const.filemode_Read \n        && fmode != Const.filemode_Write \n        && fmode != Const.filemode_ReadWrite \n        && fmode != Const.filemode_WriteAppend) \n        throw('glk_stream_open_file: illegal filemode');\n\n    if (fmode == Const.filemode_Read && !Dialog.file_ref_exists(fref.ref))\n        return null;\n\n    if (!Dialog.streaming) {\n        var content = null;\n        if (fmode != Const.filemode_Write) {\n            content = Dialog.file_read(fref.ref);\n        }\n        if (content == null) {\n            content = [];\n            if (fmode != Const.filemode_Read) {\n                /* We just created this file. (Or perhaps we're in Write mode\n                   and we're truncating.) Write immediately, to create it and\n                   get the creation date right. */\n                Dialog.file_write(fref.ref, '', true);\n            }\n        }\n        if (content.length == null) \n            throw('glk_stream_open_file: data read had no length');\n    }\n    else {\n        fstream = Dialog.file_fopen(fmode, fref.ref);\n        if (!fstream)\n            return null;\n    }\n\n    str = gli_new_stream(strtype_File, \n        (fmode != Const.filemode_Write), \n        (fmode != Const.filemode_Read), \n        rock);\n    str.unicode = false;\n    str.isbinary = !fref.textmode;\n    str.ref = fref.ref;\n    str.origfmode = fmode;\n\n    if (!Dialog.streaming) {\n        str.streaming = false;\n        str.buf = content;\n        str.buflen = 0xFFFFFFFF; /* enormous */\n        if (fmode == Const.filemode_Write)\n            str.bufeof = 0;\n        else\n            str.bufeof = content.length;\n        if (fmode == Const.filemode_WriteAppend)\n            str.bufpos = str.bufeof;\n        else\n            str.bufpos = 0;\n    }\n    else {\n        str.streaming = true;\n        str.fstream = fstream;\n        /* We'll want a Buffer object around for short and writes. */\n        str.buffer4 = fstream.BufferClass.alloc(4);\n    }\n\n    return str;\n}\n\nfunction glk_stream_open_memory(buf, fmode, rock) {\n    var str;\n\n    if (fmode != Const.filemode_Read \n        && fmode != Const.filemode_Write \n        && fmode != Const.filemode_ReadWrite) \n        throw('glk_stream_open_memory: illegal filemode');\n\n    str = gli_new_stream(strtype_Memory, \n        (fmode != Const.filemode_Write), \n        (fmode != Const.filemode_Read), \n        rock);\n    str.unicode = false;\n\n    if (buf) {\n        str.buf = buf;\n        str.buflen = buf.length;\n        str.bufpos = 0;\n        if (fmode == Const.filemode_Write)\n            str.bufeof = 0;\n        else\n            str.bufeof = str.buflen;\n        if (GiDispa)\n            GiDispa.retain_array(buf);\n    }\n\n    return str;\n}\n\nfunction glk_stream_open_resource(filenum, rock) {\n    var str;\n\n    if (!Blorb || !Blorb.find_data_chunk)\n        return null;\n    var el = Blorb.find_data_chunk(filenum);\n    if (!el)\n        return null;\n\n    var buf = el.data;\n    var isbinary = (el.type == 'BINA');\n\n    str = gli_new_stream(strtype_Resource,\n        true, \n        false, \n        rock);\n    str.unicode = false;\n    str.isbinary = isbinary;\n\n    str.resfilenum = filenum;\n\n    /* Resource streams always use buffer mode. */\n    str.streaming = false;\n\n    /* We have been handed an array of bytes. (They're big-endian four-byte\n       chunks, or perhaps a UTF-8 byte sequence, rather than native-endian\n       four-byte integers). We'll have to do the translation in the get()\n       functions. */\n\n    if (buf) {\n        str.buf = buf;\n        str.buflen = buf.length;\n        str.bufpos = 0;\n        str.bufeof = str.buflen;\n    }\n\n    return str;\n}\n\nfunction glk_stream_open_resource_uni(filenum, rock) {\n    var str;\n\n    if (!Blorb || !Blorb.find_data_chunk)\n        return null;\n    var el = Blorb.find_data_chunk(filenum);\n    if (!el)\n        return null;\n\n    var buf = el.data;\n    var isbinary = (el.type == 'BINA');\n\n    str = gli_new_stream(strtype_Resource,\n        true, \n        false, \n        rock);\n    str.unicode = true;\n    str.isbinary = isbinary;\n\n    str.resfilenum = filenum;\n\n    /* Resource streams always use buffer mode. */\n    str.streaming = false;\n\n    /* We have been handed an array of bytes. (They're big-endian four-byte\n       chunks, or perhaps a UTF-8 byte sequence, rather than native-endian\n       four-byte integers). We'll have to do the translation in the get()\n       functions. */\n\n    if (buf) {\n        str.buf = buf;\n        str.buflen = buf.length;\n        str.bufpos = 0;\n        str.bufeof = str.buflen;\n    }\n\n    return str;\n}\n\nfunction glk_stream_close(str, result) {\n    if (!str)\n        throw('glk_stream_close: invalid stream');\n\n    if (str.type == strtype_Window)\n        throw('glk_stream_close: cannot close window stream');\n\n    if (str.type == strtype_File && str.writable) {\n        if (!str.streaming) {\n            if (!(str.timer_id === null)) {\n                clearTimeout(str.timer_id);\n                str.timer_id = null;\n            }\n            Dialog.file_write(str.ref, str.buf);\n        }\n    }\n\n    gli_stream_fill_result(str, result);\n    gli_delete_stream(str);\n}\n\nfunction glk_stream_set_position(str, pos, seekmode) {\n    if (!str)\n        throw('glk_stream_set_position: invalid stream');\n\n    switch (str.type) {\n    case strtype_File:\n        if (str.streaming) {\n            str.fstream.fseek(pos, seekmode);\n            break;\n        }\n        //### check if file has been modified? This is a half-decent time.\n        /* fall through to memory... */\n    case strtype_Resource:\n        /* fall through to memory... */\n    case strtype_Memory:\n        if (seekmode == Const.seekmode_Current) {\n            pos = str.bufpos + pos;\n        }\n        else if (seekmode == Const.seekmode_End) {\n            pos = str.bufeof + pos;\n        }\n        else {\n            /* pos = pos */\n        }\n        if (pos < 0)\n            pos = 0;\n        if (pos > str.bufeof)\n            pos = str.bufeof;\n        str.bufpos = pos;\n    }\n}\n\nfunction glk_stream_get_position(str) {\n    if (!str)\n        throw('glk_stream_get_position: invalid stream');\n\n    switch (str.type) {\n    case strtype_File:\n        if (str.streaming) {\n            return str.fstream.ftell();\n        }\n        /* fall through to memory... */\n    case strtype_Resource:\n        /* fall through to memory... */\n    case strtype_Memory:\n        return str.bufpos;\n    default:\n        return 0;\n    }\n}\n\nfunction glk_stream_set_current(str) {\n    gli_currentstr = str;\n}\n\nfunction glk_stream_get_current() {\n    return gli_currentstr;\n}\n\nfunction glk_fileref_create_temp(usage, rock) {\n    var filetype = (usage & Const.fileusage_TypeMask);\n    var filetypename = FileTypeMap[filetype];\n    var ref = Dialog.file_construct_temp_ref(filetypename);\n    var fref = gli_new_fileref(ref.filename, usage, rock, ref);\n    return fref;\n}\n\nfunction glk_fileref_create_by_name(usage, filename, rock) {\n    /* Filenames that do not come from the user must be cleaned up. */\n    filename = Dialog.file_clean_fixed_name(filename, (usage & Const.fileusage_TypeMask));\n\n    var fref = gli_new_fileref(filename, usage, rock, null);\n    return fref;\n}\n\nfunction glk_fileref_create_by_prompt(usage, fmode, rock) {\n    var modename;\n\n    var filetype = (usage & Const.fileusage_TypeMask);\n    var filetypename = FileTypeMap[filetype];\n    if (!filetypename) {\n        filetypename = 'xxx';\n    }\n\n    switch (fmode) {\n        case Const.filemode_Write:\n            modename = 'write';\n            break;\n        case Const.filemode_ReadWrite:\n            modename = 'readwrite';\n            break;\n        case Const.filemode_WriteAppend:\n            modename = 'writeappend';\n            break;\n        case Const.filemode_Read:\n        default:\n            modename = 'read';\n            break;\n    }\n\n    var special = {\n        type: 'fileref_prompt',\n        filetype: filetypename,\n        filemode: modename\n    };\n    var callback = {\n        usage: usage,\n        rock: rock\n    };\n\n    if (filetype == Const.fileusage_SavedGame)\n        special.gameid = VM.get_signature();\n\n    ui_specialinput = special;\n    ui_specialcallback = callback;\n    gli_selectref = null;\n    return DidNotReturn;\n}\n\nfunction gli_fileref_create_by_prompt_callback(obj) {\n    var ref = obj.value;\n    var usage = ui_specialcallback.usage;\n    var rock = ui_specialcallback.rock;\n\n    var fref = null;\n    if (ref) {\n        fref = gli_new_fileref(ref.filename, usage, rock, ref);\n    }\n\n    ui_specialinput = null;\n    ui_specialcallback = null;\n\n    if (GiDispa)\n        GiDispa.prepare_resume(fref);\n    VM.resume(fref);\n}\n\nfunction glk_fileref_destroy(fref) {\n    if (!fref)\n        throw('glk_fileref_destroy: invalid fileref');\n    gli_delete_fileref(fref);\n}\n\nfunction glk_fileref_iterate(fref, rockref) {\n    if (!fref)\n        fref = gli_filereflist;\n    else\n        fref = fref.next;\n\n    if (fref) {\n        if (rockref)\n            rockref.set_value(fref.rock);\n        return fref;\n    }\n\n    if (rockref)\n        rockref.set_value(0);\n    return null;\n}\n\nfunction glk_fileref_get_rock(fref) {\n    if (!fref)\n        throw('glk_fileref_get_rock: invalid fileref');\n    return fref.rock;\n}\n\nfunction glk_fileref_delete_file(fref) {\n    if (!fref)\n        throw('glk_fileref_delete_file: invalid fileref');\n    Dialog.file_remove_ref(fref.ref);\n}\n\nfunction glk_fileref_does_file_exist(fref) {\n    if (!fref)\n        throw('glk_fileref_does_file_exist: invalid fileref');\n    if (Dialog.file_ref_exists(fref.ref))\n        return 1;\n    else\n        return 0;\n}\n\nfunction glk_fileref_create_from_fileref(usage, oldfref, rock) {\n    if (!oldfref)\n        throw('glk_fileref_create_from_fileref: invalid fileref');\n    \n    var fref = gli_new_fileref(oldfref.filename, usage, rock, null);\n    return fref;\n}\n\nfunction glk_put_char(ch) {\n    gli_put_char(gli_currentstr, ch & 0xFF);\n}\n\nfunction glk_put_char_stream(str, ch) {\n    gli_put_char(str, ch & 0xFF);\n}\n\nfunction glk_put_string(val) {\n    glk_put_jstring_stream(gli_currentstr, val, true);\n}\n\nfunction glk_put_string_stream(str, val) {\n    glk_put_jstring_stream(str, val, true);\n}\n\nfunction glk_put_buffer(arr) {\n    arr = TrimArrayToBytes(arr);\n    gli_put_array(gli_currentstr, arr, true);\n}\n\nfunction glk_put_buffer_stream(str, arr) {\n    arr = TrimArrayToBytes(arr);\n    gli_put_array(str, arr, true);\n}\n\nfunction glk_set_style(val) {\n    gli_set_style(gli_currentstr, val);\n}\n\nfunction glk_set_style_stream(str, val) {\n    gli_set_style(str, val);\n}\n\nfunction glk_get_char_stream(str) {\n    if (!str)\n        throw('glk_get_char_stream: invalid stream');\n    return gli_get_char(str, false);\n}\n\nfunction glk_get_line_stream(str, buf) {\n    if (!str)\n        throw('glk_get_line_stream: invalid stream');\n    return gli_get_line(str, buf, false);\n}\n\nfunction glk_get_buffer_stream(str, buf) {\n    if (!str)\n        throw('glk_get_buffer_stream: invalid stream');\n    return gli_get_buffer(str, buf, false);\n}\n\nfunction glk_char_to_lower(val) {\n    if (val >= 0x41 && val <= 0x5A)\n        return val + 0x20;\n    if (val >= 0xC0 && val <= 0xDE && val != 0xD7)\n        return val + 0x20;\n    return val;\n}\n\nfunction glk_char_to_upper(val) {\n    if (val >= 0x61 && val <= 0x7A)\n        return val - 0x20;\n    if (val >= 0xE0 && val <= 0xFE && val != 0xF7)\n        return val - 0x20;\n    return val;\n}\n\n/* Style hints */\n\nvar last_page_bg = null\nvar stylehints = {\n    buffer: {},\n    grid: {},\n}\n\nfunction clone_stylehints(stylehints) {\n    const newstylehints = {}\n    for (const [selector, styles] of Object.entries(stylehints)) {\n        newstylehints[selector] = Object.assign({}, styles)\n    }\n    return newstylehints\n}\n\nconst STYLE_NAMES = ['normal', 'emphasized', 'preformatted', 'header', 'subheader', 'alert', 'note', 'blockquote', 'input', 'user1', 'user2']\nconst CSS_STYLE_PROPERTIES = ['margin-left', 'text-indent', 'text-align', 'font-size', 'font-weight', 'font-style', 'monospace', 'color', 'background-color', 'reverse']\n\n// Handle autorestoring the old style stylehints\nfunction restore_stylehints(stylehints) {\n    if (Array.isArray(stylehints)) {\n        const res = {}\n        for (const [stylenum, stylehint] of stylehints.entries()) {\n            for (const [css_style, value] of Object.entries(stylehint)) {\n                const selector = `${['margin-left', 'text-indent','text-align'].includes(css_style) ? 'div' : 'span'}.Style_${STYLE_NAMES[stylenum]}`\n                if (!res[selector]) {\n                    res[selector] = {}\n                }\n                res[selector][css_style] = value\n            }\n        }\n        return res\n    }\n    return stylehints\n}\n\nfunction glk_stylehint_set(wintype, style, hint, value) {\n    if (wintype === Const.wintype_AllTypes || wintype === Const.wintype_TextBuffer) {\n        add_css_style(stylehints.buffer, style, hint, value)\n    }\n\n    if ((wintype === Const.wintype_AllTypes || wintype === Const.wintype_TextGrid) && hint !== Const.stylehint_Proportional) {\n        add_css_style(stylehints.grid, style, hint, value)\n    }\n}\n\nfunction add_css_style(styles, style, hint, value) {\n    const selector = `${hint <= Const.stylehint_Justification ? 'div' : 'span'}.Style_${STYLE_NAMES[style]}`\n    var stylevalue\n    var justifications = ['left', 'justify', 'center', 'right']\n    var weights = ['lighter', 'normal', 'bold']\n\n    if (hint === Const.stylehint_Indentation)\n    {\n        stylevalue = value + 'em'\n    }\n\n    if (hint === Const.stylehint_ParaIndentation)\n    {\n        stylevalue = value + 'em'\n    }\n\n    if (hint === Const.stylehint_Justification)\n    {\n        stylevalue = justifications[value]\n    }\n\n    if (hint === Const.stylehint_Size)\n    {\n        stylevalue = (1 + value * 0.1) + 'em'\n    }\n\n    if (hint === Const.stylehint_Weight)\n    {\n        stylevalue = weights[value + 1]\n    }\n\n    if (hint === Const.stylehint_Oblique)\n    {\n        stylevalue = value ? 'italic': 'normal'\n    }\n\n    if (hint === Const.stylehint_Proportional)\n    {\n        stylevalue = value ? 0 : 1\n    }\n\n    if (hint === Const.stylehint_TextColor)\n    {\n        stylevalue = '#' + ('000000' + value.toString(16)).slice(-6)\n    }\n\n    if (hint === Const.stylehint_BackColor)\n    {\n        stylevalue = '#' + ('000000' + value.toString(16)).slice(-6)\n    }\n\n    if (hint === Const.stylehint_ReverseColor)\n    {\n        stylevalue = value\n    }\n\n    if (!styles[selector]) {\n        styles[selector] = {}\n    }\n    styles[selector][CSS_STYLE_PROPERTIES[hint]] = stylevalue\n}\n\nfunction glk_stylehint_clear(wintype, style, hint) {\n    const selector = `${hint <= Const.stylehint_Justification ? 'div' : 'span'}.Style_${STYLE_NAMES[style]}`\n    function remove_style(styles) {\n        if (styles[selector]) {\n            delete styles[selector][CSS_STYLE_PROPERTIES[hint]]\n            if (!Object.keys(styles[selector]).length) {\n                delete styles[selector]\n            }\n        }\n    }\n\n    if (wintype === Const.wintype_AllTypes || wintype === Const.wintype_TextBuffer) {\n        remove_style(stylehints.buffer)\n    }\n\n    if (wintype === Const.wintype_AllTypes || wintype === Const.wintype_TextGrid) {\n        remove_style(stylehints.grid)\n    }\n}\n\nfunction glk_style_distinguish(/*win, styl1, styl2*/) {\n    return 0;\n}\n\nfunction glk_style_measure(win, styl, hint, resultref) {\n    if (resultref)\n        resultref.set_value(0);\n    return 0;\n}\n\n// Gargolye text formatting functions\n\nfunction garglk_set_zcolors(fg, bg)\n{\n    garglk_set_zcolors_stream(gli_currentstr, fg, bg)\n}\n\nfunction garglk_set_zcolors_stream(str, fg, bg)\n{\n    if (!str || !str.writable)\n    {\n        throw('garglk_set_zcolors: invalid stream')\n    }\n\n    fg = fg >> 0\n    bg = bg >> 0\n    if (str.type == strtype_Window)\n    {\n        if (fg !== -2)\n        {\n            str.win.fg = fg === -1 ? null : '#' + ('000000' + fg.toString(16)).slice(-6)\n        }\n        if (bg !== -2)\n        {\n            str.win.bg = bg === -1 ? null : '#' + ('000000' + bg.toString(16)).slice(-6)\n        }\n        if (str.win.echostr)\n        {\n            garglk_set_zcolors_stream(str.win.echostr, fg, bg)\n        }\n    }\n}\n\nfunction garglk_set_reversevideo(reverse)\n{\n    garglk_set_reversevideo_stream(gli_currentstr, reverse)\n}\n\nfunction garglk_set_reversevideo_stream(str, reverse)\n{\n    if (!str || !str.writable)\n    {\n        throw('garglk_set_reversevideo: invalid stream')\n    }\n\n    if (str.type == strtype_Window)\n    {\n        str.win.reverse = reverse || null\n        if (str.win.echostr)\n        {\n            garglk_set_reversevideo_stream(str.win.echostr, reverse)\n        }\n    }\n}\n\nfunction glk_select(eventref) {\n    gli_selectref = eventref;\n    return DidNotReturn;\n}\n\nfunction glk_select_poll(eventref) {\n    /* Because the Javascript interpreter is single-threaded, we cannot\n       have gotten a timer event since the last glk_select call. */\n\n    eventref.set_field(0, Const.evtype_None);\n    eventref.set_field(1, null);\n    eventref.set_field(2, 0);\n    eventref.set_field(3, 0);\n\n    if (gli_timer_interval) {\n        var now = Date.now();\n        if (now - gli_timer_started > gli_timer_interval) {\n            /* We're past the timer interval, even though we got no\n               event. Let's pretend we did, reset it, and return a\n               timer event. */\n            gli_timer_started = Date.now();\n            /* Resend timer request at next update. */\n            gli_timer_lastsent = null;\n\n            eventref.set_field(0, Const.evtype_Timer);\n        }\n    }\n}\n\nfunction glk_request_line_event(win, buf, initlen) {\n    if (!win)\n        throw('glk_request_line_event: invalid window');\n    if (win.char_request || win.line_request)\n        throw('glk_request_line_event: window already has keyboard request');\n\n    if (win.type == Const.wintype_TextBuffer \n        || win.type == Const.wintype_TextGrid) {\n        if (initlen) {\n            /* This will be copied into the next update. */\n            var ls = buf.slice(0, initlen);\n            if (!current_partial_outputs)\n                current_partial_outputs = {};\n            current_partial_outputs[win.disprock] = ByteArrayToString(ls);\n        }\n        win.line_request = true;\n        win.line_request_uni = false;\n        if (win.type == Const.wintype_TextBuffer)\n            win.request_echo_line_input = win.echo_line_input;\n        else\n            win.request_echo_line_input = true;\n        win.input_generation = event_generation;\n        win.linebuf = buf;\n        if (GiDispa)\n            GiDispa.retain_array(buf);\n    }\n    else {\n        throw('glk_request_line_event: window does not support keyboard input');\n    }\n}\n\nfunction glk_cancel_line_event(win, eventref) {\n    if (!win)\n        throw('glk_cancel_line_event: invalid window');\n\n    if (!win.line_request) {\n        if (eventref) {\n            eventref.set_field(0, Const.evtype_None);\n            eventref.set_field(1, null);\n            eventref.set_field(2, 0);\n            eventref.set_field(3, 0);\n        }\n        return;\n    }\n\n    var input = \"\";\n    var ix, val;\n\n    if (current_partial_inputs) {\n        val = current_partial_inputs[win.disprock];\n        if (val) \n            input = val;\n    }\n\n    if (input.length > win.linebuf.length)\n        input = input.slice(0, win.linebuf.length);\n\n    if (win.request_echo_line_input) {\n        ix = win.style;\n        gli_set_style(win.str, Const.style_Input);\n        gli_window_put_string(win, input);\n        if (win.echostr)\n            glk_put_jstring_stream(win.echostr, input);\n        gli_set_style(win.str, ix);\n        gli_window_put_string(win, \"\\n\");\n        if (win.echostr)\n            glk_put_jstring_stream(win.echostr, \"\\n\");\n    }\n\n    for (ix=0; ix<input.length; ix++)\n        win.linebuf[ix] = input.charCodeAt(ix);\n\n    if (eventref) {\n        eventref.set_field(0, Const.evtype_LineInput);\n        eventref.set_field(1, win);\n        eventref.set_field(2, input.length);\n        eventref.set_field(3, 0);\n    }\n\n    if (GiDispa)\n        GiDispa.unretain_array(win.linebuf);\n    win.line_request = false;\n    win.line_request_uni = false;\n    win.request_echo_line_input = null;\n    win.input_generation = null;\n    win.linebuf = null;\n}\n\nfunction glk_request_char_event(win) {\n    if (!win)\n        throw('glk_request_char_event: invalid window');\n    if (win.char_request || win.line_request)\n        throw('glk_request_char_event: window already has keyboard request');\n\n    if (win.type == Const.wintype_TextBuffer \n        || win.type == Const.wintype_TextGrid) {\n        win.char_request = true;\n        win.char_request_uni = false;\n        win.input_generation = event_generation;\n    }\n    else {\n        /* ### wintype_Graphics could accept char input if we set up the focus to allow it. See gestalt_GraphicsCharInput. */\n        throw('glk_request_char_event: window does not support keyboard input');\n    }\n}\n\nfunction glk_cancel_char_event(win) {\n    if (!win)\n        throw('glk_cancel_char_event: invalid window');\n\n    win.char_request = false;\n    win.char_request_uni = false;\n}\n\nfunction glk_set_echo_line_event(win, val) {\n   if (!win)\n        throw('glk_set_echo_line_event: invalid window');\n\n   win.echo_line_input = (val != 0);\n}\n\nfunction glk_set_terminators_line_event(win, arr) {\n   if (!win)\n        throw('glk_set_terminators_line_event: invalid window');\n\n   if (KeystrokeValueMap === null) {\n       /* First, we have to build this map. (It's only used by this\n          function, which is why the constructor code is here. */\n       KeystrokeValueMap = {};\n       for (let val in KeystrokeNameMap) {\n           KeystrokeValueMap[KeystrokeNameMap[val]] = val;\n       }\n   }\n\n   const res = [];\n   if (arr) {\n       for (let ix=0; ix<arr.length; ix++) {\n           const val = KeystrokeValueMap[arr[ix]];\n           if (val)\n               res.push(val);\n       }\n   }\n   win.line_input_terminators = res;\n}\n\nfunction glk_request_mouse_event(win) {\n    if (!win)\n        throw('glk_request_mouse_event: invalid window');\n    if (win.type == Const.wintype_TextGrid\n        || win.type == Const.wintype_Graphics) {\n        win.mouse_request = true;\n    }\n    /* else ignore request */\n}\n\nfunction glk_cancel_mouse_event(win) {\n    if (!win)\n        throw('glk_cancel_mouse_event: invalid window');\n    win.mouse_request = false;\n}\n\nfunction glk_request_timer_events(msec) {\n    if (!msec) {\n        gli_timer_interval = null;\n        gli_timer_started = null;\n    }\n    else {\n        gli_timer_interval = msec;\n        gli_timer_started = Date.now();\n    }\n}\n\n/* Graphics functions. */\n\nfunction glk_image_get_info(imgid, widthref, heightref) {\n    if (!Blorb || !Blorb.get_image_info)\n        return null;\n\n    var info = Blorb.get_image_info(imgid);\n    if (info) {\n        if (widthref)\n            widthref.set_value(info.width);\n        if (heightref)\n            heightref.set_value(info.height);\n        return 1;\n    }\n    if (widthref)\n        widthref.set_value(0);\n    if (heightref)\n        heightref.set_value(0);\n    return 0;\n}\n\nfunction glk_image_draw(win, imgid, val1, val2) {\n    if (!win)\n        throw('glk_image_draw: invalid window');\n\n    if (!Blorb || !Blorb.get_image_info)\n        return 0;\n    var info = Blorb.get_image_info(imgid);\n    if (!info)\n        return 0;\n\n    var img = { special:'image', image:imgid, \n                url:info.url, alttext:info.alttext,\n                width:info.width, height:info.height };\n\n    switch (win.type) {\n    case Const.wintype_TextBuffer:\n        var alignment = 'inlineup';\n        switch (val1) {\n            case Const.imagealign_InlineUp:\n                alignment = 'inlineup';\n                break;\n            case Const.imagealign_InlineDown:\n                alignment = 'inlinedown';\n                break;\n            case Const.imagealign_InlineCenter:\n                alignment = 'inlinecenter';\n                break;\n            case Const.imagealign_MarginLeft:\n                alignment = 'marginleft';\n                break;\n            case Const.imagealign_MarginRight:\n                alignment = 'marginright';\n                break;\n        }\n        img.alignment = alignment;\n        if (win.hyperlink)\n            img.hyperlink = win.hyperlink;\n        gli_window_buffer_put_special(win, img);\n        return 1;\n\n    case Const.wintype_Graphics:\n        img.x = val1;\n        img.y = val2;\n        win.content.push(img);\n        return 1;\n    }\n\n    return 0;\n}\n\nfunction glk_image_draw_scaled(win, imgid, val1, val2, width, height) {\n    if (!win)\n        throw('glk_image_draw_scaled: invalid window');\n\n    if (!Blorb || !Blorb.get_image_info)\n        return 0;\n    var info = Blorb.get_image_info(imgid);\n    if (!info)\n        return 0;\n\n    /* Same as above, except we use the passed-in width and height\n       values */\n    var img = { special:'image', image:imgid, \n                url:info.url, alttext:info.alttext,\n                width:width, height:height };\n\n    switch (win.type) {\n    case Const.wintype_TextBuffer:\n        var alignment = 'inlineup';\n        switch (val1) {\n            case Const.imagealign_InlineUp:\n                alignment = 'inlineup';\n                break;\n            case Const.imagealign_InlineDown:\n                alignment = 'inlinedown';\n                break;\n            case Const.imagealign_InlineCenter:\n                alignment = 'inlinecenter';\n                break;\n            case Const.imagealign_MarginLeft:\n                alignment = 'marginleft';\n                break;\n            case Const.imagealign_MarginRight:\n                alignment = 'marginright';\n                break;\n        }\n        img.alignment = alignment;\n        if (win.hyperlink)\n            img.hyperlink = win.hyperlink;\n        gli_window_buffer_put_special(win, img);\n        return 1;\n\n    case Const.wintype_Graphics:\n        img.x = val1;\n        img.y = val2;\n        /* width, height already set */\n        win.content.push(img);\n        return 1;\n    }\n\n    return 0;\n}\n\nfunction glk_window_flow_break(win) {\n    if (!win)\n        throw('glk_window_flow_break: invalid window');\n\n    if (win.type == Const.wintype_TextBuffer)\n        gli_window_buffer_put_special(win, undefined, true);\n}\n\nfunction glk_window_erase_rect(win, left, top, width, height) {\n    if (!win)\n        throw('glk_window_erase_rect: invalid window');\n    if (win.type != Const.wintype_Graphics)\n        throw('glk_window_erase_rect: not a graphics window');\n\n    win.content.push({ special:'fill', x:left, y:top, width:width, height:height });\n}\n\nfunction glk_window_fill_rect(win, color, left, top, width, height) {\n    if (!win)\n        throw('glk_window_fill_rect: invalid window');\n    if (win.type != Const.wintype_Graphics)\n        throw('glk_window_fill_rect: not a graphics window');\n\n    var colstr = gli_color_to_css(color);\n    win.content.push({ special:'fill', color:colstr, x:left, y:top, width:width, height:height });\n}\n\nfunction glk_window_set_background_color(win, color) {\n    if (!win)\n        throw('glk_window_set_background_color: invalid window');\n    if (win.type != Const.wintype_Graphics)\n        throw('glk_window_set_background_color: not a graphics window');\n\n    var colstr = gli_color_to_css(color);\n    win.content.push({ special:'setcolor', color:colstr });\n}\n\n/* Convert a Glk numeric color value to a CSS-compatible string.\n*/\nfunction gli_color_to_css(color) {\n    var res = (color & 0xFFFFFF).toString(16);\n    while (res.length < 6) {\n        res = '0' + res;\n    }\n    return '#' + res.toUpperCase();\n}\n\nfunction glk_schannel_iterate(schan, rockref) {\n    if (!schan)\n        schan = gli_schannellist;\n    else\n        schan = schan.next;\n\n    if (schan) {\n        if (rockref)\n            rockref.set_value(schan.rock);\n        return schan;\n    }\n\n    if (rockref)\n        rockref.set_value(0);\n    return null;\n}\n\nfunction glk_schannel_get_rock(schan) {\n    if (!schan)\n        throw('glk_schannel_get_rock: invalid schannel');\n    return schan.rock;\n}\n\nfunction glk_schannel_create(/*rock*/) {\n    return null;\n}\n\nfunction glk_schannel_destroy(/*schan*/) {\n    throw('glk_schannel_destroy: invalid schannel');\n}\n\nfunction glk_schannel_play(/*schan, sndid*/) {\n    throw('glk_schannel_play: invalid schannel');\n}\n\nfunction glk_schannel_play_ext(/*schan, sndid, repeats, notify*/) {\n    throw('glk_schannel_play_ext: invalid schannel');\n}\n\nfunction glk_schannel_stop(/*schan*/) {\n    throw('glk_schannel_stop: invalid schannel');\n}\n\nfunction glk_schannel_set_volume(/*schan, vol*/) {\n    throw('glk_schannel_set_volume: invalid schannel');\n}\n\nfunction glk_sound_load_hint(/*sndid, flag*/) {\n}\n\nfunction glk_schannel_create_ext(/*rock, vol*/) {\n    return null;\n}\n\nfunction glk_schannel_play_multi(/*schans, sndids, notify*/) {\n    throw('glk_schannel_play_multi: invalid schannel');\n}\n\nfunction glk_schannel_pause(/*schan*/) {\n    throw('glk_schannel_pause: invalid schannel');\n}\n\nfunction glk_schannel_unpause(/*schan*/) {\n    throw('glk_schannel_unpause: invalid schannel');\n}\n\nfunction glk_schannel_set_volume_ext(/*schan, vol, duration, notify*/) {\n    throw('glk_schannel_set_volume_ext: invalid schannel');\n}\n\nfunction glk_set_hyperlink(val) {\n    gli_set_hyperlink(gli_currentstr, val);\n}\n\nfunction glk_set_hyperlink_stream(str, val) {\n    gli_set_hyperlink(str, val);\n}\n\nfunction glk_request_hyperlink_event(win) {\n    if (!win)\n        throw('glk_request_hyperlink_event: invalid window');\n    if (win.type == Const.wintype_TextBuffer \n        || win.type == Const.wintype_TextGrid) {\n        win.hyperlink_request = true;\n    }\n}\n\nfunction glk_cancel_hyperlink_event(win) {\n    if (!win)\n        throw('glk_cancel_hyperlink_event: invalid window');\n    if (win.type == Const.wintype_TextBuffer \n        || win.type == Const.wintype_TextGrid) {\n        win.hyperlink_request = false;\n    }\n}\n\nfunction glk_buffer_to_lower_case_uni(arr, numchars) {\n    var ix, jx, pos, val, origval;\n    var arrlen = arr.length;\n    var src = arr.slice(0, numchars);\n\n    if (arrlen < numchars)\n        throw('buffer_to_lower_case_uni: numchars exceeds array length');\n\n    pos = 0;\n    for (ix=0; ix<numchars; ix++) {\n        origval = src[ix];\n        val = unicode_lower_table[origval];\n        if (val === undefined) {\n            arr[pos] = origval;\n            pos++;\n        }\n        else if (!(val instanceof Array)) {\n            arr[pos] = val;\n            pos++;\n        }\n        else {\n            for (jx=0; jx<val.length; jx++) {\n                arr[pos] = val[jx];\n                pos++;\n            }\n        }\n    }\n\n    /* in case we stretched the array */\n    arr.length = arrlen;\n\n    return pos;\n}\n\nfunction glk_buffer_to_upper_case_uni(arr, numchars) {\n    var ix, jx, pos, val, origval;\n    var arrlen = arr.length;\n    var src = arr.slice(0, numchars);\n\n    if (arrlen < numchars)\n        throw('buffer_to_upper_case_uni: numchars exceeds array length');\n\n    pos = 0;\n    for (ix=0; ix<numchars; ix++) {\n        origval = src[ix];\n        val = unicode_upper_table[origval];\n        if (val === undefined) {\n            arr[pos] = origval;\n            pos++;\n        }\n        else if (!(val instanceof Array)) {\n            arr[pos] = val;\n            pos++;\n        }\n        else {\n            for (jx=0; jx<val.length; jx++) {\n                arr[pos] = val[jx];\n                pos++;\n            }\n        }\n    }\n\n    /* in case we stretched the array */\n    arr.length = arrlen;\n\n    return pos;\n}\n\nfunction glk_buffer_to_title_case_uni(arr, numchars, lowerrest) {\n    var ix, jx, pos, val, origval;\n    var arrlen = arr.length;\n    var src = arr.slice(0, numchars);\n\n    if (arrlen < numchars)\n        throw('buffer_to_title_case_uni: numchars exceeds array length');\n\n    pos = 0;\n\n    if (numchars == 0)\n        return 0;\n\n    ix = 0;\n    {\n        origval = src[ix];\n        val = unicode_title_table[origval];\n        if (val === undefined) {\n            val = unicode_upper_table[origval];\n        }\n        if (val === undefined) {\n            arr[pos] = origval;\n            pos++;\n        }\n        else if (!(val instanceof Array)) {\n            arr[pos] = val;\n            pos++;\n        }\n        else {\n            for (jx=0; jx<val.length; jx++) {\n                arr[pos] = val[jx];\n                pos++;\n            }\n        }\n    }\n    \n    if (!lowerrest) {\n        for (ix=1; ix<numchars; ix++) {\n            origval = src[ix];\n            arr[pos] = origval;\n            pos++;\n        }\n    }\n    else {\n        for (ix=1; ix<numchars; ix++) {\n            origval = src[ix];\n            val = unicode_lower_table[origval];\n            if (val === undefined) {\n                arr[pos] = origval;\n                pos++;\n            }\n            else if (!(val instanceof Array)) {\n                arr[pos] = val;\n                pos++;\n            }\n            else {\n                for (jx=0; jx<val.length; jx++) {\n                    arr[pos] = val[jx];\n                    pos++;\n                }\n            }\n        }\n    }\n\n    /* in case we stretched the array */\n    arr.length = arrlen;\n\n    return pos;\n}\n\nfunction gli_buffer_canon_decompose_uni(arr, numchars) {\n    /* This is a utility function to decompose an array. The behavior is\n       almost the same as glk_buffer_canon_decompose_uni(), except that\n       this *doesn't* trim the array down to its original length. That\n       is, this decomposition can cause the array to grow. */\n\n    /* The algorithm for the canonical decomposition of a string: For\n       each character, look up the decomposition in the decomp table.\n       Append the decomposition to the buffer. Finally, sort every\n       substring of the buffer which is made up of combining\n       characters (characters with a nonzero combining class). */\n\n    var src = arr.slice(0, numchars);\n    var pos, ix, jx, origval, val;\n    var grpstart, grpend, kx, tmp;\n\n    pos = 0;\n    for (ix=0; ix<numchars; ix++) {\n        origval = src[ix];\n        val = unicode_decomp_table[origval];\n        if (val === undefined) {\n            arr[pos] = origval;\n            pos++;\n        }\n        else if (!(val instanceof Array)) {\n            arr[pos] = val;\n            pos++;\n        }\n        else {\n            for (jx=0; jx<val.length; jx++) {\n                arr[pos] = val[jx];\n                pos++;\n            }\n        }\n    }\n\n    /* Now we sort groups of combining characters. This should be a\n       stable sort by the combining-class number. We're lazy and\n       nearly all groups are short, so we'll just bubble-sort. */\n    ix = 0;\n    while (ix < pos) {\n        if (!unicode_combin_table[arr[ix]]) {\n            ix++;\n            continue;\n        }\n        if (ix >= pos)\n            break;\n        grpstart = ix;\n        while (ix < pos && unicode_combin_table[arr[ix]]) \n            ix++;\n        grpend = ix;\n        if (grpend - grpstart >= 2) {\n            /* Sort this group. */\n            for (jx = grpend-1; jx > grpstart; jx--) {\n                for (kx = grpstart; kx < jx; kx++) {\n                    if (unicode_combin_table[arr[kx]] > unicode_combin_table[arr[kx+1]]) {\n                        tmp = arr[kx];\n                        arr[kx] = arr[kx+1];\n                        arr[kx+1] = tmp;\n                    }\n                }\n            }\n        }\n    }\n\n    return pos;\n}\n\nfunction gli_buffer_canon_compose_uni(arr, numchars) {\n    /* The algorithm for canonically composing characters in a string:\n       for each base character, compare it to all the following\n       combining characters (up to the next base character). If they're \n       composable, compose them. Repeat until no more pairs are found. */\n\n    var ix, jx, curch, newch, curclass, newclass, map, pos;\n\n    if (numchars == 0)\n        return 0;\n\n    pos = 0;\n    curch = arr[0];\n    curclass = unicode_combin_table[curch];\n    if (curclass)\n        curclass = 999; // just in case the first character is a combiner\n    ix = 1;\n    jx = ix;\n    while (true) {\n        if (jx >= numchars) {\n            arr[pos] = curch;\n            pos = ix;\n            break;\n        }\n        newch = arr[jx];\n        newclass = unicode_combin_table[newch];\n        map = unicode_compo_table[curch];\n        if (map !== undefined && map[newch] !== undefined\n            && (!curclass || (newclass && curclass < newclass))) {\n            curch = map[newch];\n            arr[pos] = curch;\n        }\n        else {\n            if (!newclass) {\n                pos = ix;\n                curch = newch;\n            }\n            curclass = newclass;\n            arr[ix] = newch;\n            ix++;\n        }\n        jx++;\n    }\n\n    return pos;\n}\n\nfunction glk_buffer_canon_decompose_uni(arr, numchars) {\n    var arrlen = arr.length;\n    var len;\n\n    len = gli_buffer_canon_decompose_uni(arr, numchars);\n\n    /* in case we stretched the array */\n    arr.length = arrlen;\n\n    return len;\n}\n\nfunction glk_buffer_canon_normalize_uni(arr, numchars) {\n    var arrlen = arr.length;\n    var len;\n\n    len = gli_buffer_canon_decompose_uni(arr, numchars);\n    len = gli_buffer_canon_compose_uni(arr, len);\n\n    /* in case we stretched the array */\n    arr.length = arrlen;\n\n    return len;\n}\n\nfunction glk_put_char_uni(ch) {\n    gli_put_char(gli_currentstr, ch);\n}\n\nfunction glk_put_string_uni(val) {\n    glk_put_jstring_stream(gli_currentstr, val, false);\n}\n\nfunction glk_put_buffer_uni(arr) {\n    gli_put_array(gli_currentstr, arr, false);\n}\n\nfunction glk_put_char_stream_uni(str, ch) {\n    gli_put_char(str, ch);\n}\n\nfunction glk_put_string_stream_uni(str, val) {\n    glk_put_jstring_stream(str, val, false);\n}\n\nfunction glk_put_buffer_stream_uni(str, arr) {\n    gli_put_array(str, arr, false);\n}\n\nfunction glk_get_char_stream_uni(str) {\n    if (!str)\n        throw('glk_get_char_stream_uni: invalid stream');\n    return gli_get_char(str, true);\n}\n\nfunction glk_get_buffer_stream_uni(str, buf) {\n    if (!str)\n        throw('glk_get_buffer_stream_uni: invalid stream');\n    return gli_get_buffer(str, buf, true);\n}\n\nfunction glk_get_line_stream_uni(str, buf) {\n    if (!str)\n        throw('glk_get_line_stream_uni: invalid stream');\n    return gli_get_line(str, buf, true);\n}\n\nfunction glk_stream_open_file_uni(fref, fmode, rock) {\n    if (!fref)\n        throw('glk_stream_open_file_uni: invalid fileref');\n\n    var str;\n    var fstream;\n\n    if (fmode != Const.filemode_Read \n        && fmode != Const.filemode_Write \n        && fmode != Const.filemode_ReadWrite \n        && fmode != Const.filemode_WriteAppend) \n        throw('glk_stream_open_file_uni: illegal filemode');\n\n    if (fmode == Const.filemode_Read && !Dialog.file_ref_exists(fref.ref))\n        return null;\n\n    if (!Dialog.streaming) {\n        var content = null;\n        if (fmode != Const.filemode_Write) {\n            content = Dialog.file_read(fref.ref);\n        }\n        if (content == null) {\n            content = [];\n            if (fmode != Const.filemode_Read) {\n                /* We just created this file. (Or perhaps we're in Write mode\n                   and we're truncating.) Write immediately, to create it and\n                   get the creation date right. */\n                Dialog.file_write(fref.ref, '', true);\n            }\n        }\n        if (content.length == null) \n            throw('glk_stream_open_file_uni: data read had no length');\n    }\n    else {\n        fstream = Dialog.file_fopen(fmode, fref.ref);\n        if (!fstream)\n            return null;\n    }\n\n    str = gli_new_stream(strtype_File, \n        (fmode != Const.filemode_Write), \n        (fmode != Const.filemode_Read), \n        rock);\n    str.unicode = true;\n    str.isbinary = !fref.textmode;\n    str.ref = fref.ref;\n    str.origfmode = fmode;\n\n    if (!Dialog.streaming) {\n        str.streaming = false;\n        str.buf = content;\n        str.buflen = 0xFFFFFFFF; /* enormous */\n        if (fmode == Const.filemode_Write)\n            str.bufeof = 0;\n        else\n            str.bufeof = content.length;\n        if (fmode == Const.filemode_WriteAppend)\n            str.bufpos = str.bufeof;\n        else\n            str.bufpos = 0;\n    }\n    else {\n        str.streaming = true;\n        str.fstream = fstream;\n        /* We'll want a Buffer object around for short and writes. */\n        str.buffer4 = fstream.BufferClass.alloc(4);\n    }\n\n    return str;\n}\n\nfunction glk_stream_open_memory_uni(buf, fmode, rock) {\n    var str;\n\n    if (fmode != Const.filemode_Read \n        && fmode != Const.filemode_Write \n        && fmode != Const.filemode_ReadWrite) \n        throw('glk_stream_open_memory: illegal filemode');\n\n    str = gli_new_stream(strtype_Memory, \n        (fmode != Const.filemode_Write), \n        (fmode != Const.filemode_Read), \n        rock);\n    str.unicode = true;\n\n    if (buf) {\n        str.buf = buf;\n        str.buflen = buf.length;\n        str.bufpos = 0;\n        if (fmode == Const.filemode_Write)\n            str.bufeof = 0;\n        else\n            str.bufeof = str.buflen;\n        if (GiDispa)\n            GiDispa.retain_array(buf);\n    }\n\n    return str;\n}\n\nfunction glk_request_char_event_uni(win) {\n    if (!win)\n        throw('glk_request_char_event: invalid window');\n    if (win.char_request || win.line_request)\n        throw('glk_request_char_event: window already has keyboard request');\n\n    if (win.type == Const.wintype_TextBuffer \n        || win.type == Const.wintype_TextGrid) {\n        win.char_request = true;\n        win.char_request_uni = true;\n        win.input_generation = event_generation;\n    }\n    else {\n        /* ### wintype_Graphics could accept char input if we set up the focus to allow it. See gestalt_GraphicsCharInput. */\n        throw('glk_request_char_event: window does not support keyboard input');\n    }\n}\n\nfunction glk_request_line_event_uni(win, buf, initlen) {\n    if (!win)\n        throw('glk_request_line_event: invalid window');\n    if (win.char_request || win.line_request)\n        throw('glk_request_line_event: window already has keyboard request');\n\n    if (win.type == Const.wintype_TextBuffer \n        || win.type == Const.wintype_TextGrid) {\n        if (initlen) {\n            /* This will be copied into the next update. */\n            var ls = buf.slice(0, initlen);\n            if (!current_partial_outputs)\n                current_partial_outputs = {};\n            current_partial_outputs[win.disprock] = UniArrayToString(ls);\n        }\n        win.line_request = true;\n        win.line_request_uni = true;\n        if (win.type == Const.wintype_TextBuffer)\n            win.request_echo_line_input = win.echo_line_input;\n        else\n            win.request_echo_line_input = true;\n        win.input_generation = event_generation;\n        win.linebuf = buf;\n        if (GiDispa)\n            GiDispa.retain_array(buf);\n    }\n    else {\n        throw('glk_request_line_event: window does not support keyboard input');\n    }\n}\n\nfunction glk_current_time(timevalref) {\n    var now = new Date().getTime();\n    var usec;\n\n    timevalref.set_field(0, Math.floor(now / 4294967296000));\n    timevalref.set_field(1, Math.floor(now / 1000) >>>0);\n    usec = Math.floor((now % 1000) * 1000);\n    if (usec < 0)\n        usec = 1000000 + usec;\n    timevalref.set_field(2, usec);\n}\n\nfunction glk_current_simple_time(factor) {\n    var now = new Date().getTime();\n    return Math.floor(now / (factor * 1000));\n}\n\nfunction glk_time_to_date_utc(timevalref, dateref) {\n    var now = timevalref.get_field(0) * 4294967296000 + timevalref.get_field(1) * 1000 + timevalref.get_field(2) / 1000;\n    var obj = new Date(now);\n    \n    dateref.set_field(0, obj.getUTCFullYear())\n    dateref.set_field(1, 1+obj.getUTCMonth())\n    dateref.set_field(2, obj.getUTCDate())\n    dateref.set_field(3, obj.getUTCDay())\n    dateref.set_field(4, obj.getUTCHours())\n    dateref.set_field(5, obj.getUTCMinutes())\n    dateref.set_field(6, obj.getUTCSeconds())\n    dateref.set_field(7, 1000*obj.getUTCMilliseconds())\n}\n\nfunction glk_time_to_date_local(timevalref, dateref) {\n    var now = timevalref.get_field(0) * 4294967296000 + timevalref.get_field(1) * 1000 + timevalref.get_field(2) / 1000;\n    var obj = new Date(now);\n    \n    dateref.set_field(0, obj.getFullYear())\n    dateref.set_field(1, 1+obj.getMonth())\n    dateref.set_field(2, obj.getDate())\n    dateref.set_field(3, obj.getDay())\n    dateref.set_field(4, obj.getHours())\n    dateref.set_field(5, obj.getMinutes())\n    dateref.set_field(6, obj.getSeconds())\n    dateref.set_field(7, 1000*obj.getMilliseconds())\n}\n\nfunction glk_simple_time_to_date_utc(time, factor, dateref) {\n    var now = time*(1000*factor);\n    var obj = new Date(now);\n    \n    dateref.set_field(0, obj.getUTCFullYear())\n    dateref.set_field(1, 1+obj.getUTCMonth())\n    dateref.set_field(2, obj.getUTCDate())\n    dateref.set_field(3, obj.getUTCDay())\n    dateref.set_field(4, obj.getUTCHours())\n    dateref.set_field(5, obj.getUTCMinutes())\n    dateref.set_field(6, obj.getUTCSeconds())\n    dateref.set_field(7, 1000*obj.getUTCMilliseconds())\n}\n\nfunction glk_simple_time_to_date_local(time, factor, dateref) {\n    var now = time*(1000*factor);\n    var obj = new Date(now);\n    \n    dateref.set_field(0, obj.getFullYear())\n    dateref.set_field(1, 1+obj.getMonth())\n    dateref.set_field(2, obj.getDate())\n    dateref.set_field(3, obj.getDay())\n    dateref.set_field(4, obj.getHours())\n    dateref.set_field(5, obj.getMinutes())\n    dateref.set_field(6, obj.getSeconds())\n    dateref.set_field(7, 1000*obj.getMilliseconds())\n}\n\nfunction glk_date_to_time_utc(dateref, timevalref) {\n    var obj = new Date(0);\n\n    obj.setUTCFullYear(dateref.get_field(0));\n    obj.setUTCMonth(dateref.get_field(1)-1);\n    obj.setUTCDate(dateref.get_field(2));\n    obj.setUTCHours(dateref.get_field(4));\n    obj.setUTCMinutes(dateref.get_field(5));\n    obj.setUTCSeconds(dateref.get_field(6));\n    obj.setUTCMilliseconds(dateref.get_field(7)/1000);\n\n    var now = obj.getTime();\n    var usec;\n\n    timevalref.set_field(0, Math.floor(now / 4294967296000));\n    timevalref.set_field(1, Math.floor(now / 1000) >>>0);\n    usec = Math.floor((now % 1000) * 1000);\n    if (usec < 0)\n        usec = 1000000 + usec;\n    timevalref.set_field(2, usec);\n}\n\nfunction glk_date_to_time_local(dateref, timevalref) {\n    var obj = new Date(\n        dateref.get_field(0), dateref.get_field(1)-1, dateref.get_field(2),\n        dateref.get_field(4), dateref.get_field(5), dateref.get_field(6), \n        dateref.get_field(7)/1000);\n\n    var now = obj.getTime();\n    var usec;\n\n    timevalref.set_field(0, Math.floor(now / 4294967296000));\n    timevalref.set_field(1, Math.floor(now / 1000) >>>0);\n    usec = Math.floor((now % 1000) * 1000);\n    if (usec < 0)\n        usec = 1000000 + usec;\n    timevalref.set_field(2, usec);\n}\n\nfunction glk_date_to_simple_time_utc(dateref, factor) {\n    var obj = new Date(0);\n\n    obj.setUTCFullYear(dateref.get_field(0));\n    obj.setUTCMonth(dateref.get_field(1)-1);\n    obj.setUTCDate(dateref.get_field(2));\n    obj.setUTCHours(dateref.get_field(4));\n    obj.setUTCMinutes(dateref.get_field(5));\n    obj.setUTCSeconds(dateref.get_field(6));\n    obj.setUTCMilliseconds(dateref.get_field(7)/1000);\n\n    var now = obj.getTime();\n    return Math.floor(now / (factor * 1000));\n}\n\nfunction glk_date_to_simple_time_local(dateref, factor) {\n    var obj = new Date(\n        dateref.get_field(0), dateref.get_field(1)-1, dateref.get_field(2),\n        dateref.get_field(4), dateref.get_field(5), dateref.get_field(6), \n        dateref.get_field(7)/1000);\n\n    var now = obj.getTime();\n    return Math.floor(now / (factor * 1000));\n}\n\n/* End of Glk namespace function. Return the object which will\n   become the Glk global. */\nreturn {\n    version: '2.2.5', /* GlkOte/GlkApi version */\n    init : init,\n    update : update,\n    getlibrary : get_library,\n    save_allstate : save_allstate,\n    restore_allstate : restore_allstate,\n    fatal_error : fatal_error,\n\n    byte_array_to_string : ByteArrayToString,\n    uni_array_to_string : UniArrayToString,\n    Const : Const,\n    RefBox : RefBox,\n    RefStruct : RefStruct,\n    DidNotReturn : DidNotReturn,\n    call_may_not_return : call_may_not_return,\n\n    glk_put_jstring : glk_put_jstring,\n    glk_put_jstring_stream : glk_put_jstring_stream,\n\n    glk_exit : glk_exit,\n    glk_tick : glk_tick,\n    glk_gestalt : glk_gestalt,\n    glk_gestalt_ext : glk_gestalt_ext,\n    glk_window_iterate : glk_window_iterate,\n    glk_window_get_rock : glk_window_get_rock,\n    glk_window_get_root : glk_window_get_root,\n    glk_window_open : glk_window_open,\n    glk_window_close : glk_window_close,\n    glk_window_get_size : glk_window_get_size,\n    glk_window_set_arrangement : glk_window_set_arrangement,\n    glk_window_get_arrangement : glk_window_get_arrangement,\n    glk_window_get_type : glk_window_get_type,\n    glk_window_get_parent : glk_window_get_parent,\n    glk_window_clear : glk_window_clear,\n    glk_window_move_cursor : glk_window_move_cursor,\n    glk_window_get_stream : glk_window_get_stream,\n    glk_window_set_echo_stream : glk_window_set_echo_stream,\n    glk_window_get_echo_stream : glk_window_get_echo_stream,\n    glk_set_window : glk_set_window,\n    glk_window_get_sibling : glk_window_get_sibling,\n    glk_stream_iterate : glk_stream_iterate,\n    glk_stream_get_rock : glk_stream_get_rock,\n    glk_stream_open_file : glk_stream_open_file,\n    glk_stream_open_memory : glk_stream_open_memory,\n    glk_stream_close : glk_stream_close,\n    glk_stream_set_position : glk_stream_set_position,\n    glk_stream_get_position : glk_stream_get_position,\n    glk_stream_set_current : glk_stream_set_current,\n    glk_stream_get_current : glk_stream_get_current,\n    glk_fileref_create_temp : glk_fileref_create_temp,\n    glk_fileref_create_by_name : glk_fileref_create_by_name,\n    glk_fileref_create_by_prompt : glk_fileref_create_by_prompt,\n    glk_fileref_destroy : glk_fileref_destroy,\n    glk_fileref_iterate : glk_fileref_iterate,\n    glk_fileref_get_rock : glk_fileref_get_rock,\n    glk_fileref_delete_file : glk_fileref_delete_file,\n    glk_fileref_does_file_exist : glk_fileref_does_file_exist,\n    glk_fileref_create_from_fileref : glk_fileref_create_from_fileref,\n    glk_put_char : glk_put_char,\n    glk_put_char_stream : glk_put_char_stream,\n    glk_put_string : glk_put_string,\n    glk_put_string_stream : glk_put_string_stream,\n    glk_put_buffer : glk_put_buffer,\n    glk_put_buffer_stream : glk_put_buffer_stream,\n    glk_set_style : glk_set_style,\n    glk_set_style_stream : glk_set_style_stream,\n    glk_get_char_stream : glk_get_char_stream,\n    glk_get_line_stream : glk_get_line_stream,\n    glk_get_buffer_stream : glk_get_buffer_stream,\n    glk_char_to_lower : glk_char_to_lower,\n    glk_char_to_upper : glk_char_to_upper,\n    glk_stylehint_set : glk_stylehint_set,\n    glk_stylehint_clear : glk_stylehint_clear,\n    glk_style_distinguish : glk_style_distinguish,\n    glk_style_measure : glk_style_measure,\n    glk_select : glk_select,\n    glk_select_poll : glk_select_poll,\n    glk_request_line_event : glk_request_line_event,\n    glk_cancel_line_event : glk_cancel_line_event,\n    glk_request_char_event : glk_request_char_event,\n    glk_cancel_char_event : glk_cancel_char_event,\n    glk_request_mouse_event : glk_request_mouse_event,\n    glk_cancel_mouse_event : glk_cancel_mouse_event,\n    glk_request_timer_events : glk_request_timer_events,\n    glk_image_get_info : glk_image_get_info,\n    glk_image_draw : glk_image_draw,\n    glk_image_draw_scaled : glk_image_draw_scaled,\n    glk_window_flow_break : glk_window_flow_break,\n    glk_window_erase_rect : glk_window_erase_rect,\n    glk_window_fill_rect : glk_window_fill_rect,\n    glk_window_set_background_color : glk_window_set_background_color,\n    glk_schannel_iterate : glk_schannel_iterate,\n    glk_schannel_get_rock : glk_schannel_get_rock,\n    glk_schannel_create : glk_schannel_create,\n    glk_schannel_destroy : glk_schannel_destroy,\n    glk_schannel_play : glk_schannel_play,\n    glk_schannel_play_ext : glk_schannel_play_ext,\n    glk_schannel_stop : glk_schannel_stop,\n    glk_schannel_set_volume : glk_schannel_set_volume,\n    glk_schannel_create_ext : glk_schannel_create_ext,\n    glk_schannel_play_multi : glk_schannel_play_multi,\n    glk_schannel_pause : glk_schannel_pause,\n    glk_schannel_unpause : glk_schannel_unpause,\n    glk_schannel_set_volume_ext : glk_schannel_set_volume_ext,\n    glk_sound_load_hint : glk_sound_load_hint,\n    glk_set_hyperlink : glk_set_hyperlink,\n    glk_set_hyperlink_stream : glk_set_hyperlink_stream,\n    glk_request_hyperlink_event : glk_request_hyperlink_event,\n    glk_cancel_hyperlink_event : glk_cancel_hyperlink_event,\n    glk_buffer_to_lower_case_uni : glk_buffer_to_lower_case_uni,\n    glk_buffer_to_upper_case_uni : glk_buffer_to_upper_case_uni,\n    glk_buffer_to_title_case_uni : glk_buffer_to_title_case_uni,\n    glk_buffer_canon_decompose_uni : glk_buffer_canon_decompose_uni,\n    glk_buffer_canon_normalize_uni : glk_buffer_canon_normalize_uni,\n    glk_put_char_uni : glk_put_char_uni,\n    glk_put_string_uni : glk_put_string_uni,\n    glk_put_buffer_uni : glk_put_buffer_uni,\n    glk_put_char_stream_uni : glk_put_char_stream_uni,\n    glk_put_string_stream_uni : glk_put_string_stream_uni,\n    glk_put_buffer_stream_uni : glk_put_buffer_stream_uni,\n    glk_get_char_stream_uni : glk_get_char_stream_uni,\n    glk_get_buffer_stream_uni : glk_get_buffer_stream_uni,\n    glk_get_line_stream_uni : glk_get_line_stream_uni,\n    glk_stream_open_file_uni : glk_stream_open_file_uni,\n    glk_stream_open_memory_uni : glk_stream_open_memory_uni,\n    glk_request_char_event_uni : glk_request_char_event_uni,\n    glk_request_line_event_uni : glk_request_line_event_uni,\n    glk_set_echo_line_event : glk_set_echo_line_event,\n    glk_set_terminators_line_event : glk_set_terminators_line_event,\n    glk_current_time : glk_current_time,\n    glk_current_simple_time : glk_current_simple_time,\n    glk_time_to_date_utc : glk_time_to_date_utc,\n    glk_time_to_date_local : glk_time_to_date_local,\n    glk_simple_time_to_date_utc : glk_simple_time_to_date_utc,\n    glk_simple_time_to_date_local : glk_simple_time_to_date_local,\n    glk_date_to_time_utc : glk_date_to_time_utc,\n    glk_date_to_time_local : glk_date_to_time_local,\n    glk_date_to_simple_time_utc : glk_date_to_simple_time_utc,\n    glk_date_to_simple_time_local : glk_date_to_simple_time_local,\n    glk_stream_open_resource : glk_stream_open_resource,\n    glk_stream_open_resource_uni : glk_stream_open_resource_uni,\n    garglk_set_zcolors: garglk_set_zcolors,\n    garglk_set_zcolors_stream: garglk_set_zcolors_stream,\n    garglk_set_reversevideo: garglk_set_reversevideo,\n    garglk_set_reversevideo_stream: garglk_set_reversevideo_stream,\n};\n\n}();\n\nexport default Glk;\n\n/* End of Glk library. */\n", "/*\n\nCommon Parchment Options\n========================\n\nCopyright (c) 2022 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/parchment\n\n*/\n\nimport {ClassicSyncDialog, GlkApi, GlkOte, GlkOteOptions, WebGlkOte} from '../upstream/asyncglk/src/index-browser.js'\nimport WebDialog from '../upstream/glkote/dialog.js'\nimport GlkOte_GlkApi from '../upstream/glkote/glkapi.js'\n\ntype ParchmentTruthy = boolean | number\n\nexport interface ParchmentOptions extends Partial<GlkOteOptions> {\n    // Parchment options\n\n    /** Whether or not to automatically launch Parchment */\n    auto_launch?: ParchmentTruthy,\n    /** Story path in the array format traditionally used by Parchment for Inform 7 */\n    default_story?: [string],\n    /** Domains to access directly: should always have both Access-Control-Allow-Origin and compression headers */\n    direct_domains: string[],\n    /** Format ID, matching formats.js */\n    format?: string,\n    /** Path to resources */\n    lib_path: string,\n    /** URL of Proxy */\n    proxy_url: string,\n    /** Whether to load embeded resources in single file mode */\n    single_file?: ParchmentTruthy,\n    /** Story path */\n    story?: string,\n    /** Theme name, can be set to 'dark */\n    theme?: string,\n    /** Name of theme cookie to check */\n    theme_cookie: string,\n    /** Whether to test the AsyncGlk GlkApi library */\n    use_asyncglk?: ParchmentTruthy,\n    /** Disable the file proxy, which may mean that some files can't be loaded */\n    use_proxy?: ParchmentTruthy,\n\n    // Modules to pass to other modules\n\n    /** Dialog instance to use */\n    Dialog: ClassicSyncDialog,\n    /** GlkApi instance to use */\n    Glk: GlkApi,\n    /** GlkOte instance to use */\n    GlkOte: GlkOte,\n\n    // Common options for VMs\n\n    /** Whether or not to load an autosave */\n    do_vm_autosave?: ParchmentTruthy,\n}\n\nexport function get_default_options(): ParchmentOptions {\n    return {\n        auto_launch: 1,\n        Dialog: WebDialog,\n        direct_domains: [\n            'unbox.ifarchive.org',\n        ],\n        do_vm_autosave: 1,\n        Glk: GlkOte_GlkApi,\n        GlkOte: new WebGlkOte(),\n        // This only makes sense after the source files are built\n        lib_path: import.meta.url,\n        proxy_url: 'https://iplayif.com/proxy/',\n        set_body_to_page_bg: 1,\n        theme_cookie: 'parchment_theme',\n        use_proxy: 1,\n    }\n}\n\n/** Get options specified in the URL query */\nexport function get_query_options(possible_query_options: Array<keyof ParchmentOptions>): Partial<ParchmentOptions> {\n    const query = new URLSearchParams(document.location.search)\n    const options: Partial<ParchmentOptions> = {}\n    for (const option of possible_query_options) {\n        if (query.has(option)) {\n            // I couldn't work out how to apply proper filtering here, so tell TS to ignore it\n            options[option] = query.get(option) as any\n        }\n    }\n    return options\n}\n", "/*\n\nFile loader\n===========\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/parchment\n\n*/\n\nimport {ParchmentOptions} from './options.js'\n\n// Fetch a storyfile, using the proxy if necessary, and handling JSified stories\nexport async function fetch_storyfile(options: ParchmentOptions, url: string) {\n    // Handle a relative URL\n    const story_url = new URL(url, document.URL)\n    const story_domain = story_url.hostname\n    const same_domain = story_domain === document.location.hostname\n    const proxy_url = `${options.proxy_url}?url=${story_url}`\n    let response: Response\n\n    // Load an embedded storyfile\n    if (story_url.protocol === 'embedded:') {\n        const data = (document.getElementById(story_url.pathname) as HTMLScriptElement).text\n        const buffer = await parse_base64(data)\n        return new Uint8Array(buffer)\n    }\n\n    // Only directly access files same origin files or those from the list of reliable domains\n    let direct_access = same_domain || story_url.protocol === 'data:'\n    if (!direct_access) {\n        for (const domain of options.direct_domains) {\n            if (story_domain.endsWith(domain)) {\n                direct_access = true\n                break\n            }\n        }\n    }\n\n    if (direct_access) {\n        try {\n            response = await fetch('' + story_url)\n        }\n        // We can't specifically detect CORS errors but that's probably what happened\n        catch (_) {\n            throw new Error('Failed to fetch storyfile (possible CORS error)')\n        }\n    }\n\n    // Otherwise use the proxy\n    else {\n        if (options.use_proxy) {\n            response = await fetch(proxy_url)\n        }\n        else {\n            throw new Error('Storyfile not in list of direct domains and proxy disabled')\n        }\n    }\n\n    if (!response.ok) {\n        throw new Error(`Could not fetch storyfile, got ${response.status}`)\n    }\n\n    // It would be nice to check here if the file was compressed, but we can only read the Content-Encoding header for same domain files\n\n    // Handle JSified stories\n    if (url.endsWith('.js')) {\n        const text = await response.text()\n        const matched = /processBase64Zcode\\(['\"]([a-zA-Z0-9+/=]+)['\"]\\)/.exec(text)\n        if (!matched) {\n            throw new Error('Abnormal JSified story')\n        }\n\n        const buffer = await parse_base64(matched[1])\n        return new Uint8Array(buffer)\n    }\n\n    const buffer = await response.arrayBuffer()\n    return new Uint8Array(buffer)\n}\n\nexport async function fetch_vm_resource(options: ParchmentOptions, path: string) {\n    // Handle embedded resources in single file mode\n    if (options.single_file) {\n        const data = (document.getElementById(path) as HTMLScriptElement).text\n        if (path.endsWith('.js')) {\n            return import(`data:text/javascript,${encodeURIComponent(data)}`)\n        }\n        if (!path.endsWith('.wasm')) {\n            throw new Error(`Can't load ${path} in single file mode`)\n        }\n        return parse_base64(data, 'wasm')\n    }\n\n    if (path.endsWith('.js')) {\n        return import(path)\n    }\n\n    // Something else, like a .wasm\n    // Handle when lib_path is a proper URL (such as import.meta.url), as well as the old style path fragment\n    let url\n    try {\n        url = new URL(path, options.lib_path)\n    }\n    catch (_) {\n        url = options.lib_path + path\n    }\n    const response = await fetch(url)\n    if (!response.ok) {\n        throw new Error(`Could not fetch ${path}, got ${response.status}`)\n    }\n    return response.arrayBuffer()\n}\n\n// Parse Base 64 into an ArrayBuffer\nexport async function parse_base64(data: string, data_type = 'octet-binary'): Promise<ArrayBuffer> {\n    // Parse base64 using a trick from https://stackoverflow.com/a/54123275/2854284\n    const response = await fetch(`data:application/${data_type};base64,${data}`)\n    if (!response.ok) {\n        throw new Error(`Could not parse base64: ${response.status}`)\n    }\n    return response.arrayBuffer()\n}\n\n// Read an uploaded file and return it as a Uint8Array\nexport function read_uploaded_file(file: File): Promise<Uint8Array> {\n    return new Promise((resolve, reject) => {\n        const reader = new FileReader()\n        reader.onerror = () => reject(reader.error)\n        reader.onload = () => resolve(new Uint8Array(reader.result as ArrayBuffer))\n        reader.readAsArrayBuffer(file)\n    })\n}", "/*\n\nFormat specifications\n=====================\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/parchment\n\n*/\n\nimport {Blorb} from '../upstream/asyncglk/src/index-common.js'\n\nimport {ParchmentOptions} from './options.js'\n\nexport interface Engine {\n    id: string\n    load: string[]\n    start: (options: ParchmentOptions, requires: any) => void\n}\n\nexport interface Format {\n    engines?: Engine[]\n    extensions: RegExp\n    id: string\n}\n\nasync function generic_emglken_vm(options: ParchmentOptions, requires: [Uint8Array, any, ArrayBuffer])\n{\n    const [file_data, engine, wasmBinary] = requires\n\n    const vm_options = Object.assign({}, options, {\n        wasmBinary,\n    })\n\n    const vm = new engine.default()\n    vm.init(file_data, vm_options)\n    await vm.start()\n}\n\nexport const formats: Format[] = [\n    {\n        id: 'blorb',\n        extensions: /\\.(blb|blorb)/i,\n    },\n\n    {\n        id: 'adrift4',\n        extensions: /\\.taf/i,\n        engines: [\n            {\n                id: 'scare',\n                load: ['./scare.js', './scare-core.wasm'],\n                start: generic_emglken_vm,\n            },\n        ],\n    },\n\n    /*{\n        id: 'adrift5',\n        extensions: /\\.(blb|blorb)/i,\n        engines: [\n            {\n                id: 'frankendrift',\n                load: ['./frankendrift.js'],\n                start: (options, requires) => {\n                    const [file_data, FrankenDrift] = requires\n\n                    const vm = new FrankenDrift.FrankenDrift()\n                    const vm_options = Object.assign({}, options, {\n                        vm,\n                        Glk,\n                    })\n\n                    vm.init(file_data, vm_options)\n                    Glk.init(vm_options)\n                },\n            },\n        ],\n    },*/\n\n    {\n        id: 'hugo',\n        extensions: /\\.hex/i,\n        engines: [\n            {\n                id: 'hugo',\n                load: ['./hugo.js', './hugo-core.wasm'],\n                start: generic_emglken_vm,\n            },\n        ],\n    },\n\n    {\n        id: 'glulx',\n        extensions: /\\.(gblorb|glb|ulx)/i,\n        engines: [\n            {\n                id: 'quixe',\n                load: ['./quixe.js'],\n                start: (options, requires) =>\n                {\n                    const [file_data, quixe] = requires\n                    const data_array = file_data\n\n                    const vm_options = Object.assign({}, options, {\n                        blorb_gamechunk_type: 'GLUL',\n                        GiDispa: new quixe.GiDispa(),\n                        GiLoad: quixe.GiLoad,\n                        image_info_map: 'StaticImageInfo',\n                        io: options.Glk,\n                        set_page_title: 0,\n                        spacing: 0,\n                        use_query_story: 0,\n                        vm: quixe.Quixe,\n                    })\n\n                    quixe.GiLoad.load_run(vm_options, data_array, 'array')\n                },\n            },\n\n            {\n                id: 'glulxe',\n                load: ['./glulxe.js', './glulxe-core.wasm'],\n                start: generic_emglken_vm,\n            },\n\n            {\n                id: 'git',\n                load: ['./git.js', './git-core.wasm'],\n                start: generic_emglken_vm,\n            },\n        ],\n    },\n\n    {\n        id: 'tads',\n        extensions: /\\.(gam|t3)/i,\n        engines: [\n            {\n                id: 'tads',\n                load: ['./tads.js', './tads-core.wasm'],\n                start: generic_emglken_vm,\n            },\n        ],\n    },\n\n    {\n        id: 'zcode',\n        extensions: /\\.(zblorb|zlb|z3|z4|z5|z8)/i,\n        engines: [\n            {\n                id: 'zvm',\n                load: ['./zvm.js'],\n                start: (options, requires) =>\n                {\n                    const [file_data, zvm] = requires\n\n                    const vm = new zvm.ZVM()\n                    const vm_options = Object.assign({}, options, {\n                        vm,\n                        GiDispa: new zvm.ZVMDispatch(),\n                    })\n\n                    vm.prepare(file_data, vm_options)\n                    vm_options.Glk.init(vm_options)\n                },\n            },\n\n            {\n                id: 'bocfel',\n                load: ['./bocfel.js', './bocfel-core.wasm'],\n                start: generic_emglken_vm,\n            },\n        ],\n    },\n]\n\n/** Match a format by format ID or file extension */\nexport function find_format(format: string | null, path?: string) {\n    for (const formatspec of formats) {\n        if (formatspec.id === format || (path && formatspec.extensions.test(path))) {\n            return formatspec\n        }\n    }\n    throw new Error('Unknown storyfile format')\n}\n\n/** Search within a Blorb to find what format is inside\n * Must be passed a Blorb instance */\nexport function identify_blorb_storyfile_format(blorb: Blorb) {\n    const blorb_chunks: Record<string, string> = {\n        GLUL: 'glulx',\n        ZCOD: 'zcode',\n    }\n    const chunktype = blorb.get_chunk('exec', 0)?.blorbtype\n    if (chunktype && blorb_chunks[chunktype]) {\n        return blorb_chunks[chunktype]\n    }\n    throw new Error('Unknown storyfile format in Blorb')\n}", "/*\n\nParchment Launcher\n==================\n\nCopyright (c) 2023 Dannii Willis\nMIT licenced\nhttps://github.com/curiousdannii/parchment\n\n*/\n\nimport Cookies from 'js-cookie'\n\nimport {AsyncGlk, Blorb, FileView} from '../upstream/asyncglk/src/index-browser.js'\nimport {get_default_options, get_query_options, ParchmentOptions} from './options.js'\nimport {fetch_storyfile, fetch_vm_resource, read_uploaded_file} from './file.js'\nimport {find_format, Format, identify_blorb_storyfile_format} from './formats.js'\n\ninterface ParchmentWindow extends Window {\n    parchment: ParchmentLauncher\n    parchment_options?: ParchmentOptions\n}\ndeclare let window: ParchmentWindow\n\nclass ParchmentLauncher\n{\n    options: ParchmentOptions\n\n    constructor(parchment_options?: ParchmentOptions) {\n        this.options = Object.assign({}, get_default_options(), parchment_options, get_query_options(['do_vm_autosave', 'story', 'use_asyncglk']))\n        // Use AsyncGlk if requested\n        if (this.options.use_asyncglk) {\n            this.options.Glk = new AsyncGlk()\n        }\n    }\n\n    get_storyfile_path() {\n        return this.options.story || this.options.default_story?.[0] || null\n    }\n\n    launch() {\n        try {\n            // Update the Dialog storage version\n            this.options.Dialog.init()\n\n            // Apply the dark theme if set\n            const theme = this.options.theme\n                || Cookies.get(this.options.theme_cookie)\n                // Or if the browser tells us to prefer dark\n                || (matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : '')\n            if (theme) {\n                document.documentElement.setAttribute('data-theme', theme)\n            }\n\n            const storyfile_path = this.get_storyfile_path()\n            if (!storyfile_path) {\n                // Set up all the ways we can load a story\n                $('#custom-file-upload').show().on('keydown', event => {\n                    if (event.keyCode === 32 /*Space*/ || event.keyCode === 13 /*Enter*/) {\n                        event.target.click()\n                    }\n                })\n                $('#file-upload').on('change', () => {\n                    const file = ($('#file-upload')[0] as HTMLInputElement)?.files?.[0]\n                    if (file) {\n                        this.load_uploaded_file(file)\n                    }\n                })\n                $('#play-url').show()\n                $('#play-url-button').on('click', () => this.load_url())\n                $('#play-url-input').on('keydown', event => {\n                    if (event.keyCode === 13 /*Enter*/) {\n                        this.load_url()\n                    }\n                })\n                return\n            }\n\n            this.load(storyfile_path, this.options.format)\n        }\n        catch (err) {\n            this.options.GlkOte.error(err)\n            throw err\n        }\n    }\n\n    // Overloaded load\n    // story can be a path or Uint8Array\n    // format can be an engine object, id string, or null, in which case it will be identified from the story\n    async load(story: string | Uint8Array, format?: Format | string) {\n        try {\n            // Hide the about page, and show the loading spinner instead\n            $('#about').remove()\n            $('#loadingpane').show()\n\n            // Identify the format\n            if (!format) {\n                if (typeof story === 'string') {\n                    format = find_format(null, story)\n                }\n                else {\n                    throw new Error('Cannot identify storyfile format without path')\n                }\n            }\n\n            // If a blorb file extension is generic, we must download it first to identify its format\n            let blorb\n            if (typeof format !== 'string' && format.id === 'blorb') {\n                if (typeof story === 'string') {\n                    story = await fetch_storyfile(this.options, story)\n                }\n                blorb = new Blorb(story)\n                format = identify_blorb_storyfile_format(blorb)\n            }\n\n            if (typeof format === 'string') {\n                format = find_format(format)\n            }\n            const engine = format.engines![0]\n\n            const requires = await Promise.all([\n                typeof story === 'string' ? fetch_storyfile(this.options, story) : story,\n                ...engine.load.map(path => fetch_vm_resource(this.options, path))\n            ])\n            story = requires[0]\n\n            // If the story is a Blorb, then parse it and pass in the options\n            const options = Object.assign({}, this.options)\n            const view = new FileView(story)\n            if (view.getFourCC(0) === 'FORM' && view.getFourCC(8) === 'IFRS') {\n                options.Blorb = blorb || new Blorb(story)\n            }\n\n            await engine.start(options, requires)\n        }\n        catch (err) {\n            this.options.GlkOte.error(err)\n            throw err\n        }\n    }\n\n    async load_uploaded_file(file: File) {\n        try {\n            this.load(await read_uploaded_file(file), find_format(null, file.name))\n        }\n        catch (err) {\n            this.options.GlkOte.error(err)\n            throw err\n        }\n    }\n\n    load_url() {\n        const url = $('#play-url-input').val() as string\n        if (!url) {\n            return\n        }\n        // Validate the URL\n        try {\n            new URL(url)\n        }\n        catch (_) {\n            $('#play-url-error').text('Please enter a valid URL')\n            return\n        }\n\n        // Change the page URL\n        const new_url = new URL(window.location + '')\n        new_url.searchParams.set('story', url)\n        window.location = new_url + ''\n\n        // TODO: We could use the history API, but we need to then handle going back\n        //history.pushState(null, '', new_url)\n        //this.load(url)\n    }\n}\n\n$(() => {\n    const parchment = new ParchmentLauncher(window.parchment_options)\n    window.parchment = parchment\n\n    if (parchment.options.auto_launch) {\n        parchment.launch()\n    }\n})\n"],
  "mappings": "6FAEA,SAASA,GAAQC,EAAQ,CACvB,QAASC,EAAI,EAAGA,EAAI,UAAU,OAAQA,IAAK,CACzC,IAAIC,EAAS,UAAUD,CAAC,EACxB,QAASE,KAAOD,EACdF,EAAOG,CAAG,EAAID,EAAOC,CAAG,CAE5B,CACA,OAAOH,CACT,CAIA,IAAII,GAAmB,CACrB,KAAM,SAAUC,EAAO,CACrB,OAAIA,EAAM,CAAC,IAAM,MACfA,EAAQA,EAAM,MAAM,EAAG,EAAE,GAEpBA,EAAM,QAAQ,mBAAoB,kBAAkB,CAC7D,EACA,MAAO,SAAUA,EAAO,CACtB,OAAO,mBAAmBA,CAAK,EAAE,QAC/B,2CACA,kBACF,CACF,CACF,EAKA,SAASC,GAAMC,EAAWC,EAAmB,CAC3C,SAASC,EAAKC,EAAML,EAAOM,EAAY,CACrC,GAAI,SAAO,SAAa,KAIxB,CAAAA,EAAaZ,GAAO,CAAC,EAAGS,EAAmBG,CAAU,EAEjD,OAAOA,EAAW,SAAY,WAChCA,EAAW,QAAU,IAAI,KAAK,KAAK,IAAI,EAAIA,EAAW,QAAU,KAAK,GAEnEA,EAAW,UACbA,EAAW,QAAUA,EAAW,QAAQ,YAAY,GAGtDD,EAAO,mBAAmBA,CAAI,EAC3B,QAAQ,uBAAwB,kBAAkB,EAClD,QAAQ,QAAS,MAAM,EAE1B,IAAIE,EAAwB,GAC5B,QAASC,KAAiBF,EACnBA,EAAWE,CAAa,IAI7BD,GAAyB,KAAOC,EAE5BF,EAAWE,CAAa,IAAM,KAWlCD,GAAyB,IAAMD,EAAWE,CAAa,EAAE,MAAM,GAAG,EAAE,CAAC,IAGvE,OAAQ,SAAS,OACfH,EAAO,IAAMH,EAAU,MAAMF,EAAOK,CAAI,EAAIE,EAChD,CAEA,SAASE,EAAKJ,EAAM,CAClB,GAAI,SAAO,SAAa,KAAgB,UAAU,QAAU,CAACA,GAQ7D,SAFIK,EAAU,SAAS,OAAS,SAAS,OAAO,MAAM,IAAI,EAAI,CAAC,EAC3DC,EAAM,CAAC,EACFf,EAAI,EAAGA,EAAIc,EAAQ,OAAQd,IAAK,CACvC,IAAIgB,EAAQF,EAAQd,CAAC,EAAE,MAAM,GAAG,EAC5BI,EAAQY,EAAM,MAAM,CAAC,EAAE,KAAK,GAAG,EAEnC,GAAI,CACF,IAAIC,EAAQ,mBAAmBD,EAAM,CAAC,CAAC,EAGvC,GAFAD,EAAIE,CAAK,EAAIX,EAAU,KAAKF,EAAOa,CAAK,EAEpCR,IAASQ,EACX,KAEJ,MAAY,CAAC,CACf,CAEA,OAAOR,EAAOM,EAAIN,CAAI,EAAIM,EAC5B,CAEA,OAAO,OAAO,OACZ,CACE,IAAAP,EACA,IAAAK,EACA,OAAQ,SAAUJ,EAAMC,EAAY,CAClCF,EACEC,EACA,GACAX,GAAO,CAAC,EAAGY,EAAY,CACrB,QAAS,EACX,CAAC,CACH,CACF,EACA,eAAgB,SAAUA,EAAY,CACpC,OAAOL,GAAK,KAAK,UAAWP,GAAO,CAAC,EAAG,KAAK,WAAYY,CAAU,CAAC,CACrE,EACA,cAAe,SAAUJ,EAAW,CAClC,OAAOD,GAAKP,GAAO,CAAC,EAAG,KAAK,UAAWQ,CAAS,EAAG,KAAK,UAAU,CACpE,CACF,EACA,CACE,WAAY,CAAE,MAAO,OAAO,OAAOC,CAAiB,CAAE,EACtD,UAAW,CAAE,MAAO,OAAO,OAAOD,CAAS,CAAE,CAC/C,CACF,CACF,CAEA,IAAIY,GAAMb,GAAKF,GAAkB,CAAE,KAAM,GAAI,CAAC,ECjI9C,IAAIgB,GAAa,OAAO,QAAU,UAAY,QAAU,OAAO,SAAW,QAAU,OAE7EC,GAAQD,GCAf,IAAIE,GAAW,OAAO,MAAQ,UAAY,MAAQ,KAAK,SAAW,QAAU,KAGxEC,GAAOC,IAAcF,IAAY,SAAS,aAAa,EAAE,EAEtDG,EAAQF,GCLf,IAAIG,GAASC,EAAK,OAEXC,GAAQF,GCFf,IAAIG,GAAc,OAAO,UAGrBC,GAAiBD,GAAY,eAO7BE,GAAuBF,GAAY,SAGnCG,GAAiBC,GAASA,GAAO,YAAc,OASnD,SAASC,GAAUC,EAAO,CACxB,IAAIC,EAAQN,GAAe,KAAKK,EAAOH,EAAc,EACjDK,EAAMF,EAAMH,EAAc,EAE9B,GAAI,CACFG,EAAMH,EAAc,EAAI,OACxB,IAAIM,EAAW,EACjB,MAAY,CAAC,CAEb,IAAIC,EAASR,GAAqB,KAAKI,CAAK,EAC5C,OAAIG,IACEF,EACFD,EAAMH,EAAc,EAAIK,EAExB,OAAOF,EAAMH,EAAc,GAGxBO,CACT,CAEA,IAAOC,GAAQN,GC5Cf,IAAIO,GAAc,OAAO,UAOrBC,GAAuBD,GAAY,SASvC,SAASE,GAAeC,EAAO,CAC7B,OAAOF,GAAqB,KAAKE,CAAK,CACxC,CAEA,IAAOC,GAAQF,GChBf,IAAIG,GAAU,gBACVC,GAAe,qBAGfC,GAAiBC,GAASA,GAAO,YAAc,OASnD,SAASC,GAAWC,EAAO,CACzB,OAAIA,GAAS,KACJA,IAAU,OAAYJ,GAAeD,GAEtCE,IAAkBA,MAAkB,OAAOG,CAAK,EACpDC,GAAUD,CAAK,EACfE,GAAeF,CAAK,CAC1B,CAEA,IAAOG,GAAQJ,GCHf,SAASK,GAAaC,EAAO,CAC3B,OAAOA,GAAS,MAAQ,OAAOA,GAAS,QAC1C,CAEA,IAAOC,GAAQF,GCxBf,IAAIG,GAAY,kBAmBhB,SAASC,GAASC,EAAO,CACvB,OAAO,OAAOA,GAAS,UACpBC,GAAaD,CAAK,GAAKE,GAAWF,CAAK,GAAKF,EACjD,CAEA,IAAOK,GAAQJ,GCnBf,SAASK,GAASC,EAAOC,EAAU,CAKjC,QAJIC,EAAQ,GACRC,EAASH,GAAS,KAAO,EAAIA,EAAM,OACnCI,EAAS,MAAMD,CAAM,EAElB,EAAED,EAAQC,GACfC,EAAOF,CAAK,EAAID,EAASD,EAAME,CAAK,EAAGA,EAAOF,CAAK,EAErD,OAAOI,CACT,CAEA,IAAOC,GAAQN,GCGf,IAAIO,GAAU,MAAM,QAEbC,GAAQD,GCnBf,IAAIE,GAAW,IAGXC,GAAcC,GAASA,GAAO,UAAY,OAC1CC,GAAiBF,GAAcA,GAAY,SAAW,OAU1D,SAASG,GAAaC,EAAO,CAE3B,GAAI,OAAOA,GAAS,SAClB,OAAOA,EAET,GAAIC,GAAQD,CAAK,EAEf,OAAOE,GAASF,EAAOD,EAAY,EAAI,GAEzC,GAAII,GAASH,CAAK,EAChB,OAAOF,GAAiBA,GAAe,KAAKE,CAAK,EAAI,GAEvD,IAAII,EAAUJ,EAAQ,GACtB,OAAQI,GAAU,KAAQ,EAAIJ,GAAU,CAACL,GAAY,KAAOS,CAC9D,CAEA,IAAOC,GAAQN,GCnCf,IAAIO,GAAe,KAUnB,SAASC,GAAgBC,EAAQ,CAG/B,QAFIC,EAAQD,EAAO,OAEZC,KAAWH,GAAa,KAAKE,EAAO,OAAOC,CAAK,CAAC,GAAG,CAC3D,OAAOA,CACT,CAEA,IAAOC,GAAQH,GCff,IAAII,GAAc,OASlB,SAASC,GAASC,EAAQ,CACxB,OAAOA,GACHA,EAAO,MAAM,EAAGC,GAAgBD,CAAM,EAAI,CAAC,EAAE,QAAQF,GAAa,EAAE,CAE1E,CAEA,IAAOI,GAAQH,GCOf,SAASI,GAASC,EAAO,CACvB,IAAIC,EAAO,OAAOD,EAClB,OAAOA,GAAS,OAASC,GAAQ,UAAYA,GAAQ,WACvD,CAEA,IAAOC,GAAQH,GCzBf,IAAII,GAAM,IAGNC,GAAa,qBAGbC,GAAa,aAGbC,GAAY,cAGZC,GAAe,SAyBnB,SAASC,GAASC,EAAO,CACvB,GAAI,OAAOA,GAAS,SAClB,OAAOA,EAET,GAAIC,GAASD,CAAK,EAChB,OAAON,GAET,GAAIQ,GAASF,CAAK,EAAG,CACnB,IAAIG,EAAQ,OAAOH,EAAM,SAAW,WAAaA,EAAM,QAAQ,EAAIA,EACnEA,EAAQE,GAASC,CAAK,EAAKA,EAAQ,GAAMA,CAC3C,CACA,GAAI,OAAOH,GAAS,SAClB,OAAOA,IAAU,EAAIA,EAAQ,CAACA,EAEhCA,EAAQI,GAASJ,CAAK,EACtB,IAAIK,EAAWT,GAAW,KAAKI,CAAK,EACpC,OAAQK,GAAYR,GAAU,KAAKG,CAAK,EACpCF,GAAaE,EAAM,MAAM,CAAC,EAAGK,EAAW,EAAI,CAAC,EAC5CV,GAAW,KAAKK,CAAK,EAAIN,GAAM,CAACM,CACvC,CAEA,IAAOM,GAAQP,GC3Df,IAAIQ,GAAW,yBACXC,GAAU,oBACVC,GAAS,6BACTC,GAAW,iBAmBf,SAASC,GAAWC,EAAO,CACzB,GAAI,CAACC,GAASD,CAAK,EACjB,MAAO,GAIT,IAAIE,EAAMC,GAAWH,CAAK,EAC1B,OAAOE,GAAON,IAAWM,GAAOL,IAAUK,GAAOP,IAAYO,GAAOJ,EACtE,CAEA,IAAOM,GAAQL,GCjCf,IAAIM,GAAaC,EAAK,oBAAoB,EAEnCC,GAAQF,GCFf,IAAIG,GAAc,UAAW,CAC3B,IAAIC,EAAM,SAAS,KAAKC,IAAcA,GAAW,MAAQA,GAAW,KAAK,UAAY,EAAE,EACvF,OAAOD,EAAO,iBAAmBA,EAAO,EAC1C,EAAE,EASF,SAASE,GAASC,EAAM,CACtB,MAAO,CAAC,CAACJ,IAAeA,MAAcI,CACxC,CAEA,IAAOC,GAAQF,GClBf,IAAIG,GAAY,SAAS,UAGrBC,GAAeD,GAAU,SAS7B,SAASE,GAASC,EAAM,CACtB,GAAIA,GAAQ,KAAM,CAChB,GAAI,CACF,OAAOF,GAAa,KAAKE,CAAI,CAC/B,MAAY,CAAC,CACb,GAAI,CACF,OAAQA,EAAO,EACjB,MAAY,CAAC,CACf,CACA,MAAO,EACT,CAEA,IAAOC,GAAQF,GChBf,IAAIG,GAAe,sBAGfC,GAAe,8BAGfC,GAAY,SAAS,UACrBC,GAAc,OAAO,UAGrBC,GAAeF,GAAU,SAGzBG,GAAiBF,GAAY,eAG7BG,GAAa,OAAO,IACtBF,GAAa,KAAKC,EAAc,EAAE,QAAQL,GAAc,MAAM,EAC7D,QAAQ,yDAA0D,OAAO,EAAI,GAChF,EAUA,SAASO,GAAaC,EAAO,CAC3B,GAAI,CAACC,GAASD,CAAK,GAAKE,GAASF,CAAK,EACpC,MAAO,GAET,IAAIG,EAAUC,GAAWJ,CAAK,EAAIF,GAAaL,GAC/C,OAAOU,EAAQ,KAAKE,GAASL,CAAK,CAAC,CACrC,CAEA,IAAOM,GAAQP,GCtCf,SAASQ,GAASC,EAAQC,EAAK,CAC7B,OAAoCD,IAAOC,CAAG,CAChD,CAEA,IAAOC,GAAQH,GCDf,SAASI,GAAUC,EAAQC,EAAK,CAC9B,IAAIC,EAAQC,GAASH,EAAQC,CAAG,EAChC,OAAOG,GAAaF,CAAK,EAAIA,EAAQ,MACvC,CAEA,IAAOG,GAAQN,GCZf,IAAIO,GAAUC,GAAUC,EAAM,SAAS,EAEhCC,GAAQH,GCHf,IAAII,GAAe,OAAO,OAUtBC,GAAc,UAAW,CAC3B,SAASC,GAAS,CAAC,CACnB,OAAO,SAASC,EAAO,CACrB,GAAI,CAACC,GAASD,CAAK,EACjB,MAAO,CAAC,EAEV,GAAIH,GACF,OAAOA,GAAaG,CAAK,EAE3BD,EAAO,UAAYC,EACnB,IAAIE,EAAS,IAAIH,EACjB,OAAAA,EAAO,UAAY,OACZG,CACT,CACF,EAAE,EAEKC,GAAQL,GCrBf,SAASM,GAAUC,EAAQC,EAAO,CAChC,IAAIC,EAAQ,GACRC,EAASH,EAAO,OAGpB,IADAC,IAAUA,EAAQ,MAAME,CAAM,GACvB,EAAED,EAAQC,GACfF,EAAMC,CAAK,EAAIF,EAAOE,CAAK,EAE7B,OAAOD,CACT,CAEA,IAAOG,GAAQL,GCjBf,IAAIM,GAAkB,UAAW,CAC/B,GAAI,CACF,IAAIC,EAAOC,GAAU,OAAQ,gBAAgB,EAC7C,OAAAD,EAAK,CAAC,EAAG,GAAI,CAAC,CAAC,EACRA,CACT,MAAY,CAAC,CACf,EAAE,EAEKE,GAAQH,GCDf,SAASI,GAAUC,EAAOC,EAAU,CAIlC,QAHIC,EAAQ,GACRC,EAASH,GAAS,KAAO,EAAIA,EAAM,OAEhC,EAAEE,EAAQC,GACXF,EAASD,EAAME,CAAK,EAAGA,EAAOF,CAAK,IAAM,IAA7C,CAIF,OAAOA,CACT,CAEA,IAAOI,GAAQL,GCpBf,IAAIM,GAAmB,iBAGnBC,GAAW,mBAUf,SAASC,GAAQC,EAAOC,EAAQ,CAC9B,IAAIC,EAAO,OAAOF,EAClB,OAAAC,EAASA,GAAiBJ,GAEnB,CAAC,CAACI,IACNC,GAAQ,UACNA,GAAQ,UAAYJ,GAAS,KAAKE,CAAK,IACrCA,EAAQ,IAAMA,EAAQ,GAAK,GAAKA,EAAQC,CACjD,CAEA,IAAOE,GAAQJ,GCbf,SAASK,GAAgBC,EAAQC,EAAKC,EAAO,CACvCD,GAAO,aAAeE,GACxBA,GAAeH,EAAQC,EAAK,CAC1B,aAAgB,GAChB,WAAc,GACd,MAASC,EACT,SAAY,EACd,CAAC,EAEDF,EAAOC,CAAG,EAAIC,CAElB,CAEA,IAAOE,GAAQL,GCQf,SAASM,GAAGC,EAAOC,EAAO,CACxB,OAAOD,IAAUC,GAAUD,IAAUA,GAASC,IAAUA,CAC1D,CAEA,IAAOC,GAAQH,GChCf,IAAII,GAAc,OAAO,UAGrBC,GAAiBD,GAAY,eAYjC,SAASE,GAAYC,EAAQC,EAAKC,EAAO,CACvC,IAAIC,EAAWH,EAAOC,CAAG,GACrB,EAAEH,GAAe,KAAKE,EAAQC,CAAG,GAAKG,GAAGD,EAAUD,CAAK,IACvDA,IAAU,QAAa,EAAED,KAAOD,KACnCK,GAAgBL,EAAQC,EAAKC,CAAK,CAEtC,CAEA,IAAOI,GAAQP,GCdf,SAASQ,GAAWC,EAAQC,EAAOC,EAAQC,EAAY,CACrD,IAAIC,EAAQ,CAACF,EACbA,IAAWA,EAAS,CAAC,GAKrB,QAHIG,EAAQ,GACRC,EAASL,EAAM,OAEZ,EAAEI,EAAQC,GAAQ,CACvB,IAAIC,EAAMN,EAAMI,CAAK,EAEjBG,EAAWL,EACXA,EAAWD,EAAOK,CAAG,EAAGP,EAAOO,CAAG,EAAGA,EAAKL,EAAQF,CAAM,EACxD,OAEAQ,IAAa,SACfA,EAAWR,EAAOO,CAAG,GAEnBH,EACFK,GAAgBP,EAAQK,EAAKC,CAAQ,EAErCE,GAAYR,EAAQK,EAAKC,CAAQ,CAErC,CACA,OAAON,CACT,CAEA,IAAOS,GAAQZ,GCtCf,IAAIa,GAAmB,iBA4BvB,SAASC,GAASC,EAAO,CACvB,OAAO,OAAOA,GAAS,UACrBA,EAAQ,IAAMA,EAAQ,GAAK,GAAKA,GAASF,EAC7C,CAEA,IAAOG,GAAQF,GCNf,SAASG,GAAYC,EAAO,CAC1B,OAAOA,GAAS,MAAQC,GAASD,EAAM,MAAM,GAAK,CAACE,GAAWF,CAAK,CACrE,CAEA,IAAOG,GAAQJ,GC/Bf,IAAIK,GAAc,OAAO,UASzB,SAASC,GAAYC,EAAO,CAC1B,IAAIC,EAAOD,GAASA,EAAM,YACtBE,EAAS,OAAOD,GAAQ,YAAcA,EAAK,WAAcH,GAE7D,OAAOE,IAAUE,CACnB,CAEA,IAAOC,GAAQJ,GCRf,SAASK,GAAUC,EAAGC,EAAU,CAI9B,QAHIC,EAAQ,GACRC,EAAS,MAAMH,CAAC,EAEb,EAAEE,EAAQF,GACfG,EAAOD,CAAK,EAAID,EAASC,CAAK,EAEhC,OAAOC,CACT,CAEA,IAAOC,GAAQL,GCff,IAAIM,GAAU,qBASd,SAASC,GAAgBC,EAAO,CAC9B,OAAOC,GAAaD,CAAK,GAAKE,GAAWF,CAAK,GAAKF,EACrD,CAEA,IAAOK,GAAQJ,GCbf,IAAIK,GAAc,OAAO,UAGrBC,GAAiBD,GAAY,eAG7BE,GAAuBF,GAAY,qBAoBnCG,GAAcC,GAAgB,UAAW,CAAE,OAAO,SAAW,EAAE,CAAC,EAAIA,GAAkB,SAASC,EAAO,CACxG,OAAOC,GAAaD,CAAK,GAAKJ,GAAe,KAAKI,EAAO,QAAQ,GAC/D,CAACH,GAAqB,KAAKG,EAAO,QAAQ,CAC9C,EAEOE,GAAQJ,GCtBf,SAASK,IAAY,CACnB,MAAO,EACT,CAEA,IAAOC,GAAQD,GCbf,IAAIE,GAAc,OAAO,SAAW,UAAY,SAAW,CAAC,QAAQ,UAAY,QAG5EC,GAAaD,IAAe,OAAO,QAAU,UAAY,QAAU,CAAC,OAAO,UAAY,OAGvFE,GAAgBD,IAAcA,GAAW,UAAYD,GAGrDG,GAASD,GAAgBE,EAAK,OAAS,OAGvCC,GAAiBF,GAASA,GAAO,SAAW,OAmB5CG,GAAWD,IAAkBE,GAE1BC,GAAQF,GChCf,IAAIG,GAAU,qBACVC,GAAW,iBACXC,GAAU,mBACVC,GAAU,gBACVC,GAAW,iBACXC,GAAU,oBACVC,GAAS,eACTC,GAAY,kBACZC,GAAY,kBACZC,GAAY,kBACZC,GAAS,eACTC,GAAY,kBACZC,GAAa,mBAEbC,GAAiB,uBACjBC,GAAc,oBACdC,GAAa,wBACbC,GAAa,wBACbC,GAAU,qBACVC,GAAW,sBACXC,GAAW,sBACXC,GAAW,sBACXC,GAAkB,6BAClBC,GAAY,uBACZC,GAAY,uBAGZC,EAAiB,CAAC,EACtBA,EAAeT,EAAU,EAAIS,EAAeR,EAAU,EACtDQ,EAAeP,EAAO,EAAIO,EAAeN,EAAQ,EACjDM,EAAeL,EAAQ,EAAIK,EAAeJ,EAAQ,EAClDI,EAAeH,EAAe,EAAIG,EAAeF,EAAS,EAC1DE,EAAeD,EAAS,EAAI,GAC5BC,EAAexB,EAAO,EAAIwB,EAAevB,EAAQ,EACjDuB,EAAeX,EAAc,EAAIW,EAAetB,EAAO,EACvDsB,EAAeV,EAAW,EAAIU,EAAerB,EAAO,EACpDqB,EAAepB,EAAQ,EAAIoB,EAAenB,EAAO,EACjDmB,EAAelB,EAAM,EAAIkB,EAAejB,EAAS,EACjDiB,EAAehB,EAAS,EAAIgB,EAAef,EAAS,EACpDe,EAAed,EAAM,EAAIc,EAAeb,EAAS,EACjDa,EAAeZ,EAAU,EAAI,GAS7B,SAASa,GAAiBC,EAAO,CAC/B,OAAOC,GAAaD,CAAK,GACvBE,GAASF,EAAM,MAAM,GAAK,CAAC,CAACF,EAAeK,GAAWH,CAAK,CAAC,CAChE,CAEA,IAAOI,GAAQL,GCpDf,SAASM,GAAUC,EAAM,CACvB,OAAO,SAASC,EAAO,CACrB,OAAOD,EAAKC,CAAK,CACnB,CACF,CAEA,IAAOC,GAAQH,GCVf,IAAII,GAAc,OAAO,SAAW,UAAY,SAAW,CAAC,QAAQ,UAAY,QAG5EC,GAAaD,IAAe,OAAO,QAAU,UAAY,QAAU,CAAC,OAAO,UAAY,OAGvFE,GAAgBD,IAAcA,GAAW,UAAYD,GAGrDG,GAAcD,IAAiBE,GAAW,QAG1CC,GAAY,UAAW,CACzB,GAAI,CAEF,IAAIC,EAAQL,IAAcA,GAAW,SAAWA,GAAW,QAAQ,MAAM,EAAE,MAE3E,OAAIK,GAKGH,IAAeA,GAAY,SAAWA,GAAY,QAAQ,MAAM,CACzE,MAAY,CAAC,CACf,EAAE,EAEKI,GAAQF,GCxBf,IAAIG,GAAmBC,IAAYA,GAAS,aAmBxCC,GAAeF,GAAmBG,GAAUH,EAAgB,EAAII,GAE7DC,GAAQH,GClBf,IAAII,GAAc,OAAO,UAGrBC,GAAiBD,GAAY,eAUjC,SAASE,GAAcC,EAAOC,EAAW,CACvC,IAAIC,EAAQC,GAAQH,CAAK,EACrBI,EAAQ,CAACF,GAASG,GAAYL,CAAK,EACnCM,EAAS,CAACJ,GAAS,CAACE,GAASG,GAASP,CAAK,EAC3CQ,EAAS,CAACN,GAAS,CAACE,GAAS,CAACE,GAAUG,GAAaT,CAAK,EAC1DU,EAAcR,GAASE,GAASE,GAAUE,EAC1CG,EAASD,EAAcE,GAAUZ,EAAM,OAAQ,MAAM,EAAI,CAAC,EAC1Da,EAASF,EAAO,OAEpB,QAASG,KAAOd,GACTC,GAAaH,GAAe,KAAKE,EAAOc,CAAG,IAC5C,EAAEJ,IAECI,GAAO,UAENR,IAAWQ,GAAO,UAAYA,GAAO,WAErCN,IAAWM,GAAO,UAAYA,GAAO,cAAgBA,GAAO,eAE7DC,GAAQD,EAAKD,CAAM,KAExBF,EAAO,KAAKG,CAAG,EAGnB,OAAOH,CACT,CAEA,IAAOK,GAAQjB,GCxCf,SAASkB,GAAQC,EAAMC,EAAW,CAChC,OAAO,SAASC,EAAK,CACnB,OAAOF,EAAKC,EAAUC,CAAG,CAAC,CAC5B,CACF,CAEA,IAAOC,GAAQJ,GCXf,IAAIK,GAAaC,GAAQ,OAAO,KAAM,MAAM,EAErCC,GAAQF,GCDf,IAAIG,GAAc,OAAO,UAGrBC,GAAiBD,GAAY,eASjC,SAASE,GAASC,EAAQ,CACxB,GAAI,CAACC,GAAYD,CAAM,EACrB,OAAOE,GAAWF,CAAM,EAE1B,IAAIG,EAAS,CAAC,EACd,QAASC,KAAO,OAAOJ,CAAM,EACvBF,GAAe,KAAKE,EAAQI,CAAG,GAAKA,GAAO,eAC7CD,EAAO,KAAKC,CAAG,EAGnB,OAAOD,CACT,CAEA,IAAOE,GAAQN,GCGf,SAASO,GAAKC,EAAQ,CACpB,OAAOC,GAAYD,CAAM,EAAIE,GAAcF,CAAM,EAAIG,GAASH,CAAM,CACtE,CAEA,IAAOI,GAAQL,GC3Bf,SAASM,GAAaC,EAAQ,CAC5B,IAAIC,EAAS,CAAC,EACd,GAAID,GAAU,KACZ,QAASE,KAAO,OAAOF,CAAM,EAC3BC,EAAO,KAAKC,CAAG,EAGnB,OAAOD,CACT,CAEA,IAAOE,GAAQJ,GCdf,IAAIK,GAAc,OAAO,UAGrBC,GAAiBD,GAAY,eASjC,SAASE,GAAWC,EAAQ,CAC1B,GAAI,CAACC,GAASD,CAAM,EAClB,OAAOE,GAAaF,CAAM,EAE5B,IAAIG,EAAUC,GAAYJ,CAAM,EAC5BK,EAAS,CAAC,EAEd,QAASC,KAAON,EACRM,GAAO,gBAAkBH,GAAW,CAACL,GAAe,KAAKE,EAAQM,CAAG,IACxED,EAAO,KAAKC,CAAG,EAGnB,OAAOD,CACT,CAEA,IAAOE,GAAQR,GCLf,SAASS,GAAOC,EAAQ,CACtB,OAAOC,GAAYD,CAAM,EAAIE,GAAcF,EAAQ,EAAI,EAAIG,GAAWH,CAAM,CAC9E,CAEA,IAAOI,GAAQL,GC5Bf,IAAIM,GAAeC,GAAU,OAAQ,QAAQ,EAEtCC,GAAQF,GCIf,SAASG,IAAY,CACnB,KAAK,SAAWC,GAAeA,GAAa,IAAI,EAAI,CAAC,EACrD,KAAK,KAAO,CACd,CAEA,IAAOC,GAAQF,GCJf,SAASG,GAAWC,EAAK,CACvB,IAAIC,EAAS,KAAK,IAAID,CAAG,GAAK,OAAO,KAAK,SAASA,CAAG,EACtD,YAAK,MAAQC,EAAS,EAAI,EACnBA,CACT,CAEA,IAAOC,GAAQH,GCbf,IAAII,GAAiB,4BAGjBC,GAAc,OAAO,UAGrBC,GAAiBD,GAAY,eAWjC,SAASE,GAAQC,EAAK,CACpB,IAAIC,EAAO,KAAK,SAChB,GAAIC,GAAc,CAChB,IAAIC,EAASF,EAAKD,CAAG,EACrB,OAAOG,IAAWP,GAAiB,OAAYO,CACjD,CACA,OAAOL,GAAe,KAAKG,EAAMD,CAAG,EAAIC,EAAKD,CAAG,EAAI,MACtD,CAEA,IAAOI,GAAQL,GC1Bf,IAAIM,GAAc,OAAO,UAGrBC,GAAiBD,GAAY,eAWjC,SAASE,GAAQC,EAAK,CACpB,IAAIC,EAAO,KAAK,SAChB,OAAOC,GAAgBD,EAAKD,CAAG,IAAM,OAAaF,GAAe,KAAKG,EAAMD,CAAG,CACjF,CAEA,IAAOG,GAAQJ,GCnBf,IAAIK,GAAiB,4BAYrB,SAASC,GAAQC,EAAKC,EAAO,CAC3B,IAAIC,EAAO,KAAK,SAChB,YAAK,MAAQ,KAAK,IAAIF,CAAG,EAAI,EAAI,EACjCE,EAAKF,CAAG,EAAKG,IAAgBF,IAAU,OAAaH,GAAiBG,EAC9D,IACT,CAEA,IAAOG,GAAQL,GCTf,SAASM,GAAKC,EAAS,CACrB,IAAIC,EAAQ,GACRC,EAASF,GAAW,KAAO,EAAIA,EAAQ,OAG3C,IADA,KAAK,MAAM,EACJ,EAAEC,EAAQC,GAAQ,CACvB,IAAIC,EAAQH,EAAQC,CAAK,EACzB,KAAK,IAAIE,EAAM,CAAC,EAAGA,EAAM,CAAC,CAAC,CAC7B,CACF,CAGAJ,GAAK,UAAU,MAAQK,GACvBL,GAAK,UAAU,OAAYM,GAC3BN,GAAK,UAAU,IAAMO,GACrBP,GAAK,UAAU,IAAMQ,GACrBR,GAAK,UAAU,IAAMS,GAErB,IAAOC,GAAQV,GCxBf,SAASW,IAAiB,CACxB,KAAK,SAAW,CAAC,EACjB,KAAK,KAAO,CACd,CAEA,IAAOC,GAAQD,GCFf,SAASE,GAAaC,EAAOC,EAAK,CAEhC,QADIC,EAASF,EAAM,OACZE,KACL,GAAIC,GAAGH,EAAME,CAAM,EAAE,CAAC,EAAGD,CAAG,EAC1B,OAAOC,EAGX,MAAO,EACT,CAEA,IAAOE,GAAQL,GCjBf,IAAIM,GAAa,MAAM,UAGnBC,GAASD,GAAW,OAWxB,SAASE,GAAgBC,EAAK,CAC5B,IAAIC,EAAO,KAAK,SACZC,EAAQC,GAAaF,EAAMD,CAAG,EAElC,GAAIE,EAAQ,EACV,MAAO,GAET,IAAIE,EAAYH,EAAK,OAAS,EAC9B,OAAIC,GAASE,EACXH,EAAK,IAAI,EAETH,GAAO,KAAKG,EAAMC,EAAO,CAAC,EAE5B,EAAE,KAAK,KACA,EACT,CAEA,IAAOG,GAAQN,GCvBf,SAASO,GAAaC,EAAK,CACzB,IAAIC,EAAO,KAAK,SACZC,EAAQC,GAAaF,EAAMD,CAAG,EAElC,OAAOE,EAAQ,EAAI,OAAYD,EAAKC,CAAK,EAAE,CAAC,CAC9C,CAEA,IAAOE,GAAQL,GCPf,SAASM,GAAaC,EAAK,CACzB,OAAOC,GAAa,KAAK,SAAUD,CAAG,EAAI,EAC5C,CAEA,IAAOE,GAAQH,GCHf,SAASI,GAAaC,EAAKC,EAAO,CAChC,IAAIC,EAAO,KAAK,SACZC,EAAQC,GAAaF,EAAMF,CAAG,EAElC,OAAIG,EAAQ,GACV,EAAE,KAAK,KACPD,EAAK,KAAK,CAACF,EAAKC,CAAK,CAAC,GAEtBC,EAAKC,CAAK,EAAE,CAAC,EAAIF,EAEZ,IACT,CAEA,IAAOI,GAAQN,GCZf,SAASO,GAAUC,EAAS,CAC1B,IAAIC,EAAQ,GACRC,EAASF,GAAW,KAAO,EAAIA,EAAQ,OAG3C,IADA,KAAK,MAAM,EACJ,EAAEC,EAAQC,GAAQ,CACvB,IAAIC,EAAQH,EAAQC,CAAK,EACzB,KAAK,IAAIE,EAAM,CAAC,EAAGA,EAAM,CAAC,CAAC,CAC7B,CACF,CAGAJ,GAAU,UAAU,MAAQK,GAC5BL,GAAU,UAAU,OAAYM,GAChCN,GAAU,UAAU,IAAMO,GAC1BP,GAAU,UAAU,IAAMQ,GAC1BR,GAAU,UAAU,IAAMS,GAE1B,IAAOC,GAAQV,GC3Bf,IAAIW,GAAMC,GAAUC,EAAM,KAAK,EAExBC,GAAQH,GCKf,SAASI,IAAgB,CACvB,KAAK,KAAO,EACZ,KAAK,SAAW,CACd,KAAQ,IAAIC,GACZ,IAAO,IAAKC,IAAOC,IACnB,OAAU,IAAIF,EAChB,CACF,CAEA,IAAOG,GAAQJ,GCbf,SAASK,GAAUC,EAAO,CACxB,IAAIC,EAAO,OAAOD,EAClB,OAAQC,GAAQ,UAAYA,GAAQ,UAAYA,GAAQ,UAAYA,GAAQ,UACvED,IAAU,YACVA,IAAU,IACjB,CAEA,IAAOE,GAAQH,GCJf,SAASI,GAAWC,EAAKC,EAAK,CAC5B,IAAIC,EAAOF,EAAI,SACf,OAAOG,GAAUF,CAAG,EAChBC,EAAK,OAAOD,GAAO,SAAW,SAAW,MAAM,EAC/CC,EAAK,GACX,CAEA,IAAOE,GAAQL,GCNf,SAASM,GAAeC,EAAK,CAC3B,IAAIC,EAASC,GAAW,KAAMF,CAAG,EAAE,OAAUA,CAAG,EAChD,YAAK,MAAQC,EAAS,EAAI,EACnBA,CACT,CAEA,IAAOE,GAAQJ,GCNf,SAASK,GAAYC,EAAK,CACxB,OAAOC,GAAW,KAAMD,CAAG,EAAE,IAAIA,CAAG,CACtC,CAEA,IAAOE,GAAQH,GCJf,SAASI,GAAYC,EAAK,CACxB,OAAOC,GAAW,KAAMD,CAAG,EAAE,IAAIA,CAAG,CACtC,CAEA,IAAOE,GAAQH,GCHf,SAASI,GAAYC,EAAKC,EAAO,CAC/B,IAAIC,EAAOC,GAAW,KAAMH,CAAG,EAC3BI,EAAOF,EAAK,KAEhB,OAAAA,EAAK,IAAIF,EAAKC,CAAK,EACnB,KAAK,MAAQC,EAAK,MAAQE,EAAO,EAAI,EAC9B,IACT,CAEA,IAAOC,GAAQN,GCRf,SAASO,GAASC,EAAS,CACzB,IAAIC,EAAQ,GACRC,EAASF,GAAW,KAAO,EAAIA,EAAQ,OAG3C,IADA,KAAK,MAAM,EACJ,EAAEC,EAAQC,GAAQ,CACvB,IAAIC,EAAQH,EAAQC,CAAK,EACzB,KAAK,IAAIE,EAAM,CAAC,EAAGA,EAAM,CAAC,CAAC,CAC7B,CACF,CAGAJ,GAAS,UAAU,MAAQK,GAC3BL,GAAS,UAAU,OAAYM,GAC/BN,GAAS,UAAU,IAAMO,GACzBP,GAAS,UAAU,IAAMQ,GACzBR,GAAS,UAAU,IAAMS,GAEzB,IAAOC,GAAQV,GCRf,SAASW,GAASC,EAAO,CACvB,OAAOA,GAAS,KAAO,GAAKC,GAAaD,CAAK,CAChD,CAEA,IAAOE,GAAQH,GCnBf,SAASI,GAAUC,EAAOC,EAAQ,CAKhC,QAJIC,EAAQ,GACRC,EAASF,EAAO,OAChBG,EAASJ,EAAM,OAEZ,EAAEE,EAAQC,GACfH,EAAMI,EAASF,CAAK,EAAID,EAAOC,CAAK,EAEtC,OAAOF,CACT,CAEA,IAAOK,GAAQN,GChBf,IAAIO,GAAeC,GAAQ,OAAO,eAAgB,MAAM,EAEjDC,GAAQF,GCEf,SAASG,GAAeC,EAAQ,CAC9B,OAAO,SAASC,EAAK,CACnB,OAAoCD,IAAOC,CAAG,CAChD,CACF,CAEA,IAAOC,GAAQH,GCJf,SAASI,IAAa,CACpB,KAAK,SAAW,IAAIC,GACpB,KAAK,KAAO,CACd,CAEA,IAAOC,GAAQF,GCLf,SAASG,GAAYC,EAAK,CACxB,IAAIC,EAAO,KAAK,SACZC,EAASD,EAAK,OAAUD,CAAG,EAE/B,YAAK,KAAOC,EAAK,KACVC,CACT,CAEA,IAAOC,GAAQJ,GCRf,SAASK,GAASC,EAAK,CACrB,OAAO,KAAK,SAAS,IAAIA,CAAG,CAC9B,CAEA,IAAOC,GAAQF,GCJf,SAASG,GAASC,EAAK,CACrB,OAAO,KAAK,SAAS,IAAIA,CAAG,CAC9B,CAEA,IAAOC,GAAQF,GCRf,IAAIG,GAAmB,IAYvB,SAASC,GAASC,EAAKC,EAAO,CAC5B,IAAIC,EAAO,KAAK,SAChB,GAAIA,aAAgBC,GAAW,CAC7B,IAAIC,EAAQF,EAAK,SACjB,GAAI,CAACG,IAAQD,EAAM,OAASN,GAAmB,EAC7C,OAAAM,EAAM,KAAK,CAACJ,EAAKC,CAAK,CAAC,EACvB,KAAK,KAAO,EAAEC,EAAK,KACZ,KAETA,EAAO,KAAK,SAAW,IAAII,GAASF,CAAK,CAC3C,CACA,OAAAF,EAAK,IAAIF,EAAKC,CAAK,EACnB,KAAK,KAAOC,EAAK,KACV,IACT,CAEA,IAAOK,GAAQR,GCnBf,SAASS,GAAMC,EAAS,CACtB,IAAIC,EAAO,KAAK,SAAW,IAAIC,GAAUF,CAAO,EAChD,KAAK,KAAOC,EAAK,IACnB,CAGAF,GAAM,UAAU,MAAQI,GACxBJ,GAAM,UAAU,OAAYK,GAC5BL,GAAM,UAAU,IAAMM,GACtBN,GAAM,UAAU,IAAMO,GACtBP,GAAM,UAAU,IAAMQ,GAEtB,IAAOC,GAAQT,GCdf,SAASU,GAAWC,EAAQC,EAAQ,CAClC,OAAOD,GAAUE,GAAWD,EAAQE,GAAKF,CAAM,EAAGD,CAAM,CAC1D,CAEA,IAAOI,GAAQL,GCJf,SAASM,GAAaC,EAAQC,EAAQ,CACpC,OAAOD,GAAUE,GAAWD,EAAQE,GAAOF,CAAM,EAAGD,CAAM,CAC5D,CAEA,IAAOI,GAAQL,GCbf,IAAIM,GAAc,OAAO,SAAW,UAAY,SAAW,CAAC,QAAQ,UAAY,QAG5EC,GAAaD,IAAe,OAAO,QAAU,UAAY,QAAU,CAAC,OAAO,UAAY,OAGvFE,GAAgBD,IAAcA,GAAW,UAAYD,GAGrDG,GAASD,GAAgBE,EAAK,OAAS,OACvCC,GAAcF,GAASA,GAAO,YAAc,OAUhD,SAASG,GAAYC,EAAQC,EAAQ,CACnC,GAAIA,EACF,OAAOD,EAAO,MAAM,EAEtB,IAAIE,EAASF,EAAO,OAChBG,EAASL,GAAcA,GAAYI,CAAM,EAAI,IAAIF,EAAO,YAAYE,CAAM,EAE9E,OAAAF,EAAO,KAAKG,CAAM,EACXA,CACT,CAEA,IAAOC,GAAQL,GCzBf,SAASM,GAAYC,EAAOC,EAAW,CAMrC,QALIC,EAAQ,GACRC,EAASH,GAAS,KAAO,EAAIA,EAAM,OACnCI,EAAW,EACXC,EAAS,CAAC,EAEP,EAAEH,EAAQC,GAAQ,CACvB,IAAIG,EAAQN,EAAME,CAAK,EACnBD,EAAUK,EAAOJ,EAAOF,CAAK,IAC/BK,EAAOD,GAAU,EAAIE,EAEzB,CACA,OAAOD,CACT,CAEA,IAAOE,GAAQR,GCNf,SAASS,IAAY,CACnB,MAAO,CAAC,CACV,CAEA,IAAOC,GAAQD,GClBf,IAAIE,GAAc,OAAO,UAGrBC,GAAuBD,GAAY,qBAGnCE,GAAmB,OAAO,sBAS1BC,GAAcD,GAA+B,SAASE,EAAQ,CAChE,OAAIA,GAAU,KACL,CAAC,GAEVA,EAAS,OAAOA,CAAM,EACfC,GAAYH,GAAiBE,CAAM,EAAG,SAASE,EAAQ,CAC5D,OAAOL,GAAqB,KAAKG,EAAQE,CAAM,CACjD,CAAC,EACH,EARqCC,GAU9BC,GAAQL,GClBf,SAASM,GAAYC,EAAQC,EAAQ,CACnC,OAAOC,GAAWF,EAAQG,GAAWH,CAAM,EAAGC,CAAM,CACtD,CAEA,IAAOG,GAAQL,GCTf,IAAIM,GAAmB,OAAO,sBAS1BC,GAAgBD,GAA+B,SAASE,EAAQ,CAElE,QADIC,EAAS,CAAC,EACPD,GACLE,GAAUD,EAAQE,GAAWH,CAAM,CAAC,EACpCA,EAASI,GAAaJ,CAAM,EAE9B,OAAOC,CACT,EAPuCI,GAShCC,GAAQP,GCbf,SAASQ,GAAcC,EAAQC,EAAQ,CACrC,OAAOC,GAAWF,EAAQG,GAAaH,CAAM,EAAGC,CAAM,CACxD,CAEA,IAAOG,GAAQL,GCDf,SAASM,GAAeC,EAAQC,EAAUC,EAAa,CACrD,IAAIC,EAASF,EAASD,CAAM,EAC5B,OAAOI,GAAQJ,CAAM,EAAIG,EAASE,GAAUF,EAAQD,EAAYF,CAAM,CAAC,CACzE,CAEA,IAAOM,GAAQP,GCRf,SAASQ,GAAWC,EAAQ,CAC1B,OAAOC,GAAeD,EAAQE,GAAMC,EAAU,CAChD,CAEA,IAAOC,GAAQL,GCHf,SAASM,GAAaC,EAAQ,CAC5B,OAAOC,GAAeD,EAAQE,GAAQC,EAAY,CACpD,CAEA,IAAOC,GAAQL,GCZf,IAAIM,GAAWC,GAAUC,EAAM,UAAU,EAElCC,GAAQH,GCFf,IAAII,GAAUC,GAAUC,EAAM,SAAS,EAEhCC,GAAQH,GCFf,IAAII,GAAMC,GAAUC,EAAM,KAAK,EAExBC,GAAQH,GCGf,IAAII,GAAS,eACTC,GAAY,kBACZC,GAAa,mBACbC,GAAS,eACTC,GAAa,mBAEbC,GAAc,oBAGdC,GAAqBC,GAASC,EAAQ,EACtCC,GAAgBF,GAASG,EAAG,EAC5BC,GAAoBJ,GAASK,EAAO,EACpCC,GAAgBN,GAASO,EAAG,EAC5BC,GAAoBR,GAASS,EAAO,EASpCC,GAASC,IAGRV,IAAYS,GAAO,IAAIT,GAAS,IAAI,YAAY,CAAC,CAAC,CAAC,GAAKH,IACxDK,IAAOO,GAAO,IAAIP,EAAG,GAAKV,IAC1BY,IAAWK,GAAOL,GAAQ,QAAQ,CAAC,GAAKV,IACxCY,IAAOG,GAAO,IAAIH,EAAG,GAAKX,IAC1Ba,IAAWC,GAAO,IAAID,EAAO,GAAKZ,MACrCa,GAAS,SAASE,EAAO,CACvB,IAAIC,EAASF,GAAWC,CAAK,EACzBE,EAAOD,GAAUnB,GAAYkB,EAAM,YAAc,OACjDG,EAAaD,EAAOd,GAASc,CAAI,EAAI,GAEzC,GAAIC,EACF,OAAQA,EAAY,CAClB,KAAKhB,GAAoB,OAAOD,GAChC,KAAKI,GAAe,OAAOT,GAC3B,KAAKW,GAAmB,OAAOT,GAC/B,KAAKW,GAAe,OAAOV,GAC3B,KAAKY,GAAmB,OAAOX,EACjC,CAEF,OAAOgB,CACT,GAGF,IAAOG,GAAQN,GCxDf,IAAIO,GAAc,OAAO,UAGrBC,GAAiBD,GAAY,eASjC,SAASE,GAAeC,EAAO,CAC7B,IAAIC,EAASD,EAAM,OACfE,EAAS,IAAIF,EAAM,YAAYC,CAAM,EAGzC,OAAIA,GAAU,OAAOD,EAAM,CAAC,GAAK,UAAYF,GAAe,KAAKE,EAAO,OAAO,IAC7EE,EAAO,MAAQF,EAAM,MACrBE,EAAO,MAAQF,EAAM,OAEhBE,CACT,CAEA,IAAOC,GAAQJ,GCtBf,IAAIK,GAAaC,EAAK,WAEfC,GAAQF,GCIf,SAASG,GAAiBC,EAAa,CACrC,IAAIC,EAAS,IAAID,EAAY,YAAYA,EAAY,UAAU,EAC/D,WAAIE,GAAWD,CAAM,EAAE,IAAI,IAAIC,GAAWF,CAAW,CAAC,EAC/CC,CACT,CAEA,IAAOE,GAAQJ,GCLf,SAASK,GAAcC,EAAUC,EAAQ,CACvC,IAAIC,EAASD,EAASE,GAAiBH,EAAS,MAAM,EAAIA,EAAS,OACnE,OAAO,IAAIA,EAAS,YAAYE,EAAQF,EAAS,WAAYA,EAAS,UAAU,CAClF,CAEA,IAAOI,GAAQL,GCdf,IAAIM,GAAU,OASd,SAASC,GAAYC,EAAQ,CAC3B,IAAIC,EAAS,IAAID,EAAO,YAAYA,EAAO,OAAQF,GAAQ,KAAKE,CAAM,CAAC,EACvE,OAAAC,EAAO,UAAYD,EAAO,UACnBC,CACT,CAEA,IAAOC,GAAQH,GCbf,IAAII,GAAcC,GAASA,GAAO,UAAY,OAC1CC,GAAgBF,GAAcA,GAAY,QAAU,OASxD,SAASG,GAAYC,EAAQ,CAC3B,OAAOF,GAAgB,OAAOA,GAAc,KAAKE,CAAM,CAAC,EAAI,CAAC,CAC/D,CAEA,IAAOC,GAAQF,GCPf,SAASG,GAAgBC,EAAYC,EAAQ,CAC3C,IAAIC,EAASD,EAASE,GAAiBH,EAAW,MAAM,EAAIA,EAAW,OACvE,OAAO,IAAIA,EAAW,YAAYE,EAAQF,EAAW,WAAYA,EAAW,MAAM,CACpF,CAEA,IAAOI,GAAQL,GCRf,IAAIM,GAAU,mBACVC,GAAU,gBACVC,GAAS,eACTC,GAAY,kBACZC,GAAY,kBACZC,GAAS,eACTC,GAAY,kBACZC,GAAY,kBAEZC,GAAiB,uBACjBC,GAAc,oBACdC,GAAa,wBACbC,GAAa,wBACbC,GAAU,qBACVC,GAAW,sBACXC,GAAW,sBACXC,GAAW,sBACXC,GAAkB,6BAClBC,GAAY,uBACZC,GAAY,uBAchB,SAASC,GAAeC,EAAQC,EAAKC,EAAQ,CAC3C,IAAIC,EAAOH,EAAO,YAClB,OAAQC,EAAK,CACX,KAAKb,GACH,OAAOgB,GAAiBJ,CAAM,EAEhC,KAAKpB,GACL,KAAKC,GACH,OAAO,IAAIsB,EAAK,CAACH,CAAM,EAEzB,KAAKX,GACH,OAAOgB,GAAcL,EAAQE,CAAM,EAErC,KAAKZ,GAAY,KAAKC,GACtB,KAAKC,GAAS,KAAKC,GAAU,KAAKC,GAClC,KAAKC,GAAU,KAAKC,GAAiB,KAAKC,GAAW,KAAKC,GACxD,OAAOQ,GAAgBN,EAAQE,CAAM,EAEvC,KAAKpB,GACH,OAAO,IAAIqB,EAEb,KAAKpB,GACL,KAAKG,GACH,OAAO,IAAIiB,EAAKH,CAAM,EAExB,KAAKhB,GACH,OAAOuB,GAAYP,CAAM,EAE3B,KAAKf,GACH,OAAO,IAAIkB,EAEb,KAAKhB,GACH,OAAOqB,GAAYR,CAAM,CAC7B,CACF,CAEA,IAAOS,GAAQV,GCjEf,SAASW,GAAgBC,EAAQ,CAC/B,OAAQ,OAAOA,EAAO,aAAe,YAAc,CAACC,GAAYD,CAAM,EAClEE,GAAWC,GAAaH,CAAM,CAAC,EAC/B,CAAC,CACP,CAEA,IAAOI,GAAQL,GCbf,IAAIM,GAAS,eASb,SAASC,GAAUC,EAAO,CACxB,OAAOC,GAAaD,CAAK,GAAKE,GAAOF,CAAK,GAAKF,EACjD,CAEA,IAAOK,GAAQJ,GCZf,IAAIK,GAAYC,IAAYA,GAAS,MAmBjCC,GAAQF,GAAYG,GAAUH,EAAS,EAAII,GAExCC,GAAQH,GCtBf,IAAII,GAAS,eASb,SAASC,GAAUC,EAAO,CACxB,OAAOC,GAAaD,CAAK,GAAKE,GAAOF,CAAK,GAAKF,EACjD,CAEA,IAAOK,GAAQJ,GCZf,IAAIK,GAAYC,IAAYA,GAAS,MAmBjCC,GAAQF,GAAYG,GAAUH,EAAS,EAAII,GAExCC,GAAQH,GCFf,IAAII,GAAkB,EAClBC,GAAkB,EAClBC,GAAqB,EAGrBC,GAAU,qBACVC,GAAW,iBACXC,GAAU,mBACVC,GAAU,gBACVC,GAAW,iBACXC,GAAU,oBACVC,GAAS,6BACTC,GAAS,eACTC,GAAY,kBACZC,GAAY,kBACZC,GAAY,kBACZC,GAAS,eACTC,GAAY,kBACZC,GAAY,kBACZC,GAAa,mBAEbC,GAAiB,uBACjBC,GAAc,oBACdC,GAAa,wBACbC,GAAa,wBACbC,GAAU,qBACVC,GAAW,sBACXC,GAAW,sBACXC,GAAW,sBACXC,GAAkB,6BAClBC,GAAY,uBACZC,GAAY,uBAGZC,EAAgB,CAAC,EACrBA,EAAc1B,EAAO,EAAI0B,EAAczB,EAAQ,EAC/CyB,EAAcX,EAAc,EAAIW,EAAcV,EAAW,EACzDU,EAAcxB,EAAO,EAAIwB,EAAcvB,EAAO,EAC9CuB,EAAcT,EAAU,EAAIS,EAAcR,EAAU,EACpDQ,EAAcP,EAAO,EAAIO,EAAcN,EAAQ,EAC/CM,EAAcL,EAAQ,EAAIK,EAAcnB,EAAM,EAC9CmB,EAAclB,EAAS,EAAIkB,EAAcjB,EAAS,EAClDiB,EAAchB,EAAS,EAAIgB,EAAcf,EAAM,EAC/Ce,EAAcd,EAAS,EAAIc,EAAcb,EAAS,EAClDa,EAAcJ,EAAQ,EAAII,EAAcH,EAAe,EACvDG,EAAcF,EAAS,EAAIE,EAAcD,EAAS,EAAI,GACtDC,EAActB,EAAQ,EAAIsB,EAAcrB,EAAO,EAC/CqB,EAAcZ,EAAU,EAAI,GAkB5B,SAASa,GAAUC,EAAOC,EAASC,EAAYC,EAAKC,EAAQC,EAAO,CACjE,IAAIC,EACAC,EAASN,EAAUhC,GACnBuC,EAASP,EAAU/B,GACnBuC,EAASR,EAAU9B,GAKvB,GAHI+B,IACFI,EAASF,EAASF,EAAWF,EAAOG,EAAKC,EAAQC,CAAK,EAAIH,EAAWF,CAAK,GAExEM,IAAW,OACb,OAAOA,EAET,GAAI,CAACI,GAASV,CAAK,EACjB,OAAOA,EAET,IAAIW,EAAQC,GAAQZ,CAAK,EACzB,GAAIW,GAEF,GADAL,EAASO,GAAeb,CAAK,EACzB,CAACO,EACH,OAAOO,GAAUd,EAAOM,CAAM,MAE3B,CACL,IAAIS,EAAMC,GAAOhB,CAAK,EAClBiB,EAASF,GAAOtC,IAAWsC,GAAOrC,GAEtC,GAAIwC,GAASlB,CAAK,EAChB,OAAOmB,GAAYnB,EAAOO,CAAM,EAElC,GAAIQ,GAAOlC,IAAakC,GAAO3C,IAAY6C,GAAU,CAACb,GAEpD,GADAE,EAAUE,GAAUS,EAAU,CAAC,EAAIG,GAAgBpB,CAAK,EACpD,CAACO,EACH,OAAOC,EACHa,GAAcrB,EAAOsB,GAAahB,EAAQN,CAAK,CAAC,EAChDuB,GAAYvB,EAAOwB,GAAWlB,EAAQN,CAAK,CAAC,MAE7C,CACL,GAAI,CAACF,EAAciB,CAAG,EACpB,OAAOX,EAASJ,EAAQ,CAAC,EAE3BM,EAASmB,GAAezB,EAAOe,EAAKR,CAAM,CAC5C,CACF,CAEAF,IAAUA,EAAQ,IAAIqB,IACtB,IAAIC,EAAUtB,EAAM,IAAIL,CAAK,EAC7B,GAAI2B,EACF,OAAOA,EAETtB,EAAM,IAAIL,EAAOM,CAAM,EAEnBsB,GAAM5B,CAAK,EACbA,EAAM,QAAQ,SAAS6B,GAAU,CAC/BvB,EAAO,IAAIP,GAAU8B,GAAU5B,EAASC,EAAY2B,GAAU7B,EAAOK,CAAK,CAAC,CAC7E,CAAC,EACQyB,GAAM9B,CAAK,GACpBA,EAAM,QAAQ,SAAS6B,GAAU1B,EAAK,CACpCG,EAAO,IAAIH,EAAKJ,GAAU8B,GAAU5B,EAASC,EAAYC,EAAKH,EAAOK,CAAK,CAAC,CAC7E,CAAC,EAGH,IAAI0B,EAAWtB,EACVD,EAASwB,GAAeC,GACxBzB,EAAS0B,GAASC,GAEnBC,EAAQzB,EAAQ,OAAYoB,EAAS/B,CAAK,EAC9C,OAAAqC,GAAUD,GAASpC,EAAO,SAAS6B,GAAU1B,EAAK,CAC5CiC,IACFjC,EAAM0B,GACNA,GAAW7B,EAAMG,CAAG,GAGtBmC,GAAYhC,EAAQH,EAAKJ,GAAU8B,GAAU5B,EAASC,EAAYC,EAAKH,EAAOK,CAAK,CAAC,CACtF,CAAC,EACMC,CACT,CAEA,IAAOiC,GAAQxC,GClKf,IAAIyC,GAAkB,EAClBC,GAAqB,EAoBzB,SAASC,GAAUC,EAAO,CACxB,OAAOC,GAAUD,EAAOH,GAAkBC,EAAkB,CAC9D,CAEA,IAAOI,GAAQH,GCVf,IAAII,GAAM,UAAW,CACnB,OAAOC,EAAK,KAAK,IAAI,CACvB,EAEOC,GAAQF,GCjBf,IAAIG,GAAkB,sBAGlBC,GAAY,KAAK,IACjBC,GAAY,KAAK,IAwDrB,SAASC,GAASC,EAAMC,EAAMC,EAAS,CACrC,IAAIC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAAiB,EACjBC,EAAU,GACVC,EAAS,GACTC,EAAW,GAEf,GAAI,OAAOZ,GAAQ,WACjB,MAAM,IAAI,UAAUJ,EAAe,EAErCK,EAAOY,GAASZ,CAAI,GAAK,EACrBa,GAASZ,CAAO,IAClBQ,EAAU,CAAC,CAACR,EAAQ,QACpBS,EAAS,YAAaT,EACtBG,EAAUM,EAASd,GAAUgB,GAASX,EAAQ,OAAO,GAAK,EAAGD,CAAI,EAAII,EACrEO,EAAW,aAAcV,EAAU,CAAC,CAACA,EAAQ,SAAWU,GAG1D,SAASG,EAAWC,EAAM,CACxB,IAAIC,GAAOd,EACPe,GAAUd,EAEd,OAAAD,EAAWC,EAAW,OACtBK,EAAiBO,EACjBV,EAASN,EAAK,MAAMkB,GAASD,EAAI,EAC1BX,CACT,CAEA,SAASa,EAAYH,EAAM,CAEzB,OAAAP,EAAiBO,EAEjBT,EAAU,WAAWa,EAAcnB,CAAI,EAEhCS,EAAUK,EAAWC,CAAI,EAAIV,CACtC,CAEA,SAASe,EAAcL,EAAM,CAC3B,IAAIM,GAAoBN,EAAOR,EAC3Be,GAAsBP,EAAOP,EAC7Be,GAAcvB,EAAOqB,GAEzB,OAAOX,EACHb,GAAU0B,GAAanB,EAAUkB,EAAmB,EACpDC,EACN,CAEA,SAASC,GAAaT,EAAM,CAC1B,IAAIM,GAAoBN,EAAOR,EAC3Be,GAAsBP,EAAOP,EAKjC,OAAQD,IAAiB,QAAcc,IAAqBrB,GACzDqB,GAAoB,GAAOX,GAAUY,IAAuBlB,CACjE,CAEA,SAASe,GAAe,CACtB,IAAIJ,EAAOU,GAAI,EACf,GAAID,GAAaT,CAAI,EACnB,OAAOW,GAAaX,CAAI,EAG1BT,EAAU,WAAWa,EAAcC,EAAcL,CAAI,CAAC,CACxD,CAEA,SAASW,GAAaX,EAAM,CAK1B,OAJAT,EAAU,OAINK,GAAYT,EACPY,EAAWC,CAAI,GAExBb,EAAWC,EAAW,OACfE,EACT,CAEA,SAASsB,IAAS,CACZrB,IAAY,QACd,aAAaA,CAAO,EAEtBE,EAAiB,EACjBN,EAAWK,EAAeJ,EAAWG,EAAU,MACjD,CAEA,SAASsB,IAAQ,CACf,OAAOtB,IAAY,OAAYD,EAASqB,GAAaD,GAAI,CAAC,CAC5D,CAEA,SAASI,IAAY,CACnB,IAAId,EAAOU,GAAI,EACXK,GAAaN,GAAaT,CAAI,EAMlC,GAJAb,EAAW,UACXC,EAAW,KACXI,EAAeQ,EAEXe,GAAY,CACd,GAAIxB,IAAY,OACd,OAAOY,EAAYX,CAAY,EAEjC,GAAIG,EAEF,oBAAaJ,CAAO,EACpBA,EAAU,WAAWa,EAAcnB,CAAI,EAChCc,EAAWP,CAAY,CAElC,CACA,OAAID,IAAY,SACdA,EAAU,WAAWa,EAAcnB,CAAI,GAElCK,CACT,CACA,OAAAwB,GAAU,OAASF,GACnBE,GAAU,MAAQD,GACXC,EACT,CAEA,IAAOE,GAAQjC,GC1Lf,IAAIkC,GAAkB,sBA8CtB,SAASC,GAASC,EAAMC,EAAMC,EAAS,CACrC,IAAIC,EAAU,GACVC,EAAW,GAEf,GAAI,OAAOJ,GAAQ,WACjB,MAAM,IAAI,UAAUF,EAAe,EAErC,OAAIO,GAASH,CAAO,IAClBC,EAAU,YAAaD,EAAU,CAAC,CAACA,EAAQ,QAAUC,EACrDC,EAAW,aAAcF,EAAU,CAAC,CAACA,EAAQ,SAAWE,GAEnDE,GAASN,EAAMC,EAAM,CAC1B,QAAWE,EACX,QAAWF,EACX,SAAYG,CACd,CAAC,CACH,CAEA,IAAOG,GAAQR,GCjEf,IAAIS,GAAgB,CAClB,QAAS,IACT,OAAQ,IACR,OAAQ,IACR,SAAU,IACV,QAAS,GACX,EASIC,GAAmBC,GAAeF,EAAa,EAE5CG,GAAQF,GChBf,IAAIG,GAAgB,4BAChBC,GAAmB,OAAOD,GAAc,MAAM,EAqBlD,SAASE,GAASC,EAAQ,CACxB,OAAAA,EAASC,GAASD,CAAM,EAChBA,GAAUF,GAAiB,KAAKE,CAAM,EAC1CA,EAAO,QAAQH,GAAeK,EAAgB,EAC9CF,CACN,CAEA,IAAOG,GAAQJ,GClBR,IAAMK,GAAN,cAAuB,QAAS,CAGnC,YAAYC,EAAgCC,EAAqBC,EAAqB,CAC9EF,aAAgB,WAChB,MAAMA,EAAK,OAAQA,EAAK,WAAYA,EAAK,UAAU,EAGnD,MAAMA,EAAMC,EAAYC,CAAU,CAE1C,CAEA,UAAUC,EAAe,CACrB,OAAO,OAAO,aAAa,KAAK,SAASA,CAAK,EAAG,KAAK,SAASA,EAAQ,CAAC,EAAG,KAAK,SAASA,EAAQ,CAAC,EAAG,KAAK,SAASA,EAAQ,CAAC,CAAC,CACjI,CAEA,iBAAiBA,EAAgBC,EAA6B,CAC1D,OAAO,IAAI,WAAW,KAAK,OAAQ,KAAK,YAAcD,GAAS,GAAIC,CAAM,CAC7E,CAEA,UAAUD,EAAeE,EAAc,CACnC,KAAK,SAASF,EAAOE,EAAK,WAAW,CAAC,CAAE,EACxC,KAAK,SAASF,EAAQ,EAAGE,EAAK,WAAW,CAAC,CAAC,EAC3C,KAAK,SAASF,EAAQ,EAAGE,EAAK,WAAW,CAAC,CAAC,EAC3C,KAAK,SAASF,EAAQ,EAAGE,EAAK,WAAW,CAAC,CAAC,CAC/C,CAEA,cAAcF,EAAeH,EAAkB,CAC1B,KAAK,iBAAiBG,EAAOH,EAAK,MAAM,EAChD,IAAIA,CAAI,CACrB,CACJ,EAGO,SAASM,GAAkBC,EAAkB,CAChD,IAAMC,EAAM,IAAI,WAAWD,EAAI,OAAS,CAAC,EACnCE,EAAK,IAAI,SAASD,EAAI,MAAM,EAClC,QAAS,EAAI,EAAG,EAAID,EAAI,OAAQ,IAC5BE,EAAG,UAAU,EAAI,EAAGF,EAAI,CAAC,CAAC,EAE9B,OAAOC,CACX,CAGO,SAASE,GAAkBF,EAAiB,CAC/C,IAAMC,EAAK,IAAI,SAASD,EAAI,OAAQA,EAAI,WAAYA,EAAI,MAAM,EACxDD,EAAM,IAAI,YAAYC,EAAI,OAAS,CAAC,EAC1C,QAAS,EAAI,EAAG,EAAIA,EAAI,OAAQ,GAAK,EACjCD,EAAI,EAAI,CAAC,EAAIE,EAAG,UAAU,CAAC,EAE/B,OAAOF,CACX,CAEO,SAASI,GAAiBJ,EAAoB,CACjD,OAAOA,EAAI,oBAAsB,CACrC,CAEO,IAAMK,GAAc,IAAI,YAClBC,GAAc,IAAI,YCrDxB,IAAMC,GAAN,KAAU,CAAV,cACH,UAAO,GACP,YAAqB,CAAC,EAEtB,MAAMC,EAAkB,CACpB,IAAMC,EAAO,IAAIC,GAASF,CAAI,EAG9B,GAAIC,EAAK,UAAU,CAAC,IAAM,OACtB,MAAM,IAAI,MAAM,iBAAiB,EAIrC,KAAK,KAAOA,EAAK,UAAU,CAAC,EAC5B,IAAI,EAAI,GAGFE,EAASH,EAAK,OACpB,KAAO,EAAIG,GAAQ,CACf,IAAMC,EAAeH,EAAK,UAAU,EAAI,CAAC,EACzC,GAAIG,EAAe,GAAMA,EAAe,EAAKD,EACzC,MAAM,IAAI,MAAM,wBAAwB,EAE5C,KAAK,OAAO,KAAK,CACb,KAAMF,EAAK,iBAAiB,EAAI,EAAGG,CAAY,EAC/C,OAAQ,EACR,KAAMH,EAAK,UAAU,CAAC,CAC1B,CAAC,EACD,GAAK,EAAIG,EACL,EAAI,GACJ,GAER,CACJ,CAEA,OAAoB,CAEhB,IAAIC,EAAgB,GACpB,QAAWC,KAAS,KAAK,OACrBD,GAAiB,EAAIC,EAAM,KAAK,OAC5BD,EAAgB,GAChBA,IAKR,IAAMJ,EAAO,IAAIC,GAAS,IAAI,YAAYG,CAAa,CAAC,EACxDJ,EAAK,UAAU,EAAG,MAAM,EACxBA,EAAK,UAAU,EAAGI,EAAgB,CAAC,EACnCJ,EAAK,UAAU,EAAG,KAAK,IAAI,EAC3B,IAAI,EAAI,GACR,QAAWK,KAAS,KAAK,OACrBL,EAAK,UAAU,EAAGK,EAAM,IAAI,EAC5BL,EAAK,UAAU,EAAI,EAAGK,EAAM,KAAK,MAAM,EACvCL,EAAK,cAAc,EAAI,EAAGK,EAAM,IAAI,EACpC,GAAK,EAAIA,EAAM,KAAK,OAChB,EAAI,GACJ,IAGR,OAAOL,EAAK,iBAAiB,CACjC,CACJ,ECrBA,IAAMM,GAAsD,CACxD,KAAM,OACN,KAAM,OACN,KAAM,OACN,OAAQ,OACZ,EAEMC,GAAqB,OAEdC,GAAN,KAAY,CAWf,YAAYC,EAAmB,CAV/B,eAAY,QAEZ,YAAqC,CAAC,EAGtC,KAAQ,UAAY,GACpB,KAAQ,SAAmC,CAAC,EAKpCA,GACA,KAAK,KAAKA,CAAI,CAEtB,CAKA,KAAKA,EAAyCC,EAAe,CACzD,GAAI,MAAK,UAGT,IAAID,aAAgB,WAAY,CAC5B,IAAME,EAAM,IAAIC,GAEhB,GADAD,EAAI,MAAMF,CAAI,EACVE,EAAI,OAAS,OACb,MAAM,IAAI,MAAM,kBAAkB,EAEtC,GAAIA,EAAI,OAAO,CAAC,EAAE,OAAS,OACvB,MAAM,IAAI,MAAM,sCAAsC,EAI1D,QAAWE,KAAaF,EAAI,OACxB,OAAQE,EAAU,KAAM,CACpB,IAAK,OAAQ,CAET,KAAK,UAAYA,EAAU,KAC3B,KACJ,CACA,IAAK,OAAQ,CAET,IAAMC,EAAO,IAAIC,GAASF,EAAU,IAAI,EACxC,KAAK,cAAgBC,EAAK,UAAU,CAAC,EACrC,KACJ,CACA,IAAK,OAAQ,CACT,IAAME,EAAMC,GAAY,OAAOJ,EAAU,IAAI,EAEvCK,EAAgB,yCAAyC,KAAKF,CAAG,EACjEG,EAAgB,sBAChBC,EAAoB,UACpBC,EAAqB,OAC3B,GAAIH,EAAe,CACf,IAAII,EACJ,KAAQA,EAASH,EAAc,KAAKD,EAAc,CAAC,CAAC,GAAI,CACpD,IAAMK,EAAMD,EAAO,CAAC,EAAE,YAAY,EAC9BE,EAAUF,EAAO,CAAC,EAAE,QAAQD,EAAoB,GAAG,EACnDE,IAAQ,gBACRC,EAAUA,EAAQ,QAAQJ,EAAmB;AAAA,CAAI,GAErD,KAAK,SAASG,CAAG,EAAIE,GAASD,CAAO,CACzC,CACJ,CACA,KACJ,CACA,IAAK,OAAQ,CAET,IAAMV,EAAO,IAAIC,GAASF,EAAU,IAAI,EACpCa,EAAI,EACR,KAAOA,EAAIZ,EAAK,YAAY,CACxB,IAAMa,EAAQrB,GAA4BQ,EAAK,UAAUY,CAAC,CAAC,EACrDE,EAAkBd,EAAK,UAAUY,EAAI,CAAC,EACtCG,EAAcf,EAAK,UAAUY,EAAI,CAAC,EAClCI,EAAQ,KAAK,OAAO,GAAGH,CAAK,IAAIC,CAAe,EAAE,EACnDE,IACAA,EAAM,QAAUb,GAAY,OAAOH,EAAK,iBAAiBY,EAAI,GAAIG,CAAW,CAAC,GAEjFH,GAAK,GAAKG,CACd,CACA,KACJ,CACA,IAAK,OAAQ,CAET,IAAMf,EAAO,IAAIC,GAASF,EAAU,IAAI,EACpCa,EAAI,EACR,KAAOA,EAAIZ,EAAK,YAAY,CACxB,IAAMa,EAAQb,EAAK,UAAUY,CAAC,EACxBE,EAAkBd,EAAK,UAAUY,EAAI,CAAC,EACtCK,EAAkBjB,EAAK,UAAUY,EAAI,CAAC,EAC5CA,GAAK,GACL,IAAMM,EAAiBrB,EAAI,OAAO,OAAOmB,GAASA,EAAM,SAAWC,CAAe,EAAE,CAAC,EACrF,GAAI,CAACC,EACD,MAAM,IAAI,MAAM,4BAA4BD,CAAe,EAAE,EAEjE,IAAME,EAAOD,EAAe,KACtBF,EAAoB,CACtB,UAAWG,EAEX,QAASA,IAAS,OAASxB,EAAK,SAASuB,EAAe,OAAQA,EAAe,OAAS,EAAIA,EAAe,KAAK,MAAM,EAAIA,EAAe,KACzI,MAAO1B,GAA4BqB,CAAK,CAC5C,EACIA,IAAU,SACNM,IAAS,OACTH,EAAM,KAAO,OAERG,IAAS,OACdH,EAAM,KAAO,MAGbA,EAAM,KAAOvB,IAGjBoB,IAAU,SACVG,EAAM,OAASG,IAAS,QAAUA,IAAS,QAE/C,KAAK,OAAO,GAAGH,EAAM,KAAK,IAAIF,CAAe,EAAE,EAAIE,CACvD,CACA,KACJ,CACJ,CAER,SAESpB,GAAS,SAAW,UACzB,QAAWwB,KAAOzB,EAAM,CACpB,GAAI,CAAC,OAAO,UAAU,CAACyB,CAAG,EACtB,SAEJ,IAAMJ,EAAa,OAAO,OAAO,CAAC,EAAIrB,EAAiByB,CAAG,CAAC,EAC3D,OAAOJ,EAAM,MACTA,EAAM,QAAUA,EAAM,QACtBA,EAAM,UAAY,CACd,OAAQA,EAAM,OACd,MAAOA,EAAM,KACjB,EACA,OAAOA,EAAM,OACb,OAAOA,EAAM,OAEjBA,EAAM,KAAOA,EAAM,IAAI,SAAS,MAAM,EAAI,MAAQ,OAClDA,EAAM,MAAQ,OACd,KAAK,OAAO,QAAQI,CAAG,EAAE,EAAIJ,CACjC,SAEK,QAAM,QAAQrB,CAAI,GAAKA,EAAK,SAAW,GAI5C,MAAM,IAAI,MAAM,oCAAoC,EAGxD,KAAK,UAAY,GACrB,CAEA,YAAmB,CACf,OAAO,IACX,CAEA,UAAUkB,EAAeQ,EAAgC,CACrD,OAAO,KAAK,OAAO,GAAGR,CAAK,IAAIQ,CAAG,EAAE,GAAK,IAC7C,CAEA,gBAAgC,CAC5B,OAAO,KAAK,eAAiB,IACjC,CAEA,eAAeA,EAAoC,CAC/C,IAAML,EAAQ,KAAK,OAAO,QAAQK,CAAG,EAAE,EACvC,OAAKL,GAAO,QAGL,CACH,OAAQA,EAAM,OACd,KAAMA,EAAM,OAChB,EALW,IAMf,CAEA,gBAAyC,CACrC,OAAO,KAAK,SAChB,CAKA,cAAcM,EAA+C,CACzD,IAAMN,EAAQ,KAAK,OAAO,QAAQ,EAClC,MAAI,CAACA,GAAO,SAAYM,GAAYN,EAAM,YAAcM,EAC7C,KAEJN,EAAM,OACjB,CAEA,eAAeK,EAA+B,CAC1C,IAAML,EAAQ,KAAK,OAAO,QAAQK,CAAG,EAAE,EACvC,GAAI,CAACL,EACD,OAAO,KAIP,CAACA,EAAM,WAAaA,EAAM,UACtBA,EAAM,OAAS,OACfA,EAAM,UAAYO,GAAoBP,EAAM,OAAO,EAE9CA,EAAM,OAAS,QACpBA,EAAM,UAAYQ,GAAmBR,EAAM,OAAO,IAI1D,IAAMS,EAAiB,OAAO,OAAO,CAAC,MAAOJ,CAAG,EAAGL,CAAK,EACxD,OAAIS,EAAI,YACJA,EAAI,OAASA,EAAI,UAAU,OAC3BA,EAAI,MAAQA,EAAI,UAAU,OAEvBA,CACX,CAEA,cAAcJ,EAA4B,CACtC,IAAML,EAAQ,KAAK,OAAO,QAAQK,CAAG,EAAE,EACvC,OAAKL,EAIDA,EAAM,IACCA,EAAM,IAGbA,EAAM,OAASvB,IAAsBuB,EAAM,SAC3CA,EAAM,IAAM,IAAI,gBAAgB,IAAI,KAAK,CAACA,EAAM,OAAO,EAAG,CAAC,KAAM,SAASA,EAAM,IAAI,EAAE,CAAC,CAAC,EACjFA,EAAM,KAGV,KAZI,IAaf,CAEA,aAAaU,EAAuB,CAChC,OAAO,KAAK,SAASA,CAAK,CAC9B,CAEA,QAAkB,CACd,OAAO,KAAK,SAChB,CACJ,EAOA,SAASC,GAAoBC,EAAyC,CAClE,IAAMC,EAAO,IAAIC,GAASF,CAAI,EAC1BG,EAAI,EACR,KAAOA,EAAIF,EAAK,YAAY,CACxB,GAAIA,EAAK,SAASE,CAAC,IAAM,IACrB,OAEJ,KAAOF,EAAK,SAASE,CAAC,IAAM,KACxBA,IAEJ,IAAMC,EAASH,EAAK,SAASE,GAAG,EAEhC,GAAIC,IAAW,GAASA,GAAU,KAAQA,GAAU,IAChD,SAEJ,IAAMC,EAAcJ,EAAK,UAAUE,CAAC,EACpC,GAAIC,GAAU,KAAQA,GAAU,KAAQA,IAAW,IAC/C,OAAIC,EAAc,EAEd,OAEG,CACH,OAAQJ,EAAK,UAAUE,EAAI,CAAC,EAC5B,MAAOF,EAAK,UAAUE,EAAI,CAAC,CAC/B,EAEJA,GAAKE,CACT,CACJ,CAEA,SAASC,GAAmBN,EAAyC,CACjE,IAAMC,EAAO,IAAIC,GAASF,CAAI,EAC9B,GAAIC,EAAK,UAAU,CAAC,IAAM,UACtB,OAGJ,IAAIE,EAAI,EACR,KAAOA,EAAIF,EAAK,YAAY,CACxB,IAAMI,EAAcJ,EAAK,UAAUE,CAAC,EAC9BI,EAAYN,EAAK,UAAUE,EAAI,CAAC,EAEtC,GADAA,GAAK,EACDI,IAAc,OACd,MAAO,CACH,OAAQN,EAAK,SAASE,EAAI,CAAC,EAC3B,MAAOF,EAAK,SAASE,CAAC,CAC1B,EAGJA,GAAKE,EAAc,CACvB,CACJ,CCrWO,IAAMG,GAA8C,CACvD,iBAAkB,EAClB,gBAAiB,EACjB,cAAe,EACf,cAAe,EACf,gBAAiB,EACjB,gBAAiB,EACjB,eAAgB,EAChB,cAAe,EACf,YAAa,EACb,YAAa,EACb,OAAQ,GACR,WAAY,EACZ,WAAY,EACZ,YAAa,EACb,YAAa,EACb,MAAO,EACX,EAEaC,GAA8D,CACvE,EAAG,SACH,EAAG,MACH,GAAI,SACJ,GAAI,SACJ,GAAI,SACJ,GAAI,WACJ,GAAI,MACJ,GAAI,OACJ,GAAI,OACJ,GAAI,KACJ,GAAI,QACJ,GAAI,OACJ,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,QACT,EAEaC,GAAgB,GAChBC,GAAkB,GAClBC,GAAc,GAEdC,GAAO,OAGb,IAAMC,GAAmB,WAEnBC,GAAkB,QCpE/B,IAAAC,GAAA,GAAAC,GAAAD,GAAA,oBAAAE,GAAA,qBAAAC,GAAA,qBAAAC,GAAA,qBAAAC,GAAA,sBAAAC,GAAA,gBAAAC,GAAA,kBAAAC,GAAA,uBAAAC,GAAA,iBAAAC,GAAA,wBAAAC,GAAA,kBAAAC,GAAA,uBAAAC,GAAA,mBAAAC,GAAA,yBAAAC,GAAA,yBAAAC,GAAA,mBAAAC,GAAA,0BAAAC,GAAA,wBAAAC,GAAA,uBAAAC,GAAA,yBAAAC,GAAA,uBAAAC,GAAA,sBAAAC,GAAA,uBAAAC,GAAA,mCAAAC,GAAA,mCAAAC,GAAA,kCAAAC,GAAA,qBAAAC,GAAA,sBAAAC,GAAA,uBAAAC,GAAA,qBAAAC,GAAA,8BAAAC,GAAA,iCAAAC,GAAA,2BAAAC,GAAA,uBAAAC,GAAA,sBAAAC,GAAA,0BAAAC,GAAA,8BAAAC,GAAA,4BAAAC,GAAA,uBAAAC,GAAA,2BAAAC,GAAA,kBAAAC,GAAA,mBAAAC,GAAA,uBAAAC,GAAA,wBAAAC,GAAA,wBAAAC,GAAA,kBAAAC,GAAA,oBAAAC,GAAA,wBAAAC,GAAA,oBAAAC,GAAA,4BAAAC,GAAA,0BAAAC,GAAA,wBAAAC,GAAA,0BAAAC,GAAA,2BAAAC,GAAA,mBAAAC,GAAA,iBAAAC,GAAA,gBAAAC,GAAA,mBAAAC,GAAA,kBAAAC,GAAA,mBAAAC,GAAA,mBAAAC,GAAA,mBAAAC,GAAA,kBAAAC,GAAA,kBAAAC,GAAA,kBAAAC,GAAA,kBAAAC,GAAA,kBAAAC,GAAA,kBAAAC,GAAA,kBAAAC,GAAA,kBAAAC,GAAA,iBAAAC,GAAA,iBAAAC,GAAA,mBAAAC,GAAA,qBAAAC,GAAA,mBAAAC,GAAA,mBAAAC,GAAA,kBAAAC,GAAA,gBAAAC,GAAA,oBAAAC,GAAA,eAAAC,GAAA,qBAAAC,GAAA,iBAAAC,GAAA,mBAAAC,GAAA,gBAAAC,GAAA,qBAAAC,GAAA,qBAAAC,GAAA,iBAAAC,GAAA,gBAAAC,GAAA,oBAAAC,GAAA,iBAAAC,GAAA,eAAAC,GAAA,uBAAAC,GAAA,oBAAAC,GAAA,gBAAAC,GAAA,gBAAAC,GAAA,wBAAAC,GAAA,0BAAAC,GAAA,4BAAAC,GAAA,uBAAAC,GAAA,sBAAAC,GAAA,8BAAAC,GAAA,2BAAAC,GAAA,2BAAAC,GAAA,mBAAAC,GAAA,wBAAAC,GAAA,qBAAAC,GAAA,4BAAAC,GAAA,6BAAAC,GAAA,6BAAAC,GAAA,8BAAAC,GAAA,oBAAAC,GAAA,oBAAAC,GAAA,qBAAAC,GAAA,yBAAAC,GAAA,sBAAAC,GAAA,2BAAAC,GAAA,oBAAAC,GAAA,mBAAAC,GAAA,uBAAAC,GAAA,2BAAAC,GAAA,oBAAAC,GAAA,qBAAAC,GAAA,kBAAAC,GAAA,qBAAAC,GAAA,iBAAAC,GAAA,uBAAAC,GAAA,qBAAAC,GAAA,mBAAAC,GAAA,mBAAAC,KAWO,IAAMhF,GAAkB,EAClB3B,GAAoB,EACpBa,GAAoB,EACpBZ,GAAqB,EACrBE,GAAiC,EACjCD,GAAiC,EACjCE,GAAgC,EAChCa,GAAqB,EACrBO,GAAgB,EAChBhB,GAAmB,EACnBF,GAAoB,EACpBa,GAAgB,EAChBI,GAAsB,EACtBD,GAAsB,GACtBV,GAAqB,GACrBD,GAAyB,GACzBU,GAAqB,GACrBX,GAA+B,GAC/Be,GAAkB,GAClBC,GAAsB,GACtBZ,GAAwB,GACxBE,GAA0B,GAC1BD,GAA4B,GAC5BV,GAAmB,GACnBe,GAAiB,GACjBF,GAAyB,GACzBT,GAA4B,GAC5BF,GAAqB,KAErBkD,GAAkB,WAClBP,GAAe,WACfK,GAAgB,WAChBG,GAAa,WACbxB,GAAe,WACfoB,GAAiB,WACjBrB,GAAiB,WACjBG,GAAiB,WACjBoB,GAAc,WACdH,GAAiB,WACjBD,GAAmB,WACnBH,GAAe,WACfd,GAAc,WACdE,GAAgB,WAChBI,GAAgB,WAChBC,GAAgB,WAChBC,GAAgB,WAChBC,GAAgB,WAChBC,GAAgB,WAChBC,GAAgB,WAChBC,GAAgB,WAChBC,GAAgB,WAChBV,GAAiB,WACjBC,GAAiB,WACjBC,GAAiB,WAEjBW,GAAiB,GAEjBnE,GAAc,EACdG,GAAe,EACfP,GAAmB,EACnBE,GAAmB,EACnBC,GAAoB,EACpBJ,GAAiB,EACjBM,GAAgB,EAChBC,GAAqB,EACrBL,GAAmB,EACnBO,GAAsB,EAEtBgF,GAAe,EACfJ,GAAmB,EACnBM,GAAqB,EACrBL,GAAe,EACfM,GAAkB,EAClBT,GAAc,EACdO,GAAa,EACbN,GAAmB,EACnBG,GAAc,EACdM,GAAc,EACdC,GAAc,GACdN,GAAkB,GAElBiC,GAAmB,EACnBG,GAAe,EACfF,GAAgB,EAChBG,GAAqB,EACrBC,GAAmB,EACnBH,GAAmB,EAEnBN,GAAkB,EAClBG,GAAkB,EAClBV,GAAkB,EAClBC,GAAkB,EAClBG,GAAoB,GAEpBE,GAAkB,GAClBG,GAAyB,GACzBJ,GAAyB,IAEzBH,GAAmB,EACnBM,GAAqB,IACrBL,GAAuB,IAEvBlG,GAAiB,EACjBE,GAAsB,EACtBE,GAAuB,EACvBH,GAAwB,EACxBI,GAAqB,GAErBF,GAAqB,IACrBJ,GAAuB,EAEvBF,GAAiB,EACjBF,GAAgB,EAChBC,GAAqB,EACrBE,GAAuB,EAGvBqE,GAAiB,EACjBF,GAAmB,EACnBC,GAAe,EAEfe,GAAwB,EACxBI,GAA4B,EAC5BH,GAA0B,EAC1BM,GAAiB,EACjBE,GAAmB,EACnBN,GAAoB,EACpBE,GAAyB,EACzBG,GAAsB,EACtBT,GAAsB,EACtBO,GAAyB,EACzBJ,GAAqB,GAErBS,GAA2B,EAC3BC,GAA2B,EAC3BF,GAA0B,EAC1BG,GAA4B,EAE5B1D,GAAsB,EACtBD,GAAwB,EACxBD,GAA0B,EAC1BG,GAAwB,EACxBC,GAAyB,EAEzB2E,GAAiB,GACjBD,GAAiB,GCzIvB,IAAME,GAAN,KAAiB,CAMpB,YAAYC,EAAoBC,EAAiBC,EAAe,CAC5D,KAAK,OAASD,EACd,KAAK,IAAMD,EACX,KAAK,KAAOE,EACZ,KAAK,IAAMC,GAAiBH,CAAG,CACnC,CAEA,SAAU,CACN,GAAI,KAAK,IAAK,CACV,GAAI,KAAK,OACL,OAAOI,GAAkB,KAAK,GAAkB,EAE/C,CACD,IAAMC,EAAO,OAAO,cAAc,GAAG,KAAK,GAAG,EAC7C,OAAOC,GAAY,OAAOD,CAAI,CAClC,CACJ,KAEI,QAAQ,KAAK,IAAmB,MAAM,CAE9C,CACJ,EAGaE,GAAN,KAAwD,CAM3D,YAAYC,EAAoD,CALhE,KAAQ,MAAoC,CAAC,EAC7C,eAAY,uBAEZ,eAAY,GAmDZ,KAAQ,MAAQC,GAAS,IAAM,CAC3B,QAAWC,KAAY,KAAK,MAAO,CAC/B,IAAMC,EAAU,KAAK,MAAMD,CAAQ,EACnC,GAAI,KAAK,OAAO,UAAW,CACvB,IAAME,EAAU,KAAK,OAAO,WAAW,EAAgBD,EAAQ,IAAI,EACnEC,EAAQ,OAAOD,EAAQ,QAAQ,CAAC,EAChCC,EAAQ,OAAO,CACnB,MAEI,KAAK,OAAO,WAAWD,EAAQ,KAAMA,EAAQ,QAAQ,CAAC,CAE9D,CACA,KAAK,MAAQ,CAAC,CAClB,EAAG,CAAC,EA7DA,KAAK,OAASH,CAClB,CAEA,KAAKK,EAAyB,CAAC,CAE/B,gBAAgBX,EAAe,CAC3B,MAAO,CAAC,CAAC,KAAK,MAAMA,EAAK,QAAQ,GAAK,KAAK,OAAO,gBAAgBA,CAAI,CAC1E,CAEA,UAAUA,EAAe,CACrB,GAAI,KAAK,MAAMA,EAAK,QAAQ,EAExB,OAAO,KAAK,MAAMA,EAAK,QAAQ,EAAE,QAAQ,EAE7C,GAAI,KAAK,OAAO,UAAW,CACvB,IAAMU,EAAU,KAAK,OAAO,WAAW,EAAeV,CAAI,EAC1D,GAAI,CAACU,EACD,OAAO,KAEXA,EAAQ,MAAM,EAAG,CAAY,EAC7B,IAAME,EAASF,EAAQ,MAAM,EACvBZ,EAAM,IAAI,WAAWc,CAAM,EACjC,OAAAF,EAAQ,MAAM,EAAG,CAAc,EAC/BA,EAAQ,MAAMZ,CAAG,EACjBY,EAAQ,OAAO,EACRZ,CACX,KAEI,QAAO,KAAK,OAAO,UAAUE,CAAI,CAEzC,CAEA,gBAAgBA,EAAe,CACvB,KAAK,MAAMA,EAAK,QAAQ,GACxB,OAAO,KAAK,MAAMA,EAAK,QAAQ,EAEnC,KAAK,OAAO,gBAAgBA,CAAI,CACpC,CAEA,WAAWa,EAAgBC,EAA+B,CACtD,MAAM,IAAI,MAAM,0DAA0D,CAC9E,CAEA,QAAS,CACL,MAAO,EACX,CAkBA,WAAWd,EAAee,EAAqB,CAC3C,YAAK,MAAMf,EAAK,QAAQ,EAAIe,EAC5B,KAAK,MAAM,EACJ,EACX,CAIA,cAAcC,EAAmB,CAC7B,OAAO,KAAK,OAAO,cAAcA,CAAS,CAC9C,CAEA,eAAeA,EAAmBC,EAA+B,CAC7D,KAAK,OAAO,eAAeD,EAAWC,CAAQ,CAClD,CAEA,sBAAsBT,EAAkBU,EAAe,CACnD,OAAO,KAAK,OAAO,sBAAsBV,EAAUU,CAAK,CAC5D,CAEA,mBAAmBV,EAAmBU,EAAgBC,EAAiB,CACnE,OAAO,KAAK,OAAO,mBAAmBX,EAAUU,EAAOC,CAAM,CACjE,CAEA,wBAAwBD,EAAe,CACnC,OAAO,KAAK,OAAO,wBAAwBA,CAAK,CACpD,CAEA,WAAWE,EAAc,CACrB,OAAO,KAAK,OAAO,WAAWA,CAAI,CACtC,CAEA,KAAKC,EAAeH,EAAsBC,EAAmCG,EAA0C,CACnH,KAAK,OAAO,KAAKD,EAAMH,EAAOC,EAAQG,CAAQ,CAClD,CACJ,EC7IO,SAASC,GAAWC,EAAuBC,EAAkBC,EAAgB,CAChF,IAAMC,EAAc,KAAK,IAAID,EAAQD,EAAO,MAAM,EAClD,QAASG,EAAI,EAAGA,EAAID,EAAaC,IAC7BH,EAAOG,CAAC,EAAIJ,EAAOI,CAAC,CAE5B,CCAO,IAAMC,GAAN,KAAiC,CAUpC,YAAYC,EAA8BC,EAAkBC,EAA4BC,EAAcC,EAAe,CALrH,UAAuB,KACvB,UAAuB,KAKnB,KAAK,OAAS,EAAEA,EAAQ,KACxB,KAAK,OAASJ,EACd,KAAK,SAAWC,EAChB,KAAK,MAAQC,EACb,KAAK,KAAOC,CAChB,CAEA,aAAc,CACV,KAAK,OAAO,gBAAgB,KAAK,KAAK,CAC1C,CAEA,QAAkB,CACd,OAAO,KAAK,OAAO,gBAAgB,KAAK,KAAK,CACjD,CAEA,MAA0B,CACtB,OAAO,KAAK,OAAO,UAAU,KAAK,KAAK,CAC3C,CAEA,MAAME,EAAoB,CACtB,IAAMC,EAAU,IAAIC,GAAWF,EAAK,KAAK,OAAQ,KAAK,KAAK,EAC3D,KAAK,OAAO,WAAW,KAAK,MAAOC,CAAO,CAC9C,CACJ,ECDO,IAAME,GAAe,CACxB,MAAO,+BACX,ECtCO,IAAMC,GAAW,EACXC,GAAa,IACbC,GAAgB,GAEhBC,GAAuB,CAAC,cAAe,cAAe,aAAc,YAAa,cAAe,aAAc,YAAa,QAAS,mBAAoB,SAAS,EAEjKC,GAAuC,CAChD,EAAG,QACH,EAAG,OACH,EAAG,YACH,EAAG,aACP,EAEaC,GAAuC,CAChD,EAAG,OACH,EAAG,OACH,EAAG,aACH,EAAG,SACP,EAEaC,GAAmE,CAC5E,EAAG,WACH,EAAG,aACH,EAAG,eACH,EAAG,aACH,EAAG,aACP,EAEaC,GAAqD,CAC9D,OAAQ,WACR,KAAM,WACN,IAAK,WACL,OAAQ,WACR,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,OAAQ,WACR,OAAQ,WACR,OAAQ,WACR,KAAM,WACN,KAAM,WACN,SAAU,WACV,OAAQ,WACR,OAAQ,WACR,MAAO,WACP,IAAK,WACL,GAAI,UACR,EAEaC,GAAsC,CAC/C,EAAG,SACH,EAAG,aACH,EAAG,eACH,EAAG,SACH,EAAG,YACH,EAAG,QACH,EAAG,OACH,EAAG,aACH,EAAG,QACH,EAAG,QACH,GAAI,OACR,EAEaC,GAAkD,CAC3D,WAAY,SACZ,WAAY,QACZ,WAAY,QACZ,WAAY,QACZ,WAAY,QACZ,WAAY,QACZ,WAAY,QACZ,WAAY,QACZ,WAAY,QACZ,WAAY,QACZ,WAAY,SACZ,WAAY,SACZ,WAAY,QAChB,EAEaC,GAAoE,CAC7E,OAAQ,WACR,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,MAAO,WACP,OAAQ,WACR,OAAQ,WACR,OAAQ,UACZ,EC5FA,IAAeC,GAAf,KAA+C,CAS3C,YAAYC,EAAeC,EAAc,CANzC,UAAsB,KACtB,UAAsB,KAGtB,KAAU,YAAc,EAGpB,KAAK,MAAQD,EACb,KAAK,KAAOC,CAChB,CAEA,MAAMC,EAAuB,CACrBA,IACAA,EAAO,UAAU,EAAG,CAAC,EACrBA,EAAO,UAAU,EAAG,KAAK,WAAW,EAE5C,CAEA,WAAWC,EAA6B,CACpC,MAAO,EACX,CAEA,SAASC,EAA2B,CAChC,MAAO,EACX,CAEA,SAASD,EAA6B,CAClC,MAAO,EACX,CAEA,cAAuB,CACnB,MAAO,EACX,CAMA,aAAaE,EAAeC,EAAc,CAAC,CAC/C,EAGaC,GAAN,cAAgCR,EAAW,CAe9C,YAAYS,EAAoBR,EAAeC,EAAcQ,EAAuB,CAChF,MAAMT,EAAOC,CAAI,EANrB,KAAU,IAAM,EAChB,KAAQ,WAAa,EACrB,UAAO,QAKH,KAAK,IAAMO,EACX,KAAK,SAAWC,EAChB,KAAK,WAAaT,IAAU,EAC5B,KAAK,IAAMA,IAAU,EAAiB,EAAIQ,EAAI,OAC9C,KAAK,IAAME,GAAiBF,CAAG,CACnC,CAEA,MAAMN,EAAuB,CACzB,KAAK,WAAW,EAChB,KAAK,MAAM,EACPA,IACAA,EAAO,UAAU,EAAG,KAAK,UAAU,EACnCA,EAAO,UAAU,EAAG,KAAK,WAAW,EAE5C,CAEU,OAAOS,EAAkB,CAC/B,KAAK,IAAM,KAAK,IAAI,KAAK,IAAMA,EAAU,KAAK,IAAI,MAAM,EACpD,KAAK,MAAQ,KAAK,IAAI,SACtB,KAAK,WAAa,GAE1B,CAEA,WAAWH,EAA4B,CACnC,IAAMI,EAAc,KAAK,IAAIJ,EAAI,OAAQ,KAAK,IAAM,KAAK,GAAG,EAE5D,GAAI,CAACE,GAAiBF,CAAG,GAAK,KAAK,IAC/B,QAASK,EAAI,EAAGA,EAAID,EAAaC,IAAK,CAClC,IAAMC,EAAK,KAAK,IAAI,KAAK,IAAMD,CAAC,EAChCL,EAAIK,CAAC,EAAIC,EAAKC,GAAaC,GAAgBF,CAC/C,MAIAN,EAAI,IAAI,KAAK,IAAI,SAAS,KAAK,IAAK,KAAK,IAAMI,CAAW,CAAC,EAE/D,YAAK,KAAOA,EACZ,KAAK,YAAcA,EACZA,CACX,CAEA,SAASK,EAA0B,CAC/B,GAAI,KAAK,IAAM,KAAK,IAAK,CACrB,KAAK,aACL,IAAMH,EAAK,KAAK,IAAI,KAAK,KAAK,EAC9B,MAAO,CAACG,GAAWH,EAAKC,GAAaC,GAAgBF,CACzD,CACA,MAAO,EACX,CAEA,SAASN,EAA4B,CACjC,IAAMI,EAAc,KAAK,IAAIJ,EAAI,OAAS,EAAG,KAAK,IAAM,KAAK,GAAG,EAChE,GAAII,EAAc,EACd,MAAO,GAEX,IAAMM,EAAgB,CAACR,GAAiBF,CAAG,GAAK,KAAK,IACjDK,EAAI,EACR,KAAOA,EAAID,GAAa,CACpB,IAAME,EAAK,KAAK,IAAI,KAAK,KAAK,EAE9B,GADAN,EAAIK,GAAG,EAAIK,GAAiBJ,EAAKC,GAAaC,GAAgBF,EAC1DA,IAAO,GACP,KAER,CACA,OAAAN,EAAIK,CAAC,EAAIM,GACT,KAAK,YAAcN,EACZA,CACX,CAEA,cAAuB,CACnB,OAAO,KAAK,GAChB,CAEA,WAAWL,EAAeY,EAAc,CACpC,IAAMC,EAAab,EAAI,OACvB,KAAK,aAAea,EAChB,KAAK,IAAMA,EAAa,KAAK,KAAO,KAAK,YACzC,KAAK,OAAOA,CAAU,EAE1B,IAAMC,EAAe,KAAK,IAAID,EAAY,KAAK,IAAM,KAAK,GAAG,EAC7D,GAAIC,IAAiB,EAIrB,IAAIF,GAAO,CAAC,KAAK,IACb,QAASP,EAAI,EAAGA,EAAIS,EAAcT,IAAK,CACnC,IAAMC,EAAKN,EAAIK,CAAC,EAChB,KAAK,IAAI,KAAK,IAAMA,CAAC,EAAIC,EAAKC,GAAaC,GAAgBF,CAC/D,MAII,MAAM,QAAQN,CAAG,IACjBA,GAAOY,EAAM,YAAc,YAAY,KAAKZ,CAAG,GAEnD,KAAK,IAAI,IAAIA,EAAI,SAAS,EAAGc,CAAY,EAAG,KAAK,GAAG,EAExD,KAAK,KAAOA,EACZ,KAAK,MAAM,EACf,CAEA,SAASR,EAAY,CACjB,KAAK,cACD,KAAK,MAAQ,KAAK,KAAO,KAAK,YAC9B,KAAK,OAAO,CAAC,EAEb,KAAK,IAAM,KAAK,MAChB,KAAK,IAAI,KAAK,KAAK,EAAK,CAAC,KAAK,KAAOA,EAAKC,GAAcC,GAAgBF,EACxE,KAAK,MAAM,EAEnB,CAEA,WAAWS,EAAa,CACpB,KAAK,WAAW,YAAY,KAAKA,EAAKT,GAAMA,EAAG,YAAY,CAAC,CAAE,EAAG,EAAI,CACzE,CAEA,aAAaU,EAAcC,EAAa,CAChCD,IAAS,EACT,KAAK,KAAOC,EAEPD,IAAS,EACd,KAAK,IAAM,KAAK,IAAMC,EAItB,KAAK,IAAMA,EAEX,KAAK,IAAM,IACX,KAAK,IAAM,GAEX,KAAK,IAAM,KAAK,MAChB,KAAK,IAAM,KAAK,IAExB,CAEU,OAAQ,CAAC,CACvB,EAGaC,GAAN,cAAyBnB,EAAkB,CAG9C,YAAYoB,EAAenB,EAAoBR,EAAeC,EAAc,CACxE,MAAMO,EAAKR,EAAOC,CAAI,EACtB,KAAK,WAAa,GAClB,KAAK,KAAO0B,CAChB,CAEU,OAAOhB,EAAkB,CAC/B,IAAMiB,EAAU,KAAK,IAAMjB,EAC3B,KAAK,IAAMiB,EACX,IAAIC,EAAS,KAAK,IAAI,OACtB,GAAID,EAAUC,EAAQ,CAElBA,GAAU,KAAK,IAAID,EAAUC,EAAQ,GAAG,EACxC,IAAMC,EAAU,KAAK,IACrB,KAAK,IAAM,IAAK,KAAK,IAAM,YAAc,YAAYD,CAAM,EAC3D,KAAK,IAAI,IAAIC,CAAO,CACxB,CACJ,CAEU,OAAQ,CACd,KAAK,KAAK,MAAM,KAAK,IAAI,SAAS,EAAG,KAAK,GAAG,CAAC,CAClD,CACJ,EAGaC,GAAN,cAAyBhC,EAAW,CAApC,kCACH,UAAO,OAEP,WAAWS,EAAewB,EAAe,CACrC,KAAK,aAAexB,EAAI,MAC5B,CAEA,SAASyB,EAAa,CAClB,KAAK,aACT,CAEA,WAAWV,EAAaW,EAAiB,CACrC,KAAK,aAAe,CAAC,GAAGX,CAAG,EAAE,MACjC,CACJ,EAGaY,GAAN,cAA2BpC,EAAW,CAIzC,YAAYqC,EAAa,CACrB,MAAM,EAAgB,CAAC,EAJ3B,UAAO,SAKH,KAAK,IAAMA,CACf,CAEA,WAAW5B,EAAeY,EAAc,CACpC,GAAI,KAAK,IAAI,MAAM,OAAS,OACxB,MAAM,IAAI,MAAM,iCAAiC,EAErD,KAAK,aAAeZ,EAAI,OACxB,KAAK,IAAI,WAAW,OAAO,cAAc,GAAGA,CAAG,CAAC,EAChD,KAAK,IAAI,SAAS,WAAWA,EAAKY,CAAG,CACzC,CAEA,SAASN,EAAY,CACjB,GAAI,KAAK,IAAI,MAAM,OAAS,OACxB,MAAM,IAAI,MAAM,iCAAiC,EAErD,KAAK,cACL,KAAK,IAAI,WAAW,OAAO,cAAcA,CAAE,CAAC,EAC5C,KAAK,IAAI,SAAS,SAASA,CAAE,CACjC,CAEA,WAAWS,EAAac,EAAgB,CACpC,GAAI,KAAK,IAAI,MAAM,OAAS,OACxB,MAAM,IAAI,MAAM,iCAAiC,EAErD,KAAK,aAAe,CAAC,GAAGd,CAAG,EAAE,OAC7B,KAAK,IAAI,WAAWA,EAAKc,CAAK,EAC9B,KAAK,IAAI,SAAS,WAAWd,EAAKc,CAAK,CAC3C,CAEA,QAAQC,EAAcC,EAAuB,CACzC,KAAK,IAAI,QAAQD,EAAMC,CAAG,EACtB,KAAK,IAAI,SAAS,OAAS,UAC3B,KAAK,IAAI,QAAQ,QAAQD,EAAMC,CAAG,CAE1C,CAEA,cAAcA,EAAa,CACvB,KAAK,IAAI,cAAcA,CAAG,EACtB,KAAK,IAAI,SAAS,OAAS,UAC3B,KAAK,IAAI,QAAQ,cAAcA,CAAG,CAE1C,CAEA,UAAUF,EAAe,CACrB,KAAK,IAAI,UAAUA,CAAK,EACpB,KAAK,IAAI,SAAS,OAAS,UAC3B,KAAK,IAAI,QAAQ,UAAUA,CAAK,CAExC,CACJ,ECnSA,IAAeG,GAAf,KAA+C,CAqB3C,YAAYC,EAAc,CAnB1B,SAAiB,CACb,OAAQ,EACR,KAAM,EACN,MAAO,EACP,IAAK,CACT,EACA,cAAW,EACX,aAAyB,KACzB,WAAqB,CACjB,GAAI,CACR,EACA,UAAsB,KACtB,YAA4B,KAC5B,UAAsB,KAOlB,KAAK,KAAOA,EACZ,KAAK,IAAM,IAAIC,GAAa,IAAc,CAC9C,CAEA,OAAQ,CAAC,CACT,WAAWC,EAAcC,EAAiB,CAAC,CAC3C,QAAQC,EAAeC,EAAwB,CAAC,CAChD,cAAcA,EAAc,CAAC,CAC7B,UAAUF,EAAgB,CAAC,CAE3B,QAAuB,CACnB,GAAI,KAAK,OAAS,SAAW,KAAK,OAAS,OACvC,MAAO,CACH,QAAS,KACT,MAAO,KACP,KAAM,IACV,EAGJ,IAAMG,EAA4B,CAC9B,GAAI,KAAK,MAAM,EACnB,EACAC,GAAU,KAAK,MAAOD,EAAc,WAAW,EAC/CC,GAAU,KAAK,MAAOD,EAAc,OAAO,EAE3C,IAAME,EAAM,KAAK,IACjB,MAAO,CACH,QAAS,KACT,MAAOF,EACP,KAAM,CACF,OAAQE,EAAI,OAASA,EAAI,IACzB,GAAI,KAAK,SACT,KAAMA,EAAI,KACV,KAAM,KAAK,KACX,IAAKA,EAAI,IACT,KAAM,KAAK,KACX,MAAOA,EAAI,MAAQA,EAAI,IAC3B,CACJ,CACJ,CACJ,EAEaC,GAAN,cAA0BV,EAAW,CAArC,kCACH,UAAO,QACP,aAAU,EACd,EAEsBW,GAAf,cAAkCX,EAAW,CAOhD,YAAYC,EAAcW,EAA0B,CAChD,MAAMX,CAAI,EAPd,aAAU,GAEV,6BAA0B,GAMtB,KAAK,WAAaW,CACtB,CAEA,QAAuB,CACnB,IAAMC,EAAS,MAAM,OAAO,EAGxB,OAAO,KAAK,KAAK,UAAU,EAAE,SAC7BA,EAAO,KAAM,OAAS,KAAK,YAG/B,IAAMC,EAAQ,KAAK,MACbP,EAAeM,EAAO,MAC5B,OAAIC,EAAM,OACNN,GAAUM,EAAOP,EAAc,KAAK,EACpCC,GAAUM,EAAOP,EAAc,MAAM,EACjCO,EAAM,OAAS,SACfP,EAAa,OAAU,KAAoB,eAAgB,OAC3DC,GAAUM,EAAOP,EAAc,SAAS,EACxCC,GAAUM,EAAOP,EAAc,aAAa,IAIpD,OAAOO,EAAM,QAEND,CACX,CACJ,EAaaE,GAAN,cAA2BJ,EAAW,CAQzC,YAAYV,EAAcW,EAA0B,CAChD,MAAMX,EAAMW,CAAU,EAP1B,qBAAkB,GAElB,KAAQ,aAAwBI,GAAcC,GAAc,EAAI,EAChE,UAAO,SACP,aAAU,EAIN,KAAK,aAAeD,GAAcC,GAAc,EAAI,EACpD,KAAK,QAAU,CAAC,CACZ,QAAS,CAAC,KAAK,YAAY,CAC/B,CAAC,EACD,KAAK,SAAW,KAAK,QAAQ,CAAC,CAClC,CAEA,OAAQ,CACJ,KAAK,QAAU,GACf,KAAK,cAAc,CACvB,CAEA,eAAgB,CACZ,KAAK,aAAeD,GAAc,KAAK,aAAc,EAAK,EAC1D,KAAK,QAAU,CAAC,CACZ,OAAQ,GACR,QAAS,CAAC,KAAK,YAAY,CAC/B,CAAC,EACD,KAAK,SAAW,KAAK,QAAQ,CAAC,CAClC,CAEQ,cAAcE,EAAuBC,EAAiB,EACtDA,GAAS,KAAK,aAAa,OAAS,MACpC,KAAK,aAAeH,GAAc,KAAK,aAAcE,CAAY,EACjE,KAAK,SAAS,QAAS,KAAK,KAAK,YAAY,EAErD,CAEA,UAAUE,EAAwB,CAC9BA,EAAI,UAAY,KAAK,aAAa,UAClC,KAAK,SAAS,QAAS,KAAKA,CAAG,EAC/B,KAAK,cAAc,GAAO,EAAI,CAClC,CAEA,WAAWC,EAAaC,EAAgB,CACpC,IAAMC,EAAY,KAAK,aAAa,MAChCD,GACA,KAAK,UAAUA,CAAK,EAExB,OAAW,CAACE,EAAGC,CAAI,IAAKJ,EAAI,MAAM;AAAA,CAAI,EAAE,QAAQ,EACxCG,IAAM,IACN,KAAK,aAAeR,GAAc,KAAK,aAAc,EAAK,EAC1D,KAAK,SAAW,CAAC,QAAS,CAAC,KAAK,YAAY,CAAC,EAC7C,KAAK,QAAQ,KAAK,KAAK,QAAQ,GAEnC,KAAK,aAAa,MAAQS,EAE1BH,GACA,KAAK,UAAUC,CAAS,CAEhC,CAEA,QAAQG,EAAcC,EAAuB,CACrC,KAAK,aAAa,WAAYD,CAAI,IAAMC,IACxC,KAAK,cAAc,EAAI,EACnBA,IAAQ,OACR,OAAO,KAAK,aAAa,WAAYD,CAAI,EAGzC,KAAK,aAAa,WAAYA,CAAI,EAAIC,EAGlD,CAEA,gBAAiB,CACb,KAAK,SAAS,UAAY,EAC9B,CAEA,cAAcA,EAAc,CACpBA,IAAQ,IACRA,EAAM,QAENA,IAAQ,KAAK,aAAa,YAC1B,KAAK,cAAc,EAAK,EACpBA,EACA,KAAK,aAAa,UAAYA,EAG9B,OAAO,KAAK,aAAa,UAGrC,CAEA,UAAUL,EAAe,CACjBA,IAAU,KAAK,aAAa,QAC5B,KAAK,cAAc,EAAK,EACxB,KAAK,aAAa,MAAQA,EAElC,CAEA,QAAuB,CACnB,IAAMT,EAAS,MAAM,OAAO,EAG5B,KAAK,aAAeG,GAAc,KAAK,aAAc,EAAK,EAG1D,IAAMY,EAAa,KAAK,QACxB,QAAWC,KAAOD,EACdC,EAAI,QAAUC,GAAyBD,EAAI,QAAQ,OAAQE,GAAS,YAAaA,GAAQA,EAAK,IAAI,CAAC,EAGvG,OAAI,KAAK,SAAWH,EAAW,OAAS,GAAKA,EAAW,CAAC,EAAE,QAAQ,UAC/Df,EAAO,QAAU,CACb,GAAI,KAAK,SAET,KAAMe,EAAW,IAAIC,GAAOA,EAAI,QAAUA,EAAI,WAAaA,EAAI,QAAQ,OAASA,EAAM,CAAC,CAAC,CAC5F,EACI,KAAK,UACLhB,EAAO,QAAQ,MAAQ,GACvB,KAAK,QAAU,KAIvB,KAAK,cAAc,EAEZA,CACX,CACJ,EAEamB,GAAN,cAA6BhC,EAAW,CAAxC,kCACH,UAAkC,CAAC,EACnC,YAAS,EACT,UAAO,WACP,aAAU,EAEV,WAAQ,EAER,OAAQ,CACJ,KAAK,KAAO,KAAK,KAAK,OAAOiC,GAAMA,EAAG,UAAY,UAAU,EAAE,MAAM,EAAE,EACtE,KAAK,KAAK,KAAK,CAAC,QAAS,MAAM,CAAC,CACpC,CAEA,QAAuB,CACnB,IAAMpB,EAAS,MAAM,OAAO,EAE5B,OAAI,KAAK,KAAK,SACVA,EAAO,QAAU,CACb,KAAM,KAAK,KACX,GAAI,KAAK,QACb,EACA,KAAK,KAAO,CAAC,GAGjBA,EAAO,KAAM,YAAc,KAAK,OAChCA,EAAO,KAAM,WAAa,KAAK,MAExBA,CACX,CACJ,EAOaqB,GAAN,cAAyBvB,EAAW,CAApC,kCACH,KAAQ,eAAiBK,GAAcC,GAAc,EAAI,EACzD,YAAS,EACT,WAAoB,CAAC,EACrB,UAAO,OACP,aAAU,EACV,WAAQ,EACR,OAAI,EACJ,OAAI,EAEJ,OAAQ,CACJ,KAAK,QAAU,GACf,IAAMkB,EAAS,KAAK,OACpB,KAAK,YAAY,EAAG,KAAK,KAAK,EAC9B,KAAK,YAAYA,EAAQ,KAAK,KAAK,EACnC,KAAK,EAAI,KAAK,EAAI,CACtB,CAEA,YAAa,CAKT,GAJI,KAAK,GAAK,KAAK,QACf,KAAK,EAAI,EACT,KAAK,KAEL,KAAK,GAAK,KAAK,OACf,MAAO,EAEf,CAEA,WAAWd,EAAaC,EAAgB,CACpC,IAAMC,EAAY,KAAK,eAAe,MAClCD,GACA,KAAK,UAAUA,CAAK,EAExB,QAAWc,KAAMf,EAAK,CAClB,GAAI,KAAK,WAAW,EAChB,MAEJ,GAAIe,IAAO;AAAA,EAAM,CACb,KAAK,EAAI,EACT,KAAK,IACL,QACJ,CACA,IAAMX,EAAO,KAAK,MAAM,KAAK,CAAC,EAC9BA,EAAK,QAAU,GACfA,EAAK,QAAQ,KAAK,GAAG,EAAIT,GAAc,KAAK,eAAgB,GAAOoB,CAAE,CACzE,CACId,GACA,KAAK,UAAUC,CAAS,CAEhC,CAEA,QAAQG,EAAcC,EAAuB,CACrC,KAAK,eAAe,WAAYD,CAAI,IAAMC,IAC1C,KAAK,eAAiBX,GAAc,KAAK,eAAgB,EAAI,EACzDW,IAAQ,OACR,OAAO,KAAK,eAAe,WAAYD,CAAI,EAG3C,KAAK,eAAe,WAAYA,CAAI,EAAIC,EAGpD,CAEA,cAAcA,EAAa,CACnBA,EACA,KAAK,eAAe,UAAYA,EAGhC,OAAO,KAAK,eAAe,SAEnC,CAEA,UAAUL,EAAe,CACrB,KAAK,eAAe,MAAQA,CAChC,CAEA,YAAYa,EAAgBE,EAAe,CACvC,IAAMC,EAAY,KAAK,OACjBC,EAAW,KAAK,MACtB,KAAK,OAASJ,EACd,KAAK,MAAQE,EAGb,IAAMG,EAAcxB,GAAcC,GAAc,GAAM,GAAG,EACzD,GAAIqB,EAAYH,EACZ,KAAK,MAAM,OAASA,UAEfA,EAASG,EACd,QAASd,EAAIc,EAAWd,EAAIW,EAAQX,IAAK,CACrC,IAAMiB,EAAsB,CAAC,EAC7B,QAASC,EAAI,EAAGA,EAAIL,EAAOK,IACvBD,EAAS,KAAKzB,GAAcwB,EAAa,GAAO,GAAG,CAAC,EAExD,KAAK,MAAMhB,CAAC,EAAI,CACZ,QAAS,GACT,QAASiB,CACb,CACJ,CAGJ,IAAME,EAAc,KAAK,IAAIR,EAAQG,CAAS,EAC9C,GAAIK,GAAeN,IAAUE,EACzB,QAASf,EAAI,EAAGA,EAAImB,EAAanB,IAAK,CAClC,IAAMC,EAAO,KAAK,MAAMD,CAAC,EACzB,GAAIa,EAAQE,EACRd,EAAK,QAAU,GACfA,EAAK,QAAQ,OAASY,MAErB,CACDZ,EAAK,QAAU,GACf,QAASiB,EAAIH,EAAUG,EAAIL,EAAOK,IAC9BjB,EAAK,QAAQ,KAAKT,GAAcwB,EAAa,GAAO,GAAG,CAAC,CAEhE,CACJ,CAER,CAEA,QAAuB,CACnB,IAAM3B,EAAS,MAAM,OAAO,EAqC5B,GAnCI,KAAK,MAAM,KAAKY,GAAQA,EAAK,OAAO,IACpCZ,EAAO,QAAU,CACb,GAAI,KAAK,SACT,MAAO,KAAK,MAAM,QAAQ,CAACY,EAAMmB,IACxBnB,EAAK,SAGVA,EAAK,QAAU,GACR,CACH,QAASK,GAAyBL,EAAK,QAAQ,OAAO,CAACoB,EAAgBC,IAAQ,CAC3E,GAAI,CAACD,EAAI,OACL,MAAO,CAAC7B,GAAc8B,EAAK,GAAOA,EAAI,IAAI,CAAC,EAI/C,IAAMC,EAAOF,EAAIA,EAAI,OAAS,CAAC,EAC/B,OAAIC,EAAI,aAAeC,EAAK,YAAcD,EAAI,YAAcC,EAAK,WAAaD,EAAI,QAAUC,EAAK,MAC7FA,EAAK,MAAQD,EAAI,KAGjBD,EAAI,KAAK7B,GAAc8B,EAAK,GAAOA,EAAI,IAAI,CAAC,EAEzCD,CACX,EAAG,CAAC,CAAC,CAAC,EACN,KAAMD,CACV,GApBW,CAAC,CAqBf,CACL,EACI,KAAK,UACL/B,EAAO,QAAQ,MAAQ,GACvB,KAAK,QAAU,KAKnB,KAAK,MAAM,KAAM,CACjB,IAAMN,EAAeM,EAAO,MACxB,KAAK,WAAW,GAChBN,EAAa,KAAO,KAAK,MAAQ,EACjCA,EAAa,KAAO,KAAK,OAAS,IAGlCA,EAAa,KAAO,KAAK,EACzBA,EAAa,KAAO,KAAK,EAEjC,CAEA,OAAAM,EAAO,KAAM,WAAa,KAAK,OAC/BA,EAAO,KAAM,UAAY,KAAK,MAEvBA,CACX,CACJ,EAEamC,GAAN,cAAyBhD,EAAW,CAavC,YAAYiD,EAAgBC,EAAgBC,EAAc,CACtD,MAAM,CAAC,EAZX,YAAwB,KACxB,YAAwB,KAMxB,UAAO,OACP,aAAU,EAKN,KAAK,QAAUD,EAAS,OAA0B,IAClD,KAAK,IAAMA,EAAS,GACpB,KAAK,OAASA,EAAS,OAA4B,GACnD,KAAK,IAAMD,EACX,KAAK,KAAOE,EACZ,KAAK,SAAW,KAAK,MAAQ,GAAkB,KAAK,MAAQ,EAC5D,KAAK,SAAW,KAAK,MAAQ,GAAkB,KAAK,MAAQ,CAChE,CACJ,EAEMlC,GAAwB,CAC1B,WAAY,CAAC,EACb,MAAO,SACP,KAAM,EACV,EAGA,SAASa,GAAyBD,EAAyB,CACvD,OAAOA,EAAI,IAAIuB,IACL,YAAaA,GACV,OAAO,KAAKA,EAAG,UAAW,EAAE,QAC7B,OAAOA,EAAG,WAGXA,EACV,CACL,CAGA,SAASpC,GAAcoC,EAAalC,EAAuBmC,EAAW,GAAI,CACtE,OAAO,OAAO,OAAO,CAAC,EAAGD,EAAI,CACzB,WAAYlC,EAAe,OAAO,OAAO,CAAC,EAAGkC,EAAG,UAAU,EAAIA,EAAG,WACjE,KAAMC,CACV,CAAC,CACL,CAGA,SAAS7C,GAAU8C,EAAmBC,EAAiBC,EAAyB,CACxEF,EAAKE,CAAI,IACRD,EAAGC,CAAI,EAAYF,EAAKE,CAAI,EAErC,CCrgBO,IAAMC,GAAN,KAAyC,CAAzC,cACH,KAAQ,MAAwB,EAChC,WAAY,CACR,OAAO,KAAK,KAChB,CACA,UAAUC,EAAqB,CAC3B,KAAK,MAAQA,CACjB,CACJ,EAEaC,GAAN,KAA+C,CAA/C,cACH,KAAQ,OAA2B,CAAC,EACpC,UAAUC,EAA+B,CACrC,OAAO,KAAK,OAAOA,CAAK,CAC5B,CACA,YAA+B,CAC3B,OAAO,KAAK,MAChB,CACA,WAAWF,EAAqB,CAC5B,KAAK,OAAO,KAAKA,CAAG,CACxB,CACA,UAAUE,EAAeF,EAAqB,CAC1C,KAAK,OAAOE,CAAK,EAAIF,CACzB,CACJ,EAEaG,GAAN,KAA2C,CAA3C,cAEH,KAAQ,OAA+B,KAEvC,KAAQ,OAAiB,KACzB,KAAQ,GAAsB,KAM9B,KAAQ,iBAAmB,EAE3B,KAAQ,YAAc,GAEtB,KAAQ,OAAS,GAEjB,KAAQ,WAA6B,KAErC,KAAQ,IAAM,EAEd,KAAQ,QAA6BC,GAYrC,KAAQ,eAAgC,KACxC,KAAQ,aAA8B,KAEtC,KAAQ,WAAyD,CAC7D,OAAQ,CAAC,EACT,KAAM,CAAC,CACX,EAEA,KAAQ,QAAoB,CAAC,EAE7B,KAAQ,MAAmB,CACvB,SAAU,EACV,cAAe,EACf,QAAS,CACb,EAEA,aAAUC,GAEV,KAAQ,aAA8B,KACtC,KAAQ,YAA6B,KACrC,KAAQ,gBAAkB,GAyJ1B,WAAQC,GACR,kBAAeC,GACf,YAASR,GACT,eAAYE,GAxJZ,KAAKO,EAAwB,CAGzB,GAFA,KAAK,mBAAqBA,EAAQ,mBAClC,KAAK,MAAQA,EAAQ,MACjBA,EAAQ,OACR,KAAK,OAAS,IAAIC,GAAqBD,EAAQ,MAAM,MAGrD,OAAM,IAAI,MAAM,wBAAwB,EAO5C,GALA,KAAK,YAAc,CAAC,CAACA,EAAQ,eAG7B,KAAK,QAAUA,EAAQ,QACvB,KAAK,aAAeA,EAAQ,iBACxBA,EAAQ,OACR,KAAK,OAASA,EAAQ,WAGtB,OAAM,IAAI,MAAM,wBAAwB,EAE5C,GAAIA,EAAQ,GACR,KAAK,GAAKA,EAAQ,OAGlB,OAAM,IAAI,MAAM,oBAAoB,EAGxC,KAAK,qBAAqB,EAC1B,KAAK,SAAS,KAAK,CACf,GAAI,KACJ,GAAI,KAAK,EACb,CAAC,EACD,IAAME,EAAiBF,EACvBE,EAAe,OAAS,KAAK,OAAO,KAAK,IAAI,EAC7C,KAAK,OAAO,KAAKA,CAAc,CACnC,CAEA,oBAAoBC,EAAqB,CACrC,OAAOA,IAAO,GAAQA,IAAO,KAAQA,IAAO,EAChD,CAEA,YAAYC,EAAa,CAErB,GADA,KAAK,OAAS,GACV,CAAC,KAAK,OAAQ,CACd,QAAQ,MAAM,gBAAkBA,CAAG,EACnC,MACJ,CACA,KAAK,OAAO,MAAMA,CAAG,EACrB,KAAK,OAAO,OAAO,CACf,KAAM,SACN,QAAS,GACT,IAAK,KAAK,GACd,CAAC,CACL,CAEA,WAAWC,EAAoB,CAC3B,OAAQA,EAAY,CAChB,IAAK,QACD,OAAO,KAAK,OAAS,KACzB,IAAK,SACD,OAAO,KAAK,OAChB,IAAK,UACD,OAAO,KAAK,SAAW,KAC3B,IAAK,SACD,OAAO,KAAK,OAChB,IAAK,KACD,OAAO,KAAK,GAChB,QACI,OAAO,IACf,CACJ,CAEA,QAAS,CACL,MAAO,CAAC,EAAE,KAAK,QAAU,KAAK,GAClC,CAEA,iBAAiBC,EAAa,CAC1B,MAAM,IAAI,MAAM,6BAA6B,CACjD,CACA,eAAgB,CACZ,MAAM,IAAI,MAAM,6BAA6B,CACjD,CAEA,QAAS,CACL,IAAMC,EAA8B,CAChC,IAAK,KAAK,IACV,KAAM,QACV,EAEI,KAAK,SACLA,EAAM,QAAU,IAIpB,IAAMC,EAAqC,CAAC,EACtCC,EAAiC,CAAC,EAClCC,EAAiC,CAAC,EACxC,QAASC,EAAM,KAAK,aAAcA,EAAKA,EAAMA,EAAI,KAAM,CACnD,IAAMC,EAASD,EAAI,OAAO,EAI1B,GAHIC,EAAO,SACPJ,EAAS,KAAKI,EAAO,OAAO,EAE5BA,EAAO,MAAO,CACd,IAAMC,EAAeD,EAAO,OACxBC,EAAa,WAAaA,EAAa,OAASA,EAAa,OAC7DJ,EAAO,KAAKI,CAAY,CAEhC,CACI,KAAK,iBAAmBD,EAAO,MAC/BF,EAAM,KAAKE,EAAO,IAAI,CAE9B,CACIJ,EAAS,SACTD,EAAM,QAAUC,GAEhBC,EAAO,SACPF,EAAM,MAAQE,GAEdC,EAAM,SACNH,EAAM,QAAUG,GAEpB,KAAK,gBAAkB,GAKnB,KAAK,UACLH,EAAM,aAAe,KAAK,QAC1B,OAAO,KAAK,SAIhB,IAAMO,EAAQ,KAAK,MACfA,EAAM,gBAAkBA,EAAM,WAC9BP,EAAM,MAAQO,EAAM,UAAY,KAChCA,EAAM,cAAgBA,EAAM,UAMhC,KAAK,OAAO,OAAOC,GAAUR,CAAK,CAAC,EACnC,KAAK,qBAAqB,CAG9B,CAWA,qBAAqBS,EAAmB,CACpC,OAAO,OAAO,cAAc,GAAGA,CAAG,CACtC,CAEA,gBAAgBxB,EAAayB,EAAsB,CAC/C,KAAK,uBAAuB,KAAK,eAAiBzB,CAAG,CACzD,CAEA,uBAAuB0B,EAAa1B,EAAayB,EAAsB,CACnE,GAAI,CAACC,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpCA,EAAI,WAAW1B,CAAG,CACtB,CAEA,oBAAoBwB,EAAmB,CACnC,OAAO,OAAO,cAAc,GAAGA,CAAG,CACtC,CAIA,+BAA+BG,EAAmBC,EAAyB,CACvE,OAAOC,GAAmBF,EAAKC,EAASF,GAAQA,EAAe,UAAU,KAAK,CAAC,CACnF,CAEA,+BAA+BC,EAAmBC,EAAyB,CACvE,OAAOC,GAAmBF,EAAKC,EAASF,GAAQA,EAAe,UAAU,KAAK,CAAC,CACnF,CAEA,6BAA6BC,EAAmBC,EAAyB,CACrE,OAAOC,GAAmBF,EAAKC,EAASF,GAAQA,EAAe,YAAY,CAAC,CAChF,CAEA,6BAA6BC,EAAmBC,EAAiBE,EAA2B,CACxF,OAAOD,GAAmBF,EAAKC,EAASD,GAAQA,EAAoB,OAAO,CAACI,EAAMC,EAAI9B,IAAU,CAC5F,IAAM+B,EAAwC,CAC1C,OAAG,KAAM,OAAG,SAAK,OAAG,SAAK,OAAG,SAAK,OAAG,SAAK,OAAG,SAAK,OAAG,SAAK,OAAG,SAAK,OAAG,SAAK,OAAG,SAC5E,OAAG,SAAK,OAAG,SAAK,OAAG,SAAK,OAAG,eAAM,OAAG,eAAM,OAAG,SAAK,OAAG,eAAM,OAAG,qBAAO,OAAG,SAAK,OAAG,eAChF,OAAG,SAAK,OAAG,eAAM,OAAG,qBAAO,OAAG,SAAK,OAAG,eAAM,OAAG,SAAK,OAAG,eAAM,OAAG,qBAAO,OAAG,SAAK,OAAG,KAClF,OAAG,KAAM,OAAG,KAAM,OAAG,MAAO,OAAG,MAAO,OAAG,KAAM,OAAG,KAAM,OAAG,eAAM,OAAG,eACpE,OAAG,eAAM,OAAG,eAAM,OAAG,cACzB,EACMC,EAA8B,CAAC,mDAAY,mDAAY,kDAAU,EACnEC,EAAW,OAAO,cAAcH,CAAE,EACtC,OAAI9B,IAAU,EACN+B,EAAcE,CAAQ,EACtBA,EAAWF,EAAcE,CAAQ,EAE5BH,GAAM,MAAQA,EAAK,KACxBG,EAAWD,GAA8BF,EAAK,MAAQ,GAAM,CAAC,EAAEA,EAAK,CAAC,EAGrEG,EAAWA,EAAS,YAAY,EAG/BL,IACLK,EAAWA,EAAS,YAAY,GAE7BJ,EAAOI,CAClB,EAAG,EAAE,EAAG,EAAI,CAChB,CAEA,6BAA6BR,EAAmBC,EAAyB,CACrE,OAAOC,GAAmBF,EAAKC,EAASF,GAAQA,EAAe,YAAY,CAAC,CAChF,CAEA,sBAAsBP,EAAa,CAC/B,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,OAAOA,EAAI,MAAM,IACrB,CAEA,2BAA2BA,EAAa,CACpC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,GAEhCA,EAAI,OAAS,UAAYA,EAAI,OAAS,SACtC,OAAOA,EAAI,MAAM,SAEzB,CAEA,sBAAsBA,EAAaiB,EAAmB,CAClD,GAAI,CAACjB,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,MAAM,OAAS,QAAWA,EAAI,OAAS,UAAYA,EAAI,OAAS,OAAS,CACzEiB,GACAC,GAAUD,CAAE,EAEhB,MACJ,CAEA,KAAK,kBAAkBjB,EAAK,KAAK,iBAAiBA,EAAI,QAAQ,GAAK,GAAIiB,CAAE,CAC7E,CAEA,uBAAuBjB,EAAa,CAChC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,GAEhCA,EAAI,OAAS,YAAcA,EAAI,OAAS,SACxC,OAAOA,EAAI,MAAM,KAEzB,CAEA,kBAAkBnB,EAAqB,CAInC,OAHIA,GAAO,IAAQA,GAAO,IAGtBA,GAAO,KAAQA,GAAO,KAAQA,IAAQ,IAC/BA,EAAM,GAEVA,CACX,CAEA,kBAAkBA,EAAqB,CAInC,OAHIA,GAAO,IAAQA,GAAO,KAGtBA,GAAO,KAAQA,GAAO,KAAQA,IAAQ,IAC/BA,EAAM,GAEVA,CACX,CAEA,wBAAwBsC,EAAwB,CAC5C,OAAO,KAAK,MAAM,KAAK,IAAI,GAAKA,EAAS,IAAK,CAClD,CAEA,iBAAiBC,EAAmB,CAChCC,GAAyB,KAAK,IAAI,EAAGD,CAAM,CAC/C,CAEA,8BAA8BA,EAAmBD,EAAwB,CACrE,OAAO,KAAK,MAAMG,GAA+BF,CAAM,GAAKD,EAAS,IAAK,CAC9E,CAEA,4BAA4BC,EAAmBD,EAAwB,CACnE,OAAO,KAAK,MAAMI,GAA6BH,CAAM,GAAKD,EAAS,IAAK,CAC5E,CAEA,uBAAuBK,EAAuBC,EAAuB,CACjEJ,GAAyBC,GAA+BE,CAAU,EAAGC,CAAU,CACnF,CAEA,qBAAqBD,EAAuBC,EAAuB,CAC/DJ,GAAyBE,GAA6BC,CAAU,EAAGC,CAAU,CACjF,CAEA,UAAgC,CAC5B,YAAK,OAAS,GAKPrC,EACX,CAEA,2BAA2BsC,EAAeC,EAAkBC,EAAuB,CAC/E,IAAMC,EAAiB,KAAK,OAAO,sBAAsBF,EAAUD,EAAQ,EAAkB,EAC7F,OAAO,KAAK,eAAeG,EAAgBD,EAAMF,CAAK,CAC1D,CAEA,6BAA6BA,EAAeI,EAAeF,EAAmC,CAC1F,IAAMG,EAAWC,GAAWF,CAAK,GAAK,OAChCG,EAAcP,EAAQ,GACtBQ,EAAWC,GAAWF,CAAW,GAAK,OAE5C,YAAK,QAAU,CACX,SAAAF,EACA,SAAAG,EACA,KAAM,gBACV,EACID,IAAgB,IAChB,KAAK,QAAQ,OAAS,KAAK,GAAG,cAAc,GAEhD,KAAK,aAAe,CAChB,KAAAL,EACA,MAAAF,CACJ,EACOtC,EACX,CAEA,gCAAgCsC,EAAeU,EAAkBR,EAAuB,CACpF,GAAI,CAACQ,EACD,MAAM,IAAI,MAAM,iBAAiB,EAErC,OAAO,KAAK,eAAeA,EAAQ,SAAUR,EAAMF,CAAK,CAC5D,CAEA,wBAAwBA,EAAeE,EAAuB,CAC1D,IAAMS,EAAeF,GAAWT,EAAQ,EAAkB,EACpDY,EAAc,KAAK,OAAO,wBAAwBD,CAAY,EACpE,OAAO,KAAK,eAAeC,EAAY,SAAUV,EAAMF,EAAOY,CAAW,CAC7E,CAEA,wBAAwBC,EAAe,CACnC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,iBAAiB,EAErCA,EAAK,YAAY,CACrB,CAEA,oBAAoBA,EAAe,CAC/B,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,iBAAiB,EAErC,KAAK,SAAS,iBAAiB,UAAWA,CAAI,EAC9C,IAAM3B,EAAO2B,EAAK,KACZC,EAAOD,EAAK,KAClBA,EAAK,KAAO,KACZA,EAAK,KAAO,KACR3B,EACAA,EAAK,KAAO4B,EAGZ,KAAK,WAAaA,EAElBA,IACAA,EAAK,KAAO5B,EAEpB,CAEA,4BAA4B2B,EAAwB,CAChD,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,iBAAiB,EAErC,OAAOA,EAAK,OAAO,CACvB,CAEA,qBAAqBA,EAAuB,CACxC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,iBAAiB,EAErC,OAAOA,EAAK,IAChB,CAEA,oBAAoBA,EAAgBE,EAAqC,CACrE,IAAMC,EAAYH,EAAOA,EAAK,KAAO,KAAK,WAC1C,OAAIE,GACAA,EAAQ,UAAUC,EAAYA,EAAU,KAAO,CAAC,EAE7CA,CACX,CAEA,YAAYC,EAAa9D,EAAqB,CAC1C,OAAO,KAAK,gBAAgB8D,EAAK9D,EAAK,IAAI,CAC9C,CAEA,gBAAgB8D,EAAa9D,EAAawB,EAA8B,CACpE,IAAMuC,EAAW,KAAK,eAAeD,EAAK9D,EAAKwB,CAAG,EAClD,GAAIuC,EACA,OAAOA,EAGX,OAAQD,EAAK,CACT,IAAK,GACD,MAAO,MACX,IAAK,GAED,OAAI9D,GAAO,YAAgBA,GAAO,WACvB,EAGPA,GAAQ,WAAc,IAAmBA,EAAM,SAAaA,GAAO,GAAKA,EAAM,IAAOA,GAAO,KAAOA,EAAM,IAClG,EAGJ,EACX,IAAK,GAED,OAAIA,EAAM,SAAaA,GAAO,GAAKA,EAAM,IAAOA,GAAO,KAAOA,EAAM,IACzD,EAEJ,EACX,IAAK,GAED,OAAIwB,IACAA,EAAI,CAAC,EAAI,GAEN,EACX,IAAK,IACD,MAAO,EAAExB,IAAQ,YAAmBA,GAAO,YAAkBA,GAAO,YAExE,IAAK,GACD,MAAO,GAAGA,IAAQ,GAAoBA,IAAQ,IAAuB,KAAK,QAAQ,SAAS,UAAU,GACzG,IAAK,MACD,MAAO,CAAC,KAAK,QAAQ,SAAS,YAAY,EAC9C,IAAK,GACL,IAAK,IACL,IAAK,IACD,MAAO,CAAC,KAAK,QAAQ,SAAS,UAAU,EAC5C,IAAK,IACD,MAAO,CAAC,KAAK,QAAQ,SAAS,YAAY,EAC9C,IAAK,IACD,MAAO,GAAGA,IAAQ,GAAsBA,IAAQ,IAAqB,KAAK,QAAQ,SAAS,YAAY,GAC3G,IAAK,GACD,MAAO,GAAGA,IAAQ,GAAoBA,IAAQ,IAAqB,KAAK,QAAQ,SAAS,UAAU,GACvG,IAAK,GACD,MAAO,CAAC,KAAK,QAAQ,SAAS,OAAO,EAEzC,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACD,MAAO,GAEX,QACI,MAAO,EACf,CACJ,CAEA,sBAAsB0B,EAAaC,EAA2B,CAC1D,GAAI,CAACD,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,QAAU,GAAiBA,EAAI,QAAU,EAC7C,MAAM,IAAI,MAAO,oCAAoC,EAEzD,OAAI,MAAM,QAAQC,CAAG,EACVqC,GAAerC,EAAK,WAAYH,GAAOE,EAAI,WAAWF,CAAG,CAAC,EAG1DE,EAAI,WAAWC,CAAG,CAEjC,CAEA,0BAA0BD,EAAaC,EAA2B,CAC9D,GAAI,CAACD,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,QAAU,GAAiBA,EAAI,QAAU,EAC7C,MAAM,IAAI,MAAO,oCAAoC,EAEzD,OAAI,MAAM,QAAQC,CAAG,EACVqC,GAAerC,EAAK,YAAaH,GAAOE,EAAI,WAAWF,CAAG,CAAC,EAG3DE,EAAI,WAAWC,CAAG,CAEjC,CAEA,oBAAoBD,EAAqB,CACrC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,QAAU,GAAiBA,EAAI,QAAU,EAC7C,MAAM,IAAI,MAAO,oCAAoC,EAEzD,OAAOA,EAAI,SAAS,EAAK,CAC7B,CAEA,wBAAwBA,EAAqB,CACzC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,QAAU,GAAiBA,EAAI,QAAU,EAC7C,MAAM,IAAI,MAAO,oCAAoC,EAEzD,OAAOA,EAAI,SAAS,EAAI,CAC5B,CAEA,oBAAoBA,EAAaC,EAA2B,CACxD,GAAI,CAACD,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,QAAU,GAAiBA,EAAI,QAAU,EAC7C,MAAM,IAAI,MAAO,oCAAoC,EAEzD,OAAI,MAAM,QAAQC,CAAG,EAEVqC,GAAerC,EAAK,WAAYH,GAAOE,EAAI,SAASF,CAAG,EAAI,CAAC,EAAI,EAGhEE,EAAI,SAASC,CAAG,CAE/B,CAEA,wBAAwBD,EAAaC,EAA2B,CAC5D,GAAI,CAACD,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,QAAU,GAAiBA,EAAI,QAAU,EAC7C,MAAM,IAAI,MAAO,oCAAoC,EAEzD,OAAI,MAAM,QAAQC,CAAG,EAEVqC,GAAerC,EAAK,YAAaH,GAAOE,EAAI,SAASF,CAAG,EAAI,CAAC,EAAI,EAGjEE,EAAI,SAASC,CAAG,CAE/B,CAEA,eAAeR,EAAa8C,EAAeC,EAAcC,EAAsB,CAC3E,IAAMC,EAAO,KAAK,OAAO,eAAeH,CAAK,EAC7C,OAAKG,GAGL,KAAK,WAAWjD,EAAKiD,EAAMA,EAAK,QAAU,EAAGF,EAAMC,EAAMC,EAAK,OAAS,CAAC,EACjE,GAHI,CAIf,CAEA,sBAAsBjD,EAAa8C,EAAeC,EAAcC,EAAcE,EAAeC,EAAwB,CACjH,IAAMF,EAAO,KAAK,OAAO,eAAeH,CAAK,EAC7C,OAAKG,GAGL,KAAK,WAAWjD,EAAKiD,EAAME,GAAU,EAAGJ,EAAMC,EAAME,GAAS,CAAC,EACvD,GAHI,CAIf,CAEA,mBAAmBJ,EAAeI,EAAmBC,EAA4B,CAC7E,IAAMF,EAAO,KAAK,OAAO,eAAeH,CAAK,EAC7C,OAAIK,GACAA,EAAO,UAAUF,GAAM,QAAU,CAAC,EAElCC,GACAA,EAAM,UAAUD,GAAM,OAAS,CAAC,EAE7BA,EAAO,EAAI,CACtB,CAEA,eAAepE,EAAmB,CAC9B,KAAK,sBAAsB,KAAK,eAAiBA,CAAG,CACxD,CAEA,sBAAsB0B,EAAa1B,EAAmB,CAClD,GAAI,CAAC0B,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,QAAU,EACd,MAAM,IAAI,MAAM,kCAAkC,EAEtDA,EAAI,WAAW1B,EAAK,EAAK,CAC7B,CAEA,0BAA0B0B,EAAa1B,EAAmB,CACtD,GAAI,CAAC0B,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,QAAU,EACd,MAAM,IAAI,MAAM,kCAAkC,EAEtDA,EAAI,WAAW1B,EAAK,EAAI,CAC5B,CAEA,mBAAmBA,EAAmB,CAClC,KAAK,0BAA0B,KAAK,eAAiBA,CAAG,CAC5D,CAEA,aAAaA,EAAa,CACtB,KAAK,oBAAoB,KAAK,eAAiBA,CAAG,CACtD,CAEA,oBAAoB0B,EAAa1B,EAAa,CAC1C,GAAI,CAAC0B,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,QAAU,EACd,MAAM,IAAI,MAAM,kCAAkC,EAEtDA,EAAI,SAAS1B,CAAG,CACpB,CAEA,wBAAwB0B,EAAa1B,EAAa,CAC9C,KAAK,oBAAoB0B,EAAK1B,CAAG,CACrC,CAEA,iBAAiBA,EAAa,CAC1B,KAAK,oBAAoB,KAAK,eAAiBA,CAAG,CACtD,CAEA,eAAeA,EAAa,CACxB,KAAK,sBAAsB,KAAK,eAAiBA,CAAG,CACxD,CAEA,sBAAsB0B,EAAa1B,EAAa,CAC5C,GAAI,CAAC0B,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,QAAU,EACd,MAAM,IAAI,MAAM,kCAAkC,EAEtDA,EAAI,WAAW1B,CAAG,CACtB,CAEA,0BAA0B0B,EAAa1B,EAAa,CAChD,KAAK,sBAAsB0B,EAAK1B,CAAG,CACvC,CAEA,mBAAmBA,EAAa,CAC5B,KAAK,sBAAsB,KAAK,eAAiBA,CAAG,CACxD,CAEA,uBAAuBmB,EAAa,CAChC,KAAK,mBAAmBA,EAAK,EAAK,CACtC,CAEA,2BAA2BA,EAAa,CACpC,KAAK,mBAAmBA,EAAK,EAAI,CACrC,CAEA,4BAA4BA,EAAa,CACrC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,GAEhCA,EAAI,OAAS,UAAYA,EAAI,OAAS,UACtCA,EAAI,MAAM,UAAY,GAE9B,CAEA,uBAAuBA,EAAaQ,EAAmBC,EAAkB,CACrE,KAAK,mBAAmBT,EAAKQ,EAAK,GAAOC,CAAO,CACpD,CAEA,2BAA2BT,EAAaQ,EAAmBC,EAAkB,CACzE,KAAK,mBAAmBT,EAAKQ,EAAK,GAAMC,CAAO,CACnD,CAEA,wBAAwBT,EAAa,CACjC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,GAEhCA,EAAI,OAAS,YAAcA,EAAI,OAAS,UACxCA,EAAI,MAAM,MAAQ,GAE1B,CAEA,yBAAyBoD,EAAe,CACpC,KAAK,MAAM,SAAWA,EACtB,KAAK,MAAM,QAAUA,EAAQ,KAAK,IAAI,EAAI,CAC9C,CAEA,oBAAoBC,EAAmC,CACnD,OAAO,IACX,CAEA,wBAAwBA,EAAeC,EAAqC,CACxE,OAAO,IACX,CAEA,qBAAqBC,EAAwB,CACzC,MAAM,IAAI,MAAM,kBAAkB,CACtC,CAEA,sBAAsBA,EAAgC,CAClD,MAAM,IAAI,MAAM,kBAAkB,CACtC,CAEA,qBAAqBA,EAAyBd,EAAyC,CACnF,OAAIA,GACAA,EAAQ,UAAU,CAAC,EAEhB,IACX,CAEA,mBAAmBc,EAAwB,CACvC,MAAM,IAAI,MAAM,kBAAkB,CACtC,CAEA,kBAAkBA,EAAwBC,EAAwB,CAC9D,MAAM,IAAI,MAAM,kBAAkB,CACtC,CAEA,sBAAsBD,EAAwBC,EAAgBC,EAAkBC,EAAyB,CACrG,MAAM,IAAI,MAAM,kBAAkB,CACtC,CAEA,wBAAwBC,EAA2BC,EAAmBF,EAAyB,CAC3F,MAAM,IAAI,MAAM,kBAAkB,CACtC,CAEA,wBAAwBH,EAAwBD,EAAiB,CAC7D,MAAM,IAAI,MAAM,kBAAkB,CACtC,CAEA,4BAA4BC,EAAwBD,EAAiBO,EAAoBC,EAAgB,CACrG,MAAM,IAAI,MAAM,kBAAkB,CACtC,CAEA,kBAAkBP,EAAwB,CACtC,MAAM,IAAI,MAAM,kBAAkB,CACtC,CAEA,qBAAqBA,EAAwB,CACzC,MAAM,IAAI,MAAM,kBAAkB,CACtC,CAEA,WAAWtC,EAAoC,CAC3C,YAAK,UAAYA,EACV7B,EACX,CAEA,gBAAgB6B,EAAe,CAE3BC,GAAUD,CAAE,EAEZ,IAAMd,EAAQ,KAAK,MACnB,GAAIA,EAAM,SAAU,CAChB,IAAM4D,EAAM,KAAK,IAAI,EACjBA,EAAM5D,EAAM,QAAUA,EAAM,WAE5BA,EAAM,cAAgB,EACtBA,EAAM,QAAU4D,EAChB9C,EAAG,UAAU,EAAG,CAAY,EAEpC,CACJ,CAEA,wBAAwBjB,EAAanB,EAAa,CAC9C,GAAI,CAACmB,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEhCA,EAAI,OAAS,WACbA,EAAI,gBAAkB,CAAC,CAACnB,EAEhC,CAEA,kBAAkBA,EAAa,CAC3B,KAAK,yBAAyB,KAAK,eAAiBA,CAAG,CAC3D,CAEA,yBAAyB0B,EAAa1B,EAAa,CAC/C,GAAI,CAAC0B,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEhCA,EAAI,OAAS,UACbA,EAAI,cAAc1B,CAAG,CAE7B,CAEA,cAAcmF,EAAe,CACzB,KAAK,qBAAqB,KAAK,eAAiBA,CAAK,CACzD,CAEA,qBAAqBzD,EAAayD,EAAe,CAC7C,GAAI,CAACzD,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEhCA,EAAI,OAAS,YACTyD,EAAQ,GAAKA,EAAQ,MACrBA,EAAQ,GAEZzD,EAAI,UAAU0D,GAAYD,CAAK,CAAC,EAExC,CAEA,+BAA+BhE,EAAakE,EAAoB,CAC5D,GAAI,CAAClE,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,IAAMmE,EAAgC,CAAC,EACvC,QAAWC,KAAQF,EACXG,GAAgBD,CAAI,GACpBD,EAAY,KAAKE,GAAgBD,CAAI,CAAC,EAG1CD,EAAY,OACZnE,EAAI,MAAM,YAAcmE,EAGxB,OAAOnE,EAAI,MAAM,WAEzB,CAEA,eAAeA,EAAc,CACzB,KAAK,eAAiBA,EAAMA,EAAI,IAAM,IAC1C,CAEA,oBAAoBwD,EAAgBc,EAAe,CAAC,CAEpD,iBAAiB/D,EAAagE,EAAuB,CACjD,GAAI,CAAChE,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpCA,EAAI,MAAMgE,CAAM,EAChB,KAAK,kBAAkBhE,CAAG,CAC9B,CAEA,wBAAwC,CACpC,OAAO,KAAK,cAChB,CAEA,wBAAwBA,EAAqB,CACzC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,OAAOA,EAAI,aAAa,CAC5B,CAEA,oBAAoBA,EAAqB,CACrC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,OAAOA,EAAI,IACf,CAEA,mBAAmBA,EAAckC,EAAoC,CACjE,IAAM+B,EAAcjE,EAAMA,EAAI,KAAO,KAAK,aAC1C,OAAIkC,GACAA,EAAQ,UAAU+B,EAAcA,EAAY,KAAO,CAAC,EAEjDA,CACX,CAEA,qBAAqBjC,EAAekC,EAAc7C,EAA6B,CAC3E,OAAO,KAAK,mBAAmBW,EAAMkC,EAAM7C,EAAM,EAAK,CAC1D,CAEA,yBAAyBW,EAAekC,EAAc7C,EAA6B,CAC/E,OAAO,KAAK,mBAAmBW,EAAMkC,EAAM7C,EAAM,EAAI,CACzD,CAEA,uBAAuBpB,EAA0BiE,EAAc7C,EAAsB,CACjF,OAAO,KAAK,qBAAqBpB,EAAKiE,EAAM7C,EAAM,UAAU,CAChE,CAEA,2BAA2BpB,EAA0BiE,EAAc7C,EAAsB,CACrF,OAAO,KAAK,qBAAqBpB,EAAKiE,EAAM7C,EAAM,WAAW,CACjE,CAEA,yBAAyB8C,EAAiB9C,EAA6B,CACnE,OAAO,KAAK,uBAAuB8C,EAAS9C,EAAM,EAAK,CAC3D,CAEA,6BAA6B8C,EAAiB9C,EAA6B,CACvE,OAAO,KAAK,uBAAuB8C,EAAS9C,EAAM,EAAI,CAC1D,CAEA,uBAAuBrB,EAAoB,CACvC,KAAK,eAAiBA,CAC1B,CAEA,wBAAwBA,EAAaoE,EAAaC,EAAkB,CAChE,GAAI,CAACrE,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpCA,EAAI,aAAaqE,EAAUD,CAAG,CAClC,CAEA,sBAAsBE,EAAcC,EAAiBC,EAAyB,CAC1E,MAAO,EACX,CAEA,kBAAkBF,EAAcG,EAAgBC,EAAeV,EAA4B,CACvF,OAAIA,GACAA,EAAO,UAAU,CAAC,EAEf,CACX,CAEA,oBAAoBW,EAAiBlB,EAAemB,EAAc,CAC9D,IAAMC,EAAW,GAAGD,GAAQ,EAA0B,MAAQ,MAAM,UAAUlB,GAAYD,CAAK,CAAC,GAChG,SAASqB,EAAaC,EAAsB,CACpCA,EAAOF,CAAQ,IACf,OAAOE,EAAOF,CAAQ,EAAEG,GAAqBJ,CAAI,CAAC,EAC7C,OAAO,KAAKG,EAAOF,CAAQ,CAAC,EAAE,QAC/B,OAAOE,EAAOF,CAAQ,EAGlC,EAEIF,IAAY,GAAoBA,IAAY,IAC5CG,EAAa,KAAK,WAAW,MAAM,GAGnCH,IAAY,GAAoBA,IAAY,IAC5CG,EAAa,KAAK,WAAW,IAAI,CAEzC,CAEA,kBAAkBH,EAAiBlB,EAAemB,EAAcK,EAAe,CAC3E,GAAIxB,EAAQ,GAAKA,GAAS,IAAmBmB,EAAO,GAAKA,GAAQ,GAC7D,OAEJ,GAAID,IAAY,EAAkB,CAC9B,KAAK,kBAAkB,EAAoBlB,EAAOmB,EAAMK,CAAK,EAC7D,KAAK,kBAAkB,EAAkBxB,EAAOmB,EAAMK,CAAK,EAC3D,MACJ,CACA,GAAIN,IAAY,GAAiBA,IAAY,GAAoBA,IAAY,EACzE,OAGJ,IAAMO,EAAaP,IAAY,EAAqB,KAAK,WAAW,OAAS,KAAK,WAAW,KACvFE,EAAW,GAAGD,GAAQ,EAA0B,MAAQ,MAAM,UAAUlB,GAAYD,CAAK,CAAC,GAC1F0B,EAAiB,CAAC,OAAQ,UAAW,SAAU,OAAO,EACtDC,EAAU,CAAC,UAAW,SAAU,MAAM,EACxCC,GAEAT,IAAS,GAAyBA,IAAS,KAC3CS,EAAaJ,EAAQ,MAErBL,IAAS,IACTS,EAAaF,EAAeF,CAAK,GAEjCL,IAAS,IACTS,EAAc,EAAIJ,EAAQ,GAAO,MAEjCL,IAAS,IACTS,EAAaD,EAAQH,CAAK,GAE1BL,IAAS,IACTS,EAAaJ,EAAQ,SAAW,UAEhCL,IAAS,IACTS,EAAaJ,EAAQ,EAAI,IAEzBL,IAAS,GAAuBA,IAAS,KACzCS,EAAaC,GAAmBL,CAAK,GAErCL,IAAS,IACTS,EAAaJ,GAGbI,IAAe,SAIdH,EAAWL,CAAQ,IACpBK,EAAWL,CAAQ,EAAI,CAAC,GAE5BK,EAAWL,CAAQ,EAAEG,GAAqBJ,CAAI,CAAC,EAAIS,EACvD,CAEA,UAAW,CAAC,CAEZ,8BAA8BE,EAAc3E,EAAgBC,EAAmB,CAC3E2E,GAA+BD,EAAO,IAAO3E,EAAQC,CAAM,CAC/D,CAEA,4BAA4B0E,EAAc3E,EAAgBC,EAAmB,CACzE4E,GAA6BF,EAAO,IAAO3E,EAAQC,CAAM,CAC7D,CAEA,uBAAuBK,EAAuBD,EAAuB,CACjEuE,GAA+BE,GAAyBxE,CAAU,EAAGD,CAAU,CACnF,CAEA,qBAAqBC,EAAuBD,EAAuB,CAC/DwE,GAA6BC,GAAyBxE,CAAU,EAAGD,CAAU,CACjF,CAEA,iBAAiBxB,EAAa,CAC1B,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,MAAM,OAAS,OACnB,MAAM,IAAI,MAAM,+BAA+B,EAEnDA,EAAI,MAAM,CACd,CAEA,iBAAiBA,EAAakG,EAAsB,CAChD,GAAI,CAAClG,EACD,MAAM,IAAI,MAAM,gBAAgB,EAKpC,GAFAA,EAAI,IAAI,MAAMkG,CAAK,EAEflG,IAAQ,KAAK,YAEb,KAAK,YAAc,KACnB,KAAK,cAAcA,EAAK,EAAI,MAE3B,CACD,IAAMmG,EAAanG,EAAI,OACjBoG,EAAcD,EAAW,SAAWnG,EAAMmG,EAAW,OAAUA,EAAW,OAC1EE,EAAkBF,EAAW,OAC/BE,GACIA,EAAgB,SAAWF,EAC3BE,EAAgB,OAASD,EAGzBC,EAAgB,OAASD,EAE7BA,EAAY,OAASC,IAGrB,KAAK,YAAcD,EACnBA,EAAY,OAAS,MAEzB,KAAK,cAAcpG,EAAK,EAAI,EAC5B,KAAK,cAAcmG,EAAY,EAAK,EAEpC,KAAK,iBAAiBC,EAAaD,EAAW,GAAG,CACrD,CACJ,CAEA,sBAAsBnG,EAAasG,EAAcC,EAAarD,EAAeC,EAAgB,CACzF,GAAI,CAACnD,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,OAAS,WACb,MAAM,IAAI,MAAM,uCAAuC,EAE3DA,EAAI,KAAK,KAAK,CACV,OAAAmD,EACA,QAAS,OACT,MAAAD,EACA,EAAGoD,EACH,EAAGC,CACP,CAAC,CACL,CAEA,qBAAqBvG,EAAawG,EAAgBF,EAAcC,EAAarD,EAAeC,EAAgB,CACxG,GAAI,CAACnD,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,OAAS,WACb,MAAM,IAAI,MAAM,uCAAuC,EAE3DA,EAAI,KAAK,KAAK,CACV,MAAO6F,GAAmBW,CAAM,EAChC,OAAArD,EACA,QAAS,OACT,MAAAD,EACA,EAAGoD,EACH,EAAGC,CACP,CAAC,CACL,CAEA,sBAAsBvG,EAAa,CAC/B,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEhCA,EAAI,OAAS,UACbA,EAAI,eAAe,CAE3B,CAEA,2BAA2BA,EAAayG,EAAoBC,EAAkBC,EAAoB,CAC9F,GAAI,CAAC3G,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,OAAS,OACb,MAAM,IAAI,MAAM,mCAAmC,EAEnD2G,GACAA,GAAQ,UAAU3G,EAAI,GAAG,EAEzByG,GACAA,GAAQ,UAAUzG,EAAI,KAAOA,EAAI,MAAQ,GAAkB,KAA2BA,EAAI,OAAS,EAAmB,IAAmB,EAEzI0G,GACAA,GAAM,UAAU1G,EAAI,IAAI,CAEhC,CAEA,2BAA2BA,EAA4B,CACnD,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,OAAOA,EAAI,OACf,CAEA,sBAAsBA,EAA4B,CAC9C,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,OAAOA,EAAI,MACf,CAEA,oBAAoBA,EAAqB,CACrC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,OAAOA,EAAI,IACf,CAEA,qBAAqC,CACjC,OAAO,KAAK,WAChB,CAEA,uBAAuBA,EAA4B,CAC/C,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,IAAM4G,EAAS5G,EAAI,OACnB,OAAK4G,EAGDA,EAAO,SAAW5G,EACX4G,EAAO,OAGPA,EAAO,OANP,IAQf,CAEA,oBAAoB5G,EAAa6G,EAAsBC,EAAuB,CAC1E,GAAI,CAAC9G,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,IAAM+G,EAAU,KAAK,QACjB5D,EAAS,EACTD,EAAQ,EACZ,OAAQlD,EAAI,KAAM,CACd,IAAK,SACDmD,EAAS6D,IAA4BhH,EAAI,IAAI,OAASA,EAAI,IAAI,IAAM+G,EAAQ,eAAiBA,EAAQ,gBAAgB,EACrH7D,EAAQ8D,IAA4BhH,EAAI,IAAI,MAAQA,EAAI,IAAI,KAAO+G,EAAQ,eAAiBA,EAAQ,eAAe,EACnH,MACJ,IAAK,WACL,IAAK,OACD5D,EAASnD,EAAI,OACbkD,EAAQlD,EAAI,MACZ,KACR,CACI8G,GACAA,GAAW,UAAU3D,CAAM,EAE3B0D,GACAA,GAAU,UAAU3D,CAAK,CAEjC,CAEA,sBAAsBlD,EAAqB,CACvC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,OAAOA,EAAI,GACf,CAEA,oBAAoBA,EAAqB,CACrC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,OAAOA,EAAI,OACf,CAEA,mBAAmBA,EAAcyC,EAAoC,CACjE,IAAMwE,EAAcjH,EAAMA,EAAI,KAAO,KAAK,aAC1C,OAAIyC,GACAA,GAAS,UAAUwE,EAAcA,EAAY,KAAO,CAAC,EAElDA,CACX,CAEA,uBAAuBjH,EAAakH,EAAcC,EAAc,CAC5D,GAAI,CAACnH,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,OAAS,OACb,MAAM,IAAI,MAAM,mCAAmC,EAEvDA,EAAI,EAAI,KAAK,IAAI,EAAGkH,CAAI,EACxBlH,EAAI,EAAI,KAAK,IAAI,EAAGmH,CAAI,CAC5B,CAEA,gBAAgBC,EAAyBX,EAAgBC,EAAcxB,EAAiBtD,EAA6B,CAEjH,GAAK,KAAK,YAKL,CACD,GAAI,CAACwF,EACD,MAAM,IAAI,MAAM,kBAAkB,EAEtC,GAAIA,EAAS,OAAS,OAClB,MAAM,IAAI,MAAM,6CAA6C,EAEjE,IAAMC,EAAWZ,EAAS,IACpBa,EAAYb,EAAS,GAC3B,GAAIY,IAAa,IAAmBA,IAAa,GAC7C,MAAM,IAAI,MAAM,+CAA+C,EAEnE,GAAIA,IAAa,IAAmBD,EAAS,OAAS,QAClD,MAAM,IAAI,MAAM,sEAAsE,EAE1F,GAAIE,IAAc,GAAmBA,IAAc,GAAmBA,IAAc,GAAkBA,IAAc,EAChH,MAAM,IAAI,MAAM,+BAA+B,CAEvD,SAtBQF,EACA,MAAM,IAAI,MAAM,iDAAiD,EAwBzE,IAAIpH,EACJ,OAAQkF,EAAS,CACb,IAAK,GACDlF,EAAM,IAAIuH,GAAY3F,CAAI,EAC1B,MACJ,IAAK,GACD5B,EAAM,IAAIwH,GAAe5F,CAAI,EAC7B,MACJ,IAAK,GACD5B,EAAM,IAAIyH,GAAa7F,EAAM,KAAK,WAAW,MAAM,EACnD,MACJ,IAAK,GACD5B,EAAM,IAAI0H,GAAW9F,EAAM,KAAK,WAAW,IAAI,EAC/C,MACJ,QACI,MAAM,IAAI,MAAM,iBAAiB,CACzC,CAIA,GAHA,KAAK,gBAAgB5B,CAAG,EAGpBoH,EAAU,CACV,IAAMO,EAAU,IAAIC,GAAW5H,EAAKyG,EAAQC,CAAI,EAChD,KAAK,gBAAgBiB,CAAO,EAE5BA,EAAQ,OAASP,EACjBO,EAAQ,OAAS3H,EACjB,IAAM6H,EAAYT,EAAS,OAC3BA,EAAS,OAASO,EAClB3H,EAAI,OAAS2H,EACbA,EAAQ,OAASE,EACbA,EACIA,EAAU,SAAWT,EACrBS,EAAU,OAASF,EAGnBE,EAAU,OAASF,EAIvB,KAAK,YAAcA,EAEvB,KAAK,iBAAiBA,EAASP,EAAS,GAAG,CAC/C,MAEI,KAAK,YAAcpH,EACnB,KAAK,iBAAiBA,EAAK,CACvB,OAAQ,KAAK,QAAQ,OACrB,KAAM,EACN,MAAO,KAAK,QAAQ,MACpB,IAAK,CACT,CAAC,EAGL,OAAOA,CACX,CAEA,2BAA2BA,EAAayG,EAAgBC,EAAcC,EAAiB,CACnF,GAAI,CAAC3G,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,OAAS,OACb,MAAM,IAAI,MAAM,mCAAmC,EAGvD,GAAI2G,EAAQ,CACR,GAAIA,EAAO,OAAS,OAChB,MAAM,IAAI,MAAM,yCAAyC,EAE7D,IAAImB,EAA4BnB,EAChC,MAAQmB,EAAaA,GAAY,SACzBA,IAAe9H,GAAnB,CAIJ,GAAI,CAAC8H,EACD,MAAM,IAAI,MAAM,6BAA6B,CAErD,CAEA,IAAMC,EAAUtB,EAAS,GACnBuB,EAAeD,IAAY,GAAkBA,IAAY,EAI/D,GAHKpB,IACDA,EAAS3G,EAAI,KAEbgI,GAAgB,CAAChI,EAAI,SACrB,MAAM,IAAI,MAAM,4CAA4C,EAEhE,GAAI,CAACgI,GAAgBhI,EAAI,SACrB,MAAM,IAAI,MAAM,0CAA0C,EAE9D,IAAMiI,GAAaxB,EAAS,OAA4B,GACxD,GAAIE,EAAO,OAAS,SAAWsB,EAC3B,MAAM,IAAI,MAAM,sEAAsE,EAG1F,IAAMC,EAAeH,IAAY,GAAkBA,IAAY,EAC/D,GAAIG,IAAiBlI,EAAI,SAAU,CAE/B,IAAMmI,EAAWnI,EAAI,OACrBA,EAAI,OAASA,EAAI,OACjBA,EAAI,OAASmI,CACjB,CAGAnI,EAAI,SAAWkI,EACflI,EAAI,QAAUyG,EAAS,OAA0B,IACjDzG,EAAI,IAAM+H,EACV/H,EAAI,MAAQiI,EACZjI,EAAI,IAAM2G,EACV3G,EAAI,KAAO0G,EACX1G,EAAI,SAAWgI,EAEf,KAAK,iBAAiBhI,EAAKA,EAAI,GAAG,CACtC,CAEA,gCAAgCA,EAAawG,EAAgB,CACzD,GAAI,CAACxG,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,OAAS,WACb,MAAM,IAAI,MAAM,uCAAuC,EAE3DA,EAAI,KAAK,KAAK,CACV,MAAO6F,GAAmBW,CAAM,EAChC,QAAS,UACb,CAAC,CACL,CAEA,2BAA2BxG,EAAaoI,EAAuB,CAC3D,GAAI,CAACpI,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpCA,EAAI,QAAUoI,CAClB,CAEA,wBAAwBvJ,EAAa,CACjC,KAAK,+BAA+B,KAAK,eAAiBA,CAAG,CACjE,CAEA,+BAA+B0B,EAAa1B,EAAa,CACrD,GAAI,CAAC0B,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEhCA,EAAI,OAAS,UACbA,EAAI,QAAQ,UAAW1B,EAAM,EAAI,MAAS,CAElD,CAEA,mBAAmBwJ,EAAYC,EAAY,CACvC,KAAK,0BAA0B,KAAK,eAAiBD,EAAIC,CAAE,CAC/D,CAEA,0BAA0B/H,EAAa8H,EAAYC,EAAY,CAC3D,GAAI,CAAC/H,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEhCA,EAAI,OAAS,WACT8H,IAAO,IACP9H,EAAI,QAAQ,QAAS8H,IAAO,GAAiB,OAAYxC,GAAmBwC,CAAE,CAAC,EAE/EC,IAAO,IACP/H,EAAI,QAAQ,mBAAoB+H,IAAO,GAAiB,OAAYzC,GAAmByC,CAAE,CAAC,EAGtG,CAKQ,OAAOrH,EAAoB,CAC/B,GAAI,KAAK,OACL,OAAO,KAAK,OAAO,IAAI,mBAAmB,EAG9C,GAAIA,EAAG,MAAQ,KAAK,IAChB,OAAO,KAAK,OAAO,IAAI,qDAAqD,KAAK,GAAG,cAAcA,EAAG,GAAG,EAAE,EAI9G,GAFA,KAAK,MAED,CAAC,KAAK,WAAaA,EAAG,OAAS,QAAUA,EAAG,OAAS,kBACrD,OAGJ,KAAK,eAAiBA,EAAG,QAEzB,IAAIsH,EAAO,EACPvI,EAAqB,KACrB+C,EAAO,EACPC,EAAO,EACPT,EAEJ,GAAI,WAAYtB,EACZ,IAAKjB,EAAM,KAAK,aAAcA,GACtBA,EAAI,WAAaiB,EAAG,OADOjB,EAAMA,EAAI,KACzC,CAMR,OAAQiB,EAAG,KAAM,CACb,IAAK,OACD,KAAK,QAAUuH,GAAkBvH,EAAG,OAAO,EAC3C,KAAK,QAAUA,EAAG,QAClB,KAAK,GAAG,MAAM,EACd,OACJ,IAAK,UACD,KAAK,QAAUuH,GAAkBvH,EAAG,OAAO,EACvC,KAAK,aACL,KAAK,iBAAiB,KAAK,YAAa,CACpC,OAAQ,KAAK,QAAQ,OACrB,KAAM,EACN,MAAO,KAAK,QAAQ,MACpB,IAAK,CACT,CAAC,EAELsH,EAAO,EACP,MACJ,IAAK,OACD,GAAIvI,GAAK,MAAM,OAAS,OACpB,OAEJ,OAAOA,EAAI,MAAM,KACjBuI,EAAO,EACHtH,EAAG,MAAM,SAAW,GACpB8B,EAAO9B,EAAG,MAAM,YAAY,CAAC,EACvBjB,EAAmB,YACrB+C,EAAOA,EAAO,MAIlBA,EAAO0F,GAAmBxH,EAAG,KAAgC,GAAK,WAEtE,MACJ,IAAK,YACD,GAAI,CAACjB,GAAK,MAAM,UACZ,OAEJuI,EAAO,EACPxF,EAAO9B,EAAG,MACV,MACJ,IAAK,OACD,GAAIjB,GAAK,MAAM,OAAS,OACpB,OAEJ,KAAK,kBAAkBA,EAAmBiB,EAAG,MAAO,KAAK,UAAWA,EAAG,UAAU,EACjF,KAAK,SAAS,eAAe,KAAK,SAAU,EAC5C,OAAO,KAAK,UACZ,MACJ,IAAK,QACD,GAAI,CAACjB,GAAK,MAAM,MACZ,OAEJuI,EAAO,EACPxF,EAAO9B,EAAG,EACV+B,EAAO/B,EAAG,EACV,MACJ,IAAK,SACDsH,EAAO,EACP,MACJ,IAAK,kBAAmB,CACpB,GAAItH,EAAG,WAAa,iBAChB,MAAM,IAAI,MAAM,uCAAuC,EAE3D,IAAMqB,EAAcrB,EAAG,MACvB,GAAI,OAAOqB,GAAgB,SACvB,MAAM,IAAI,MAAM,+DAA+D,EAE/EA,IACAC,EAAO,KAAK,eAAeD,EAAY,SAAU,KAAK,aAAc,KAAM,KAAK,aAAc,MAAOA,CAAW,GAEnH,KACJ,CACA,IAAK,QACDiG,EAAO,EACP,KAAK,MAAM,QAAU,KAAK,IAAI,EAC9B,MACJ,QACI,MAAM,IAAI,MAAM,cAActH,EAAG,IAAI,4BAA4B,CACzE,CAEI,KAAK,YACLC,GAAU,KAAK,UAAYqH,EAAMvI,EAAK+C,EAAMC,CAAI,EAChD,KAAK,SAAS,eAAe,KAAK,SAAU,EAC5C,OAAO,KAAK,WAEhB,KAAK,GAAG,OAAOT,CAAI,CACvB,CAEQ,eAAeZ,EAAkBC,EAAcF,EAAeY,EAAsC,CACxG,GAAI,CAACA,EAAa,CACd,IAAMJ,EAAWR,EAAQ,GACnBgH,EAAYxG,IAAa,EAAsB,KAAK,GAAG,cAAc,EAAI,OAC/EI,EAAc,KAAK,OAAO,mBAAmBX,EAAUQ,GAAWD,CAAQ,GAAK,MAAOwG,CAAS,CACnG,CACA,IAAMnG,EAAO,IAAIoG,GAAQ,KAAK,OAAQhH,EAAUW,EAAaV,EAAMF,CAAK,EACxE,OAAAa,EAAK,KAAO,KAAK,WACjB,KAAK,WAAaA,EACdA,EAAK,OACLA,EAAK,KAAK,KAAOA,GAErB,KAAK,SAAS,eAAe,UAAWA,CAAI,EACrCA,CACX,CAEQ,mBAAmBA,EAAekC,EAAc7C,EAAcgH,EAAkB,CACpF,GAAI,CAACrG,EACD,MAAM,IAAI,MAAM,iBAAiB,EAErC,GAAIkC,IAAS,GAAkBA,IAAS,GAAiBA,IAAS,GAAsBA,IAAS,EAC7F,MAAM,IAAI,MAAM,kBAAkB,EAEtC,GAAIA,IAAS,GAAiB,CAAClC,EAAK,OAAO,EACvC,OAAO,KAIX,IAAIsG,EAA0B,KAC1BpE,IAAS,IACToE,EAAOtG,EAAK,KAAK,GAEhBsG,IACDA,EAAO,IAAI,WAAW,CAAC,EACvBtG,EAAK,MAAMsG,CAAI,GAGnB,IAAMtI,EAAMuI,GAA0BD,EAAMtG,EAAK,OAAQkC,EAAM7C,EAAMgH,EAASrG,CAAI,EAElF,OAAIkC,IAAS,GACTlE,EAAI,aAAa,EAAc,CAAC,EAEpC,KAAK,gBAAgBA,CAAG,EACjBA,CACX,CAEQ,qBAAqBC,EAAsBiE,EAAc7C,EAAcmH,EAAuC,CAClH,GAAItE,IAAS,GAAiBA,IAAS,GAAkBA,IAAS,EAC9D,MAAM,IAAI,MAAM,kBAAkB,EAEtC,IAAIlE,EACJ,GAAIC,EAAK,CACL,IAAMwI,EAAY,IAAM,KAAK,SAAS,eAAexI,CAAG,EACxD,GAAI,MAAM,QAAQA,CAAG,EAAG,CACpB,IAAMyI,EAAUF,EAAY,KAAKvI,CAAG,EAChCiE,IAAS,EACTlE,EAAM,IAAI2I,GAAkBD,EAASxE,EAAM7C,EAAMoH,CAAS,EAI1DzI,EAAM,IAAI2I,GAAkBD,EAASxE,EAAM7C,EAAM,IAAM,CACnDuH,GAAWF,EAASzI,EAAKA,EAAI,MAAM,EACnCwI,EAAU,CACd,CAAC,CAET,MAEIzI,EAAM,IAAI2I,GAAkB1I,EAAKiE,EAAM7C,EAAMoH,CAAS,EAE1D,KAAK,SAAS,aAAaxI,CAAG,CAClC,MAEID,EAAM,IAAI6I,GAAW3E,EAAM7C,CAAI,EAEnC,YAAK,gBAAgBrB,CAAG,EACjBA,CACX,CAEQ,uBAAuBmE,EAAiB9C,EAAcgH,EAAkB,CAC5E,GAAI,CAAC,KAAK,MACN,OAAO,KAEX,IAAMS,EAAQ,KAAK,MAAM,eAAe3E,CAAO,EAC/C,GAAI,CAAC2E,EACD,OAAO,KAEX,IAAM9I,EAAMuI,GAA0BO,EAAM,KAAMA,EAAM,OAAQ,EAAezH,EAAMgH,CAAO,EAC5F,YAAK,gBAAgBrI,CAAG,EACjBA,CACX,CAEQ,WAAWP,EAAasJ,EAAoBnG,EAAgBJ,EAAcC,EAAcE,EAAe,CAC3G,IAAM2F,EAAoD,CACtD,QAASS,EAAQ,QACjB,OAAAnG,EACA,MAAOmG,EAAQ,MACf,QAAS,QACT,IAAKA,EAAQ,IACb,MAAApG,CACJ,EACA,OAAQlD,EAAI,KAAM,CACd,IAAK,SACD,OAAA6I,EAAK,UAAYU,GAAiBxG,CAAI,GAAK,WAC3C/C,EAAI,UAAU6I,CAAyB,EAChC,EACX,IAAK,WACD,OAAAA,EAAK,EAAI9F,EACT8F,EAAK,EAAI7F,EACThD,EAAI,KAAK,KAAK6I,CAAsB,EAC7B,CACf,CACA,MAAO,EACX,CAEQ,kBAAkB7I,EAAiBwJ,EAAevI,EAAmBwI,EAA0B,CAG/FzJ,EAAI,0BACJA,EAAI,WAAWwJ,EAAQ;AAAA,EAAM,OAAO,EAChCxJ,EAAI,SACJA,EAAI,QAAQ,WAAWwJ,EAAQ;AAAA,EAAM,OAAO,GAKhDA,EAAM,OAASxJ,EAAI,eAAgB,SACnCwJ,EAAQA,EAAM,MAAM,EAAGxJ,EAAI,eAAgB,MAAM,GAEhDA,EAAI,YACLwJ,EAAQA,EAAM,QAAQ,gBAAiB,GAAG,GAG9C,IAAME,EAAY,YAAY,KAAKF,EAAO3I,GAAMA,EAAG,YAAY,CAAC,CAAE,EAC9D,MAAM,QAAQb,EAAI,cAAe,EACjCmJ,GAAWO,EAAW1J,EAAI,eAAiBwJ,EAAM,MAAM,EAGvDxJ,EAAI,gBAAgB,IAAI0J,CAAS,EAGrC,IAAMC,EAAaC,GAAyBH,CAAyB,GAAK,EAEtExI,GACAC,GAAUD,EAAI,EAAkBjB,EAAewJ,EAAM,OAAQG,CAAU,EAE3E,KAAK,SAAS,eAAe3J,EAAI,cAAe,EAChD,OAAOA,EAAI,MAAM,KACjB,OAAOA,EAAI,cACf,CAEQ,iBAAiBA,EAAa6J,EAAgB,CAClD,IAAM9C,EAAU,KAAK,QACrB,KAAK,gBAAkB,GACvB/G,EAAI,IAAM6J,EACV,IAAMC,EAAYD,EAAI,OAASA,EAAI,IAC7BE,EAAWF,EAAI,MAAQA,EAAI,KACjC,OAAQ7J,EAAI,KAAM,CACd,IAAK,WAAY,CACbA,EAAI,OAASgH,GAA2B8C,EAAY/C,EAAQ,eAAe,EAC3E/G,EAAI,MAAQgH,GAA2B+C,EAAWhD,EAAQ,eAAe,EACzE,KACJ,CACA,IAAK,OAAQ,CACT,IAAM5D,EAAS6D,IAA4B8C,EAAY/C,EAAQ,aAAeA,EAAQ,cAAc,EAC9F7D,EAAQ8D,IAA4B+C,EAAWhD,EAAQ,aAAeA,EAAQ,aAAa,EACjG/G,EAAI,YAAYmD,EAAQD,CAAK,EAC7B,KACJ,CACA,IAAK,OAAQ,CACT,IAAI8G,EAAKC,EAAKC,EACVlK,EAAI,UACJgK,EAAMH,EAAI,KACVI,EAAMJ,EAAI,MACVK,EAAanD,EAAQ,aAGrBiD,EAAMH,EAAI,IACVI,EAAMJ,EAAI,OACVK,EAAanD,EAAQ,YAEpB/G,EAAI,SACLkK,EAAa,GAEjB,IAAMC,EAAOF,EAAMD,EAGfI,EAAQ,EACZ,GAAIpK,EAAI,MAAO,CACX,OAAQA,EAAI,IAAK,KAAM,CACnB,IAAK,SACGA,EAAI,SACJoK,EAAQpK,EAAI,KAAO+G,EAAQ,gBAAkBA,EAAQ,cAGrDqD,EAAQpK,EAAI,KAAO+G,EAAQ,iBAAmBA,EAAQ,cAE1D,MACJ,IAAK,WACDqD,EAAQpK,EAAI,MAAQA,EAAI,SAAW+G,EAAQ,gBAAkBA,EAAQ,iBACrE,MACJ,IAAK,OACG/G,EAAI,SACJoK,EAAQpK,EAAI,KAAO+G,EAAQ,cAAgBA,EAAQ,YAGnDqD,EAAQpK,EAAI,KAAO+G,EAAQ,eAAiBA,EAAQ,YAExD,KACR,CACAqD,EAAQ,KAAK,KAAKA,CAAK,CAC3B,MAEIA,EAAQ,KAAK,MAAOD,EAAOnK,EAAI,KAAQ,GAAG,EAI1CA,EAAI,SACJoK,EAAQJ,EAAMI,EAGdA,EAAQH,EAAMG,EAAQF,EAItBF,GAAOC,EACPG,EAAQJ,EAGRI,EAAQ,KAAK,IAAI,KAAK,IAAIA,EAAOJ,CAAG,EAAGC,EAAMC,CAAU,EAI3D,IAAIG,EAAiBC,EACjBtK,EAAI,UACJqK,EAAO,CACH,OAAQR,EAAI,OACZ,KAAMA,EAAI,KACV,MAAOO,EACP,IAAKP,EAAI,GACb,EACAS,EAAO,CACH,OAAQT,EAAI,OACZ,KAAMO,EAAQF,EACd,MAAOL,EAAI,MACX,IAAKA,EAAI,GACb,IAGAQ,EAAO,CACH,OAAQD,EACR,KAAMP,EAAI,KACV,MAAOA,EAAI,MACX,IAAKA,EAAI,GACb,EACAS,EAAO,CACH,OAAQT,EAAI,OACZ,KAAMA,EAAI,KACV,MAAOA,EAAI,MACX,IAAKO,EAAQF,CACjB,GAEJ,KAAK,iBAAiBlK,EAAI,OAASA,EAAI,SAAWsK,EAAOD,CAAI,EAC7D,KAAK,iBAAiBrK,EAAI,OAASA,EAAI,SAAWqK,EAAOC,CAAI,EAC7D,KACJ,CACJ,CACJ,CAEQ,gBAAgB/J,EAAa,CACjCA,EAAI,KAAO,KAAK,aAChB,KAAK,aAAeA,EAChBA,EAAI,OACJA,EAAI,KAAK,KAAOA,GAEpB,KAAK,SAAS,eAAe,SAAUA,CAAG,CAC9C,CAEQ,gBAAgBP,EAAa,CACjC,KAAK,gBAAkB,GACvBA,EAAI,KAAO,KAAK,aAChB,KAAK,aAAeA,EAChBA,EAAI,OACJA,EAAI,KAAK,KAAOA,GAGhB,KAAK,QACL,KAAK,SAAS,eAAe,SAAUA,CAAG,EAG1CA,EAAI,SAAW,KAAK,mBAExBA,EAAI,MAAM,GAAKA,EAAI,SACnB,KAAK,gBAAgBA,EAAI,GAAG,CAChC,CAEQ,cAAcA,EAAauK,EAAkB,CACjD,KAAK,gBAAkB,GAEnB,KAAK,SAAW,mBAAoBvK,GAAOA,EAAI,iBAC/C,KAAK,QAAQ,eAAeA,EAAI,cAAe,EAC/C,OAAOA,EAAI,gBAGXA,EAAI,OAAS,SACTuK,IACA,KAAK,cAAcvK,EAAI,OAAS,EAAI,EACpC,KAAK,cAAcA,EAAI,OAAS,EAAI,GAExCA,EAAI,OAAS,KACbA,EAAI,OAAS,KACbA,EAAI,IAAM,MAGd,KAAK,kBAAkBA,EAAI,GAAG,EAC9BA,EAAI,QAAU,KACdA,EAAI,OAAS,KAEb,KAAK,SAAS,iBAAiB,SAAUA,CAAG,EAC5C,IAAMY,EAAOZ,EAAI,KACXwC,EAAOxC,EAAI,KACjBA,EAAI,KAAO,KACXA,EAAI,KAAO,KACPY,EACAA,EAAK,KAAO4B,EAGZ,KAAK,aAAeA,EAEpBA,IACAA,EAAK,KAAO5B,EAEpB,CAEQ,mBAAmBZ,EAAawK,EAAc,CAClD,GAAI,CAACxK,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,MAAM,KACV,MAAM,IAAI,MAAM,qCAAqC,EAEzD,GAAIA,EAAI,OAAS,SAAWA,EAAI,OAAS,OACrC,MAAM,IAAI,MAAM,yCAAyC,EAG7DA,EAAI,MAAM,IAAM,KAAK,IACrBA,EAAI,MAAM,KAAO,OACjBA,EAAI,UAAYwK,CACpB,CAEQ,mBAAmBxK,EAAaQ,EAAegK,EAAc/J,EAAkB,CACnF,GAAI,CAACT,EACD,MAAM,IAAI,MAAM,gBAAgB,EAEpC,GAAIA,EAAI,MAAM,KACV,MAAM,IAAI,MAAM,qCAAqC,EAEzD,GAAIA,EAAI,OAAS,UAAYA,EAAI,OAAS,OACtC,MAAM,IAAI,MAAM,oCAAoC,EAGxDA,EAAI,MAAM,IAAM,KAAK,IACjBS,IACAT,EAAI,MAAM,QAAU,OAAO,cAAc,GAAGQ,EAAI,MAAM,EAAGC,CAAO,CAAC,GAErET,EAAI,MAAM,KAAO,OACjBA,EAAI,eAAiBQ,EACjBR,EAAI,OAAS,WACbA,EAAI,wBAA0BA,EAAI,iBAEtCA,EAAI,UAAYwK,EAChB,KAAK,SAAS,aAAahK,CAAG,CAClC,CAEQ,kBAAkBD,EAAa,CAC/B,KAAK,iBAAmBA,IACxB,KAAK,eAAiB,MAE1B,KAAK,SAAS,iBAAiB,SAAUA,CAAG,EAC5C,IAAMK,EAAOL,EAAI,KACXiC,EAAOjC,EAAI,KACjBA,EAAI,KAAO,KACXA,EAAI,KAAO,KACPK,EACAA,EAAK,KAAO4B,EAGZ,KAAK,aAAeA,EAEpBA,IACAA,EAAK,KAAO5B,EAEpB,CACJ,EAEA,SAASF,GAAmBF,EAAmBC,EAAiBgK,EAA6CC,EAAuB,CAChI,IAAMC,EAAc,MAAM,QAAQnK,CAAG,EAAIA,EAAI,MAAM,EAAGC,CAAO,EAA0BD,EAAI,SAAS,EAAGC,CAAO,EACxGoI,EAAO6B,EAAcC,EAAcA,EAAY,OAAO,CAAC/J,EAAMC,IAAOD,EAAO,OAAO,cAAcC,CAAE,EAAG,EAAE,EACvG+J,EAAUH,EAAK5B,CAAI,EACnBgC,EAAS,YAAY,KAAKD,EAAS/J,GAAMA,EAAG,YAAY,CAAC,CAAE,EAC3DiK,EAASD,EAAO,OACtB,OAAI,MAAM,QAAQrK,CAAG,EACjB2I,GAAW0B,EAAQrK,EAAKsK,CAAM,EAG9BtK,EAAI,IAAIqK,EAAO,SAAS,EAAG,KAAK,IAAIrK,EAAI,OAAQsK,CAAM,CAAC,CAAC,EAErDA,CACX,CAEA,SAASjF,GAAmBW,EAAgB,CAExC,MAAO,KAAOA,EAAS,UAAU,SAAS,EAAE,EAAE,YAAY,EAAE,SAAS,EAAG,GAAG,CAC/E,CAEA,SAASsC,GAA0BtI,EAAiBuK,EAAiBtG,EAAc7C,EAAcgH,EAAkBrG,EAAgB,CAC/H,IAAIsG,EACJ,GAAID,EACA,GAAImC,EACAlC,EAAOmC,GAAkBxK,CAAG,MAE3B,CACD,IAAMyK,EAAOC,GAAY,OAAO1K,CAAG,EACnCqI,EAAO,YAAY,KAAKoC,EAAMpK,GAAMA,EAAG,YAAY,CAAC,CAAE,CAC1D,MAGAgI,EAAOrI,EAEX,OAAIiE,IAAS,EACF,IAAIyE,GAAkBL,EAAMpE,EAAM7C,CAAI,EAGtC,IAAIuJ,GAAW5I,EAAOsG,EAAMpE,EAAM7C,CAAI,CAErD,CAEA,SAASN,GAA+BF,EAA2B,CAU/D,OATa,IAAI,KACbA,EAAO,UAAU,CAAC,EAClBA,EAAO,UAAU,CAAC,EAAc,EAChCA,EAAO,UAAU,CAAC,EAClBA,EAAO,UAAU,CAAC,EAClBA,EAAO,UAAU,CAAC,EAClBA,EAAO,UAAU,CAAC,EAClBA,EAAO,UAAU,CAAC,EAAc,GACpC,EACY,QAAQ,CACxB,CAEA,SAASG,GAA6BH,EAA2B,CAC7D,IAAMgK,EAAO,IAAI,KAAK,CAAC,EACvB,OAAAA,EAAK,eAAehK,EAAO,UAAU,CAAC,CAAW,EACjDgK,EAAK,YAAYhK,EAAO,UAAU,CAAC,EAAc,CAAC,EAClDgK,EAAK,WAAWhK,EAAO,UAAU,CAAC,CAAW,EAC7CgK,EAAK,YAAYhK,EAAO,UAAU,CAAC,CAAW,EAC9CgK,EAAK,cAAchK,EAAO,UAAU,CAAC,CAAW,EAChDgK,EAAK,cAAchK,EAAO,UAAU,CAAC,CAAW,EAChDgK,EAAK,mBAAmBhK,EAAO,UAAU,CAAC,EAAc,GAAI,EACrDgK,EAAK,QAAQ,CACxB,CAEA,SAAS5C,GAAkBzB,EAA2B,CAClD,IAAMsE,EAAiD,OAAO,OAAO,CAAC,EAAGpM,EAAe,EACpFJ,EAuEJ,GArEAA,EAAMkI,EAAQ,WACVlI,IAAQ,SACRwM,EAAmB,iBAAkBxM,EACrCwM,EAAmB,eAAiBxM,GAExCA,EAAMkI,EAAQ,UACVlI,IAAQ,SACRwM,EAAmB,gBAAkBxM,EACrCwM,EAAmB,cAAgBxM,GAGvCA,EAAMkI,EAAQ,OACVlI,IAAQ,SACRwM,EAAmB,cAAgBxM,EACnCwM,EAAmB,cAAgBxM,EACnCwM,EAAmB,gBAAkBxM,EACrCwM,EAAmB,gBAAkBxM,EACrCwM,EAAmB,YAAcxM,EACjCwM,EAAmB,YAAcxM,GAErCA,EAAMkI,EAAQ,aACVlI,IAAQ,SACRwM,EAAmB,cAAgBxM,EACnCwM,EAAmB,cAAgBxM,GAEvCA,EAAMkI,EAAQ,eACVlI,IAAQ,SACRwM,EAAmB,gBAAkBxM,EACrCwM,EAAmB,gBAAkBxM,GAEzCA,EAAMkI,EAAQ,WACVlI,IAAQ,SACRwM,EAAmB,YAAcxM,EACjCwM,EAAmB,YAAcxM,GAErCA,EAAMkI,EAAQ,QACVlI,IAAQ,SACRwM,EAAmB,cAAgBxM,EACnCwM,EAAmB,gBAAkBxM,EACrCwM,EAAmB,YAAcxM,GAErCA,EAAMkI,EAAQ,QACVlI,IAAQ,SACRwM,EAAmB,cAAgBxM,EACnCwM,EAAmB,gBAAkBxM,EACrCwM,EAAmB,YAAcxM,GAGrCA,EAAMkI,EAAQ,QACVlI,IAAQ,SACRwM,EAAmB,WAAaxM,EAChCwM,EAAmB,WAAaxM,GAEpCA,EAAMkI,EAAQ,UACVlI,IAAQ,SACRwM,EAAmB,WAAaxM,EAChCwM,EAAmB,WAAaxM,GAEpCA,EAAMkI,EAAQ,SACVlI,IAAQ,SACRwM,EAAmB,WAAaxM,GAEpCA,EAAMkI,EAAQ,SACVlI,IAAQ,SACRwM,EAAmB,WAAaxM,GAGpC,OAAO,OAAOwM,EAAoBtE,CAAO,EAErCA,EAAQ,YAAcsE,EAAmB,aAAeA,EAAmB,YAC3E,MAAM,IAAI,MAAM,gDAAgD,EAGpE,OAAOA,CACX,CAEA,SAASrE,GAA2BnI,EAAa,CAC7C,OAAO,KAAK,IAAI,EAAG,KAAK,MAAMA,CAAG,CAAC,CACtC,CAEA,SAASqC,GAAUD,EAAyBsH,EAAe,EAAavI,EAAqB,KAAM+C,EAAO,EAAGC,EAAO,EAAG,CACnH/B,EAAG,UAAU,EAAGsH,CAAI,EACpBtH,EAAG,UAAU,EAAGjB,CAAG,EACnBiB,EAAG,UAAU,EAAG8B,CAAI,EACpB9B,EAAG,UAAU,EAAG+B,CAAI,CACxB,CAEA,SAAS+C,GAA+BuF,EAAmBlK,EAAmB,CAC1E,IAAMgK,EAAO,IAAI,KAAKE,CAAS,EAC/BlK,EAAO,UAAU,EAAGgK,EAAK,YAAY,CAAC,EACtChK,EAAO,UAAU,EAAGgK,EAAK,SAAS,EAAI,CAAC,EACvChK,EAAO,UAAU,EAAGgK,EAAK,QAAQ,CAAC,EAClChK,EAAO,UAAU,EAAGgK,EAAK,OAAO,CAAC,EACjChK,EAAO,UAAU,EAAGgK,EAAK,SAAS,CAAC,EACnChK,EAAO,UAAU,EAAGgK,EAAK,WAAW,CAAC,EACrChK,EAAO,UAAU,EAAGgK,EAAK,WAAW,CAAC,EACrChK,EAAO,UAAU,EAAGgK,EAAK,gBAAgB,EAAI,GAAI,CACrD,CAEA,SAASpF,GAA6BsF,EAAmBlK,EAAmB,CACxE,IAAMgK,EAAO,IAAI,KAAKE,CAAS,EAC/BlK,EAAO,UAAU,EAAGgK,EAAK,eAAe,CAAC,EACzChK,EAAO,UAAU,EAAGgK,EAAK,YAAY,EAAI,CAAC,EAC1ChK,EAAO,UAAU,EAAGgK,EAAK,WAAW,CAAC,EACrChK,EAAO,UAAU,EAAGgK,EAAK,UAAU,CAAC,EACpChK,EAAO,UAAU,EAAGgK,EAAK,YAAY,CAAC,EACtChK,EAAO,UAAU,EAAGgK,EAAK,cAAc,CAAC,EACxChK,EAAO,UAAU,EAAGgK,EAAK,cAAc,CAAC,EACxChK,EAAO,UAAU,EAAGgK,EAAK,mBAAmB,EAAI,GAAI,CACxD,CAEA,SAAS/J,GAAyBiK,EAAmBlK,EAAmB,CACpEA,EAAO,UAAU,EAAG,KAAK,MAAMkK,EAAY,YAAa,CAAC,EACzDlK,EAAO,UAAU,EAAG,KAAK,MAAMkK,EAAY,GAAI,IAAM,CAAC,EACtD,IAAIC,EAAY,KAAK,MAAOD,EAAY,IAAQ,GAAI,EAChDC,EAAY,IACZA,GAAa,KAEjBnK,EAAO,UAAU,EAAGmK,CAAS,CACjC,CAEA,SAAStF,GAAyB7E,EAA2B,CACzD,OAAQA,EAAO,UAAU,CAAC,EAAe,aACpCA,EAAO,UAAU,CAAC,EAAe,IACjCA,EAAO,UAAU,CAAC,EAAe,GAC1C,CAGA,SAASyB,GAAexC,EAAe0I,EAAuC0B,EAA8C,CACxH,IAAMxB,EAAU,IAAIF,EAAY1I,EAAI,MAAM,EACpCmL,EAAMf,EAAKxB,CAAO,EACxB,OAAAE,GAAWF,EAAS5I,EAAKmL,CAAG,EACrBA,CACX,CCzmEO,IAAeC,GAAf,KAA4C,CAA5C,cACH,eAAY,SACZ,aAAoBC,GAEpB,KAAU,YAA+C,IAAM,CAAC,EAChE,KAAU,cAAgB,GAE1B,qBAAkB,OAAO,OAAO,CAAC,EAAaC,EAAe,EAE7D,cAAW,GACX,KAAU,WAAa,EACvB,KAAU,UAAY,GACtB,KAAU,QAAyB,CAAC,EACpC,KAAU,MAA8C,KACxD,KAAU,mBAAqB,GAE/B,MAAM,KAAKC,EAAwB,CAC/B,GAAI,CAACA,EACD,OAAO,KAAK,MAAM,qBAAqB,EAE3C,GAAI,CAACA,EAAQ,OACT,OAAO,KAAK,MAAM,4CAA4C,EAGlE,KAAK,QAAUA,EACf,KAAK,YAAcA,EAAQ,OAEvBA,EAAQ,QACR,KAAK,MAAQA,EAAQ,OAErBA,EAAQ,SACR,KAAK,OAASA,EAAQ,QAG1B,KAAK,UAAY,GAGjB,KAAK,WAAW,CAAC,KAAM,MAAM,CAAC,CAClC,CAEA,MAAMC,EAAuB,CACzB,MAAO,OAAOA,GAAU,SAAW,IAAI,MAAMA,CAAK,EAAIA,CAC1D,CAEA,SAASC,EAAY,CACjB,KAAK,WAAW,CACZ,KAAM,WACN,MAAAA,CACJ,CAAC,CACL,CAEA,eAAyC,CACrC,MAAM,IAAI,MAAM,wDAAwD,CAC5E,CAEA,SAASC,EAAsB,CAC3B,MAAM,IAAI,MAAM,mDAAmD,CACvE,CAEA,cAA8B,CAC1B,OAAO,KAAK,OAChB,CAEA,WAAWA,EAAiD,CACxD,OAAQA,EAAM,CACV,IAAK,QAAS,OAAO,KAAK,MAC1B,IAAK,SAAU,OAAO,KAAK,OAC3B,QAAS,OAAO,IACpB,CACJ,CAEA,QAAkB,CACd,OAAO,KAAK,SAChB,CAEA,IAAIC,EAAa,CACb,QAAQ,IAAIA,CAAG,CACnB,CAEA,cAAcC,EAAkB,CAC5B,MAAM,IAAI,MAAM,wDAAwD,CAC5E,CAEA,OAAOC,EAAuB,CAC1B,GAAI,CAIA,GAHA,KAAK,cAAgB,GACrB,KAAK,mBAAqB,GAEtBA,EAAK,OAAS,QACd,OAAO,KAAK,MAAMA,EAAK,OAAO,EAElC,GAAIA,EAAK,OAAS,OACd,OAEJ,GAAIA,EAAK,OAAS,QAAS,CACvB,WAAW,IAAM,KAAK,WAAW,CAAC,KAAM,SAAS,CAAC,EAAG,GAAI,EACzD,MACJ,CACA,GAAIA,EAAK,OAAS,SACd,OAAO,KAAK,MAAM,wBAAyBA,EAAa,IAAI,EAAE,EAGlE,GAAIA,EAAK,MAAQ,KAAK,WAAY,CAC9B,KAAK,IAAI,wCAAwCA,EAAK,GAAG,EAAE,EAC3D,MACJ,CACA,KAAK,WAAaA,EAAK,IAEnB,KAAK,UACL,KAAK,QAAQ,EAAK,EAIlBA,EAAK,OACL,KAAK,cAAcA,EAAK,KAAK,EAE7BA,EAAK,SACL,KAAK,eAAeA,EAAK,OAAO,EAEhCA,EAAK,SACL,KAAK,eAAeA,EAAK,OAAO,EAEhCA,EAAK,OACL,KAAK,cAAcA,EAAK,KAAK,EAG7BA,EAAK,QAAU,SACX,KAAK,QACL,cAAc,KAAK,KAAK,EACxB,KAAK,MAAQ,MAEbA,EAAK,QACL,KAAK,MAAQ,YAAY,IAAM,KAAK,QAAQ,EAAGA,EAAK,KAAK,IAI7DA,EAAK,cACL,KAAK,oBAAoBA,EAAK,YAAY,EAI9C,KAAK,SAAW,IACZA,EAAK,SAAWA,EAAK,eACrB,KAAK,QAAQ,EAAI,EAGjBA,EAAK,cACL,KAAK,cAAgB,GACrB,KAAK,YAAYA,EAAK,WAAW,GAIjC,OAAOA,EAAK,eAAmB,KAAe,KAAK,QAAQ,qBAC3D,KAAK,YAAYA,EAAK,cAAc,EAGpCA,EAAK,SACL,KAAK,KAAK,CAElB,OACOC,EAAK,CACR,KAAK,MAAMA,CAAY,CAC3B,CACJ,CAEA,QAAQH,EAAU,CACd,QAAQ,KAAKA,CAAG,CACpB,CAGU,YAAYE,EAAW,CAAC,CAExB,cAAyB,CAC/B,MAAO,CAAC,OAAO,CACnB,CAEU,MAAO,CAAC,CAER,oBAAoBA,EAA6B,CACvD,GAAIA,EAAK,OAAS,iBAAkB,CAChC,IAAME,EAAaC,GAAiC,KAAK,WAAW,CAChE,KAAM,kBACN,SAAU,iBACV,MAAOA,CACX,CAAC,EAED,GAAI,CACK,KAAK,OAIN,KAAK,OAAO,KAAKH,EAAK,WAAa,OAAQA,EAAK,SAAUA,EAAK,OAAQE,CAAS,EAHhF,WAAW,IAAMA,EAAU,IAAI,EAAG,CAAC,CAK3C,OACOE,EAAI,CACP,KAAK,IAAI,+BAA+BA,CAAE,EAAE,EAG5C,WAAW,IAAMF,EAAU,IAAI,EAAG,CAAC,CACvC,CACJ,MAEI,KAAK,MAAO,2CAA2CF,EAAK,IAAI,EAAG,CAE3E,CAEU,SAAU,CACX,KAAK,UACN,KAAK,WAAW,CAAC,KAAM,OAAO,CAAC,CAEvC,CAEA,eAAqB,CAAC,CAEtB,WAAWK,EAA6B,CACpC,GAAI,OAAK,UAAYA,EAAG,OAAS,mBAGjC,IAAI,KAAK,mBAAoB,CACzB,QAAQ,IAAI,8CAA+CA,CAAE,EAC7D,MACJ,CAGA,OAFA,KAAK,mBAAqB,GAC1BA,EAAG,IAAM,KAAK,WACNA,EAAG,KAAM,CACb,IAAK,UACDA,EAAG,QAAU,KAAK,gBAClB,MACJ,IAAK,OACDA,EAAG,QAAU,KAAK,gBAClBA,EAAG,QAAU,KAAK,aAAa,EAC/B,MACJ,IAAK,kBACDA,EAAG,SAAW,iBACd,KACR,CACA,KAAK,YAAYA,CAA8B,EACnD,CAEU,YAAYC,EAAgB,CAAC,CAQ3C,EC5TO,SAASC,GAAOC,EAAaC,EAAuC,CACvE,OAAO,EAAE,IAAID,CAAG,IAAK,CAAC,MAASC,CAAS,CAAC,CAC7C,CAGO,IAAMC,GAAN,KAAU,CASb,YAAYC,EAQT,CACC,KAAK,gBAAkBA,EAAQ,gBAC/B,KAAK,gBAAkBA,EAAQ,gBAC/B,KAAK,aAAeA,EAAQ,aAC5B,KAAK,YAAcA,EAAQ,YAC3B,KAAK,eAAiBA,EAAQ,eAC9B,KAAK,OAASA,EAAQ,OACtB,KAAK,cAAgBA,EAAQ,aACjC,CAGA,OAAOH,EAAaI,EAAYC,EAA2C,CACvE,OAAAA,IAAU,CAAC,EAEP,OAAOA,GAAU,WACjBA,EAAQ,CACJ,MAAOA,CACX,GAEJA,EAAM,GAAK,KAAK,OAASD,EAClB,EAAE,IAAIJ,CAAG,IAAKK,CAAK,CAC9B,CAEA,UAAgC,CAC5B,OAAO,EAAE,IAAI,KAAK,WAAW,GAAI,KAAK,eAAe,CACzD,CAGA,GAAGD,EAAiC,CAChC,OAAO,EAAE,IAAI,KAAK,MAAM,GAAGA,CAAE,GAAI,KAAK,eAAe,CACzD,CAEA,YAAkC,CAC9B,OAAO,EAAE,IAAI,KAAK,aAAa,GAAI,KAAK,eAAe,CAC3D,CACJ,EAKO,SAASE,IAAkB,CAC9B,OAAI,eACQ,eAAe,MAAQ,EAAK,KAEjC,EACX,CC/DA,SAASC,GAASC,EAA0D,CACxE,MAAO,CACH,OAAQA,EAAG,YAAY,EACvB,MAAOA,EAAG,WAAW,CACzB,CACJ,CAGA,SAASC,GAAeC,EAAwCC,EAAiD,CAC7G,OAAQA,EAAW,mBAAqBD,EAAW,kBAC/CC,EAAW,kBAAoBD,EAAW,iBAC1CC,EAAW,iBAAmBD,EAAW,gBACzCC,EAAW,gBAAkBD,EAAW,eACxCC,EAAW,SAAWD,EAAW,QACjCC,EAAW,QAAUD,EAAW,KACxC,CAEA,IAAME,GAAU,8BAA8B,KAAK,UAAU,SAAS,EAEjDC,GAArB,KAA6B,CAOzB,YAAYC,EAAmB,CA4H/B,wBAAqBC,GAAS,SAAY,CAEtC,GAAI,KAAK,OAAO,UAAY,CAAC,KAAK,OAAO,OAAO,EAAG,CAC/C,KAAK,mBAAmB,EACxB,MACJ,CACA,IAAMJ,EAAa,OAAO,OAAO,CAAC,EAAG,KAAK,OAAO,EACjD,MAAM,KAAK,QAAQ,EACfF,GAAe,KAAK,QAASE,CAAU,GACvC,KAAK,OAAO,WAAW,CAAC,KAAM,SAAS,CAAC,CAEhD,EAAG,IAAK,CAAC,QAAS,EAAK,CAAC,EAExB,8BAA2B,IAAM,CAE7B,GAAIK,GAAgB,EAChB,OAKJ,IAAMC,EAAW,KAAK,OAAO,IAAI,SAAS,EACpCC,EAAkB,SAAS,eAAe,UAAY,QAOxDN,IACAK,EAAS,YAAY,WAAYC,CAAe,EAGpDD,EAAS,YAAY,eAAgB,OAAQ,EAAI,EAGjD,OAAO,SAAS,EAAG,CAAC,EAGpB,KAAK,mBAAmB,CAC5B,EAnKI,KAAK,OAASH,EACd,KAAK,QAAUA,EAAO,gBAIlB,SAAS,aAAe,WACxB,KAAK,OAAS,QAAQ,QAAQ,EAG9B,KAAK,OAAS,IAAI,QAASK,GAAiB,CACxC,OAAO,iBAAiB,OAAQA,EAAS,CAAC,KAAM,EAAI,CAAC,CACzD,CAAC,EAID,OAAO,gBACP,KAAK,SAAW,IAAI,eAAe,KAAK,kBAAkB,EAC1D,KAAK,SAAS,QAAQ,KAAK,OAAO,IAAI,SAAS,EAAE,CAAC,CAAC,GAGnD,EAAE,MAAM,EAAE,GAAG,SAAU,KAAK,kBAAkB,EAE9C,gBACA,EAAE,cAAc,EAAE,GAAG,SAAU,KAAK,wBAAwB,CAEpE,CAEA,SAAU,CACF,KAAK,SACL,KAAK,SAAS,WAAW,EAGzB,EAAE,MAAM,EAAE,IAAI,SAAU,KAAK,kBAAkB,EAE/C,gBACA,EAAE,cAAc,EAAE,IAAI,SAAU,KAAK,wBAAwB,CAErE,CAEA,MAAM,SAAU,CAEZ,IAAMC,EAAM,KAAK,OAAO,IAClBH,EAAWG,EAAI,SAAS,EAC9B,GAAI,CAACH,EAAS,OACV,MAAM,IAAI,MAAM,iCAAiCG,EAAI,WAAW,EAAE,EAItEA,EAAI,GAAG,gBAAgB,EAAE,OAAO,EAGhC,IAAMC,EAAmBD,EAAI,OAAO,MAAO,kBAAkB,EAC7DC,EAAiB,KAAK,4BAA4B,EAGlD,IAAMC,EAAO,EAAE,OAAO,EACtBC,GAAO,OAAQ,cAAc,EAAE,KAAK,UAAU,EAAE,SAASD,CAAI,EAE7D,IAAME,EAASD,GAAO,MAAO,0BAA0B,EACjDE,EAAcF,GAAO,MAAO,mBAAmB,EAAE,SAASC,CAAM,EAChEE,EAAWJ,EAAK,MAAM,EAAE,SAAS,YAAY,EAAE,SAASG,CAAW,EACnEE,EAAWL,EAAK,MAAM,EAAE,SAAS,YAAY,EAAE,SAASG,CAAW,EACzEF,GAAO,OAAQ,iBAAiB,EAAE,SAASI,CAAQ,EACnD,IAAMC,EAAUF,EAAS,SAAS,MAAM,EACxCL,EAAiB,OAAOG,CAAM,EAE9B,IAAMK,EAAWN,GAAO,MAAO,4BAA4B,EACrDO,EAAc,EAAE,WAAY,CAC9B,OAAQ,GACR,MAAO,EACX,CAAC,EAAE,SAASD,CAAQ,EACpBR,EAAiB,OAAOQ,CAAQ,EAEhC,IAAME,EAAUR,GAAO,MAAO,wBAAwB,EAChDS,EAAYV,EAAK,MAAM,EAAE,SAAS,UAAU,EAAE,SAASS,CAAO,EAC9DE,EAAYX,EAAK,MAAM,EAAE,SAAS,UAAU,EAAE,SAASS,CAAO,EAC9DG,EAAWF,EAAU,SAAS,MAAM,EAC1CX,EAAiB,OAAOU,CAAO,EAE/Bd,EAAS,OAAOI,CAAgB,EAGhC,MAAM,KAAK,OAEX,IAAMc,GAAc,iBAAiBJ,EAAQ,CAAC,CAAC,EAAE,iBAAiB,2BAA2B,EAAE,MAAM,GAAG,EAAE,CAAC,EAAE,QAAQ,KAAM,EAAE,EAC7H,MAAM,SAAS,MAAM,KAAK,QAAQI,EAAW,EAAE,EAG/C,KAAK,QAAQ,OAASlB,EAAS,OAAO,EACtC,KAAK,QAAQ,MAAQA,EAAS,MAAM,EAGpC,IAAMmB,EAAa7B,GAASiB,CAAM,EAC5Ba,GAAc9B,GAASqB,CAAO,EAC9BU,GAAe/B,GAASmB,CAAQ,EAChCa,GAAehC,GAASoB,CAAQ,EAEtC,KAAK,QAAQ,iBAAmB,KAAK,IAAI,EAAGA,EAAS,SAAS,EAAE,IAAMD,EAAS,SAAS,EAAE,GAAG,EAC7F,KAAK,QAAQ,gBAAkB,KAAK,IAAI,EAAGE,EAAQ,MAAM,EAAK,CAAC,EAC/D,KAAK,QAAQ,cAAgBQ,EAAW,MAAQC,GAAY,MAC5D,KAAK,QAAQ,cAAgBD,EAAW,QAAUE,GAAa,OAASC,GAAa,QAGrF,IAAMC,GAAkBjC,GAASsB,CAAQ,EACnCY,EAAalC,GAASuB,CAAW,EACvC,KAAK,QAAQ,gBAAkBU,GAAgB,MAAQC,EAAW,MAClE,KAAK,QAAQ,gBAAkBD,GAAgB,OAASC,EAAW,OAGnE,IAAMC,GAAcnC,GAASwB,CAAO,EAC9BY,GAAepC,GAAS2B,CAAQ,EAChCU,GAAgBrC,GAASyB,CAAS,EAClCa,GAAgBtC,GAAS0B,CAAS,EAExC,KAAK,QAAQ,eAAiB,KAAK,IAAI,EAAGA,EAAU,SAAS,EAAE,IAAMD,EAAU,SAAS,EAAE,GAAG,EAC7F,KAAK,QAAQ,cAAgB,KAAK,IAAI,EAAGE,EAAS,MAAM,EAAK,CAAC,EAC9D,KAAK,QAAQ,YAAcQ,GAAY,MAAQC,GAAa,MAC5D,KAAK,QAAQ,YAAcD,GAAY,QAAUE,GAAc,OAASC,GAAc,QAGtFxB,EAAiB,OAAO,CAC5B,CA2CJ,ECjMA,IAAqByB,GAArB,KAAwC,CAUpC,YAAYC,EAAwBC,EAAkB,CATtD,aAAU,GACV,aAAoDC,GAAS,KAAK,YAAYA,CAAK,EAEnF,WAAQ,GACR,aAAU,KAAK,IAAI,EAAI,KAAK,KAAK,KAAK,OAAO,EAAI,GAAK,EAAE,SAAS,EAAE,EAEnE,SAAM,GAIF,KAAK,QAAUD,EACXD,EAAQ,oBACR,KAAK,QAAU,GACf,KAAK,QAAUA,EAAQ,kBACvB,KAAK,IAAM,oBAEXA,EAAQ,gBACR,KAAK,QAAU,GACf,KAAK,IAAMA,EAAQ,eAEvB,KAAK,MAAQA,EAAQ,iBAAmB,GACpC,KAAK,SACL,QAAQ,IAAI,wCAAwC,KAAK,OAAO,KAAK,KAAK,KAAK,kBAAkB,KAAK,GAAG,EAAE,CAEnH,CAGA,aAAaG,EAA6B,CACtC,KAAK,MAAQA,EACb,KAAK,UAAY,KAAK,IAAI,CAC9B,CAGA,cAAcD,EAA6B,CACvC,GAAI,CAACA,EAAM,QACP,OAIJ,IAAME,EAAQ,KAAK,MACbC,EAAYD,EAAM,KACpBE,EAAQ,GACZ,GAAID,IAAc,QAAUA,IAAc,OACtCC,EAASF,EAAkD,cAEtD,EAAE,CAACC,GAAaA,IAAc,YAAcA,IAAc,QAAUA,IAAc,mBACvF,OAIJ,IAAIE,EAAS,GACb,QAAWC,KAAUN,EAAM,QAAS,CAChC,IAAMO,EAAM,KAAK,QAAQ,IAAID,EAAO,EAAE,EACtC,GAAI,CAACC,GAAOA,EAAI,OAAS,SACrB,SAEJ,IAAMC,EAAYF,EAA8C,MAAQ,CAAC,EACzE,QAAWG,KAAQD,EAAU,CACpBC,EAAK,SACNJ,GAAU;AAAA,GAEd,IAAMK,EAAUD,EAAK,QACrB,GAAKC,GAAS,OAGd,QAASC,EAAY,EAAGA,EAAYD,EAAQ,OAAQC,IAAa,CAC7D,IAAMC,EAAcF,EAAQC,CAAS,EACjC,OAAOC,GAAgB,SACvBP,GAAUK,EAAQ,EAAEC,CAAS,EAExB,SAAUC,IACfP,GAAUO,EAAY,KAE9B,CACJ,CACJ,CAEA,KAAK,QAAQ,CACT,OAAQ,SACR,MAAAR,EACA,MAAO,KAAK,MACZ,OAAAC,EACA,aAAc,KAAK,IAAI,EACvB,UAAW,KAAK,QAChB,UAAW,KAAK,SACpB,CAAC,CACL,CAEA,MAAM,YAAYL,EAAgC,CAC9C,GAAI,CACA,IAAMa,EAAW,MAAM,MAAM,KAAK,IAAK,CACnC,KAAM,KAAK,UAAUb,CAAK,EAC1B,QAAS,CACL,eAAgB,kBACpB,EACA,OAAQ,MACZ,CAAC,EAED,GAAI,CAACa,EAAS,GACV,MAAM,IAAI,MAAM,2CAA2CA,EAAS,MAAM,EAAE,CAEpF,OACOC,EAAU,CACb,KAAK,QAAU,GACf,QAAQ,IAAI,kDAAkDA,CAAY,EAAE,CAChF,CACJ,CACJ,EC1GA,IAAMC,GAAqB,GAEdC,GAAN,KAAgB,CAMnB,YAAYC,EAAgB,CAJ5B,mBAAgB,EAChB,aAAU,GAIN,KAAK,OAASA,EAId,KAAK,GAAK,EAAE,aAAc,CACtB,cAAe,OACf,eAAgB,MAChB,MAAO,QACP,KAAM,CACF,OAAAA,CACJ,EACA,GAAI,CACA,KAAM,IAAM,KAAK,OAAO,EACxB,MAAO,IAAM,KAAK,QAAQ,EAC1B,MAAQC,GAAY,KAAK,QAAQA,CAAE,EACnC,QAAUA,GAA4B,KAAK,UAAUA,CAAE,EACvD,SAAWA,GAA6B,KAAK,WAAWA,CAAE,CAC9D,EACA,KAAM,CACV,CAAC,EACI,KAAK,WAAY,EAAI,EACrB,SAASD,EAAO,OAAO,CAChC,CAEA,SAAU,CACN,KAAK,GAAG,OAAO,CACnB,CAEQ,QAAS,CACbE,GAAc,CAClB,CAEQ,SAAU,CAEV,KAAK,OAAO,OAAS,UAAY,CAACC,GAAgB,GAClD,KAAK,OAAO,iBAAiB,EAGjCD,GAAc,CAClB,CAGQ,QAAQD,EAAS,CAErB,GAAI,CAAC,KAAK,OAAO,QAAQ,KACrB,YAAK,GAAG,QAAQ,MAAM,EACf,GAGX,GAAI,KAAK,OAAO,OAAO,OAAS,OAAQ,CACpC,IAAMG,EAAOH,EAAG,OAAO,MAAM,CAAC,EAC9B,YAAK,YAAYG,CAAI,EAEjBA,IAAS,KACT,KAAK,GAAG,QAAQ,MAAM,EAAE,QAAQ,OAAO,EAEpC,EACX,CACJ,CAEQ,UAAUH,EAAyB,CAEvC,GAAI,CAAC,KAAK,OAAO,QAAQ,KACrB,YAAK,GAAG,QAAQ,MAAM,EACf,GAGX,IAAMI,EAAUJ,EAAG,MACnB,GAAKI,EAIL,IAAI,KAAK,SAEL,GAAIA,IAAYC,IAAiBD,IAAYE,GAAa,CACtD,IAAMC,EAAU,KAAK,OAAO,QAAQ,QAChCC,EACJ,OAAIJ,IAAYC,IAAiB,KAAK,cAAgB,GAClD,KAAK,gBACLG,EAAU,GAELJ,IAAYE,IAAe,KAAK,cAAgBC,EAAQ,SAC7D,KAAK,gBACLC,EAAU,GAEVA,GACA,KAAK,GAAG,IAAI,KAAK,gBAAkB,EAAI,GAAKD,EAAQ,KAAK,cAAgB,CAAC,CAAC,EAExE,EACX,SAGS,KAAK,OAAO,OAAQ,YAAa,CACtC,IAAME,EAAaC,GAAmBN,CAAO,EAC7C,GAAI,KAAK,OAAO,OAAQ,YAAY,SAASK,CAAU,EACnD,YAAK,YAAYT,EAAG,OAAO,MAAOS,CAAU,EACrC,EAEf,MAGC,CACD,IAAME,EAAOD,GAAmBN,CAAO,EACvC,GAAIO,EACA,YAAK,YAAYA,CAAI,EACd,EAEf,CAGAX,EAAG,gBAAgB,EACvB,CAEQ,WAAWA,EAA0B,CAEzC,GAAI,CAAC,KAAK,OAAO,QAAQ,KACrB,YAAK,GAAG,QAAQ,MAAM,EACf,GAGX,IAAMI,EAAUJ,EAAG,MACnB,GAAKI,EAKL,GAAI,KAAK,SACL,GAAIA,IAAYQ,GACZ,YAAK,YAAYZ,EAAG,OAAO,KAAK,EACzB,OAIV,CACD,IAAMW,EAAOP,IAAYQ,GAAkB,SAAW,OAAO,aAAaR,CAAO,EACjF,YAAK,YAAYO,CAAI,EACd,EACX,CACJ,CAIA,SAAU,CACF,KAAK,OAAO,OAAS,UACA,KAAK,OAAO,QAAQ,YAAY,EAAK,KAAK,OAAO,gBACnD,KAAK,OAAO,uBAInC,KAAK,GAAG,CAAC,EAAE,MAAM,CAAC,cAAe,EAAI,CAAC,CAC1C,CAEA,OAAQ,CACJ,KAAK,cAAgB,EACrB,KAAK,GACA,KAAK,CACF,cAAe,OACf,MAAO,OACX,CAAC,EACA,IAAI,CACD,mBAAoB,GACpB,MAAO,GACP,KAAME,GACN,IAAK,GACL,MAAO,EACX,CAAC,EACA,IAAI,EAAE,EACX,IAAMC,EAAc,KAAK,OAAO,OAAS,SAAW,KAAK,OAAO,QAAU,KAAK,OAAO,QACjF,KAAK,GAAG,OAAO,EAAE,GAAGA,CAAW,GAChC,KAAK,GAAG,SAASA,CAAW,CAEpC,CAEQ,YAAYC,EAAa,CAC7B,KAAK,OAAO,gBAAgB,CACxB,KAAM,OACN,MAAOA,CACX,CAAC,CACL,CAEQ,YAAYA,EAAaN,EAAsC,CAEnE,IAAMF,EAAU,KAAK,OAAO,QAAQ,QAChCQ,GAAOA,IAAQR,EAAQ,CAAC,IACxBA,EAAQ,QAAQQ,CAAG,EACfR,EAAQ,OAASV,KACjBU,EAAQ,OAASV,KAIzB,KAAK,OAAO,gBAAgB,CACxB,KAAM,OACN,WAAAY,EACA,MAAOM,CACX,CAAC,CACL,CAEA,QAAS,CAEL,KAAK,MAAM,EAEX,IAAMC,EAAS,KAAK,OAAO,OAC3B,GAAI,EAAAA,EAAO,OAAS,QAAUA,EAAO,OAAS,QAc9C,IAXA,KAAK,QAAUA,EAAO,OAAS,OAG/B,KAAK,GACA,KAAK,CACF,cAAe,QACf,UAAW,KAAK,QAAUA,EAAO,OAAU,CAC/C,CAAC,EACA,KAAK,WAAY,EAAK,EACtB,IAAIA,EAAO,SAAW,EAAE,EAEzB,KAAK,QAAS,CACd,GAAI,KAAK,OAAO,OAAS,WACrB,MAAM,IAAI,MAAM,gDAAgD,KAAK,OAAO,EAAE,EAAE,EAEpF,KAAK,GAAG,SAAS,WAAW,CAChC,CAGA,OAAQ,KAAK,OAAO,KAAM,CACtB,IAAK,UACA,KAAK,OAAO,UAAY,KAAK,OAAO,SAAS,OAAO,KAAK,EAAE,EAC5D,MACJ,IAAK,OAAQ,CACT,IAAMC,EAAU,KAAK,OAAO,QAC5B,KAAK,GAAG,IAAI,CACR,KAAMD,EAAO,KAAQC,EAAQ,cAAiBA,EAAQ,YAAc,EACpE,IAAKD,EAAO,KAAQC,EAAQ,eAAkBA,EAAQ,YAAc,EACpE,OAAQD,EAAO,QAAU,GAAKC,EAAQ,aAC1C,CAAC,EACD,KACJ,CACJ,CAGA,GAAI,KAAK,OAAO,OAAS,WAAY,CACjC,IAAMC,EAAa,KAAK,OAAO,gBAC/B,GAAIA,EAAY,CACZ,IAAMC,EAAU,CAAC,CAACD,EAAW,QAC7B,KAAK,GAAG,YAAY,UAAWC,CAAO,EACtCC,GAAsBF,EAAYC,EAAS,KAAK,EAAE,CACtD,CACJ,EACJ,CACJ,EAQMlB,GAAgBoB,GAAS,IAAM,CACjC,SAASC,EAAUC,EAAe,CAC9B,OAAO,SAAS,EAAG,CAAC,EAChBA,EAAQ,GACR,WAAWD,EAAW,GAAIC,EAAQ,CAAC,CAE3C,CACAD,EAAU,EAAE,CAChB,EAAG,GAAI,EC5QP,SAASE,IAA4B,CACjC,OAAQ,OAAO,aAAa,EAAI,IAAQ,EAC5C,CAaA,IAAeC,GAAf,KAA0B,CAYtB,YAAYC,EAAmC,CAV/C,aAAU,GAWN,KAAK,MAAQA,EAAQ,MACrB,KAAK,IAAMA,EAAQ,IACnB,KAAK,GAAKA,EAAQ,GAClB,KAAK,QAAUA,EAAQ,QACvB,KAAK,QAAUA,EAAQ,QACvB,KAAK,KAAOA,EAAQ,KAEpB,KAAK,QAAU,KAAK,IAAI,OAAO,MAAO,SAASA,EAAQ,EAAE,GAAI,CACzD,MAAO,eAAeC,GAAa,KAAK,IAAI,CAAC,eAAeD,EAAQ,IAAI,GACxE,MAAQE,GAA0B,KAAK,QAAQA,CAAE,CACrD,CAAC,EACI,SAAS,KAAK,IAAI,WAAW,CAAC,EAGnC,KAAK,UAAY,IAAIC,GAAU,IAAqB,CACxD,CAEA,QAAQC,EAAuB,CAC3B,KAAK,UAAU,QAAQ,EACnBA,EACA,KAAK,QAAQ,OAAO,EAGpB,KAAK,OAAS,MAEtB,CAGA,gBAAiB,CAAC,CAER,QAAQF,EAAuB,CACrC,GAAI,KAAK,QAAQ,MAAQJ,GAAiB,EACtC,YAAK,UAAU,GAAG,QAAQ,OAAO,EAC1B,EAEf,CAEA,gBAAgBI,EAAsD,CAElE,KAAK,eAAe,EACpB,KAAK,UAAU,MAAM,EAErB,KAAK,OAAQ,KAAO,OAEpB,KAAK,QAAQ,cAAgB,KAE7BA,EAAG,OAAS,KAAK,GACjB,KAAK,QAAQ,WAAWA,CAAE,CAC9B,CACJ,EAGO,SAASG,GAAsBC,EAAqCC,EAAkBC,EAAyB,CAElH,IAAMC,EAAS,OAAO,OAAO,CAAC,EAAGH,CAAW,EAE5C,GAAIC,EAAS,CACT,IAAMG,EAAKD,EAAO,kBAAkB,EAC9BE,EAAKF,EAAO,MACdC,EACAD,EAAO,MAAQC,EAGf,OAAOD,EAAO,MAEdE,EACAF,EAAO,kBAAkB,EAAIE,EAG7B,OAAOF,EAAO,kBAAkB,EAEpC,OAAOA,EAAO,OAClB,CACAD,EAAG,IAAIC,CAAM,CACjB,CAGA,SAASG,GAAmBC,EAAwB,CAChD,IAAMC,EAAgB,CAAC,EAAE,EACnBC,EAAa,KACfC,EAAkB,GACtB,QAAWC,KAAKJ,EAAM,CAClB,IAAMK,EAAgBH,EAAW,KAAKE,CAAC,EACnC,CAACC,GAAiBF,GAClBF,EAAI,QAAQ,EAAE,EAElBA,EAAI,CAAC,GAAKG,EACVD,EAAkBE,CACtB,CACA,OAAAJ,EAAI,QAAQ,EACLA,CACX,CAEA,IAAeK,GAAf,cAAqCpB,EAAW,CAM5C,YAAYC,EAAmC,CAC3C,MAAMA,CAAO,EAGb,IAAMoB,EAAUC,GAAwB,KAAK,OAAOA,CAAM,EAC1D,KAAK,QAAQ,GAAG,QAAS,IAAK,UAAW,CAACD,EAAO,IAAI,CAAC,CAAC,EAGnDpB,EAAQ,SACR,KAAK,OAASA,EAAQ,OACtB,KAAK,eAAe,EAE5B,CAGA,gBAAiB,CACb,IAAMsB,EAAW,UAAU,KAAK,EAAE,GAC5Bb,EAAgC,CAAC,EACvC,GAAI,KAAK,OAAQ,CAEb,OAAW,CAACc,EAAUC,CAAe,IAAK,OAAO,QAAQ,KAAK,MAAM,EAAG,CACnE,IAAMC,EAAgB,GAAGH,CAAQ,IAAIC,CAAQ,GAAG,KAAK,EAC/CG,EAAajB,EAAOgB,CAAa,EAAI,OAAO,OAAO,CAAC,EAAGD,CAAe,EAG5E,GAAID,EAAU,CACV,IAAMb,EAAKgB,EAAW,kBAAkB,EAClCf,EAAKe,EAAW,MACtB,GAAIhB,GAAMC,EAAI,CACV,IAAMgB,EAAyClB,EAAO,GAAGgB,CAAa,UAAU,EAAI,CAAC,EACjFf,IACAiB,EAAe,MAAQjB,GAEvBC,IACAgB,EAAe,kBAAkB,EAAIhB,EAE7C,CAGA,OAAOe,EAAW,UAGdA,EAAW,UACX,OAAOA,EAAW,kBAAkB,EACpC,OAAOA,EAAW,OAEtB,OAAOA,EAAW,QAGd,OAAO,KAAKA,CAAU,EAAE,SAAW,GACnC,OAAOjB,EAAOgB,CAAa,CAEnC,CACJ,CAIIhB,EAAO,GAAGa,CAAQ,mBAAmB,IACrCb,EAAO,GAAGa,CAAQ,aAAa,EAAIb,EAAO,GAAGa,CAAQ,mBAAmB,EAEhF,CAGA,IAAMM,EAAgBnB,EAAO,GAAGa,CAAQ,oBAAoB,EACtDZ,EAAK,KAAK,IAAMkB,IAAgB,kBAAkB,EAClDjB,EAAK,KAAK,IAAMiB,GAAe,OACjClB,GAAMC,KACDF,EAAOa,CAAQ,IAChBb,EAAOa,CAAQ,EAAI,CAAC,GAExBb,EAAOa,CAAQ,EAAE,kBAAkB,EAAIZ,GAAM,gBAAgB,KAAK,IAAI,OACtED,EAAO,GAAGa,CAAQ,UAAU,EAAI,CAC5B,mBAAoBX,GAAM,gBAAgB,KAAK,IAAI,cACvD,GAIA,OAAO,KAAKF,CAAM,EAAE,SACpB,KAAK,QAAQ,SAAS,OAAO,EAAE,OAAO,EACtC,KAAK,QAAQ,QAAQ,UAAU,OAAO,QAAQA,CAAM,EAAE,IAAIoB,GAAQ,CAC9D,GAAM,CAACN,EAAUO,CAAU,EAAID,EAC/B,MAAO,GAAGN,CAAQ,KAAK,OAAO,QAAQO,CAAU,EAAE,IAAIC,GAAY,CAC9D,GAAM,CAACC,EAAMC,CAAK,EAAIF,EACtB,MAAO,GAAGC,CAAI,KAAKC,CAAK,EAC5B,CAAC,EAAE,KAAK,IAAI,CAAC,GACjB,CAAC,EAAE,KAAK;AAAA,CAAI,CAAC,UAAU,EAE/B,CAEA,gBAAgBC,EAAuBC,EAA4C,CAC/E,IAAMC,EAAYF,EAAI,MAEhBG,EAAgBH,EAAI,YAAY,WAAa,KAAK,SAAS,cAAcE,CAAS,EAAE,GAAG,UACzFE,EAAkB,GAElB,OAAOD,EAAkB,MACrBD,IAAc,eACTC,IACDC,EAAkB,iBAGjBD,IACLC,EAAkB,eAI1B,IAAM/B,EAAU2B,EAAI,YAAY,SAAW,KAAK,SAAS,cAAcE,CAAS,EAAE,GAAG,QAE/E5B,EAAK+B,GAAO,OAAQ,SAASH,CAAS,GAAG7B,EAAU,WAAa,EAAE,GAAG+B,CAAe,EAAE,EACxFJ,EAAI,YACJ7B,GAAsB6B,EAAI,WAAY,CAAC,CAAC3B,EAASC,CAAE,EAGnD,OAAO2B,EAAgB,MACvBA,EAAc,CAAC,CAACE,GAAiBD,IAAc,gBAEnD,IAAMI,EAAML,EACN,EAAEvB,GAAmBsB,EAAI,IAAI,EAAE,IAAIrB,GAAQL,EAAG,MAAM,EAAE,KAAKK,CAAI,EAAE,CAAC,CAAC,CAAC,EACpEL,EAAG,KAAK0B,EAAI,IAAI,EAEtB,OAAIA,EAAI,UACG,EAAE,MAAO,CACZ,KAAM,CACF,QAASA,EAAI,SACjB,EACA,KAAM,GACV,CAAC,EACI,OAAOM,CAAG,EAEZA,CACX,CAEA,OAAOnB,EAAqB,CACxB,IAAMoB,EAAU,EAAEpB,CAAM,EAAE,KAAK,SAAS,EACxC,GAAIoB,EACA,OAAI,KAAK,QAAQ,WACb,KAAK,QAAQ,WAAW,CACpB,KAAM,YACN,MAAOA,EACP,OAAQ,KAAK,EACjB,CAAC,EAEE,EAEf,CAGA,eAAe/B,EAAaC,EAAa,CACrC,IAAI+B,EACA,OAAOhC,EAAO,KAAeA,IAAO,KAAK,KACzC,KAAK,GAAKA,EACVgC,EAAyB,GAEzB,OAAO/B,EAAO,KAAeA,IAAO,KAAK,KACzC,KAAK,GAAKA,EACV+B,EAAyB,GAEzBA,GACA,KAAK,eAAe,CAE5B,CACJ,EAEMC,GAAmD,CACrD,aAAc,oBACd,WAAY,kBACZ,SAAU,gBACV,WAAY,kBACZ,YAAa,kBACjB,EAEaC,GAAN,cAA2BzB,EAAc,CAS5C,YAAYnB,EAAmC,CAC3C,MAAMA,CAAO,EATjB,UAAO,SAIP,KAAQ,iBAAmB,GAE3B,qBAAkB,EAoClB,KAAQ,SAAW,IAAM,CACrB,IAAM6C,EAAU,KAAK,QAAQ,CAAC,EAC9B,KAAK,iBAAmBA,EAAQ,aAAeA,EAAQ,UAAYA,EAAQ,aAAe,CAC9F,EAnCI,KAAK,QAAQ,KAAK,CACd,YAAa,SACb,KAAM,MACN,SAAU,EACd,CAAC,EACI,GAAG,SAAU,KAAK,QAAQ,EAC/B,KAAK,QAAUN,GAAO,MAAO,mBAAmB,EAC3C,OAAO,KAAK,UAAU,EAAE,EACxB,SAAS,KAAK,OAAO,EAC1B,KAAK,sBAAwB,KAAK,QAAQ,OAAO,CACrD,CAGA,gBAAiB,CACb,KAAK,sBAAwB,KAAK,QAAQ,OAAO,CACrD,CAEU,QAAQO,EAAsB,CACpC,GAAI,KAAK,QAAQ,MAAQhD,GAAiB,EAAG,CAEzC,GAAI,KAAK,UAAY,KAAK,sBAAuB,CAC7C,IAAMiD,EAAO,KAAK,SAAS,CAAC,EAAE,sBAAsB,EACpD,GAAIA,EAAK,OAAS,GAAKA,EAAK,IAAM,SAAS,gBAAgB,aACvD,MAAO,EAEf,CACA,YAAK,UAAU,GAAG,QAAQ,OAAO,EAC1B,EACX,CACJ,CASA,iBAAiBC,EAAgC,EACzC,CAACA,GAAwB,KAAK,oBAC9B,KAAK,QAAQ,UAAU,KAAK,QAAQ,OAAO,CAAE,EAC7C,KAAK,iBAAmB,GAEhC,CAEA,OAAOC,EAA0C,CAY7C,GAXIA,EAAK,QAEL,KAAK,UAAU,MAAM,EACrB,KAAK,QAAQ,SAAS,aAAa,EAAE,OAAO,EAC5C,KAAK,iBAAmB,GACxB,KAAK,SAAW,OAChB,KAAK,gBAAkB,OACvB,KAAK,eAAeA,EAAK,GAAIA,EAAK,EAAE,GAIpC,CAACA,EAAK,KACN,OAIJ,KAAK,QAAQ,KAAK,YAAa,MAAM,EAGrC,KAAK,gBAAkB,KAAK,IAAI,GAAI,KAAK,UAAU,SAAS,EAAE,KAAO,GAAK,EAAE,EAE5E,IAAIC,EAAa,EACjB,KAAOA,EAAaD,EAAK,KAAK,QAAQ,CAClC,IAAME,EAAOF,EAAK,KAAKC,GAAY,EAC7BE,EAAUD,EAAK,QACjBE,EACAC,EACJ,GAAIH,EAAK,QAAU,KAAK,SACpBE,EAAQ,KAAK,SACbC,EAAiB,UAGjBD,EAAQd,GAAO,MAAO,YAAY,EAClC,KAAK,QAAQ,OAAOc,CAAK,EACzB,KAAK,SAAWA,EACZ,CAACD,GAAS,OAAQ,CAClBC,EAAM,SAAS,WAAW,EAC1BA,EAAM,OAAOd,GAAO,OAAQ,gBAAgB,EAAE,KAAKgB,EAAI,CAAC,EACxD,QACJ,CAMJ,GAJIJ,EAAK,WACLE,EAAM,SAAS,WAAW,EAG1B,EAACD,GAAS,OAGd,QAASI,EAAY,EAAGA,EAAYJ,EAAQ,OAAQI,IAAa,CAC7D,IAAItB,EACEuB,EAAcL,EAAQI,CAAS,EACrC,GAAI,OAAOC,GAAgB,SACvBvB,EAAM,CACF,MAAOkB,EAAQI,GAAW,EAC1B,KAAMJ,EAAQI,CAAS,CAC3B,UAEK,YAAaC,GAAeA,EAAY,UAAY,QAAS,CAClE,IAAMjD,EAAK,EAAE,QAAS,CAClB,IAAKiD,EAAY,SAAW,SAASA,EAAY,KAAK,GACtD,MAAOd,GAAyBc,EAAY,WAAa,UAAU,EACnE,OAAQA,EAAY,OACpB,IAAK,KAAK,OAAS,KAAK,MAAM,cAAcA,EAAY,KAAM,GAAKA,EAAY,IAC/E,MAAOA,EAAY,KACvB,CAAC,EACD,GAAIA,EAAY,UAAW,CACvB,EAAE,MAAO,CACL,KAAM,CACF,QAASA,EAAY,SACzB,EACA,KAAM,GACV,CAAC,EACI,OAAOjD,CAAE,EACT,SAAS6C,CAAK,EACnB,QACJ,CACAA,EAAM,OAAO7C,CAAE,EACf,QACJ,MAEI0B,EAAMuB,EAELH,IACDA,EAAiB,EACjBD,EAAM,SAAS,SAASnB,EAAI,KAAK,EAAE,GAEvCmB,EAAM,OAAO,KAAK,gBAAgBnB,EAAKgB,IAAeD,EAAK,KAAK,OAAS,GAAO,MAAS,CAAC,EAE1F,KAAK,gBAAkBf,EAAI,UAC/B,CACJ,CAGKwB,GAAgB,GACjB,KAAK,QAAQ,UAAU,KAAK,eAAe,EAK/C,KAAK,QAAQ,KAAK,YAAa,OAAO,CAC1C,CACJ,EAEaC,GAAN,cAA6B5D,EAAW,CAY3C,YAAYC,EAAmC,CAC3C,MAAMA,CAAO,EAZjB,UAAO,WAGP,gBAAa,GACb,gBAAmD,CAAC,EAEpD,YAAS,EACT,iBAAsD,IAAI,IAE1D,WAAQ,EAkBR,iBAAc4D,GAAS,IAAM,CACzB,KAAK,YAAY,MAAM,CAC3B,EAAG,GAAI,EAfH,KAAK,OAAS,KAAK,IAAI,OAAO,SAAU,MAAM5D,EAAQ,EAAE,UAAW,CAC/D,KAAM,CACF,OAAQ,IACZ,CACJ,CAAC,EACD,KAAK,QAAQ,OAAO,KAAK,MAAM,EAC/B,KAAK,QAAQ,sBAAsB,QAAQ,KAAK,OAAO,CAAC,CAAC,EAGzD,KAAK,OAAS,KAAK,IAAI,OAAO,SAAU,MAAMA,EAAQ,EAAE,SAAS,CACrE,CAQA,aAAa6D,EAAsBC,EAA4B,CAC3D,IAAMC,EAAQ,IAAI,MAClB,OAAAA,EAAM,IAAMD,EACLC,EAAM,OAAO,EACf,KAAK,IAAM,CACR,KAAK,YAAY,IAAIF,EAAKE,CAAK,CACnC,CAAC,EACA,MAAM,IAAM,CAAC,CAAC,CACvB,CAEA,QAAQ3D,EAAuB,CAC3B,KAAK,QAAQ,sBAAsB,UAAU,KAAK,OAAO,CAAC,CAAC,EAC3D,MAAM,QAAQA,CAAY,CAC9B,CAEA,QAAQF,EAAuB,CAC3B,OAAI,KAAK,QAAQ,OAASA,EAAG,SAAW,GACpC,KAAK,OAAO,MAAQ,GACpB,KAAK,QAAQ,WAAW,CACpB,KAAM,QACN,OAAQ,KAAK,GACb,EAAG,KAAK,MAAMA,EAAG,QAAU,KAAK,QAAQ,gBAAkB,CAAC,EAC3D,EAAG,KAAK,MAAMA,EAAG,QAAU,KAAK,QAAQ,gBAAkB,CAAC,CAC/D,CAAC,EACM,IAEJ,MAAM,QAAQA,CAAE,CAC3B,CAEA,eAAe8D,EAAgBC,EAAe,CAE1C,KAAK,OAAO,IAAI,CAAC,OAAAD,EAAQ,MAAAC,CAAK,CAAC,EAC/B,KAAK,OAASD,EACd,KAAK,MAAQC,EAEb,IAAMC,EAAM,iBACZF,EAASA,EAASE,EAClBD,EAAQA,EAAQC,EAChB,KAAK,OAAO,KAAK,CAAC,OAAAF,EAAQ,MAAAC,CAAK,CAAC,EAChC,KAAK,OAAO,KAAK,CAAC,OAAAD,EAAQ,MAAAC,CAAK,CAAC,CAEpC,CAGA,MAAM,QAAS,CACX,IAAME,EAAgB,KAAK,OAAO,CAAC,EAAE,WAAW,IAAI,EAGpD,QAAS,EAAI,EAAG,EAAI,KAAK,WAAW,OAAQ,IAAK,CAC7C,IAAMC,EAAQ,KAAK,WAAW,CAAC,EAG/B,GAAI,CAAC,KAAK,QAAU,CAAC,KAAK,MACtB,MAGJ,GAAI,CAACA,EAAM,OACP,SAIJ,IAAMC,EAAiB,CAAC,EACxB,QAAWC,KAAMF,EACb,GAAIE,EAAG,UAAY,QAAS,CACxB,IAAMT,EAAMS,EAAG,KAAOA,EAAG,MACzB,GAAI,KAAK,YAAY,IAAIT,CAAG,EACxB,SAEJ,IAAMC,EAAMQ,EAAG,KAAO,KAAK,OAAS,KAAK,MAAM,cAAcA,EAAG,KAAM,EAClER,GACAO,EAAe,KAAK,KAAK,aAAaR,EAAKC,CAAG,CAAC,CAEvD,CAEJ,MAAM,QAAQ,IAAIO,CAAc,EAEhC,IAAMH,EAAM,iBACZ,QAAWI,KAAMF,EACb,OAAQE,EAAG,QAAS,CAChB,IAAK,OACDH,EAAc,UAAYG,EAAG,OAAS,KAAK,WACvC,OAAO,SAASA,EAAG,CAAC,EACpBH,EAAc,SAASG,EAAG,EAAKJ,EAAKI,EAAG,EAAKJ,EAAKI,EAAG,MAASJ,EAAKI,EAAG,OAAUJ,CAAG,EAGlFC,EAAc,SAAS,EAAG,EAAG,SAAS,KAAK,OAAO,KAAK,OAAO,CAAE,EAAG,SAAS,KAAK,OAAO,KAAK,QAAQ,CAAE,CAAC,EAE5G,MACJ,IAAK,QAAS,CACV,IAAMJ,EAAQ,KAAK,YAAY,IAAIO,EAAG,KAAOA,EAAG,KAAM,EAClDP,GACAI,EAAc,UAAUJ,EAAOO,EAAG,EAAIJ,EAAKI,EAAG,EAAIJ,EAAKI,EAAG,MAAQJ,EAAKI,EAAG,OAASJ,CAAG,EAE1F,KACJ,CACA,IAAK,WACD,KAAK,WAAaI,EAAG,MACrB,KACR,CAER,CAEI,KAAK,QAAU,KAAK,OACpB,KAAK,OAAO,CAAC,EAAE,WAAW,IAAI,EAAG,UAAU,KAAK,OAAO,CAAC,EAAG,EAAG,CAAC,EAInE,KAAK,WAAW,OAAS,EAEzB,KAAK,YAAY,CACrB,CACJ,EAEMC,GAAN,cAAyBpD,EAAc,CAMnC,YAAYnB,EAAmC,CAC3C,MAAMA,CAAO,EANjB,UAAO,OACP,YAAS,EACT,WAA+B,CAAC,EAChC,WAAQ,EAIJ,KAAK,QAAQ,KAAK,CACd,cAAe,OACf,YAAa,MACb,KAAM,QACV,CAAC,CACL,CAEA,QAAQE,EAAuB,CAC3B,OAAI,KAAK,QAAQ,OAASA,EAAG,SAAW,GAAKJ,GAAiB,GAC1D,KAAK,OAAO,MAAQ,GACpB,KAAK,QAAQ,WAAW,CACpB,KAAM,QACN,OAAQ,KAAK,GACb,EAAG,KAAK,OAAOI,EAAG,QAAU,KAAK,QAAQ,YAAc,GAAK,KAAK,QAAQ,aAAa,EACtF,EAAG,KAAK,OAAOA,EAAG,QAAU,KAAK,QAAQ,YAAc,GAAK,KAAK,QAAQ,cAAc,CAC3F,CAAC,EACM,IAEJ,MAAM,QAAQA,CAAE,CAC3B,CAEA,OAAO+C,EAAwC,CACvCA,EAAK,QACL,KAAK,gBAAkB,OACvB,KAAK,eAAeA,EAAK,GAAIA,EAAK,EAAE,GAIxC,KAAK,QAAQ,KAAK,YAAa,MAAM,EAErC,QAAWE,KAAQF,EAAK,MAAO,CAC3B,IAAMuB,EAAS,KAAK,MAAMrB,EAAK,IAAI,EACnC,GAAI,CAACqB,EAAO,OACR,MAAM,IAAI,MAAM,oCAAoCrB,EAAK,IAAI,cAAc,KAAK,EAAE,EAAE,EAGxF,IAAMC,EAAUD,EAAK,QACrB,GAAI,CAACC,GAAW,CAACA,EAAQ,OACrBoB,EAAO,KAAKjB,EAAI,MAEf,CACDiB,EAAO,MAAM,EACb,QAASC,EAAI,EAAGA,EAAIrB,EAAQ,OAAQqB,IAAK,CACrC,IAAIvC,EACA,OAAOkB,EAAQqB,CAAC,GAAM,SACtBvC,EAAM,CACF,MAAOkB,EAAQqB,GAAG,EAClB,KAAMrB,EAAQqB,CAAC,CACnB,EAGAvC,EAAMkB,EAAQqB,CAAC,EAEnBD,EAAO,OAAO,KAAK,gBAAgBtC,EAAK,EAAK,CAAC,EAE9C,KAAK,gBAAkBA,EAAI,UAC/B,CACJ,CACJ,CAGA,KAAK,QAAQ,YAAY,UAAW,EAAE,UAAU,KAAK,EAAE,qBAAqB,EAAE,SAAW,CAAC,EAGrF,KAAK,CACF,YAAa,QACb,YAAa,KAAK,MAAM,OAAS,EAAI,SAAW,KACpD,CAAC,CACT,CACJ,EAEMwC,GAAgF,CAClF,OAAQ9B,GACR,SAAUe,GACV,KAAMY,EACV,EAEMtE,GAAuC,CACzC,OAAQ,eACR,SAAU,iBACV,KAAM,YACV,EAEqB0E,GAArB,cAAqC,GAAoB,CAUrD,YAAYC,EAAmB,CAC3B,MAAM,EALV,aAAoB,CAAC,EA8ErB,KAAQ,UAAa1E,GAA4B,CAE7C,GAAI,CAAC,KAAK,OAAO,UAAYA,EAAG,OAAO,WAAa,SAAW,EAAEA,EAAG,OAAO,WAAa,OAAS,EAAEA,EAAG,MAAM,EAAE,GAAG,qBAAqB,GAAI,CAEtI,IAAM2E,EAAU,CAAC,GAAG,KAAK,OAAO,CAAC,EAC3BC,EAASD,EAAQ,OAAOE,GAAOA,EAAI,QAAQ,IAAI,EAAE,CAAC,GAAKF,EAAQ,OAAOE,GAAOA,EAAI,OAAS,QAAQ,EAAE,CAAC,EACvGD,IACAA,EAAO,QAAQ,QAAQ,OAAO,EAG1BA,EAAO,UAAU,GAAG,GAAG,QAAQ,EAC/BA,EAAO,UAAU,GAAG,QAAQ5E,CAAE,EAGzB4E,EAAO,OAAS,UACrBA,EAAO,QAAQ,QAAQ,OAAO,EAG1C,CACJ,EA3FI,QAAK,IAAMF,EAAO,IAClB,KAAK,OAASA,EACd,KAAK,QAAUA,EAAO,gBAClB,OAAO,eAAgB,CAEvB,IAAMI,EAAS,IAAI,eAAgBC,GAAY,CACvC,OAAOA,IAAU,CAAC,EAAE,4BAA4B,CAAC,EAAE,UAAc,MACjE,KAAK,qBAAuB,IAAI,eAAgBA,GAAmC,KAAK,eAAeA,CAAO,CAAC,GAEnHD,EAAO,WAAW,CACtB,CAAC,EACDA,EAAO,QAAQ,SAAS,IAAI,CAChC,CACA,KAAK,WAAa9E,GAAM0E,EAAO,WAAW1E,CAAE,EAE5C,EAAE,QAAQ,EAAE,GAAG,UAAW,KAAK,SAAS,EACxC,KAAK,IAAI,SAAS,EAAE,GAAG,QAAS,IAAM,KAAK,QAAQ,CAAC,CACxD,CAGA,SAAU,CACN,QAAW6E,KAAO,KAAK,OAAO,EAC1BA,EAAI,QAAQ,EAAK,EACjB,KAAK,OAAOA,EAAI,EAAE,EAEtB,EAAE,QAAQ,EAAE,IAAI,UAAW,KAAK,SAAS,CAC7C,CAEA,cAAcF,EAAiC,CAC3C,IAAMK,EAAkD,CAAC,EACzD,QAAWJ,KAAUD,EACjBK,EAAUJ,EAAO,EAAE,EAAIA,EAG3B,QAAWC,KAAO,KAAK,OAAO,EAEtB,CADWG,EAAUH,EAAI,EAAE,GAChBA,EAAI,SACXA,EAAI,UAAU,GAAG,GAAG,QAAQ,IAC5B,KAAK,cAAgBA,GAEzBA,EAAI,UAAU,GAAG,KAAK,WAAY,EAAI,EACtC,OAAOA,EAAI,OAGvB,CAGQ,eAAeE,EAAgC,CACnD,QAAWE,KAASF,EAAS,CACzB,IAAMG,EAAMD,EAAM,0BAA2B,CAAC,EACxCnB,EAASoB,EAAI,UACbnB,EAAQmB,EAAI,WACZL,EAAsB,EAAEI,EAAM,MAAM,EAAE,KAAK,QAAQ,EACzDJ,EAAI,OAAO,KAAK,CAAC,OAAAf,EAAQ,MAAAC,CAAK,CAAC,EAC/Bc,EAAI,OAAO,KAAK,CAAC,OAAAf,EAAQ,MAAAC,CAAK,CAAC,CACnC,CACA,KAAK,WAAW,CAAC,KAAM,QAAQ,CAAC,CACpC,CAGQ,SAAU,CACd,GAAI,CAAC,KAAK,OAAO,UAAYnE,GAAiB,GAC1C,QAAWgF,KAAU,KAAK,OAAO,EAC7B,GAAIA,EAAO,QAAQ,KAAM,CACrBA,EAAO,QAAQ,QAAQ,OAAO,EAC9B,KACJ,EAGZ,CAwBA,OAAOD,EAAkC,CAErC,QAAWE,KAAO,KAAK,OAAO,EAC1BA,EAAI,QAAU,GAIlB,QAAWM,KAAUR,EAAS,CAC1B,IAAMS,EAAKD,EAAO,GACZE,EAAOF,EAAO,KAGhBN,EAAM,KAAK,IAAIO,CAAE,EAGrB,GAAI,CAACP,EACDA,EAAM,IAAKL,GAAea,CAAI,EAAG,CAC7B,MAAO,KAAK,MACZ,IAAK,KAAK,IACV,GAAAD,EACA,QAAS,KACT,QAAS,KAAK,QACd,KAAMD,EAAO,KACb,OAAQA,EAAO,OACf,KAAAE,CACJ,CAAC,EACD,KAAK,IAAID,EAAIP,CAAG,UAGZA,EAAI,OAASQ,EACb,MAAM,IAAI,MAAM,UAAUD,CAAE,0BAA0BP,EAAI,IAAI,kCAAkCQ,CAAI,EAAE,EAa9G,GAVAR,EAAI,QAAU,GAGVA,EAAI,OAAS,aACTA,EAAI,SAAWM,EAAO,aAAeN,EAAI,QAAUM,EAAO,aAC1DN,EAAI,eAAeM,EAAO,YAAcA,EAAO,UAAW,EAK9DN,EAAI,OAAS,OAAQ,CACrB,GAAIM,EAAO,WAAcN,EAAI,OACzB,QAASN,EAAIM,EAAI,OAAQN,EAAIY,EAAO,WAAaZ,IAAK,CAClD,IAAMtB,EAAO,KAAK,IAAI,OAAO,MAAO,MAAM4B,EAAI,EAAE,MAAMN,CAAC,GAAI,UAAU,EACrEtB,EAAK,OAAOI,EAAI,EAChBwB,EAAI,QAAQ,OAAO5B,CAAI,EACvB4B,EAAI,MAAMN,CAAC,EAAItB,CACnB,CAEJ,GAAIkC,EAAO,WAAcN,EAAI,OACzB,QAASN,EAAIY,EAAO,WAAaZ,EAAIM,EAAI,OAAQN,IAC7C,KAAK,IAAI,GAAG,MAAMM,EAAI,EAAE,MAAMN,CAAC,EAAE,EAAE,OAAO,EAGlDM,EAAI,OAASM,EAAO,WACpBN,EAAI,MAAM,OAASA,EAAI,OACvBA,EAAI,MAAQM,EAAO,SACvB,CAGAN,EAAI,QAAQ,IAAI,CACZ,OAAQM,EAAO,OACf,KAAMA,EAAO,KACb,IAAKA,EAAO,IACZ,MAAOA,EAAO,KAClB,CAAC,EACGN,EAAI,OAAS,UACbA,EAAI,iBAAiB,EAAI,CAEjC,CAEA,IAAMS,EAA2B,CAAC,EAClC,QAAWT,KAAO,KAAK,OAAO,EACrBA,EAAI,SACLS,EAAe,KAAKT,CAAG,EAG/B,QAAWA,KAAOS,EACdT,EAAI,QAAQ,EAAI,EAChB,KAAK,OAAOA,EAAI,EAAE,CAE1B,CAEA,eAAe3B,EAAmC,CAC9C,QAAWiC,KAAUjC,EAAS,CAC1B,IAAM2B,EAAM,KAAK,IAAIM,EAAO,EAAE,EAC9B,GAAI,CAACN,EACD,MAAM,IAAI,MAAM,iCAAiCM,EAAO,EAAE,wBAAwB,EAItF,OAAQN,EAAI,KAAM,CACd,IAAK,SAAUA,EAAI,OAAOM,CAA4C,EAAG,MACzE,IAAK,WAEDN,EAAI,WAAW,KAAMM,EAAgD,IAAI,EACrEN,EAAI,WAAW,SAAW,GAC1BA,EAAI,OAAO,EAEf,MACJ,IAAK,OAAQA,EAAI,OAAOM,CAA0C,EAAG,KACzE,CACJ,CACJ,CAEA,cAAcR,EAAiC,CAC3C,QAAWQ,KAAUR,EAAS,CAC1B,IAAME,EAAM,KAAK,IAAIM,EAAO,EAAE,EAC9B,GAAI,CAACN,EACD,MAAM,IAAI,MAAM,+BAA+BM,EAAO,EAAE,wBAAwB,EAGpF,IAAMI,EAASV,EAAI,QAAQ,IAC3BA,EAAI,OAASM,EACTA,EAAO,MACHA,EAAO,MAAQI,GACfV,EAAI,UAAU,OAAO,CAGjC,CAII,KAAK,gBAED,KAAK,IAAI,KAAK,cAAc,EAAE,GAAK,KAAK,cAAc,QAAQ,KAC9D,KAAK,cAAc,UAAU,QAAQ,EAIrC,CAAC,GAAG,KAAK,OAAO,CAAC,EAAE,OAAOA,GAAOA,EAAI,QAAQ,IAAI,EAAE,CAAC,GAAG,UAAU,QAAQ,EAGrF,CACJ,EC15BA,IAAqBW,GAArB,cAA8CC,EAAoC,CAgB9E,aAAc,CACV,MAAM,EAhBV,SAAW,IAAIC,GAAI,CACf,gBAAiB,OACjB,gBAAiB,eACjB,aAAc,YACd,YAAa,WACb,eAAgB,cAChB,OAAQ,GACR,cAAe,YACnB,CAAC,EAED,KAAQ,cAAgB,GACxB,KAAQ,gBAAkB,GAyP1B,wBAAqBC,GAAS,SAAY,CACtC,OAAO,SAAS,EAAG,CAAC,CACxB,EAAG,IAAK,CAAC,QAAS,EAAK,CAAC,EApPpB,KAAK,mBAAqB,IAAIC,GAAQ,IAAI,EAC1C,KAAK,QAAU,IAAIC,GAAQ,IAAI,CACnC,CAEA,MAAM,KAAKC,EAA+B,CACtC,GAAI,CACA,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,qBAAqB,EAGzC,GAAI,OAAO,OAAW,IAClB,MAAM,IAAI,MAAM,sBAAsB,EAItCA,EAAQ,aACR,KAAK,IAAI,OAASA,EAAQ,YAE1BA,EAAQ,eACR,KAAK,IAAI,gBAAkBA,EAAQ,cAEnCA,EAAQ,YACR,KAAK,IAAI,aAAeA,EAAQ,WAEhCA,EAAQ,WACR,KAAK,IAAI,YAAcA,EAAQ,UAE/BA,EAAQ,cACR,KAAK,IAAI,eAAiBA,EAAQ,aAElCA,EAAQ,aACR,KAAK,IAAI,cAAgBA,EAAQ,YAGjCA,EAAQ,QACR,KAAK,QAAQ,MAAQA,EAAQ,OAIjC,IAAMC,EAAa,KAAK,IAAI,WAAW,EACvC,GAAI,CAACA,EAAW,OACZ,MAAM,IAAI,MAAM,mCAAmC,KAAK,IAAI,aAAa,EAAE,EAE/EA,EAAW,MAAM,EAEjB,EAAE,QAAQ,EAAE,GAAG,SAAU,KAAK,kBAAkB,EAMhD,IAAIC,EAA4B,wFAchC,GATI,aAAa,KAAK,UAAU,SAAS,IACrCA,GAA6B,oBAGhC,SAAS,KAAK,cAAc,uBAAuB,EAAuB,QAAUA,EAErF,MAAM,KAAK,mBAAmB,QAAQ,EAGlCF,EAAQ,eAAiBA,EAAQ,kBACjC,GAAIA,EAAQ,kBAAoBA,EAAQ,mBAAqB,SACzD,QAAQ,KAAK,yDAAyD,MAErE,CAED,IAAMG,EAAkB,IAAI,gBAAgB,SAAS,SAAS,MAAM,EAAG,IAAI,UAAU,EAC/EC,EAAcJ,EAAQ,kBAAoB,+BAC3CG,GAAkBA,IAAmB,KAAQ,SAAS,OAAO,SAAS,GAAGC,CAAW,IAAI,EACzF,QAAQ,IAAI,6CAA6C,EAGzD,KAAK,oBAAsB,IAAIC,GAAmBL,EAAS,KAAK,OAAO,CAE/E,CAIJ,OAAO,MAAM,KAAKA,CAAO,CAC7B,OACOM,EAAK,CACR,KAAK,MAAMA,CAAY,CAC3B,CACJ,CAEU,YAAYC,EAAqB,CAEnC,MAAM,QAAQA,EAAK,OAAO,IAC1B,KAAK,QAAQ,QAAUA,EAAK,SAGhC,QAAWC,KAAO,KAAK,QAAQ,OAAO,EAE9BA,EAAI,OAAS,UACbA,EAAI,iBAAiB,EAI7B,GAAID,EAAK,YACL,OAAW,CAACE,EAAOC,CAAM,IAAKH,EAAK,YAC9B,KAAK,QAAQ,IAAIE,CAAK,EAAqB,WAAaC,EAI7DH,EAAK,6BAA+B,KAAK,sBACzC,KAAK,oBAAoB,QAAUA,EAAK,4BACxC,QAAQ,IAAI,oDAAoDA,EAAK,2BAA2B,EAAE,GAItG,WAAW,IAAM,KAAK,WAAW,CAAC,KAAM,SAAS,CAAC,EAAG,CAAC,CAC1D,CAEU,cAAcI,EAAiC,CACrD,KAAK,QAAQ,cAAcA,CAAO,CACtC,CAEU,cAAyB,CAC/B,MAAO,CACH,aACA,WACA,cACA,aACA,OACJ,CACJ,CAEU,QAAQC,EAAkB,CAChC,QAAWJ,KAAO,KAAK,QAAQ,OAAO,EAClCA,EAAI,UAAU,GAAG,KAAK,WAAYI,GAAW,CAACJ,EAAI,QAAQ,IAAI,EAElE,KAAK,SAAWI,CACpB,CAEQ,iBAAkB,CACtB,GAAI,OAAO,EAAM,IACb,OAGJ,IAAMC,EAAY,EAAE,IAAI,KAAK,IAAI,YAAY,EAAE,EAiB/C,GAdKA,EAAU,KAAK,aAAa,EAAE,QAC/B,EAAE,WAAY,CACV,aAAc,QACd,MAAO,IAAM,CACTA,EAAU,KAAK,CACnB,EACA,GAAI,aACJ,KAAM,SACN,KAAM,QACV,CAAC,EACI,SAASA,CAAS,EAIvB,KAAK,eAAiB,KAAK,QAAQ,eAAgB,CACnD,IAAMC,EAAO,EAAE,MAAO,CAClB,MAAO,SAAY,CACf,MAAM,KAAK,OAAQ,eAAgB,EACnC,SAAS,OAAO,CACpB,EACA,KAAM,4BACV,CAAC,EACD,EAAE,OAAO,EACJ,OAAOA,CAAI,EACX,SAASD,CAAS,CAC3B,CACJ,CAEA,MAAME,EAAuB,CACzBA,IAAU,MACV,IAAIC,EACA,OAAOD,GAAU,UACjBC,EAAMD,EACNA,EAAQ,IAAI,MAAMA,CAAK,GAGvBC,EAAMD,EAAM,SAAS,EAIzB,IAAME,EAAe,SAAS,eAAe,KAAK,IAAI,eAAe,EACrE,GAAI,CAACA,EACD,MAAM,IAAI,MAAMD,CAAG,EAEvBC,EAAa,UAAYD,EAEzB,IAAMH,EAAY,SAAS,eAAe,KAAK,IAAI,YAAY,EAC3DA,EAAU,YAAc,gBACxBA,EAAU,UAAY,IAG1B,KAAK,gBAAgB,EAErBA,EAAU,MAAM,QAAU,GAC1B,KAAK,cAAgB,GACrB,KAAK,aAAa,EAClB,QAAQ,MAAME,CAAK,CACvB,CAEU,MAAO,CAEb,KAAK,mBAAmB,QAAQ,EAChC,KAAK,QAAQ,QAAQ,CACzB,CAEA,eAAyC,CACrC,OAAO,KAAK,IAAI,eACpB,CAEA,SAASG,EAAsB,CAC3B,OAAQA,EAAM,CACV,IAAK,eAAgB,OAAO,KAAK,IAAI,gBACrC,IAAK,YAAa,OAAO,KAAK,IAAI,aAClC,IAAK,WAAY,OAAO,KAAK,IAAI,YACjC,IAAK,cAAe,OAAO,KAAK,IAAI,eACpC,IAAK,aAAc,OAAO,KAAK,IAAI,cACnC,QAAS,OAAOA,CACpB,CACJ,CAEQ,cAAe,CACnB,GAAI,CAAC,KAAK,gBACN,OAEJ,KAAK,gBAAkB,GAGvB,IAAMC,EAAc,SAAS,eAAe,KAAK,IAAI,cAAc,EAC/DA,IACAA,EAAY,MAAM,QAAU,OAEpC,CAQA,eAA+B,CAC3B,IAAMC,EAAuC,CAAC,EAC9C,QAAWZ,KAAO,KAAK,QAAQ,OAAO,EAC9BA,EAAI,OAAS,YACbY,EAAY,KAAK,CAACZ,EAAI,GAAIA,EAAI,UAAU,CAAC,EAIjD,MAAO,CACH,YAAAY,EACA,QAAS,KAAK,QAAQ,QACtB,4BAA6B,KAAK,qBAAqB,OAC3D,CACJ,CAGA,WAAWC,EAA6B,CACpC,GAAIA,EAAG,OAAS,QAAUA,EAAG,OAAS,WAAaA,EAAG,OAAS,mBAC3D,QAAWb,KAAO,KAAK,QAAQ,OAAO,EAClC,GAAIA,EAAI,QAAQ,KAAM,CAClB,IAAMc,EAAMd,EAAI,UAAU,GAAG,IAAI,EAC7Bc,IACKD,EAAG,UACJA,EAAG,QAAU,CAAC,GAElBA,EAAG,QAAQb,EAAI,EAAE,EAAIc,EAE7B,EAGJ,KAAK,qBAAqB,SAC1B,KAAK,oBAAoB,aAAaD,CAAE,EAE5C,MAAM,WAAWA,CAAE,CACvB,CAEA,cAAcC,EAAkB,CAC5B,KAAK,IAAI,gBAAkBA,CAC/B,CAEU,YAAYZ,EAAgB,CAClC,EAAE,MAAM,EAAE,IAAI,mBAAoBA,CAAM,CAC5C,CAEA,OAAOH,EAAuB,CACtB,KAAK,iBACL,KAAK,aAAa,EAEtB,MAAM,OAAOA,CAAI,EACb,KAAK,qBAAqB,SAAWA,EAAK,OAAS,UAAY,CAACA,EAAK,aACrE,KAAK,oBAAoB,cAAcA,CAAI,CAEnD,CAEU,eAAegB,EAAmC,CACxD,KAAK,QAAQ,eAAeA,CAAO,CACvC,CAEU,cAAcZ,EAAiC,CACrD,KAAK,QAAQ,cAAcA,CAAO,CACtC,CAEU,eAAeA,EAAkC,CACvD,KAAK,QAAQ,OAAOA,CAAO,CAC/B,CAEA,QAAQK,EAAU,CAEd,GAAI,KAAK,cACL,OAGJ,IAAMH,EAAY,EAAE,IAAI,KAAK,IAAI,YAAY,EAAE,EAG/C,GAAI,CAACG,EAAK,CACNH,EAAU,KAAK,EACf,MACJ,CAEA,IAAMI,EAAe,SAAS,eAAe,KAAK,IAAI,eAAe,EACrE,GAAI,CAACA,EAAc,CACf,QAAQ,KAAKD,CAAG,EAChB,MACJ,CACAC,EAAa,UAAYD,EAEzB,KAAK,gBAAgB,EAErBH,EAAU,SAAS,aAAa,EAChCA,EAAU,KAAK,EACf,KAAK,aAAa,CACtB,CACJ,ECnYA,IAAMW,GAAc,CAClB,mnBACA,0BACF,EAEMC,GAAU,CAAC,EACXC,GAAU,CAAC,EACjBF,GAAY,QAAQ,CAACG,EAAYC,IAAM,CAErC,IAAMC,EAAmB,CAAC,EAC1BF,EAAW,MAAM,MAAM,EAAE,QAAQG,GAAQ,CACvC,IAAMC,EAAQD,EAAK,YAAY,CAAC,EAC1BE,EAAOF,EAAK,YAAY,CAAC,EAC/B,QAASG,EAAYF,EAAOE,GAAaD,EAAMC,IAC7CJ,EAAiB,KAAK,OAAO,cAAcI,CAAS,CAAC,CAEzD,CAAC,EAED,IAAMC,EAAW,GAAgB,EAAgBN,EACjDH,GAAQS,CAAQ,EAAIL,EACpBA,EAAiB,QAAQ,CAACM,EAAKC,IAAM,CACnCV,GAAQS,CAAG,EAAI,CAACD,EAAUE,CAAC,CAC7B,CAAC,CACH,CAAC,EAED,IAAMC,GAASC,GAAc,CAC3B,IAAMC,EAASD,EAAW,OAEtBE,EAAM,GACNJ,EAAI,EACJF,EAAW,EAEf,QAASO,EAAI,EAAGA,EAAIF,EAAQE,IAAK,CAC/B,IAAMC,EAAQJ,EAAWG,CAAC,EAG1B,QAASE,EAAI,EAAmBA,GAAK,EAAGA,IAAK,CAC3C,IAAMC,EAAOF,GAASC,EAAK,EAE3BP,GAAKA,GAAK,GAAKQ,EACfV,IAEIA,IAAa,KACfM,GAAOf,GAAQS,CAAQ,EAAEE,CAAC,EAC1BA,EAAI,EACJF,EAAW,EAEf,CACF,CAEA,GAAIA,IAAa,EAAG,CAqBlB,KAAO,EAAEA,KAAYT,KACnBW,GAAKA,GAAK,GAAK,EACfF,IAGFM,GAAOf,GAAQS,CAAQ,EAAEE,CAAC,CAC5B,CAEA,OAAOI,CACT,EAEMK,GAASL,GAAO,CACpB,IAAMD,EAASC,EAAI,OAIbF,EAAa,IAAI,WAAW,KAAK,MAAMC,EAAS,GAAgB,CAAa,CAAC,EAChFO,EAAY,EACZJ,EAAQ,EACRK,EAAe,EAEnB,QAASN,EAAI,EAAGA,EAAIF,EAAQE,IAAK,CAC/B,IAAMN,EAAMK,EAAI,OAAOC,CAAC,EAExB,GAAI,EAAEN,KAAOT,IACX,MAAM,IAAI,MAAM,qCAAqCS,CAAG,EAAE,EAG5D,GAAM,CAACD,EAAUE,CAAC,EAAIV,GAAQS,CAAG,EAEjC,GAAID,IAAa,IAAiBO,IAAMF,EAAS,EAC/C,MAAM,IAAI,MAAM,6DAA+D,OAAOE,CAAC,CAAC,EAI1F,QAASE,EAAIT,EAAW,EAAGS,GAAK,EAAGA,IAAK,CACtC,IAAMC,EAAOR,GAAKO,EAAK,EAEvBD,GAASA,GAAS,GAAKE,EACvBG,IAEIA,IAAiB,IACnBT,EAAWQ,CAAS,EAAIJ,EACxBI,IACAJ,EAAQ,EACRK,EAAe,EAEnB,CACF,CAKA,GAAIL,KAAY,GAAKK,GAAgB,EACnC,MAAM,IAAI,MAAM,kBAAkB,EAGpC,OAAO,IAAI,WAAWT,EAAW,OAAQ,EAAGQ,CAAS,CACvD,EC9EA,IAAME,GAAc,IAAI,YAClBC,GAAc,IAAI,YAExB,SAASC,GAAqBC,EAAK,CAC/B,OAAO,WAAW,KAAKA,EAAKC,GAAMA,EAAG,WAAW,CAAC,CAAC,CACtD,CAIA,IAAIC,GAAS,UAAW,CAExB,IAAIC,EAAe,SAEfC,EAAU,GACVC,EAAkB,KAClBC,EACAC,EACAC,EACAC,EAEAC,EACAC,EACAC,EACAC,EAGJ,SAASC,GAAc,CACnB,GAAI,CACA,IAAMC,EAAU,SAAS,aAAa,QAAQ,wBAAwB,EAAG,EAAE,EAC3E,GAAIA,EAAU,EACV,MAAM,IAAI,MAAM,4DAA4D,EAEhF,GAAI,CAACA,EAAS,CACV,QAAQ,IAAI,kCAAkC,EAC9C,OAAW,CAACC,EAAKC,CAAK,IAAK,OAAO,QAAQ,YAAY,EAMlD,GALID,EAAI,WAAW,UAAU,GACrBC,IAAU,IACV,aAAa,QAAQD,EAAKE,GAAiB,aAAa,KAAKD,CAAK,EAAI,KAAK,MAAMA,CAAK,EAAIlB,GAAqBkB,CAAK,CAAC,CAAC,EAG1HD,EAAI,WAAW,WAAW,EAAG,CAC7B,aAAa,WAAWA,CAAG,EAC3B,IAAMG,EAAO,KAAK,MAAMF,CAAK,EACzBE,EAAK,MACL,aAAa,QAAQH,EAAM,OAAQE,GAAiBC,EAAK,GAAG,CAAC,EAC7D,OAAOA,EAAK,KAEhB,aAAa,QAAQH,EAAKE,GAAiBpB,GAAY,OAAO,KAAK,UAAUqB,CAAI,CAAC,CAAC,CAAC,EACpF,aAAa,QAAQH,EAAM,QAASE,GAAiBpB,GAAY,OAAO,KAAK,UAAU,CAAC,SAAU,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CACpH,CAEJ,aAAa,QAAQ,yBAA0B,GAAG,CACtD,CACJ,MACU,CAAC,CACf,CAgBA,SAASsB,EAAYC,EAAQC,EAAOC,EAAQC,EAAU,CAClD,GAAIpB,EACA,MAAM,IAAI,MAAM,qCAAqC,EAEzD,GAAI,CAACqB,EACD,MAAM,IAAI,MAAM,sCAAsC,EAE1DpB,EAAkBmB,EAClBlB,EAAYe,EACZd,EAAa,GACbC,EAAU,GACVC,EAAiB,KACjBC,EAAYY,EACZV,EAAaW,EACbZ,EAAiBe,EAAgBhB,CAAS,EAO1C,IAAIiB,EAAa,aACbC,EAAQ,OAAO,KACf,OAAO,SACPA,EAAQ,OAAO,OAAO,aAAa,GACnCA,GAASA,EAAM,aACfD,EAAaC,EAAM,YAEvB,IAAIC,EAAS,EAAE,IAAIF,CAAU,EAC7B,GAAI,CAACE,EAAO,OACR,MAAM,IAAI,MAAM,wCAA0CF,EAAa,GAAG,EAG9E,IAAIG,EAAS,EAAE,IAAI3B,EAAa,SAAS,EACpC2B,EAAO,SACRA,EAAS,EAAE,QACP,CAAE,GAAI3B,EAAa,SAAU,CAAC,EAClC0B,EAAO,OAAOC,CAAM,GAKxB,IAAIC,EAAQ,EAAE,IAAI5B,EAAa,QAAQ,EAClC4B,EAAM,SACPA,EAAQ,EAAE,QACN,CAAE,GAAI5B,EAAa,QAAS,CAAC,EACjC0B,EAAO,OAAOE,CAAK,GAGvB,IAAIC,EAAM,EAAE,IAAI7B,CAAY,EACxB6B,EAAI,QACJA,EAAI,OAAO,EAEfA,EAAM,EAAE,QAAS,CAAE,GAAI7B,CAAa,CAAC,EAErC,IAAI8B,EAAMC,EAAIC,EAEdF,EAAO,EAAE,QAAQ,EACjBA,EAAK,GAAG,SACH3B,EAAY8B,GAA2BC,EAAyB,EACrEL,EAAI,OAAOC,CAAI,EAEfE,EAAM,EAAE,QAAS,CAAE,MAAS,iBAAkB,CAAC,EAC/CD,EAAK,EAAE,WAAY,CAAE,GAAI/B,EAAa,QAAS,KAAM,QAAS,CAAC,EAC/D+B,EAAG,OAAO,MAAM,EAChBA,EAAG,GAAG,QAASI,CAAiB,EAChCH,EAAI,OAAOD,CAAE,EACbD,EAAK,OAAOE,CAAG,EAEfA,EAAM,EAAE,QAAS,CAAE,GAAIhC,EAAa,OAAQ,MAAS,YAAa,CAAC,EACnEgC,EAAI,OAAO,KAAK,EAChBF,EAAK,OAAOE,CAAG,EAEX7B,IACA6B,EAAM,EAAE,QAAS,CAAE,GAAIhC,EAAa,SAAU,MAAS,UAAW,CAAC,EACnE8B,EAAK,OAAOE,CAAG,EACfD,EAAK,EAAE,UAAW,CAAE,GAAI/B,EAAa,WAAY,KAAM,OAAQ,KAAM,UAAW,CAAC,EACjFgC,EAAI,OAAOD,CAAE,EAGbC,EAAM,EAAE,QAAS,CAAE,GAAIhC,EAAa,WAAY,MAAS,YAAa,CAAC,EACvEgC,EAAI,KAAK,8EAA8E,EACvFF,EAAK,OAAOE,CAAG,GAGnBA,EAAM,EAAE,QAAS,CAAE,GAAIhC,EAAa,QAAS,MAAS,SAAU,CAAC,EACjE8B,EAAK,OAAOE,CAAG,EAEfA,EAAM,EAAE,QAAS,CAAE,GAAIhC,EAAa,QAAS,MAAS,YAAa,CAAC,EACpEgC,EAAI,KAAK,EACTF,EAAK,OAAOE,CAAG,EAEfA,EAAM,EAAE,QAAS,CAAE,GAAIhC,EAAa,aAAc,MAAS,YAAa,CAAC,EAGrE+B,EAAK,EAAE,WAAY,CAAE,GAAI/B,EAAa,UAAW,KAAM,QAAS,CAAC,EACjE+B,EAAG,OAAO,QAAQ,EAClBA,EAAG,GAAG,QAASK,EAAmB,EAClCJ,EAAI,OAAOD,CAAE,EAEbA,EAAK,EAAE,WAAY,CAAE,GAAI/B,EAAa,UAAW,KAAM,QAAS,CAAC,EACjE+B,EAAG,OAAO,QAAQ,EAClBA,EAAG,GAAG,QAASM,EAAmB,EAClCN,EAAG,KAAK,EACRC,EAAI,OAAOD,CAAE,EAEbA,EAAK,EAAE,WAAY,CAAE,GAAI/B,EAAa,WAAY,KAAM,QAAS,CAAC,EAClE+B,EAAG,OAAO,SAAS,EACnBA,EAAG,GAAG,QAASO,EAAoB,EACnCP,EAAG,KAAK,EACRC,EAAI,OAAOD,CAAE,EAEbA,EAAK,EAAE,WAAY,CAAE,GAAI/B,EAAa,UAAW,KAAM,QAAS,CAAC,EACjE+B,EAAG,OAAO5B,EAAY,OAAS,MAAM,EACrC4B,EAAG,GAAG,QACD5B,EAAY8B,GAA2BC,EAAyB,EACrEF,EAAI,OAAOD,CAAE,EAEjBD,EAAK,OAAOE,CAAG,EAEfJ,EAAM,OAAOC,CAAG,EAChB5B,EAAU,GAEVsC,GAAsB,EAStB,IAAIC,EACArC,EACAqC,EAAY,UAAW,CACnB,IAAIT,GAAK,EAAE,IAAI/B,EAAa,UAAU,EAClC+B,GAAG,QACHA,GAAG,MAAM,CACjB,EAGAS,EAAY,UAAW,CACnB,IAAIT,GAAK,EAAE,IAAI/B,EAAa,SAAS,EACjC+B,GAAG,QACHA,GAAG,MAAM,CACjB,EAEJU,EAAWD,CAAS,CACxB,CAIA,SAASE,GAAe,CACpB,IAAIb,EAAM,EAAE,IAAI7B,CAAY,EACxB6B,EAAI,QACJA,EAAI,OAAO,EACf,IAAID,EAAQ,EAAE,IAAI5B,EAAa,QAAQ,EACnC4B,EAAM,QACNA,EAAM,OAAO,EACjB,IAAID,EAAS,EAAE,IAAI3B,EAAa,SAAS,EACrC2B,EAAO,QACPA,EAAO,OAAO,EAElB1B,EAAU,GACVC,EAAkB,KAClBQ,EAAe,KACfL,EAAU,GACVC,EAAiB,IACrB,CAKA,SAASqC,EAAYC,EAAKC,EAAS,CAC/B,IAAIC,EAAQD,EAAU7C,EAAa,OAASA,EAAa,QACrD+B,EAAK,EAAE,IAAIe,CAAI,EACdf,EAAG,SAGHa,GAIDb,EAAG,KAAKa,CAAG,EACXb,EAAG,KAAK,GAJRA,EAAG,KAAK,EAMhB,CAKA,SAASR,EAAgBwB,EAAK,CAC1B,OAAQA,EAAK,CACb,IAAK,OACD,MAAO,YACX,IAAK,OACD,MAAO,YACX,IAAK,aACD,MAAO,aACX,IAAK,UACD,MAAO,iBACX,QACI,MAAO,MACX,CACJ,CAKA,SAASC,GAAiBD,EAAK,CAC3B,OAAQA,GAAO,cAAgBA,GAAO,SAC1C,CAGA,SAASN,EAAWQ,EACpB,CACE,OAAO,OAAO,WAAWA,EAAM,IAAK,GAAI,CAC1C,CAQA,SAASC,IAAsB,CAG3B,GAFI,CAACjD,GAEDG,EACA,MAAO,GAGX,IAAI+C,EAAQ,EAAE,IAAInD,EAAa,SAAS,EACxC,GAAI,CAACmD,EAAM,OACP,MAAO,GACX,IAAIC,EAAMD,EAAM,KAAK,eAAe,EACpC,GAAI,CAACzC,GAAgB0C,EAAM,GAAKA,GAAO1C,EAAa,OAChD,MAAO,GACX,IAAI2C,EAAO3C,EAAa0C,CAAG,EACvBE,EAAM,EAAE,IAAItD,EAAa,UAAU,EACvC,OAAKsD,EAAI,QAETA,EAAI,IAAID,EAAK,OAAO,QAAQ,EACrB,EACX,CAOA,SAASE,IAA8B,CAGnC,GAFI,CAACtD,GAED,CAACI,GAAWC,EACZ,MAAO,GAEX,IAAIkD,EAAQ,EAAE,IAAIxD,EAAa,SAAS,EACxCwD,EAAM,KAAK,WAAY,EAAI,EAC3BA,EAAQ,EAAE,IAAIxD,EAAa,UAAU,EACrCwD,EAAM,KAAK,WAAY,EAAI,EAE3B,IAAIL,EAAQ,EAAE,IAAInD,EAAa,SAAS,EACxC,GAAI,CAACmD,EAAM,OACP,MAAO,GACX,IAAIC,EAAMD,EAAM,KAAK,eAAe,EACpC,GAAI,CAACzC,GAAgB0C,EAAM,GAAKA,GAAO1C,EAAa,OAChD,MAAO,GACX,IAAI2C,EAAO3C,EAAa0C,CAAG,EAC3B,GAAI,CAACC,GAAQ,CAACA,EAAK,QAAU,CAACI,EAAgBJ,EAAK,MAAM,EACrD,MAAO,GAEXG,EAAQ,EAAE,IAAIxD,EAAa,SAAS,EACpCwD,EAAM,KAAK,WAAY,EAAK,EAC5BA,EAAQ,EAAE,IAAIxD,EAAa,UAAU,EACrCwD,EAAM,KAAK,WAAY,EAAK,CAChC,CAIA,SAAStB,GAAyBwB,EAAI,CAIlC,GAHAA,EAAG,eAAe,EACd,CAACzD,GAEDI,EACA,MAAO,GAGX,IAAI8C,EAAQ,EAAE,IAAInD,EAAa,SAAS,EACxC,GAAI,CAACmD,EAAM,OACP,MAAO,GACX,IAAIC,EAAMD,EAAM,KAAK,eAAe,EACpC,GAAI,CAACzC,GAAgB0C,EAAM,GAAKA,GAAO1C,EAAa,OAChD,MAAO,GACX,IAAI2C,EAAO3C,EAAa0C,CAAG,EAC3B,GAAI,CAACC,GAAQ,CAACA,EAAK,QAAU,CAACI,EAAgBJ,EAAK,MAAM,EACrD,MAAO,GAEX,IAAIhC,EAAWnB,EAEf,OAAAwC,EAAa,EACTrB,GACAA,EAASgC,EAAK,MAAM,EAEjB,EACX,CAIA,SAASpB,GAAyByB,EAAI,CAIlC,GAHAA,EAAG,eAAe,EACd,CAACzD,GAEDI,EACA,MAAO,GAGX,IAAIiD,EAAM,EAAE,IAAItD,EAAa,UAAU,EACvC,GAAI,CAACsD,EAAI,OACL,MAAO,GACX,IAAIK,EAAWL,EAAI,IAAI,EAEvB,GADAK,EAAW,OAAO,KAAKA,CAAQ,EAC3B,CAACA,EAAS,OACV,MAAO,GACX,IAAIC,EAASC,GAAmBF,EAAUpD,EAAWE,CAAU,EAE/D,GAAIgD,EAAgBG,CAAM,GAAK,CAACxD,EAAY,CAKxCA,EAAa,GACbuC,EAAY,sBAAwBnC,EAAiB,KAC/CoD,EAAO,SAAW,gCAAiC,EAAK,EAC9DN,EAAI,KAAK,WAAY,EAAI,EACzB,IAAIE,EAAQ,EAAE,IAAIxD,EAAa,SAAS,EACxC,OAAAwD,EAAM,KAAK,SAAS,EACb,EACX,CAEA,IAAInC,EAAWnB,EAEf,OAAAwC,EAAa,EACTrB,GACAA,EAASuC,CAAM,EAEZ,EACX,CAMA,SAASzB,EAAkBuB,EAAI,CAE3B,GADAA,EAAG,eAAe,EACd,CAACzD,EACD,MAAO,GAEX,GAAKI,EAiCA,IAAKC,EAwBN,OAAAD,EAAU,GACVC,EAAiB,KAEjB,EAAE,IAAIN,EAAa,YAAY,EAAE,KAAK,EAExB,EAAE,IAAIA,EAAa,OAAO,EAClC,KAAK,MAAM,EAEjBuC,GAAsB,EACf,GAjCe,CACtBlC,EAAU,GACVC,EAAiB,KAEjB,IAAMgD,EAAM,EAAE,IAAItD,EAAa,QAAQ,EACnCsD,EAAI,QACJA,EAAI,KAAK,EAGb,IAAIE,EAAQ,EAAE,IAAIxD,EAAa,OAAO,EACtC,OAAAwD,EAAM,KAAK,MAAM,EAEjBA,EAAQ,EAAE,IAAIxD,EAAa,SAAS,EACpCwD,EAAM,KAAK,EACXA,EAAQ,EAAE,IAAIxD,EAAa,UAAU,EACrCwD,EAAM,KAAK,EACXA,EAAQ,EAAE,IAAIxD,EAAa,SAAS,EACpCwD,EAAM,KAAK,EAEXjB,GAAsB,EACf,EACX,MAtDc,CAIV,GAHAlC,EAAU,GACVC,EAAiB,KAEbF,EAAY,CAEZA,EAAa,GACbuC,EAAY,KAAM,EAAK,EACX,EAAE,IAAI3C,EAAa,UAAU,EACrC,KAAK,WAAY,EAAK,EAC1B,IAAMwD,EAAQ,EAAE,IAAIxD,EAAa,SAAS,EAC1CwD,EAAM,KAAK,WAAY,EAAK,EAC5BA,EAAM,KAAK,MAAM,CACrB,CAEA,IAAMF,EAAM,EAAE,IAAItD,EAAa,QAAQ,EACnCsD,EAAI,QACJA,EAAI,KAAK,EAGb,IAAIE,EAAQ,EAAE,IAAIxD,EAAa,OAAO,EACtC,OAAAwD,EAAM,KAAK,MAAM,EAEjBA,EAAQ,EAAE,IAAIxD,EAAa,SAAS,EACpCwD,EAAM,KAAK,EACXA,EAAQ,EAAE,IAAIxD,EAAa,UAAU,EACrCwD,EAAM,KAAK,EACXA,EAAQ,EAAE,IAAIxD,EAAa,SAAS,EACpCwD,EAAM,KAAK,EAEXjB,GAAsB,EACf,EACX,CAoCJ,CAIA,SAASF,GAAoBqB,EAAI,CAI7B,GAHAA,EAAG,eAAe,EACd,CAACzD,GAED,CAACI,GAAWC,EACZ,MAAO,GAGX,IAAI6C,EAAQ,EAAE,IAAInD,EAAa,SAAS,EACxC,GAAI,CAACmD,EAAM,OACP,MAAO,GACX,IAAIC,EAAMD,EAAM,KAAK,eAAe,EACpC,GAAI,CAACzC,GAAgB0C,EAAM,GAAKA,GAAO1C,EAAa,OAChD,MAAO,GACX,IAAI2C,EAAO3C,EAAa0C,CAAG,EAC3B,MAAI,CAACC,GAAQ,CAACA,EAAK,SAGnBS,GAAgBT,EAAK,MAAM,EAE3Bd,GAAsB,GAEf,EACX,CAIA,SAASD,GAAqBoB,EAAI,CAI9B,GAHAA,EAAG,eAAe,EACd,CAACzD,GAED,CAACI,GAAWC,EACZ,MAAO,GAGX,IAAI6C,EAAQ,EAAE,IAAInD,EAAa,SAAS,EACxC,GAAI,CAACmD,EAAM,OACP,MAAO,GACX,IAAIC,EAAMD,EAAM,KAAK,eAAe,EACpC,GAAI,CAACzC,GAAgB0C,EAAM,GAAKA,GAAO1C,EAAa,OAChD,MAAO,GACX,IAAI2C,EAAO3C,EAAa0C,CAAG,EAC3B,GAAI,CAACC,GAAQ,CAACA,EAAK,QAAU,CAACI,EAAgBJ,EAAK,MAAM,EACrD,MAAO,GAEX,EAAE,IAAIrD,EAAa,YAAY,EAAE,KAAK,EAEtC,IAAIwD,EAAQ,EAAE,IAAIxD,EAAa,OAAO,EACtC,OAAAwD,EAAM,KAAK,OAAO,EAElBlD,EAAiB+C,EAAK,OAEtBd,GAAsB,EAEf,EACX,CAOA,SAASH,GAAoBsB,EAAI,CAE7B,GADAA,EAAG,eAAe,EACd,CAACzD,EACD,MAAO,GAEX,GAAIG,EAAY,CACZA,EAAa,GACbuC,EAAY,KAAM,EAAK,EACvB,IAAIW,EAAM,EAAE,IAAItD,EAAa,UAAU,EACvCsD,EAAI,KAAK,WAAY,EAAK,EAC1B,IAAIE,EAAQ,EAAE,IAAIxD,EAAa,SAAS,EACxC,OAAAwD,EAAM,KAAK,WAAY,EAAK,EAC5BA,EAAM,KAAK,MAAM,EACV,EACX,CAEA,IAAInC,EAAWnB,EAEf,OAAAwC,EAAa,EACTrB,GACAA,EAAS,IAAI,EAEV,EACX,CAWA,SAASkB,IAA8B,CACnC,GAAI,CAACtC,EACD,MAAO,GAEX,IAAIuD,EAAOzB,EASX,IAAMgC,EAAS,EAAE,IAAI/D,EAAa,OAAO,EACzC,GAAI,CAAC+D,EAAO,OACR,MAAO,GAgBX,GAdI1D,GAAWC,IAGNmD,EAAgBnD,CAAc,IAC/BA,EAAiB,KACjB,EAAE,IAAIN,EAAa,YAAY,EAAE,KAAK,EACtCwD,EAAQ,EAAE,IAAIxD,EAAa,OAAO,EAClCwD,EAAM,KAAK,MAAM,IAOrBnD,GAAWC,EAAgB,CAE3ByD,EAAO,MAAM,EAIb,IAAIC,EAAMC,GAAU3D,CAAc,EAMlC,GAHA0D,EAAM,OAAO,aAAa,MAAM,KAAMA,CAAG,EAGrChB,GAAiB1C,EAAe,KAAK,EAAG,CAC1C,IAAI4D,EAAS,EAAE,QAAS,CAAE,MAAS,gBAAiB,CAAC,EACrDA,EAAO,KAAKF,CAAG,EACfD,EAAO,OAAOG,CAAM,EACpBvB,EAAY,8BAA+B,EAAI,CACjD,KACK,CACH,IAAIwB,EAAS,OAAO,KAAKH,CAAG,EAGxBI,EAAS,EAAE,MAAO,CAAE,KAAQ,wCAAwCD,EAAQ,OAAU,SAAU,SAAY,MAAO,CAAC,EACxHC,EAAO,KAAK9D,EAAe,QAAQ,EACnCyD,EAAO,OAAOK,CAAM,EACpBzB,EAAY,8DAA+D,EAAI,CACjF,CAEA,MAAO,EACX,CAEA,GAAItC,EAAS,CAKT,IAAIgE,EAAKC,GAAW,KAAM7D,CAAU,EAapC,GAZIA,GAAc,KACd4D,EAAKA,EAAG,OAAOC,GAAW,KAAM,EAAE,CAAC,GAGvCD,EAAG,KAAK,SAASE,EAAIC,EAAI,CACjB,OAAID,EAAG,OAAO,MAAQC,EAAG,OAAO,MACrB,GACFD,EAAG,OAAO,MAAQC,EAAG,OAAO,MAC1B,EACJA,EAAG,SAAS,QAAQ,EAAID,EAAG,SAAS,QAAQ,CACvD,CAAC,EAEDF,EAAG,QAAU,EACb,OAAAN,EAAO,MAAM,EACbP,EAAQ,EAAE,IAAIxD,EAAa,SAAS,EACpCwD,EAAM,KAAK,WAAY,EAAI,EAC3BA,EAAQ,EAAE,IAAIxD,EAAa,UAAU,EACrCwD,EAAM,KAAK,WAAY,EAAI,EAC3Bb,EAAY,oDAAqD,EAAI,EAC9D,GAGXjC,EAAe,CAAC,EAChB,IAAI+D,EAAY,GAChB,QAASC,EAAG,EAAGA,EAAGL,EAAG,OAAQK,IAAM,CAC/B,IAAMrB,EAAOgB,EAAGK,CAAE,EACdrB,EAAK,OAAO,OAASoB,IACrBA,EAAYpB,EAAK,OAAO,MACxB3C,EAAa,KAAK,CAAE,MAAM+D,CAAU,CAAC,GAEzC/D,EAAa,KAAK2C,CAAI,CAC1B,CACAgB,EAAK3D,EAELqD,EAAO,MAAM,EAEb,IAAMZ,EAAQ,EAAE,WAAY,CAAE,GAAInD,EAAa,UAAW,KAAK,OAAQ,CAAC,EACxEmD,EAAM,KAAK,OAAQ,GAAG,EACtB,IAAIwB,EAAc,GAClB,QAASD,EAAG,EAAGA,EAAGL,EAAG,OAAQK,IAAM,CAC/B,IAAMrB,EAAOgB,EAAGK,CAAE,EAClB,GAAI,CAACrB,EAAK,OAAQ,CACdtB,EAAK,EAAE,WAAY,CAAE,KAAK,IAAI2C,CAAG,CAAE,EACnC3C,EAAG,KAAK,WAAY,EAAI,EACxBA,EAAG,KAAK,MAAQR,EAAgB8B,EAAK,KAAK,EAAI,MAAM,EACpDF,EAAM,OAAOpB,CAAE,EACf,QACJ,CAEAA,EAAK,EAAE,WAAY,CAAE,KAAK,IAAI2C,CAAG,CAAE,EAC9BC,IACDA,EAAc,GACd5C,EAAG,SAAW,IAElB,IAAM6C,EAAUC,GAAYxB,EAAK,QAAQ,EACzCtB,EAAG,KAAKsB,EAAK,OAAO,SAAW,OAASuB,CAAO,EAC/CzB,EAAM,OAAOpB,CAAE,CACnB,CACA,OAAAgC,EAAO,OAAOZ,CAAK,EAEnBA,EAAM,GAAG,SAAUI,EAA2B,EAC9CA,GAA4B,EAE5BZ,EAAY,sHAAuH,EAAI,EAChI,EACX,CAKA,IAAM0B,EAAKC,GAAW/D,EAAWE,CAAU,EAO3C,GALA4D,EAAG,KAAK,SAASE,EAAIC,EAAI,CAAE,OAAOA,EAAG,SAAS,QAAQ,EAAID,EAAG,SAAS,QAAQ,CAAG,CAAC,EAClF7D,EAAe2D,EAIXA,EAAG,QAAU,EACbN,EAAO,MAAM,MAEZ,CACDA,EAAO,MAAM,EAEb,IAAMZ,EAAQ,EAAE,WAAY,CAAE,GAAInD,EAAa,UAAW,KAAK,OAAQ,CAAC,EACxEmD,EAAM,KAAK,OAAQ,GAAG,EACtB,IAAIE,EAAMuB,EACV,QAASF,EAAG,EAAGA,EAAGL,EAAG,OAAQK,IACzBrB,EAAOgB,EAAGK,CAAE,EACZ3C,EAAK,EAAE,WAAY,CAAE,KAAK,IAAI2C,CAAG,CAAE,EAC/BA,GAAM,IACN3C,EAAG,SAAW,IAClB6C,EAAUC,GAAYxB,EAAK,QAAQ,EACnCtB,EAAG,KAAKsB,EAAK,OAAO,SAAW,OAASuB,CAAO,EAC/CzB,EAAM,OAAOpB,CAAE,EAEnBgC,EAAO,OAAOZ,CAAK,EAEfhD,GACAgD,EAAM,GAAG,SAAUD,EAAmB,CAC9C,CAEI/C,GACAwC,EAAY,aAAenC,EAAiB,IAAK,EAAI,EACrDuB,EAAK,EAAE,IAAI/B,EAAa,SAAS,EACjC+B,EAAG,KAAK,WAAY,EAAK,GAGrBsC,EAAG,QAAU,GACb1B,EAAY,eAAiBnC,EAAiB,mBAAoB,EAAI,EACtEuB,EAAK,EAAE,IAAI/B,EAAa,SAAS,EACjC+B,EAAG,KAAK,WAAY,EAAI,IAGxBY,EAAY,YAAcnC,EAAiB,YAAa,EAAI,EAC5DuB,EAAK,EAAE,IAAI/B,EAAa,SAAS,EACjC+B,EAAG,KAAK,WAAY,EAAK,EAGrC,CAYA,SAAS+C,GAAsBnB,EAAsB,CACjD,OAAOA,CACX,CAQA,SAASE,GAAmBF,EAAUxC,EAAOC,EAAQ,CAC5CuC,IACDA,EAAW,IACVxC,IACDA,EAAQ,IACPC,IACDA,EAAS,IACb,IAAIP,EAAMM,EAAQ,IAAMC,EAAS,IAAMuC,EACnCoB,EAAM,CAAE,OAAQ,UAAUlE,EAAK,QAAS,WAAWA,EAC3C,SAAU8C,EAAU,MAAOxC,EAAO,OAAQC,CAAO,EAC7D,OAAO2D,CACX,CAOA,SAASC,GAAwB7D,EAAO,CACpC,IAAI8D,EAAY,IAAI,KAAK,EAAE,QAAQ,EAC/BtB,EAAW,SAAWsB,EAAY,IAAM,KAAK,OAAO,EACxD,OAAAtB,EAAWA,EAAS,QAAQ,IAAK,EAAE,EAC5BE,GAAmBF,EAAUxC,CAAK,CAC7C,CAMA,SAAS+D,GAAgBC,EAAQ,CAC7B,GAAIA,EAAO,MAAM,EAAE,CAAC,GAAK,UACrB,OAAO,KAEX,IAAIC,EAAS,EACThC,EAAM+B,EAAO,QAAQ,IAAKC,CAAM,EACpC,GAAIhC,EAAM,EACN,OAAO,KACX,IAAIjC,EAAQgE,EAAO,MAAMC,EAAQhC,CAAG,EAIpC,GAHAgC,EAAShC,EAAI,EAEbA,EAAM+B,EAAO,QAAQ,IAAKC,CAAM,EAC5BhC,EAAM,EACN,OAAO,KACX,IAAIhC,EAAS+D,EAAO,MAAMC,EAAQhC,CAAG,EACrCgC,EAAShC,EAAI,EAEb,IAAIO,EAAWwB,EAAO,MAAMC,CAAM,EAC9BC,EAAS,OAAOF,EAAO,MAAM,CAAC,EAE9BJ,EAAM,CAAE,OAAQI,EAAQ,QAASE,EACzB,SAAU1B,EAAU,MAAOxC,EAAO,OAAQC,CAAO,EAC7D,OAAO2D,CACX,CAOA,SAASO,GAAiB1B,EAAQ,CAC9B,GAAI,OAAOA,GAAW,WAClBA,EAASsB,GAAgBtB,CAAM,EAC3B,CAACA,GACD,OAAO,KAGf,IAAI2B,EAAajE,EAAQ,QAAQsC,EAAO,MAAM,EAC9C,GAAI,CAAC2B,EACD,OAAO,KAEX,IAAIlC,EAAO,CAAE,OAAQO,CAAO,EAExBc,EAAItB,EAAKvC,EAAKkC,EAEdsB,EAAKkB,EAAW,SAAS,EAAE,MAAM,GAAG,EACxC,IAAKb,EAAG,EAAGA,EAAGL,EAAG,OAAQK,IAGrB,GAFA3B,EAAMsB,EAAGK,CAAE,EACXtB,EAAML,EAAI,QAAQ,GAAG,EACjB,EAAAK,EAAM,GAKV,OAHAvC,EAAMkC,EAAI,MAAM,EAAGK,CAAG,EACtBL,EAAMA,EAAI,MAAMK,EAAI,CAAC,EAEbvC,EAAK,CACb,IAAK,UACDwC,EAAK,QAAU,IAAI,KAAK,OAAON,CAAG,CAAC,EACnC,MACJ,IAAK,WACDM,EAAK,SAAW,IAAI,KAAK,OAAON,CAAG,CAAC,EACpC,KACJ,CAMJ,OAAOM,CACX,CAIA,SAASI,EAAgBsB,EAAK,CAC1B,IAAIQ,EAAajE,EAAQ,QAAQyD,EAAI,MAAM,EAC3C,MAAK,EAAAQ,CAIT,CAIA,SAASzB,GAAgBiB,EAAK,CAC1BzD,EAAQ,WAAWyD,EAAI,MAAM,EAC7BzD,EAAQ,WAAWyD,EAAI,OAAO,CAClC,CAYA,SAASS,GAAW5B,EAAQ6B,EAASC,EAAO,CACxC,GAAIA,GAASD,IAAY,GACrB,MAAM,IAAI,MAAM,wCAAwC,EAG5D,IAAI1C,EAAKsB,EACLsB,EAAMC,EAENvC,EAAOiC,GAAiB1B,CAAM,EAwBlC,OAvBKP,IAEDA,EAAO,CAAE,OAAQO,EAAQ,QAAS,IAAI,IAAO,GAGjDP,EAAK,SAAW,IAAI,KAEpBoC,EAAU1E,GAAiB0E,CAAO,EAElCpB,EAAK,CAAC,EAEFhB,EAAK,SACLgB,EAAG,KAAK,WAAahB,EAAK,QAAQ,QAAQ,CAAC,EAC3CA,EAAK,UACLgB,EAAG,KAAK,YAAchB,EAAK,SAAS,QAAQ,CAAC,EAKjDN,EAAMsB,EAAG,KAAK,GAAG,EACjBsB,EAAOrE,EAAQ,QAAQ+B,EAAK,OAAO,OAAQN,CAAG,EAC9C6C,EAAOtE,EAAQ,QAAQ+B,EAAK,OAAO,QAASoC,CAAO,EAE/C,EAAAE,GAAQC,EAIhB,CAWA,SAAS3B,GAAUL,EAAQ8B,EAAO,CAC9B,GAAIA,EACA,MAAM,IAAI,MAAM,wCAAwC,EAE5D,IAAIrC,EAAOiC,GAAiB1B,CAAM,EAClC,GAAI,CAACP,EACD,OAAO,KAEX,IAAIoC,EAAUnE,EAAQ,QAAQsC,EAAO,OAAO,EAC5C,OAAI6B,GAAW,KACJ,KAEJI,GAAiBJ,CAAO,CACnC,CAEA,SAASK,IAAsB,CAC3B,MAAM,IAAI,MAAM,8CAA8C,CAClE,CAMA,SAASC,GAAiBhB,EAAK5D,EAAOC,EAAQ,CAM1C,MALI,EAAAD,GAAS,MACL4D,EAAI,OAAS5D,GAIjBC,GAAU,MACN2D,EAAI,QAAU3D,EAK1B,CAMA,SAASkD,GAAWnD,EAAOC,EAAQ,CAC/B,IAAIsD,EACAL,EAAK,CAAC,EAEV,GAAI,CAAC/C,EACD,OAAO+C,EAEX,IAAI2B,EAAQ1E,EAAQ,QAAQ,EAC5B,IAAKoD,EAAG,EAAGA,EAAGsB,EAAM,OAAQtB,IAAM,CAC9B,IAAI7D,EAAMmF,EAAMtB,CAAE,EAClB,GAAK7D,EAEL,KAAI+C,EAASsB,GAAgBrE,EAAI,SAAS,CAAC,EAC3C,GAAK+C,GAEAmC,GAAiBnC,EAAQzC,EAAOC,CAAM,EAE3C,KAAIiC,EAAOiC,GAAiB1B,CAAM,EAClCS,EAAG,KAAKhB,CAAI,GAChB,CAGA,OAAOgB,CACX,CAIA,SAASQ,GAAYoB,EAAM,CACvB,GAAI,CAACA,EACD,MAAO,MAEX,IAAIC,EAAOD,EAAK,SAAS,EAAE,EAAK,IAAMA,EAAK,QAAQ,EAC/CE,EAAOF,EAAK,SAAS,EAAI,KAAOA,EAAK,WAAW,EAAI,GAAK,IAAM,IAAMA,EAAK,WAAW,EACzF,OAAOC,EAAM,IAAMC,CACvB,CAQA,SAASC,GAAeC,EAAWC,EAAU,CACzC,IAAMzF,EAAM,YAAcwF,EACpBE,EAAW1F,EAAM,QACjB2F,EAAU3F,EAAM,OACjByF,GAMGA,EAAS,MACThF,EAAQ,QAAQkF,EAASzF,GAAiBuF,EAAS,GAAG,CAAC,EACvD,OAAOA,EAAS,KAEpBhF,EAAQ,QAAQT,EAAKE,GAAiBpB,GAAY,OAAO,KAAK,UAAU2G,CAAQ,CAAC,CAAC,CAAC,EACnFhF,EAAQ,QAAQiF,EAAUxF,GAAiBpB,GAAY,OAAO,KAAK,UAAU,CAAC,SAAU,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,IAVtG2B,EAAQ,WAAWT,CAAG,EACtBS,EAAQ,WAAWiF,CAAQ,EAC3BjF,EAAQ,WAAWkF,CAAO,EAUlC,CAIA,IAAIC,GACJ,SAASC,GAAcL,EAAW,CAC9BI,GAAkBJ,EAClB,IAAMxF,EAAM,YAAcwF,EACpBG,EAAU3F,EAAM,OAChBkC,EAAMzB,EAAQ,QAAQT,CAAG,EAC/B,GAAIkC,EACA,GAAI,CACA,IAAM/B,EAAO,KAAK,MAAMtB,GAAY,OAAOmG,GAAiB9C,CAAG,CAAC,CAAC,EAC3D4D,EAAMrF,EAAQ,QAAQkF,CAAO,EACnC,OAAIG,IACA3F,EAAK,IAAM6E,GAAiBc,CAAG,GAE5B3F,CACX,MACU,CACN,OAAO,IACX,CAEJ,OAAO,IACX,CAEA,eAAe4F,IAAiB,CAC5B,GAAI,CAACH,GACD,MAAM,IAAI,MAAM,iEAAiE,EAErFL,GAAeK,GAAiB,IAAI,CACxC,CAWA,IAAInF,EAAU,KACd,GAAI,CACA,IAAIuF,GAAmB,KAWvB,GATI,OAAO,cAAgB,KAEvBA,GAAmB,OAAO,aAErB,OAAO,eAAiB,OAE7BA,GAAmB,OAAO,cAAc,SAAS,QAAQ,GAGzDA,GAGA,GAAI,CAEA,GADAA,GAAiB,QAAQ,cAAe,OAAO,EAC3CA,GAAiB,QAAQ,aAAa,GAAK,QAC3C,MAAM,IAAI,MAAM,iCAAiC,EACrDA,GAAiB,WAAW,aAAa,EAEzCvF,EAAU,CACN,QAAS,SAAST,EAAK,CACnB,GAAI,CACA,OAAOgG,GAAiB,QAAQhG,CAAG,CACvC,MACW,CACP,OAAO,IACX,CACJ,EACA,WAAY,SAASA,EAAK,CACtB,GAAI,CACAgG,GAAiB,WAAWhG,CAAG,CACnC,MACW,CACP,OAAO,IACX,CACJ,EACA,QAAS,SAASA,EAAKkC,EAAK,CACxB,GAAI,CACA8D,GAAiB,QAAQhG,EAAKkC,CAAG,CACrC,MACW,CAEP,MAAO,EACX,CACJ,EACA,QAAS,UAAW,CAEhB,QADIsB,EAAK,CAAC,EACDK,EAAG,EAAGA,EAAGmC,GAAiB,OAAQnC,IACvCL,EAAG,KAAKwC,GAAiB,IAAInC,CAAE,CAAC,EACpC,OAAOL,CACX,CACJ,CACJ,MACW,CAGX,CAER,MAEW,CAAE,CAEb,OAAI/C,GAAW,OAIXA,EAAU,CACN,KAAM,CAAC,EACP,KAAM,CAAC,EACP,QAAS,SAAST,EAAK,CACnB,OAAOS,EAAQ,KAAKT,CAAG,CAC3B,EACA,QAAS,SAASA,EAAKkC,EAAK,CACpBzB,EAAQ,KAAK,QAAQT,CAAG,EAAI,GAC5BS,EAAQ,KAAK,KAAKT,CAAG,EAEzBS,EAAQ,KAAKT,CAAG,EAAIkC,CACxB,EACA,WAAY,SAASlC,EAAK,CACtB,IAAIuC,EAAM9B,EAAQ,KAAK,QAAQT,CAAG,EAC9BuC,GAAO,IACP9B,EAAQ,KAAK,OAAO8B,EAAK,CAAC,EAC1B,OAAO9B,EAAQ,KAAKT,CAAG,EAE/B,EACA,QAAS,UAAW,CAChB,OAAOS,EAAQ,KAAK,MAAM,CAAC,CAC/B,CACJ,GAGJ,EAAE,MAAM,EAAE,GAAG,UAAWiB,EAAqB,EAItC,CACH,UAAW,GACX,KAAM5B,EAEN,KAAMM,EAEN,sBAAuB6D,GACvB,mBAAoBjB,GACpB,wBAAyBmB,GACzB,gBAAiBvB,EACjB,gBAAiBK,GACjB,WAAY0B,GACZ,UAAWvB,GAGX,WAAY6B,GAGZ,eAAAc,GACA,eAAgBR,GAChB,cAAeM,EACnB,CAEA,EAAE,EAEKI,GAAQ/G,GC9uCf,IAAIgH,GAAM,UAAW,CAGrB,IAAIC,EAAK,KAGT,IAAIC,EAAQ,KACRC,EAAS,KACTC,EAAU,KACVC,EAAS,KAGPC,EAAU,CAAC,EAGjB,IAAIC,EACAC,EACAC,EACAC,EACAC,EAGAC,EAAa,GACbC,EAAc,GACdC,EAAkB,KAClBC,EAAqB,KACrBC,EAAmB,EACnBC,GAAyB,KACzBC,EAA0B,KAgB9B,SAASC,GAAKC,EAAY,CACtB,GAAIA,EAAW,OAEXjB,EAASiB,EAAW,WAIpB,OAAM,IAAI,MAAM,wBAAwB,EAa5C,GAVIA,EAAW,UAEXhB,EAAUgB,EAAW,SAGrBA,EAAW,QAEXlB,EAAQkB,EAAW,OAGnBA,EAAW,OAEXf,EAASe,EAAW,WAIpB,OAAM,IAAI,MAAM,wBAAwB,EAG5CnB,EAAKmB,EAAW,GACZhB,IACIA,EAAQ,OACRA,EAAQ,OAAOH,CAAE,EAGjBG,EAAQ,KAAK,CACT,GAAI,KACJ,GAAIH,CACR,CAAC,GAITmB,EAAW,OAASC,GAEpBhB,EAAO,KAAKe,CAAU,EAEtBb,EAAsBa,EAAW,aACjCZ,EAAwBY,EAAW,eACnCX,EAA4BW,EAAW,mBACvCV,EAAuBU,EAAW,cAClCT,EAA0BS,EAAW,iBAEjCX,GACAA,EAA0B,CAElC,CAEA,SAASY,GAAgBC,EAAK,CAC1B,IAAIC,EAGJ,GAAIV,EAAa,CAGbW,EAAK,oCAAoC,EACzC,MACJ,CAEA,GAAIF,EAAI,KAAON,EAAkB,CAC/BX,EAAO,IAAI,gDAAkDiB,EAAI,IAAM,kBAAoBN,CAAgB,EAC3G,MACF,CAOA,OANAA,GAAoB,EAIpBC,GAAyBK,EAAI,QAErBA,EAAI,KAAM,CAClB,IAAK,OACDG,EAAkBH,EAAI,QAElBA,EAAI,SACJA,EAAI,QAAQ,QAAQI,GAAQpB,EAAQoB,CAAI,EAAI,CAAC,EAGjDzB,EAAG,MAAM,EACT,MAEJ,IAAK,WAAY,CACb,IAAI0B,EAAM,KACNjB,IACAiB,EAAMjB,EAAqBY,EAAI,KAAK,GAEpC,CAACK,GAAOL,EAAI,OAAS,UAGrBM,GAAoB,KAAK,IAAI,EAC7BD,EAAM,CAAE,KAAME,EAAM,YAAa,GAEjCF,GAAOA,EAAI,MACXG,EAAsBH,CAAG,EAE7B,KACJ,CAEA,IAAK,QAAS,CACVC,GAAoB,KAAK,IAAI,EAC7B,IAAMD,EAAM,CAAE,KAAME,EAAM,YAAa,EACvCC,EAAsBH,CAAG,EACzB,KACJ,CAEA,IAAK,YACDI,GAAuBT,EAAI,OAAQA,EAAI,KAAK,EAC5C,MAEJ,IAAK,QACDU,GAAmBV,EAAI,OAAQA,EAAI,EAAGA,EAAI,CAAC,EAC3C,MAEJ,IAAK,OACDW,GAAkBX,EAAI,OAAQA,EAAI,KAAK,EACvC,MAEJ,IAAK,OACDY,GAAkBZ,EAAI,OAAQA,EAAI,MAAOA,EAAI,UAAU,EACvD,MAEJ,IAAK,UACDG,EAAkBH,EAAI,QACtBC,EAAM,CACF,KAAME,EAAgB,YACtB,IAAKA,EAAgB,YACrB,MAAOA,EAAgB,MAAMA,EAAgB,YAC7C,OAAQA,EAAgB,OAAOA,EAAgB,WACnD,EACIU,IACAC,GAAqBD,GAAaZ,CAAG,EACzCc,GAAqB,EACrB,MAEJ,IAAK,SACDC,GAAoB,EACpB,MAEJ,IAAK,kBACGhB,EAAI,UAAY,kBAChBiB,GAAsCjB,CAAG,EAE7C,KACJ,CACJ,CAEA,SAASe,IAAuB,CACvBG,IAGLA,EAAc,UAAU,EAAGX,EAAM,cAAc,EAC/CW,EAAc,UAAU,EAAG,IAAI,EAC/BA,EAAc,UAAU,EAAG,CAAC,EAC5BA,EAAc,UAAU,EAAG,CAAC,EAExBpC,GACAA,EAAQ,eAAeoC,CAAa,EACxCA,EAAgB,KAChBvC,EAAG,OAAO,EACd,CAEA,SAASqC,IAAsB,CACtBE,IAGLA,EAAc,UAAU,EAAGX,EAAM,aAAa,EAC9CW,EAAc,UAAU,EAAG,IAAI,EAC/BA,EAAc,UAAU,EAAG,CAAC,EAC5BA,EAAc,UAAU,EAAG,CAAC,EAExBpC,GACAA,EAAQ,eAAeoC,CAAa,EACxCA,EAAgB,KAChBvC,EAAG,OAAO,EACd,CAEA,SAAS6B,EAAsBH,EAAK,CAChC,GAAKa,EAIL,KAAIC,EAAO,EACPC,EAAO,EACPf,EAAI,OACJc,EAAOd,EAAI,MACXA,EAAI,OACJe,EAAOf,EAAI,MAEfa,EAAc,UAAU,EAAGb,EAAI,IAAI,EACnCa,EAAc,UAAU,EAAG,IAAI,EAC/BA,EAAc,UAAU,EAAGC,CAAI,EAC/BD,EAAc,UAAU,EAAGE,CAAI,EAE3BtC,GACAA,EAAQ,eAAeoC,CAAa,EACxCA,EAAgB,KAChBvC,EAAG,OAAO,EACd,CAEA,SAAS8B,GAAuBY,EAAUC,EAAK,CAC3C,GAAKJ,EAGL,KAAIK,EAAM,KACV,IAAKA,EAAIC,EAAgBD,GACjBA,EAAI,UAAYF,EADME,EAAIA,EAAI,KAClC,CAGA,CAACA,GAAO,CAACA,EAAI,oBAGjBL,EAAc,UAAU,EAAGX,EAAM,gBAAgB,EACjDW,EAAc,UAAU,EAAGK,CAAG,EAC9BL,EAAc,UAAU,EAAGI,CAAG,EAC9BJ,EAAc,UAAU,EAAG,CAAC,EAE5BK,EAAI,kBAAoB,GAEpBzC,GACAA,EAAQ,eAAeoC,CAAa,EACxCA,EAAgB,KAChBvC,EAAG,OAAO,GACd,CAEA,SAAS+B,GAAmBW,EAAUI,EAAMC,EAAM,CAC9C,GAAKR,EAGL,KAAIK,EAAM,KACV,IAAKA,EAAIC,EAAgBD,GACjBA,EAAI,UAAYF,EADME,EAAIA,EAAI,KAClC,CAGA,CAACA,GAAO,CAACA,EAAI,gBAGjBL,EAAc,UAAU,EAAGX,EAAM,iBAAiB,EAClDW,EAAc,UAAU,EAAGK,CAAG,EAC9BL,EAAc,UAAU,EAAGO,CAAI,EAC/BP,EAAc,UAAU,EAAGQ,CAAI,EAE/BH,EAAI,cAAgB,GAEhBzC,GACAA,EAAQ,eAAeoC,CAAa,EACxCA,EAAgB,KAChBvC,EAAG,OAAO,GACd,CAEA,SAASgC,GAAkBU,EAAUM,EAAO,CACxC,IAAIC,EAEJ,GAAKV,EAGL,KAAIK,EAAM,KACV,IAAKA,EAAIC,EAAgBD,GACjBA,EAAI,UAAYF,EADME,EAAIA,EAAI,KAClC,CAGA,CAACA,GAAO,CAACA,EAAI,eAGbI,EAAM,QAAU,GAChBC,EAAUD,EAAM,WAAW,CAAC,EACvBJ,EAAI,mBACLK,EAAUA,EAAU,OAGxBA,EAAUC,GAAiBF,CAAK,EAC3BC,IACDA,EAAUrB,EAAM,kBAGxBW,EAAc,UAAU,EAAGX,EAAM,gBAAgB,EACjDW,EAAc,UAAU,EAAGK,CAAG,EAC9BL,EAAc,UAAU,EAAGU,CAAO,EAClCV,EAAc,UAAU,EAAG,CAAC,EAE5BK,EAAI,aAAe,GACnBA,EAAI,iBAAmB,GACvBA,EAAI,iBAAmB,KAEnBzC,GACAA,EAAQ,eAAeoC,CAAa,EACxCA,EAAgB,KAChBvC,EAAG,OAAO,GACd,CAEA,SAASiC,GAAkBS,EAAUM,EAAOG,EAAS,CACjD,IAAIC,EAEJ,GAAKb,EAGL,KAAIK,EAAM,KACV,IAAKA,EAAIC,EAAgBD,GACjBA,EAAI,UAAYF,EADME,EAAIA,EAAI,KAClC,CAGJ,GAAI,GAACA,GAAO,CAACA,EAAI,cAkBjB,KAfII,EAAM,OAASJ,EAAI,QAAQ,SAC3BI,EAAQA,EAAM,MAAM,EAAGJ,EAAI,QAAQ,MAAM,GAEzCA,EAAI,0BACJQ,EAAKR,EAAI,MACTS,GAAcT,EAAI,IAAKhB,EAAM,WAAW,EACxC0B,GAAsBV,EAAKI,CAAK,EAC5BJ,EAAI,SACJW,GAAuBX,EAAI,QAASI,CAAK,EAC7CK,GAAcT,EAAI,IAAKQ,CAAE,EACzBE,GAAsBV,EAAK;AAAA,CAAI,EAC3BA,EAAI,SACJW,GAAuBX,EAAI,QAAS;AAAA,CAAI,GAG3CQ,EAAG,EAAGA,EAAGJ,EAAM,OAAQI,IACxBR,EAAI,QAAQQ,CAAE,EAAIJ,EAAM,WAAWI,CAAE,EAEzC,IAAII,EAAW,EACXL,GAAWD,GAAiBC,CAAO,IACnCK,EAAWN,GAAiBC,CAAO,GAEvCZ,EAAc,UAAU,EAAGX,EAAM,gBAAgB,EACjDW,EAAc,UAAU,EAAGK,CAAG,EAC9BL,EAAc,UAAU,EAAGS,EAAM,MAAM,EACvCT,EAAc,UAAU,EAAGiB,CAAQ,EAE/BrD,GACAA,EAAQ,eAAeyC,EAAI,OAAO,EACtCA,EAAI,aAAe,GACnBA,EAAI,iBAAmB,GACvBA,EAAI,wBAA0B,KAC9BA,EAAI,iBAAmB,KACvBA,EAAI,QAAU,KAEVzC,GACAA,EAAQ,eAAeoC,CAAa,EACxCA,EAAgB,KAChBvC,EAAG,OAAO,GACd,CAEA,SAASyD,IAAS,CACd,IAAIC,EAAU,CAAE,KAAM,SAAU,IAAK3C,CAAiB,EAClD4C,EAAW,KACXC,EAAe,KACfC,EAAa,KACbjB,EAAKvB,EAAKyC,EAAMC,EAAQC,EAASC,EAAItB,EAAKS,EAAIc,EAC9CC,GAASC,GAEb,GAAIC,IAGA,IAFAA,GAAmB,GACnBV,EAAW,CAAC,EACPf,EAAIC,EAAgBD,EAAKA,EAAIA,EAAI,KAClC,GAAIA,EAAI,MAAQhB,EAAM,aAMtB,QAHAP,EAAM,CAAE,GAAIuB,EAAI,SAAU,KAAMA,EAAI,IAAK,EACzCe,EAAS,KAAKtC,CAAG,EAETuB,EAAI,KAAM,CAClB,KAAKhB,EAAM,mBACPP,EAAI,KAAO,SACXA,EAAI,OAASiD,GAAiB1B,EAAI,UAAU,EAC5C,MACJ,KAAKhB,EAAM,iBACPP,EAAI,KAAO,OACXA,EAAI,UAAYuB,EAAI,UACpBvB,EAAI,WAAauB,EAAI,WACrBvB,EAAI,OAASiD,GAAiB1B,EAAI,UAAU,EAC5C,MACJ,KAAKhB,EAAM,iBACPP,EAAI,KAAO,WACXA,EAAI,WAAauB,EAAI,WACrBvB,EAAI,YAAcuB,EAAI,YACtB,KACJ,CAEAvB,EAAI,KAAOuB,EAAI,KAAK,KACpBvB,EAAI,IAAMuB,EAAI,KAAK,IACnBvB,EAAI,MAAQuB,EAAI,KAAK,MAAQA,EAAI,KAAK,KACtCvB,EAAI,OAASuB,EAAI,KAAK,OAASA,EAAI,KAAK,KAIhD,IAAKA,EAAIC,EAAgBD,EAAKA,EAAIA,EAAI,KAAM,CAMxC,OALAmB,EAAS,GACT1C,EAAM,CAAE,GAAIuB,EAAI,QAAS,EACrBgB,GAAgB,OAChBA,EAAe,CAAC,GAEZhB,EAAI,KAAM,CAClB,KAAKhB,EAAM,mBAkBP,GAjBA2C,GAA+B3B,CAAG,EAC9BA,EAAI,QAAQ,SACZvB,EAAI,KAAOuB,EAAI,QAAQ,MAAM,CAAC,EAC9BA,EAAI,QAAQ,OAAS,EACrBmB,EAAS,IAETnB,EAAI,eACJvB,EAAI,MAAQ,GACZA,EAAI,GAAKuB,EAAI,WACbvB,EAAI,GAAKuB,EAAI,WACbA,EAAI,aAAe,GACnBmB,EAAS,GACJ1C,EAAI,OACLA,EAAI,KAAO,CAAC,GAEhBuB,EAAI,QAAQ,OAAS,GAErBvB,EAAI,MAAQA,EAAI,KAAK,OACrB,IAAK+B,EAAG,EAAGA,EAAG/B,EAAI,KAAK,OAAQ+B,IAC3BR,EAAI,QAAQ,KAAKvB,EAAI,KAAK+B,CAAE,CAAC,EAGjCR,EAAI,QAAQ,OAAS,KACrBA,EAAI,QAAQ,OAAO,EAAGA,EAAI,QAAQ,OAAO,GAAG,EAEhD,MACJ,KAAKhB,EAAM,iBACP,GAAIgB,EAAI,WAAa,GAAKA,EAAI,YAAc,EACxC,MAEJ,IADAvB,EAAI,MAAQ,CAAC,EACR+B,EAAG,EAAGA,EAAGR,EAAI,WAAYQ,IAE1B,GADAY,EAAUpB,EAAI,MAAMQ,CAAE,EAClB,EAACY,EAAQ,MAKb,KAHAA,EAAQ,MAAQ,GAChBC,EAAK,CAAC,EACNG,GAAU,EACLF,EAAG,EAAGA,EAAGtB,EAAI,WAAa,CAC3B,IAAM4B,GAAYR,EAAQ,OAAOE,CAAE,EAC7BO,GAAgBT,EAAQ,WAAWE,CAAE,EACrCQ,GAASV,EAAQ,IAAIE,CAAE,EACvBS,GAASX,EAAQ,IAAIE,CAAE,EACvBU,GAAcZ,EAAQ,SAASE,CAAE,EACvC,KAAOA,EAAGtB,EAAI,WACFoB,EAAQ,OAAOE,CAAE,IAAMM,IACvBR,EAAQ,WAAWE,CAAE,IAAMO,IAC3BT,EAAQ,IAAIE,CAAE,IAAMQ,IACpBV,EAAQ,IAAIE,CAAE,IAAMS,IACpBX,EAAQ,SAASE,CAAE,IAAMU,GAChCV,IAAM,CAGPE,GAAUF,IACN,CAACO,IAAiBC,IAAU,MAAQC,IAAU,MAAQ,CAACC,IACvDX,EAAG,KAAKY,GAAaL,EAAS,CAAC,EAC/BP,EAAG,KAAKD,EAAQ,MAAM,MAAMI,GAASF,CAAE,EAAE,KAAK,EAAE,CAAC,IAGjDJ,EAAO,CACH,MAAOe,GAAaL,EAAS,EAC7B,KAAMR,EAAQ,MAAM,MAAMI,GAASF,CAAE,EAAE,KAAK,EAAE,EAC9C,UAAWO,EACf,GACIE,IAAUD,IAAUE,MACpBd,EAAK,WAAa,CAAC,EACfa,KACAb,EAAK,WAAW,kBAAkB,EAAIa,IAEtCD,KACAZ,EAAK,WAAW,MAAQY,IAExBE,KACAd,EAAK,WAAW,QAAUc,KAGlCX,EAAG,KAAKH,CAAI,GAEhBM,GAAUF,EAElB,CACA7C,EAAI,MAAM,KAAK,CAAE,KAAK+B,EAAI,QAAQa,CAAG,CAAC,EAEtCrB,EAAI,eACJvB,EAAI,MAAQ,GACZA,EAAI,GAAKuB,EAAI,WACbvB,EAAI,GAAKuB,EAAI,WACbA,EAAI,aAAe,IAEvBmB,EAAS1C,EAAI,MAAM,OACnB,MACJ,KAAKO,EAAM,iBACHgB,EAAI,QAAQ,SACZvB,EAAI,KAAOuB,EAAI,QAAQ,MAAM,CAAC,EAC9BA,EAAI,QAAQ,OAAS,EACrBmB,EAAS,IAIb,IAAIe,GAAY,GAChB,GAAIzD,EAAI,MAAQA,EAAI,KAAK,OACrB,IAAK+B,EAAG,EAAGA,EAAG/B,EAAI,KAAK,OAAQ+B,IAAM,CACjC,IAAI2B,GAAS1D,EAAI,KAAK+B,CAAE,EACpB2B,GAAO,SAAW,QACfA,GAAO,IAAM,QAAaA,GAAO,IAAM,QACvCA,GAAO,QAAU,QAAaA,GAAO,SAAW,SACnDD,GAAYlC,EAAI,QAAQ,QAE5BA,EAAI,QAAQ,KAAKmC,EAAM,CAC3B,CAEJ,GAAID,IAAa,EAAG,CAGhB,IAAIE,GAAS,KACb,QAAS5B,GAAG,EAAGA,GAAGR,EAAI,QAAQ,QAAUQ,GAAG0B,GAAW1B,KAAM,CACxD,IAAM2B,GAASnC,EAAI,QAAQQ,EAAE,EACzB2B,GAAO,SAAW,aAClBC,GAASD,GACjB,CACAnC,EAAI,QAAQ,OAAO,EAAGkC,EAAS,EAC3BE,IACApC,EAAI,QAAQ,QAAQoC,EAAM,CAClC,CACA,KACJ,CAEIjB,GACAH,EAAa,KAAKvC,CAAG,CAC7B,CAGA,IADAwC,EAAa,CAAC,EACTjB,EAAIC,EAAgBD,EAAKA,EAAIA,EAAI,KAClCvB,EAAM,KACFuB,EAAI,eACJvB,EAAM,CAAE,GAAIuB,EAAI,SAAU,KAAM,OAAQ,IAAKA,EAAI,gBAAiB,EAC9DA,EAAI,MAAQhB,EAAM,mBACdqD,GAA6BrC,CAAG,GAChCvB,EAAI,KAAOuB,EAAI,UACfvB,EAAI,KAAOuB,EAAI,WAAW,IAG1BvB,EAAI,KAAOuB,EAAI,QACfvB,EAAI,KAAOuB,EAAI,WAIvBA,EAAI,eACJuB,GAAU,GACNlD,IACA0B,EAAM1B,EAAwB2B,EAAI,QAAQ,EACtCD,IACAwB,GAAUxB,IAKlBtB,EAAM,CAAE,GAAIuB,EAAI,SAAU,KAAM,OAAQ,IAAKA,EAAI,iBACzC,OAAQA,EAAI,QAAQ,OAAQ,QAASuB,EAAQ,EACjDvB,EAAI,uBAAuB,SAC3BvB,EAAI,YAAcuB,EAAI,wBAEtBA,EAAI,MAAQhB,EAAM,mBACdqD,GAA6BrC,CAAG,GAChCvB,EAAI,KAAOuB,EAAI,UACfvB,EAAI,KAAOuB,EAAI,WAAW,IAG1BvB,EAAI,KAAOuB,EAAI,QACfvB,EAAI,KAAOuB,EAAI,WAIvBA,EAAI,oBACCvB,IACDA,EAAM,CAAE,GAAIuB,EAAI,QAAS,GAC7BvB,EAAI,UAAY,IAEhBuB,EAAI,gBACCvB,IACDA,EAAM,CAAE,GAAIuB,EAAI,QAAS,GAC7BvB,EAAI,MAAQ,IAEZA,GACAwC,EAAW,KAAKxC,CAAG,EAG3BqC,EAAQ,QAAUC,EAClBD,EAAQ,QAAUE,EAClBF,EAAQ,MAAQG,EAEZqB,IAAsBC,KAEtBzB,EAAQ,MAAQyB,GAChBD,GAAqBC,IAGrBtE,IAEA6C,EAAQ,aAAe7C,GAGvBD,IAEA8C,EAAQ,QAAU,IAItB,IAAM0B,GAAkBC,GAAW,OAAO,mBAAmB,IAAI,kBAAkB,EAsBnF,GArBIC,IAAgBF,KAEhBE,GAAeF,GACf1B,EAAQ,eAAiB0B,IAAmB,IAIhDnE,EAA0B,KAKtBsE,IACA7B,EAAQ,YAAc6B,GAC1BA,EAA2B,KAE3BnF,EAAO,OAAOsD,EAAS6B,CAAwB,EAE3C/E,GACAA,EAA0B,EAE1BD,GACA,GAAII,EAEAX,EAAG,YAAY,EAAE,UAEZG,EAAS,CAEd,IAAIqF,GAAWrF,EAAQ,eAAe,EAClCqF,IACAxF,EAAG,YAAYwF,EAAQ,CAC/B,EAER,CAMA,SAASC,GAAY9C,EAAK,CACtB,OAAQA,EAAK,CACT,IAAK,KAAM,OAAO3C,EAClB,IAAK,SAAU,OAAOI,EACtB,IAAK,UAAW,OAAOD,EACvB,IAAK,QAAS,OAAOF,EACrB,IAAK,SAAU,OAAOG,EAAO,WAAW,QAAQ,CACpD,CAEA,OAAO,IACX,CAKA,SAASsF,IAAgB,CACrB,IAAIhE,EAAM,CAAC,EAEPQ,KACAR,EAAI,QAAUQ,GAAY,UAE1ByD,IACAjE,EAAI,WAAaiE,EAAe,UAEhCR,KACAzD,EAAI,eAAiByD,IAEzBzD,EAAI,QAAU,CAAC,EACf,QAASkB,EAAMC,EAAgBD,EAAKA,EAAMA,EAAI,KAAM,CAChD,IAAIvB,EAAM,CACN,KAAMuB,EAAI,KAAM,KAAMA,EAAI,KAAM,SAAUA,EAAI,SAC9C,MAAOA,EAAI,MAAO,UAAWA,EAAI,UACjC,GAAIA,EAAI,GAAI,GAAIA,EAAI,GAAI,QAASA,EAAI,QACrC,WAAYA,EAAI,WAAY,WAAYA,EAAI,UAChD,EAYA,GAXIA,EAAI,SACJvB,EAAI,OAASuB,EAAI,OAAO,UAC5BvB,EAAI,IAAMuB,EAAI,IAAI,SACdA,EAAI,UACJvB,EAAI,QAAUuB,EAAI,QAAQ,UAE9BvB,EAAI,KAAO,CACP,KAAMuB,EAAI,KAAK,KAAM,MAAOA,EAAI,KAAK,MACrC,IAAKA,EAAI,KAAK,IAAK,OAAQA,EAAI,KAAK,MACxC,EAEIA,EAAI,UAAY,KAAM,CACtB,IAAIgD,EAAOzF,EAAQ,mBAAmByC,EAAI,OAAO,EACjDvB,EAAI,QAAU,CACV,KAAMuE,EAAK,KACX,IAAKA,EAAK,IACV,IAAKA,EAAK,IAAI,MAAM,CAAC,EACrB,IAAKA,EAAK,IAAI,UAAU,CAC5B,CACJ,CAYA,OAXAvE,EAAI,aAAeuB,EAAI,aACvBvB,EAAI,aAAeuB,EAAI,aACvBvB,EAAI,iBAAmBuB,EAAI,iBAC3BvB,EAAI,iBAAmBuB,EAAI,iBAC3BvB,EAAI,kBAAoBuB,EAAI,kBAC5BvB,EAAI,cAAgBuB,EAAI,cACxBvB,EAAI,gBAAkBuB,EAAI,gBAC1BvB,EAAI,wBAA0BuB,EAAI,wBAClCvB,EAAI,uBAAyBuB,EAAI,uBAAuB,MAAM,CAAC,EAGvDA,EAAI,KAAM,CAClB,KAAKhB,EAAM,mBACPP,EAAI,QAAUuB,EAAI,QAAQ,MAAM,CAAC,EACjCvB,EAAI,WAAauB,EAAI,WACrB,MACJ,KAAKhB,EAAM,iBACPP,EAAI,UAAYuB,EAAI,UACpBvB,EAAI,WAAauB,EAAI,WACrBvB,EAAI,MAAQ,CAAC,EACb,QAAS+B,EAAG,EAAGA,EAAGR,EAAI,MAAM,OAAQQ,IAAM,CACtC,IAAIyC,EAAKjD,EAAI,MAAMQ,CAAE,EACrB/B,EAAI,MAAM,KAAK,CACP,MAAOwE,EAAG,MAAM,MAAM,CAAC,EACvB,OAAQA,EAAG,OAAO,MAAM,CAAC,EACzB,WAAYA,EAAG,WAAW,MAAM,CAAC,EACjC,IAAKA,EAAG,IAAI,MAAM,CAAC,EACnB,IAAKA,EAAG,IAAI,MAAM,CAAC,EACnB,SAAUA,EAAG,SAAS,MAAM,CAAC,CACjC,CAAC,CACT,CACAxE,EAAI,QAAUuB,EAAI,QAClBvB,EAAI,QAAUuB,EAAI,QAClBvB,EAAI,WAAauB,EAAI,WACrB,MACJ,KAAKhB,EAAM,iBACPP,EAAI,WAAauB,EAAI,WACrBvB,EAAI,YAAcuB,EAAI,YACtBvB,EAAI,QAAUuB,EAAI,QAAQ,MAAM,CAAC,EACjC,MACJ,KAAKhB,EAAM,aACPP,EAAI,SAAWuB,EAAI,SACnBvB,EAAI,cAAgBuB,EAAI,cACxBvB,EAAI,SAAWuB,EAAI,SAAS,SAC5BvB,EAAI,eAAiB,GACrBA,EAAI,UAAYuB,EAAI,UACpBvB,EAAI,eAAiBuB,EAAI,eACzBvB,EAAI,cAAgBuB,EAAI,cACxBvB,EAAI,cAAgBuB,EAAI,cACxBvB,EAAI,OAASuB,EAAI,OAAO,SACxBvB,EAAI,OAASuB,EAAI,OAAO,SACxB,KACJ,CAEAlB,EAAI,QAAQ,KAAKL,CAAG,CACxB,CAEAK,EAAI,QAAU,CAAC,EACf,QAASoE,EAAMC,GAAgBD,EAAKA,EAAMA,EAAI,KAAM,CAChD,IAAMzE,EAAM,CACR,KAAMyE,EAAI,KAAM,KAAMA,EAAI,KAAM,SAAUA,EAAI,SAC9C,QAASA,EAAI,QAAS,SAAUA,EAAI,SACpC,UAAWA,EAAI,UAAW,WAAYA,EAAI,WAC1C,SAAUA,EAAI,SAAU,SAAUA,EAAI,SACtC,UAAWA,EAAI,SACnB,EAEA,OAAQA,EAAI,KAAM,CAElB,KAAKE,EACGF,EAAI,MACJzE,EAAI,IAAMyE,EAAI,IAAI,UACtB,MAEJ,KAAKG,EACD,GAAIH,EAAI,MAAQ,KAAM,CAClB,IAAMF,EAAOzF,EAAQ,mBAAmB2F,EAAI,GAAG,EAC/CzE,EAAI,IAAM,CACN,KAAMuE,EAAK,KACX,IAAKA,EAAK,IACV,IAAKA,EAAK,IAAI,MAAM,CAAC,EACrB,IAAKA,EAAK,IAAI,UAAU,CAC5B,CACJ,CACAvE,EAAI,OAASyE,EAAI,OACjBzE,EAAI,OAASyE,EAAI,OACjBzE,EAAI,OAASyE,EAAI,OACjB,MAEJ,KAAKI,EACD7E,EAAI,WAAayE,EAAI,WAErBzE,EAAI,OAASyE,EAAI,OACjBzE,EAAI,OAASyE,EAAI,OACjBzE,EAAI,OAASyE,EAAI,OACjB,MAEJ,KAAKK,EACD9E,EAAI,UAAYyE,EAAI,UACf5F,EAAO,WASR4F,EAAI,QAAQ,OAAO,EACnBzE,EAAI,IAAMyE,EAAI,IACdzE,EAAI,QAAUyE,EAAI,QAAQ,MAAM,IAVhCzE,EAAI,IAAMyE,EAAI,IACdM,GAAsBN,CAAG,EAEzBzE,EAAI,OAASyE,EAAI,OACjBzE,EAAI,OAASyE,EAAI,OACjBzE,EAAI,OAASyE,EAAI,QAOrB,KAEJ,CAEApE,EAAI,QAAQ,KAAKL,CAAG,CACxB,CAEAK,EAAI,SAAW,CAAC,EAChB,QAAS2E,EAAOC,GAAiBD,EAAMA,EAAOA,EAAK,KAAM,CACrD,IAAMhF,EAAM,CACR,KAAMgF,EAAK,KAAM,KAAMA,EAAK,KAAM,SAAUA,EAAK,SACjD,SAAUA,EAAK,SAAU,SAAUA,EAAK,SACxC,SAAUA,EAAK,SAAU,aAAcA,EAAK,YAChD,EAEAhF,EAAI,IAAMgF,EAAK,IAEf3E,EAAI,SAAS,KAAKL,CAAG,CACzB,CAKA,OAAAK,EAAI,WAAa2D,GAGjB3D,EAAI,OAAStB,EAAO,cAAc,EAE3BsB,CACX,CAKA,SAAS6E,GAAiB7E,EAC1B,CACI,GAAImB,GAAkBkD,IAAkBO,GACpC,KAAM,4DAKV,QAASlD,EAAG1B,EAAI,QAAQ,OAAO,EAAG0B,GAAI,EAAGA,IAAM,CAC3C,IAAM/B,EAAMK,EAAI,QAAQ0B,CAAE,EACpBR,EAAM,CACR,KAAMvB,EAAI,KAAM,KAAMA,EAAI,KAAM,SAAUA,EAAI,SAC9C,MAAOA,EAAI,MAAO,UAAWA,EAAI,UACjC,GAAIA,EAAI,GAAI,GAAIA,EAAI,GAAI,QAASA,EAAI,QACrC,WAAYA,EAAI,WAAY,WAAYA,EAAI,UAChD,EACAlB,EAAQ,eAAe,SAAUyC,EAAKA,EAAI,QAAQ,EAElDA,EAAI,KAAO,KACXA,EAAI,KAAOC,EACXA,EAAiBD,EACbA,EAAI,OACJA,EAAI,KAAK,KAAOA,EACxB,CAEA,QAASQ,EAAG1B,EAAI,QAAQ,OAAO,EAAG0B,GAAI,EAAGA,IAAM,CAC3C,IAAM/B,EAAMK,EAAI,QAAQ0B,CAAE,EACpB0C,EAAM,CACR,KAAMzE,EAAI,KAAM,KAAMA,EAAI,KAAM,SAAUA,EAAI,SAC9C,QAASA,EAAI,QAAS,SAAUA,EAAI,SACpC,UAAWA,EAAI,UAAW,WAAYA,EAAI,WAC1C,SAAUA,EAAI,SAAU,SAAUA,EAAI,SACtC,UAAWA,EAAI,SACnB,EACAlB,EAAQ,eAAe,SAAU2F,EAAKA,EAAI,QAAQ,EAElDA,EAAI,KAAO,KACXA,EAAI,KAAOC,GACXA,GAAiBD,EACbA,EAAI,OACJA,EAAI,KAAK,KAAOA,EACxB,CAEA,QAAS1C,EAAG1B,EAAI,SAAS,OAAO,EAAG0B,GAAI,EAAGA,IAAM,CAC5C,IAAM/B,EAAMK,EAAI,SAAS0B,CAAE,EACrBiD,EAAO,CACT,KAAMhF,EAAI,KAAM,KAAMA,EAAI,KAAM,SAAUA,EAAI,SAC9C,SAAUA,EAAI,SAAU,SAAUA,EAAI,SACtC,SAAUA,EAAI,SAAU,aAAcA,EAAI,YAC9C,EACAlB,EAAQ,eAAe,UAAWkG,EAAMA,EAAK,QAAQ,EAErDA,EAAK,KAAO,KACZA,EAAK,KAAOC,GACZA,GAAkBD,EACdA,EAAK,OACLA,EAAK,KAAK,KAAOA,EACzB,CAIA,QAASjD,EAAG,EAAGA,EAAG1B,EAAI,QAAQ,OAAQ0B,IAAM,CACxC,IAAM/B,EAAMK,EAAI,QAAQ0B,CAAE,EACpBR,EAAMzC,EAAQ,kBAAkB,SAAUkB,EAAI,QAAQ,EA+B5D,OA7BAuB,EAAI,OAASzC,EAAQ,kBAAkB,SAAUkB,EAAI,MAAM,EAC3DuB,EAAI,IAAMzC,EAAQ,kBAAkB,SAAUkB,EAAI,GAAG,EACrDuB,EAAI,QAAUzC,EAAQ,kBAAkB,SAAUkB,EAAI,OAAO,EAE7DuB,EAAI,KAAO,CACP,KAAMvB,EAAI,KAAK,KAAM,MAAOA,EAAI,KAAK,MACrC,IAAKA,EAAI,KAAK,IAAK,OAAQA,EAAI,KAAK,MACxC,EAEAuB,EAAI,iBAAmB,MACnBvB,EAAI,cAAgBA,EAAI,gBACxBuB,EAAI,iBAAmB7B,GAC3B6B,EAAI,QAAU,KACVvB,EAAI,UAAY,SAEhBuB,EAAI,QAAUvB,EAAI,QAAQ,IAC1BlB,EAAQ,aAAayC,EAAI,QAASvB,EAAI,OAAO,GAEjDuB,EAAI,aAAevB,EAAI,aACvBuB,EAAI,aAAevB,EAAI,aACvBuB,EAAI,iBAAmBvB,EAAI,iBAC3BuB,EAAI,iBAAmBvB,EAAI,iBAC3BuB,EAAI,kBAAoBvB,EAAI,kBAC5BuB,EAAI,cAAgBvB,EAAI,cACxBuB,EAAI,gBAAkBvB,EAAI,gBAC1BuB,EAAI,wBAA0BvB,EAAI,wBAClCuB,EAAI,uBAAyBvB,EAAI,uBAAuB,MAAM,CAAC,EAGvDuB,EAAI,KAAM,CAClB,KAAKhB,EAAM,mBACPgB,EAAI,MAAQ,CAAC,EACbA,EAAI,WAAaA,EAAI,MACrBA,EAAI,eAAiBA,EAAI,UACzBA,EAAI,SAAWA,EAAI,GACnBA,EAAI,SAAWA,EAAI,GACnBA,EAAI,cAAgBA,EAAI,QACxBA,EAAI,QAAUvB,EAAI,QAAQ,MAAM,CAAC,EACjCuB,EAAI,aAAe,GACnBA,EAAI,QAAU,CAAC,EACfA,EAAI,WAAa4D,GAAmBnF,EAAI,UAAU,EAClD,MACJ,KAAKO,EAAM,iBACPgB,EAAI,UAAYvB,EAAI,UACpBuB,EAAI,WAAavB,EAAI,WACrBuB,EAAI,MAAQ,CAAC,EACb,QAAS6D,EAAG,EAAGA,EAAGpF,EAAI,MAAM,OAAQoF,IAAM,CACtC,IAAIZ,EAAKxE,EAAI,MAAMoF,CAAE,EACrB7D,EAAI,MAAM,KAAK,CACP,MAAO,GACP,MAAOiD,EAAG,MAAM,MAAM,CAAC,EACvB,OAAQA,EAAG,OAAO,MAAM,CAAC,EACzB,WAAYA,EAAG,WAAW,MAAM,CAAC,EACjC,IAAKA,EAAG,IAAI,MAAM,CAAC,EACnB,IAAKA,EAAG,IAAI,MAAM,CAAC,EACnB,SAAUA,EAAG,SAAS,MAAM,CAAC,CACjC,CAAC,CACT,CACAjD,EAAI,QAAUvB,EAAI,QAClBuB,EAAI,QAAUvB,EAAI,QAClBuB,EAAI,aAAe,GACnBA,EAAI,WAAa4D,GAAmBnF,EAAI,UAAU,EAClD,MACJ,KAAKO,EAAM,iBACPgB,EAAI,WAAavB,EAAI,WACrBuB,EAAI,YAAcvB,EAAI,YACtBuB,EAAI,QAAUvB,EAAI,QAAQ,MAAM,CAAC,EACjCuB,EAAI,QAAU,CAAC,EACf,MACJ,KAAKhB,EAAM,aACPgB,EAAI,SAAWvB,EAAI,SACnBuB,EAAI,cAAgBvB,EAAI,cACxBuB,EAAI,SAAWzC,EAAQ,kBAAkB,SAAUkB,EAAI,QAAQ,EAC/DuB,EAAI,eAAiB,GACrBA,EAAI,UAAYvB,EAAI,UACpBuB,EAAI,eAAiBvB,EAAI,eACzBuB,EAAI,cAAgBvB,EAAI,cACxBuB,EAAI,cAAgBvB,EAAI,cACxBuB,EAAI,OAASzC,EAAQ,kBAAkB,SAAUkB,EAAI,MAAM,EAC3DuB,EAAI,OAASzC,EAAQ,kBAAkB,SAAUkB,EAAI,MAAM,EAC3D,KACJ,CACJ,CAEA,QAAS+B,EAAG,EAAGA,EAAG1B,EAAI,QAAQ,OAAQ0B,IAAM,CACxC,IAAM/B,EAAMK,EAAI,QAAQ0B,CAAE,EACpB0C,EAAM3F,EAAQ,kBAAkB,SAAUkB,EAAI,QAAQ,EAe5D,OAZAyE,EAAI,IAAM,KACVA,EAAI,IAAM,KACVA,EAAI,KAAO,KAEXA,EAAI,IAAM,KACVA,EAAI,OAAS,EACbA,EAAI,OAAS,EACbA,EAAI,OAAS,EACbA,EAAI,SAAW,KACfA,EAAI,WAAa,KACjBA,EAAI,QAAU,KAENA,EAAI,KAAM,CAElB,KAAKE,EACDF,EAAI,IAAM3F,EAAQ,kBAAkB,SAAUkB,EAAI,GAAG,EACrD,MAEJ,KAAK4E,EACG5E,EAAI,MAAQ,SAEZyE,EAAI,IAAMzE,EAAI,IAAI,IAClBlB,EAAQ,aAAa2F,EAAI,IAAKzE,EAAI,GAAG,GAEzCyE,EAAI,OAASzE,EAAI,OACjByE,EAAI,OAASzE,EAAI,OACjByE,EAAI,OAASzE,EAAI,OACjB,MAEJ,KAAK6E,EACDJ,EAAI,WAAazE,EAAI,WACrB,IAAIqF,EAAKzG,EAAM,gBAAgB6F,EAAI,UAAU,EACzCY,IACAZ,EAAI,IAAMY,EAAG,MAEjBZ,EAAI,OAASzE,EAAI,OACjByE,EAAI,OAASzE,EAAI,OACjByE,EAAI,OAASzE,EAAI,OACjB,MAEJ,KAAK8E,EAED,GADAL,EAAI,UAAYzE,EAAI,UACfnB,EAAO,UAsBP,CAGD,GAFA4F,EAAI,IAAMzE,EAAI,IACdyE,EAAI,QAAU5F,EAAO,WAAW4F,EAAI,UAAWA,EAAI,GAAG,EAClD,CAACA,EAAI,QAAS,CAOd,IAAIa,EAAUzG,EAAO,wBAAwB4F,EAAI,IAAI,KAAK,EAE1D,GADAA,EAAI,QAAU5F,EAAO,WAAW4F,EAAI,UAAWa,CAAO,EAClD,CAACb,EAAI,QACL,KAAM,8DAAgEA,EAAI,IAAI,QACtF,CAEIA,EAAI,WAAalE,EAAM,sBAEvBkE,EAAI,QAAQ,MAAMzE,EAAI,QAASO,EAAM,cAAc,EAGvDkE,EAAI,QAAUA,EAAI,QAAQ,YAAY,MAAM,CAAC,CACjD,KA5CuB,CACnBA,EAAI,IAAMzE,EAAI,IACdyE,EAAI,OAASzE,EAAI,OACjByE,EAAI,OAASzE,EAAI,OACjByE,EAAI,OAASzE,EAAI,OAEjB,IAAIuF,EAAU1G,EAAO,UAAU4F,EAAI,GAAG,EAClCc,GAAW,OAGXA,EAAU,CAAC,EACX1G,EAAO,WAAW4F,EAAI,IAAK,GAAI,EAAI,GAEvCA,EAAI,IAAMc,EAKVd,EAAI,OAASc,EAAQ,OACjBd,EAAI,OAASA,EAAI,SACjBA,EAAI,OAASA,EAAI,OACzB,CAwBA,KAEJ,CACJ,CAEA,QAAS1C,EAAG,EAAGA,EAAG1B,EAAI,SAAS,OAAQ0B,IAAM,CACzC,IAAM/B,EAAMK,EAAI,SAAS0B,CAAE,EACrBiD,EAAOlG,EAAQ,kBAAkB,UAAWkB,EAAI,QAAQ,EAE9DgF,EAAK,IAAMhF,EAAI,GACnB,CAEAa,GAAc/B,EAAQ,kBAAkB,SAAUuB,EAAI,OAAO,EAC7DiE,EAAiBxF,EAAQ,kBAAkB,SAAUuB,EAAI,UAAU,EAE/DA,EAAI,gBACJmF,GAAyBnF,EAAI,cAAc,EAE/C2D,GAAW,OAASmB,GAAmB9E,EAAI,WAAW,MAAM,EAC5D2D,GAAW,KAAOmB,GAAmB9E,EAAI,WAAW,IAAI,EAGxD6D,EAA2B7D,EAAI,MACnC,CAMA,SAASoF,GAAYC,EAAK,CAGtB,GAFApG,EAAa,GACbC,EAAc,GACV,CAACR,EAAQ,CAET,QAAQ,IAAI,eAAgB2G,CAAG,EAC/B,MACJ,CACA3G,EAAO,MAAM2G,CAAG,EAChB,IAAIrD,EAAU,CAAE,KAAM,SAAU,IAAK3C,EAAkB,QAAS,EAAK,EACrE2C,EAAQ,MAAQ,CAAC,EACjBtD,EAAO,OAAOsD,CAAO,CACzB,CAKA,IAAI9B,EAAQ,CACR,gBAAkB,EAClB,kBAAoB,EACpB,kBAAoB,EACpB,mBAAqB,EACnB,+BAAiC,EACjC,+BAAiC,EACjC,8BAAgC,EAClC,mBAAqB,EACrB,cAAgB,EAChB,iBAAmB,EACnB,kBAAoB,EACpB,cAAgB,EAChB,oBAAsB,EACtB,oBAAsB,GACtB,mBAAqB,GACrB,uBAAyB,GACzB,mBAAqB,GACrB,6BAA+B,GAC/B,gBAAkB,GAClB,oBAAsB,GACtB,sBAAwB,GACxB,wBAA0B,GAC1B,0BAA4B,GAC5B,iBAAmB,GACnB,eAAiB,GACjB,uBAAyB,GACzB,0BAA4B,GAC5B,mBAAoB,KAEpB,gBAAmB,WACnB,aAAmB,WACnB,cAAmB,WACnB,WAAmB,WACnB,aAAmB,WACnB,eAAmB,WACnB,eAAmB,WACnB,eAAmB,WACnB,YAAmB,WACnB,eAAmB,WACnB,iBAAmB,WACnB,aAAmB,WACnB,YAAmB,WACnB,cAAmB,WACnB,cAAmB,WACnB,cAAmB,WACnB,cAAmB,WACnB,cAAmB,WACnB,cAAmB,WACnB,cAAmB,WACnB,cAAmB,WACnB,cAAmB,WACnB,eAAmB,WACnB,eAAmB,WACnB,eAAmB,WAEnB,eAAmB,GAEnB,YAAc,EACd,aAAe,EACf,iBAAmB,EACnB,iBAAmB,EACnB,kBAAoB,EACpB,eAAiB,EACjB,cAAgB,EAChB,mBAAqB,EACrB,iBAAmB,EACnB,oBAAsB,EAEtB,aAAe,EACf,iBAAmB,EACnB,mBAAqB,EACrB,aAAe,EACf,gBAAkB,EAClB,YAAc,EACd,WAAa,EACb,iBAAmB,EACnB,YAAc,EACd,YAAc,EACd,YAAc,GACd,gBAAkB,GAElB,iBAAmB,EACnB,aAAe,EACf,cAAgB,EAChB,mBAAqB,EACrB,iBAAmB,EACnB,iBAAmB,EAEnB,eAAkB,EAClB,gBAAkB,EAClB,gBAAkB,EAClB,gBAAkB,EAClB,kBAAoB,GAEpB,gBAAkB,GAClB,uBAAyB,GACzB,uBAAyB,IAEzB,iBAAmB,EACnB,mBAAqB,IACrB,qBAAuB,IAEvB,eAAiB,EACjB,oBAAsB,EACtB,qBAAuB,EACvB,sBAAwB,EACxB,mBAAqB,GAErB,mBAAuB,IACvB,qBAAuB,EAEvB,eAAiB,EACjB,cAAgB,EAChB,mBAAqB,EACrB,qBAAuB,EAEvB,eAAiB,EACjB,iBAAmB,EACnB,aAAe,EAEf,sBAAwB,EACxB,0BAA4B,EAC5B,wBAA0B,EAC1B,eAAiB,EACjB,iBAAmB,EACnB,kBAAoB,EACpB,uBAAyB,EACzB,oBAAsB,EACtB,oBAAsB,EACtB,uBAAyB,EACzB,mBAAqB,GAEnB,yBAA2B,EAC3B,yBAA2B,EAC3B,wBAA0B,EAC1B,0BAA4B,EAE9B,oBAAsB,EACtB,sBAAwB,EACxB,wBAA0B,EAC1B,sBAAwB,EACxB,uBAAyB,EAEzB,eAAgB,GAChB,eAAgB,EAEpB,EAEIsB,GAAmB,CAInB,KAAOtB,EAAM,aACb,MAAQA,EAAM,cACd,GAAKA,EAAM,WACX,KAAOA,EAAM,aACb,OAAWA,EAAM,eACjB,OAAWA,EAAM,eACjB,OAASA,EAAM,eACf,IAAMA,EAAM,YACZ,OAASA,EAAM,eACf,SAAWA,EAAM,iBACjB,KAAOA,EAAM,aACb,IAAMA,EAAM,YACZ,MAAQA,EAAM,cACd,MAAQA,EAAM,cACd,MAAQA,EAAM,cACd,MAAQA,EAAM,cACd,MAAQA,EAAM,cACd,MAAQA,EAAM,cACd,MAAQA,EAAM,cACd,MAAQA,EAAM,cACd,MAAQA,EAAM,cACd,OAASA,EAAM,eACf,OAASA,EAAM,eACf,OAASA,EAAM,cACnB,EAIIoF,GAAoB,KAEpBnC,GAAe,CACf,EAAI,SACJ,EAAI,aACJ,EAAI,eACJ,EAAI,SACJ,EAAI,YACJ,EAAI,QACJ,EAAI,OACJ,EAAI,aACJ,EAAI,QACJ,EAAI,QACJ,GAAK,OACT,EAEIoC,GAAc,CACd,EAAG,OACH,EAAG,OACH,EAAG,aACH,EAAG,SACP,EAMIC,GAAsB,CAC1B,IAAK,IAAK,IAAK,CAAE,GAAG,EAAG,EAAG,IAAK,IAAK,IAAK,GAAI,IAAK,CAAE,IAAI,EAAG,EAC3D,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC5C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,IACpD,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,CAAE,IAAI,IAAI,GAAI,EAAG,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACzD,IAAK,CAAE,IAAI,IAAI,GAAI,EAAG,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACzD,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,IAC9C,KAAM,KAAM,KAAM,IAAK,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,GAAG,GAAI,EAAG,KAAM,CAAE,GAAG,GAAI,EAC7E,KAAM,CAAE,GAAG,GAAI,EAAG,KAAM,CAAE,GAAG,GAAI,EAAG,KAAM,CAAE,GAAG,GAAI,EAAG,KAAM,KAAM,KAAM,CAAE,IAAI,GAAI,EAClF,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,KAAM,KAAM,KACvF,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KACtD,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KACtD,KAAM,KAAM,KAAM,KAAM,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjF,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EACjG,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,IAAK,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,GAAI,EACrF,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EACxG,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,GAAI,EACxG,KAAM,KAAM,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,IAAI,GAAI,EAC1F,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,GAAI,EAAG,MAAO,CAAE,GAAG,EAAG,EAC/F,MAAO,CAAE,GAAG,EAAG,EAAG,MAAO,CAAE,GAAG,EAAG,EAAG,MAAO,CAAE,GAAG,GAAG,EAAG,EAAG,MAAO,CAAE,GAAG,GAAG,EAAG,EAAG,MAAO,CAAE,GAAG,EAAG,EAC7F,MAAO,CAAE,GAAG,EAAG,EAAG,MAAO,CAAE,KAAK,IAAK,EAAG,MAAO,CAAE,KAAK,IAAK,EAAG,MAAO,CAAE,KAAK,IAAK,EAAG,MAAO,CAAE,KAAK,IAAK,EACvG,MAAO,CAAE,KAAK,IAAK,CACnB,GAEC,UAAW,CACV,IAAIjD,EAAIb,EAAIT,EACRwE,EAAMD,GAUV,IATAjD,EAAK,CACP,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,IAC5B,EACKb,EAAG,EAAGA,EAAG,GAAIA,IAChBT,EAAMsB,EAAGb,CAAE,EACX+D,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,IAAKA,GAAK,IAAKA,GAAK,EAC3BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,IAAKA,GAAK,IAAKA,GAAK,EAC3BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,IAAKA,GAAK,IAAKA,GAAK,EAC3BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,EAgBjB,IAdAsB,EAAK,CACP,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,KACrC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,IACV,EACKb,EAAG,EAAGA,EAAG,GAAIA,IAChBT,EAAMsB,EAAGb,CAAE,EACX+D,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,GAAIA,GAAK,IAAKA,GAAK,EAC1BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,IAAKA,GAAK,IAAKA,GAAK,EAC3BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,IAAKA,GAAK,IAAKA,GAAK,EAC3BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,MAAOA,GAAK,MAAOA,GAAK,EAC/BwE,EAAIxE,CAAG,EAAIA,EAAI,GAMjB,IAJAsB,EAAK,CACP,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GACjC,EACKb,EAAG,EAAGA,EAAG,GAAIA,IAChBT,EAAMsB,EAAGb,CAAE,EACX+D,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,MAAOA,GAAK,MAAOA,GAAK,EAC/BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjBwE,EAAI,IAAI,EAAI,GACd,GAAG,EAGH,IAAIC,GAAsB,CAC1B,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACrD,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,IAAK,KAAM,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,KACnD,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KACtD,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KACtD,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KACtD,KAAM,KAAM,KAAM,IAAK,KAAM,IAAK,KAAM,GACxC,GAEC,UAAW,CACV,IAAInD,EAAIb,EAAIT,EACRwE,EAAMC,GACV,IAAKzE,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,MAAOA,GAAK,MAAOA,GAAK,EAC/BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,GAAIA,GAAK,GAAIA,GAAK,EACzBwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,IAAKA,GAAK,IAAKA,GAAK,EAC3BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,IAAKA,GAAK,IAAKA,GAAK,EAC3BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,MAAOA,GAAK,MAAOA,GAAK,EAC/BwE,EAAIxE,CAAG,EAAIA,EAAI,GAMjB,IAJAsB,EAAK,CACP,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GACjC,EACKb,EAAG,EAAGA,EAAG,GAAIA,IAChBT,EAAMsB,EAAGb,CAAE,EACX+D,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,GAEjB,IAAKA,EAAI,IAAKA,GAAK,IAAKA,GAAK,EAC3BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,IAAKA,GAAK,IAAKA,GAAK,EAC3BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,IAAKA,GAAK,IAAKA,GAAK,EAC3BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,EAEjB,IAAKA,EAAI,KAAMA,GAAK,KAAMA,GAAK,EAC7BwE,EAAIxE,CAAG,EAAIA,EAAI,EAgBjB,IAdAsB,EAAK,CACP,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAM,KAAM,KACrC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,IACV,EACKb,EAAG,EAAGA,EAAG,GAAIA,IAChBT,EAAMsB,EAAGb,CAAE,EACX+D,EAAIxE,CAAG,EAAIA,EAAI,EAcjB,IAZAsB,EAAK,CACP,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,IAC5B,EACKb,EAAG,EAAGA,EAAG,GAAIA,IAChBT,EAAMsB,EAAGb,CAAE,EACX+D,EAAIxE,CAAG,EAAIA,EAAI,CAEnB,GAAG,EAGH,IAAI0E,GAAsB,CAC1B,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACpD,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,GAAI,EACpE,KAAM,KAAM,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,KAAM,KAAM,CAAE,KAAK,GAAI,EACnF,KAAM,KAAM,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,KAAM,KAAM,CAAE,KAAK,GAAI,EACnF,KAAM,KAAM,KAAM,CAAE,IAAI,GAAI,EAAG,KAAM,CAAE,IAAI,IAAI,GAAI,EAAG,KAAM,KAAM,MAAO,CAAE,GAAG,GAAI,EAClF,MAAO,CAAE,GAAG,GAAI,EAAG,MAAO,CAAE,GAAG,GAAI,EAAG,MAAO,CAAE,GAAG,IAAI,GAAI,EAAG,MAAO,CAAE,GAAG,IAAI,GAAI,EAAG,MAAO,CAAE,GAAG,GAAI,EACpG,MAAO,CAAE,GAAG,GAAI,EAAG,MAAO,CAAE,KAAK,IAAK,EAAG,MAAO,CAAE,KAAK,IAAK,EAAG,MAAO,CAAE,KAAK,IAAK,EAAG,MAAO,CAAE,KAAK,IAAK,EACxG,MAAO,CAAE,KAAK,IAAK,CACnB,GAEC,UAAW,CACV,IAAIpD,EAAIb,EAAIT,EACRwE,EAAME,GASV,IARApD,EAAK,CACP,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAC1C,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IACxC,EACKb,EAAG,EAAGA,EAAG,GAAIA,IAChBT,EAAMsB,EAAGb,CAAE,EACX+D,EAAI/D,EAAG,IAAI,EAAIT,CAEnB,GAAG,EAGH,IAAI2E,GAAuB,CAC3B,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAClF,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAClF,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAClF,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAClF,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAClF,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAClF,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EACpF,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EACvF,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EACvF,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EACvF,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EACrF,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EACrF,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EACpF,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EACpF,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EACrF,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EACpF,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,IAAK,CAAE,IAAI,GAAI,EAAG,IAAK,CAAE,GAAG,GAAI,EAAG,I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AAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EACjG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,GAAI,EAAG,KAAM,CAAE,KAAK,IAAK,EAClG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EACtG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EACtG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EACtG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EACtG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EACtG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EACtG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EACtG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EACtG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAC3G,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,KAAK,IAAK,EAC3G,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EACtG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EACtG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EACtG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,KAAK,IAAK,EAAG,KAAM,CAAE,IAAI,GAAI,EAC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AAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EACjG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACzF,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACjF,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EACzF,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACjF,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACzF,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACjF,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EACjG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACjG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACzF,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EACjG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACzF,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACjF,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACjG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACjF,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACjF,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,IAAI,GAAG,EAClF,CAAC,IAAI,GAAG,EAAG,CAAC,IAAI,GAAG,CACjB,EACKb,EAAG,EAAGA,EAAG,IAAKA,IACjBT,EAAMsB,EAAGb,CAAE,EACX+D,EAAI/D,EAAG,IAAI,EAAIT,EAgBjB,IAdAsB,EAAK,CACP,CAAC,GAAG,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAC7F,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAC7G,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAC7G,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EACzF,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EACjH,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACjF,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EACjH,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EACjH,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EAAG,CAAC,GAAG,GAAG,EAAG,CAAC,IAAI,GAAG,EACjG,CAAC,GAAG,IAAI,GAAG,EAAG,CAAC,IAAI,IAAI,GAAG,EAAG,CAAC,GAAG,IAAI,GA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K,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7C,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IACjD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAC9C,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAC9C,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAC9C,KAAM,GAAI,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IACjD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,GAAI,KAAM,GACjD,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAC9C,KAAM,GAAI,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IACjD,KAAM,IAAK,KAAM,IAAK,KAAM,GAAI,KAAM,IAAK,KAAM,IACjD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,IAAK,KAAM,IAAK,KAAM,GAAI,KAAM,IAAK,KAAM,IACjD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,IAClD,KAAM,IAAK,KAAM,IAAK,KAAM,IAAK,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AAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EAC/C,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EAC/C,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,KAAM,IAAI,IAAK,EAC3B,KAAM,CAAE,IAAI,KAAM,IAAI,IAAK,EAC3B,KAAM,CAAE,IAAI,KAAM,IAAI,IAAK,EAC3B,KAAM,CAAE,IAAI,KAAM,IAAI,IAAK,EAC3B,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EAC/C,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EAC/C,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EAC/C,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EAC/C,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EACrC,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EACrC,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EACrC,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EACrC,IAAM,CAAE,IAAI,KAAM,IAAI,IAAK,EAC3B,KAAM,CAAE,IAAI,KAAM,IAAI,IAAK,EAC3B,KAAM,CAAE,IAAI,KAAM,IAAI,IAAK,EAC3B,KAAM,CAAE,IAAI,KAAM,IAAI,IAAK,EAC3B,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EACrC,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EACrC,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EACrC,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EAC/C,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EAC/C,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EAC/C,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EAC/C,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EACrC,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,KAAM,IAAI,KAAM,IAAI,IAAK,EACrC,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,KAAM,CAAE,IAAI,IAAK,EACjB,MAAO,CAAE,IAAI,KAAM,EACnB,MAAO,CAAE,MAAM,KAAM,EACrB,MAAO,CAAE,MAAM,KAAM,EACrB,MAAO,CAAE,MAAM,KAAM,EACrB,MAAO,CAAE,MAAM,KAAM,EACrB,MAAO,CAAE,MAAM,KAAM,EACrB,MAAO,CAAE,MAAM,KAAM,EACrB,MAAO,CAAE,MAAM,KAAM,EACrB,MAAO,CAAE,MAAM,KAAM,EACrB,MAAO,CAAE,MAAM,KAAM,EACrB,MAAO,CAAE,MAAM,KAAM,EACrB,MAAO,CAAE,MAAM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",
  "names": ["assign", "target", "i", "source", "key", "defaultConverter", "value", "init", "converter", "defaultAttributes", "set", "name", "attributes", "stringifiedAttributes", "attributeName", "get", "cookies", "jar", "parts", "found", "api", "freeGlobal", "freeGlobal_default", "freeSelf", "root", "freeGlobal_default", "root_default", "Symbol", "root_default", "Symbol_default", "objectProto", "hasOwnProperty", "nativeObjectToString", "symToStringTag", "Symbol_default", "getRawTag", "value", "isOwn", "tag", "unmasked", "result", "getRawTag_default", "objectProto", "nativeObjectToString", "objectToString", "value", "objectToString_default", "nullTag", "undefinedTag", "symToStringTag", "Symbol_default", "baseGetTag", "value", "getRawTag_default", "objectToString_default", "baseGetTag_default", "isObjectLike", "value", "isObjectLike_default", "symbolTag", "isSymbol", "value", "isObjectLike_default", "baseGetTag_default", "isSymbol_default", "arrayMap", "array", "iteratee", "index", "length", "result", "arrayMap_default", "isArray", "isArray_default", "INFINITY", "symbolProto", "Symbol_default", "symbolToString", "baseToString", "value", "isArray_default", "arrayMap_default", "isSymbol_default", "result", "baseToString_default", "reWhitespace", "trimmedEndIndex", "string", "index", "trimmedEndIndex_default", "reTrimStart", "baseTrim", "string", "trimmedEndIndex_default", "baseTrim_default", "isObject", "value", "type", "isObject_default", "NAN", "reIsBadHex", "reIsBinary", "reIsOctal", "freeParseInt", "toNumber", "value", "isSymbol_default", "isObject_default", "other", "baseTrim_default", "isBinary", "toNumber_default", "asyncTag", "funcTag", "genTag", "proxyTag", "isFunction", "value", "isObject_default", "tag", "baseGetTag_default", "isFunction_default", "coreJsData", "root_default", "coreJsData_default", "maskSrcKey", "uid", "coreJsData_default", "isMasked", "func", "isMasked_default", "funcProto", "funcToString", "toSource", "func", "toSource_default", "reRegExpChar", "reIsHostCtor", "funcProto", "objectProto", "funcToString", "hasOwnProperty", "reIsNative", "baseIsNative", "value", "isObject_default", "isMasked_default", "pattern", "isFunction_default", "toSource_default", "baseIsNative_default", "getValue", "object", "key", "getValue_default", "getNative", "object", "key", "value", "getValue_default", "baseIsNative_default", "getNative_default", "WeakMap", "getNative_default", "root_default", "WeakMap_default", "objectCreate", "baseCreate", "object", "proto", "isObject_default", "result", "baseCreate_default", "copyArray", "source", "array", "index", "length", "copyArray_default", "defineProperty", "func", "getNative_default", "defineProperty_default", "arrayEach", "array", "iteratee", "index", "length", "arrayEach_default", "MAX_SAFE_INTEGER", "reIsUint", "isIndex", "value", "length", "type", "isIndex_default", "baseAssignValue", "object", "key", "value", "defineProperty_default", "baseAssignValue_default", "eq", "value", "other", "eq_default", "objectProto", "hasOwnProperty", "assignValue", "object", "key", "value", "objValue", "eq_default", "baseAssignValue_default", "assignValue_default", "copyObject", "source", "props", "object", "customizer", "isNew", "index", "length", "key", "newValue", "baseAssignValue_default", "assignValue_default", "copyObject_default", "MAX_SAFE_INTEGER", "isLength", "value", "isLength_default", "isArrayLike", "value", "isLength_default", "isFunction_default", "isArrayLike_default", "objectProto", "isPrototype", "value", "Ctor", "proto", "isPrototype_default", "baseTimes", "n", "iteratee", "index", "result", "baseTimes_default", "argsTag", "baseIsArguments", "value", "isObjectLike_default", "baseGetTag_default", "baseIsArguments_default", "objectProto", "hasOwnProperty", "propertyIsEnumerable", "isArguments", "baseIsArguments_default", "value", "isObjectLike_default", "isArguments_default", "stubFalse", "stubFalse_default", "freeExports", "freeModule", "moduleExports", "Buffer", "root_default", "nativeIsBuffer", "isBuffer", "stubFalse_default", "isBuffer_default", "argsTag", "arrayTag", "boolTag", "dateTag", "errorTag", "funcTag", "mapTag", "numberTag", "objectTag", "regexpTag", "setTag", "stringTag", "weakMapTag", "arrayBufferTag", "dataViewTag", "float32Tag", "float64Tag", "int8Tag", "int16Tag", "int32Tag", "uint8Tag", "uint8ClampedTag", "uint16Tag", "uint32Tag", "typedArrayTags", "baseIsTypedArray", "value", "isObjectLike_default", "isLength_default", "baseGetTag_default", "baseIsTypedArray_default", "baseUnary", "func", "value", "baseUnary_default", "freeExports", "freeModule", "moduleExports", "freeProcess", "freeGlobal_default", "nodeUtil", "types", "nodeUtil_default", "nodeIsTypedArray", "nodeUtil_default", "isTypedArray", "baseUnary_default", "baseIsTypedArray_default", "isTypedArray_default", "objectProto", "hasOwnProperty", "arrayLikeKeys", "value", "inherited", "isArr", "isArray_default", "isArg", "isArguments_default", "isBuff", "isBuffer_default", "isType", "isTypedArray_default", "skipIndexes", "result", "baseTimes_default", "length", "key", "isIndex_default", "arrayLikeKeys_default", "overArg", "func", "transform", "arg", "overArg_default", "nativeKeys", "overArg_default", "nativeKeys_default", "objectProto", "hasOwnProperty", "baseKeys", "object", "isPrototype_default", "nativeKeys_default", "result", "key", "baseKeys_default", "keys", "object", "isArrayLike_default", "arrayLikeKeys_default", "baseKeys_default", "keys_default", "nativeKeysIn", "object", "result", "key", "nativeKeysIn_default", "objectProto", "hasOwnProperty", "baseKeysIn", "object", "isObject_default", "nativeKeysIn_default", "isProto", "isPrototype_default", "result", "key", "baseKeysIn_default", "keysIn", "object", "isArrayLike_default", "arrayLikeKeys_default", "baseKeysIn_default", "keysIn_default", "nativeCreate", "getNative_default", "nativeCreate_default", "hashClear", "nativeCreate_default", "hashClear_default", "hashDelete", "key", "result", "hashDelete_default", "HASH_UNDEFINED", "objectProto", "hasOwnProperty", "hashGet", "key", "data", "nativeCreate_default", "result", "hashGet_default", "objectProto", "hasOwnProperty", "hashHas", "key", "data", "nativeCreate_default", "hashHas_default", "HASH_UNDEFINED", "hashSet", "key", "value", "data", "nativeCreate_default", "hashSet_default", "Hash", "entries", "index", "length", "entry", "hashClear_default", "hashDelete_default", "hashGet_default", "hashHas_default", "hashSet_default", "Hash_default", "listCacheClear", "listCacheClear_default", "assocIndexOf", "array", "key", "length", "eq_default", "assocIndexOf_default", "arrayProto", "splice", "listCacheDelete", "key", "data", "index", "assocIndexOf_default", "lastIndex", "listCacheDelete_default", "listCacheGet", "key", "data", "index", "assocIndexOf_default", "listCacheGet_default", "listCacheHas", "key", "assocIndexOf_default", "listCacheHas_default", "listCacheSet", "key", "value", "data", "index", "assocIndexOf_default", "listCacheSet_default", "ListCache", "entries", "index", "length", "entry", "listCacheClear_default", "listCacheDelete_default", "listCacheGet_default", "listCacheHas_default", "listCacheSet_default", "ListCache_default", "Map", "getNative_default", "root_default", "Map_default", "mapCacheClear", "Hash_default", "Map_default", "ListCache_default", "mapCacheClear_default", "isKeyable", "value", "type", "isKeyable_default", "getMapData", "map", "key", "data", "isKeyable_default", "getMapData_default", "mapCacheDelete", "key", "result", "getMapData_default", "mapCacheDelete_default", "mapCacheGet", "key", "getMapData_default", "mapCacheGet_default", "mapCacheHas", "key", "getMapData_default", "mapCacheHas_default", "mapCacheSet", "key", "value", "data", "getMapData_default", "size", "mapCacheSet_default", "MapCache", "entries", "index", "length", "entry", "mapCacheClear_default", "mapCacheDelete_default", "mapCacheGet_default", "mapCacheHas_default", "mapCacheSet_default", "MapCache_default", "toString", "value", "baseToString_default", "toString_default", "arrayPush", "array", "values", "index", "length", "offset", "arrayPush_default", "getPrototype", "overArg_default", "getPrototype_default", "basePropertyOf", "object", "key", "basePropertyOf_default", "stackClear", "ListCache_default", "stackClear_default", "stackDelete", "key", "data", "result", "stackDelete_default", "stackGet", "key", "stackGet_default", "stackHas", "key", "stackHas_default", "LARGE_ARRAY_SIZE", "stackSet", "key", "value", "data", "ListCache_default", "pairs", "Map_default", "MapCache_default", "stackSet_default", "Stack", "entries", "data", "ListCache_default", "stackClear_default", "stackDelete_default", "stackGet_default", "stackHas_default", "stackSet_default", "Stack_default", "baseAssign", "object", "source", "copyObject_default", "keys_default", "baseAssign_default", "baseAssignIn", "object", "source", "copyObject_default", "keysIn_default", "baseAssignIn_default", "freeExports", "freeModule", "moduleExports", "Buffer", "root_default", "allocUnsafe", "cloneBuffer", "buffer", "isDeep", "length", "result", "cloneBuffer_default", "arrayFilter", "array", "predicate", "index", "length", "resIndex", "result", "value", "arrayFilter_default", "stubArray", "stubArray_default", "objectProto", "propertyIsEnumerable", "nativeGetSymbols", "getSymbols", "object", "arrayFilter_default", "symbol", "stubArray_default", "getSymbols_default", "copySymbols", "source", "object", "copyObject_default", "getSymbols_default", "copySymbols_default", "nativeGetSymbols", "getSymbolsIn", "object", "result", "arrayPush_default", "getSymbols_default", "getPrototype_default", "stubArray_default", "getSymbolsIn_default", "copySymbolsIn", "source", "object", "copyObject_default", "getSymbolsIn_default", "copySymbolsIn_default", "baseGetAllKeys", "object", "keysFunc", "symbolsFunc", "result", "isArray_default", "arrayPush_default", "baseGetAllKeys_default", "getAllKeys", "object", "baseGetAllKeys_default", "keys_default", "getSymbols_default", "getAllKeys_default", "getAllKeysIn", "object", "baseGetAllKeys_default", "keysIn_default", "getSymbolsIn_default", "getAllKeysIn_default", "DataView", "getNative_default", "root_default", "DataView_default", "Promise", "getNative_default", "root_default", "Promise_default", "Set", "getNative_default", "root_default", "Set_default", "mapTag", "objectTag", "promiseTag", "setTag", "weakMapTag", "dataViewTag", "dataViewCtorString", "toSource_default", "DataView_default", "mapCtorString", "Map_default", "promiseCtorString", "Promise_default", "setCtorString", "Set_default", "weakMapCtorString", "WeakMap_default", "getTag", "baseGetTag_default", "value", "result", "Ctor", "ctorString", "getTag_default", "objectProto", "hasOwnProperty", "initCloneArray", "array", "length", "result", "initCloneArray_default", "Uint8Array", "root_default", "Uint8Array_default", "cloneArrayBuffer", "arrayBuffer", "result", "Uint8Array_default", "cloneArrayBuffer_default", "cloneDataView", "dataView", "isDeep", "buffer", "cloneArrayBuffer_default", "cloneDataView_default", "reFlags", "cloneRegExp", "regexp", "result", "cloneRegExp_default", "symbolProto", "Symbol_default", "symbolValueOf", "cloneSymbol", "symbol", "cloneSymbol_default", "cloneTypedArray", "typedArray", "isDeep", "buffer", "cloneArrayBuffer_default", "cloneTypedArray_default", "boolTag", "dateTag", "mapTag", "numberTag", "regexpTag", "setTag", "stringTag", "symbolTag", "arrayBufferTag", "dataViewTag", "float32Tag", "float64Tag", "int8Tag", "int16Tag", "int32Tag", "uint8Tag", "uint8ClampedTag", "uint16Tag", "uint32Tag", "initCloneByTag", "object", "tag", "isDeep", "Ctor", "cloneArrayBuffer_default", "cloneDataView_default", "cloneTypedArray_default", "cloneRegExp_default", "cloneSymbol_default", "initCloneByTag_default", "initCloneObject", "object", "isPrototype_default", "baseCreate_default", "getPrototype_default", "initCloneObject_default", "mapTag", "baseIsMap", "value", "isObjectLike_default", "getTag_default", "baseIsMap_default", "nodeIsMap", "nodeUtil_default", "isMap", "baseUnary_default", "baseIsMap_default", "isMap_default", "setTag", "baseIsSet", "value", "isObjectLike_default", "getTag_default", "baseIsSet_default", "nodeIsSet", "nodeUtil_default", "isSet", "baseUnary_default", "baseIsSet_default", "isSet_default", "CLONE_DEEP_FLAG", "CLONE_FLAT_FLAG", "CLONE_SYMBOLS_FLAG", "argsTag", "arrayTag", "boolTag", "dateTag", "errorTag", "funcTag", "genTag", "mapTag", "numberTag", "objectTag", "regexpTag", "setTag", "stringTag", "symbolTag", "weakMapTag", "arrayBufferTag", "dataViewTag", "float32Tag", "float64Tag", "int8Tag", "int16Tag", "int32Tag", "uint8Tag", "uint8ClampedTag", "uint16Tag", "uint32Tag", "cloneableTags", "baseClone", "value", "bitmask", "customizer", "key", "object", "stack", "result", "isDeep", "isFlat", "isFull", "isObject_default", "isArr", "isArray_default", "initCloneArray_default", "copyArray_default", "tag", "getTag_default", "isFunc", "isBuffer_default", "cloneBuffer_default", "initCloneObject_default", "copySymbolsIn_default", "baseAssignIn_default", "copySymbols_default", "baseAssign_default", "initCloneByTag_default", "Stack_default", "stacked", "isSet_default", "subValue", "isMap_default", "keysFunc", "getAllKeysIn_default", "getAllKeys_default", "keysIn_default", "keys_default", "props", "arrayEach_default", "assignValue_default", "baseClone_default", "CLONE_DEEP_FLAG", "CLONE_SYMBOLS_FLAG", "cloneDeep", "value", "baseClone_default", "cloneDeep_default", "now", "root_default", "now_default", "FUNC_ERROR_TEXT", "nativeMax", "nativeMin", "debounce", "func", "wait", "options", "lastArgs", "lastThis", "maxWait", "result", "timerId", "lastCallTime", "lastInvokeTime", "leading", "maxing", "trailing", "toNumber_default", "isObject_default", "invokeFunc", "time", "args", "thisArg", "leadingEdge", "timerExpired", "remainingWait", "timeSinceLastCall", "timeSinceLastInvoke", "timeWaiting", "shouldInvoke", "now_default", "trailingEdge", "cancel", "flush", "debounced", "isInvoking", "debounce_default", "FUNC_ERROR_TEXT", "throttle", "func", "wait", "options", "leading", "trailing", "isObject_default", "debounce_default", "throttle_default", "htmlUnescapes", "unescapeHtmlChar", "basePropertyOf_default", "unescapeHtmlChar_default", "reEscapedHtml", "reHasEscapedHtml", "unescape", "string", "toString_default", "unescapeHtmlChar_default", "unescape_default", "FileView", "data", "byteOffset", "byteLength", "index", "length", "text", "Array_to_BEBuffer", "arr", "buf", "dv", "BEBuffer_to_Array", "is_unicode_array", "utf8decoder", "utf8encoder", "IFF", "data", "view", "FileView", "length", "chunk_length", "buffer_length", "chunk", "BLORB_RESOURCE_INDEX_USAGES", "UNKNOWN_IMAGE_TYPE", "Blorb", "data", "options", "iff", "IFF", "iff_chunk", "view", "FileView", "xml", "utf8decoder", "bibliographic", "entry_pattern", "linebreak_pattern", "whitespace_pattern", "result", "tag", "content", "unescape_default", "i", "usage", "resource_number", "text_length", "chunk", "resource_offset", "resource_chunk", "type", "key", "num", "gametype", "get_jpeg_dimensions", "get_png_dimensions", "img", "field", "get_jpeg_dimensions", "data", "view", "FileView", "i", "marker", "chunklength", "get_png_dimensions", "chunktype", "DEFAULT_METRICS", "KEY_CODES_TO_NAMES", "KEY_CODE_DOWN", "KEY_CODE_RETURN", "KEY_CODE_UP", "NBSP", "OFFSCREEN_OFFSET", "PACKAGE_VERSION", "constants_exports", "__export", "evtype_Arrange", "evtype_CharInput", "evtype_Hyperlink", "evtype_LineInput", "evtype_MouseInput", "evtype_None", "evtype_Redraw", "evtype_SoundNotify", "evtype_Timer", "evtype_VolumeNotify", "filemode_Read", "filemode_ReadWrite", "filemode_Write", "filemode_WriteAppend", "fileusage_BinaryMode", "fileusage_Data", "fileusage_InputRecord", "fileusage_SavedGame", "fileusage_TextMode", "fileusage_Transcript", "fileusage_TypeMask", "gestalt_CharInput", "gestalt_CharOutput", "gestalt_CharOutput_ApproxPrint", "gestalt_CharOutput_CannotPrint", "gestalt_CharOutput_ExactPrint", "gestalt_DateTime", "gestalt_DrawImage", "gestalt_GarglkText", "gestalt_Graphics", "gestalt_GraphicsCharInput", "gestalt_GraphicsTransparency", "gestalt_HyperlinkInput", "gestalt_Hyperlinks", "gestalt_LineInput", "gestalt_LineInputEcho", "gestalt_LineTerminatorKey", "gestalt_LineTerminators", "gestalt_MouseInput", "gestalt_ResourceStream", "gestalt_Sound", "gestalt_Sound2", "gestalt_SoundMusic", "gestalt_SoundNotify", "gestalt_SoundVolume", "gestalt_Timer", "gestalt_Unicode", "gestalt_UnicodeNorm", "gestalt_Version", "imagealign_InlineCenter", "imagealign_InlineDown", "imagealign_InlineUp", "imagealign_MarginLeft", "imagealign_MarginRight", "keycode_Delete", "keycode_Down", "keycode_End", "keycode_Escape", "keycode_Func1", "keycode_Func10", "keycode_Func11", "keycode_Func12", "keycode_Func2", "keycode_Func3", "keycode_Func4", "keycode_Func5", "keycode_Func6", "keycode_Func7", "keycode_Func8", "keycode_Func9", "keycode_Home", "keycode_Left", "keycode_MAXVAL", "keycode_PageDown", "keycode_PageUp", "keycode_Return", "keycode_Right", "keycode_Tab", "keycode_Unknown", "keycode_Up", "seekmode_Current", "seekmode_End", "seekmode_Start", "style_Alert", "style_BlockQuote", "style_Emphasized", "style_Header", "style_Input", "style_NUMSTYLES", "style_Normal", "style_Note", "style_Preformatted", "style_Subheader", "style_User1", "style_User2", "stylehint_BackColor", "stylehint_Indentation", "stylehint_Justification", "stylehint_NUMHINTS", "stylehint_Oblique", "stylehint_ParaIndentation", "stylehint_Proportional", "stylehint_ReverseColor", "stylehint_Size", "stylehint_TextColor", "stylehint_Weight", "stylehint_just_Centered", "stylehint_just_LeftFlush", "stylehint_just_LeftRight", "stylehint_just_RightFlush", "winmethod_Above", "winmethod_Below", "winmethod_Border", "winmethod_BorderMask", "winmethod_DirMask", "winmethod_DivisionMask", "winmethod_Fixed", "winmethod_Left", "winmethod_NoBorder", "winmethod_Proportional", "winmethod_Right", "wintype_AllTypes", "wintype_Blank", "wintype_Graphics", "wintype_Pair", "wintype_TextBuffer", "wintype_TextGrid", "zcolor_Current", "zcolor_Default", "FileBuffer", "buf", "binary", "fref", "is_unicode_array", "Array_to_BEBuffer", "text", "utf8encoder", "CachingDialogWrapper", "Dialog", "debounce_default", "filename", "filebuf", "fstream", "_options", "length", "_fref", "_content", "content", "signature", "snapshot", "usage", "gameid", "name", "save", "callback", "copy_array", "source", "target", "length", "copy_length", "i", "FileRef", "Dialog", "filename", "dialog_fref", "rock", "usage", "buf", "filebuf", "FileBuffer", "DidNotReturn", "GLK_NULL", "MAX_LATIN1", "QUESTION_MARK", "CSS_STYLE_PROPERTIES", "FILE_MODES", "FILE_TYPES", "IMAGE_ALIGNMENTS", "KEY_NAMES_TO_CODES", "STYLE_NAMES", "TERMINATOR_KEYS", "TERMINATOR_KEYS_TO_CODES", "StreamBase", "fmode", "rock", "result", "_buf", "_unicode", "_mode", "_pos", "ArrayBackedStream", "buf", "close_cb", "is_unicode_array", "increase", "read_length", "i", "ch", "MAX_LATIN1", "QUESTION_MARK", "unicode", "check_unicode", "GLK_NULL", "uni", "buf_length", "write_length", "str", "mode", "pos", "FileStream", "fref", "end_pos", "maxlen", "old_buf", "NullStream", "_uni", "_ch", "_style", "WindowStream", "win", "style", "name", "val", "WindowBase", "rock", "WindowStream", "_str", "_style", "_name", "_val", "input_update", "copy_prop", "box", "BlankWindow", "TextWindow", "stylehints", "update", "input", "BufferWindow", "clone_textrun", "BASE_TEXTRUN", "clone_styles", "force", "img", "str", "style", "old_style", "i", "line", "name", "val", "paragraphs", "par", "cleanup_paragraph_styles", "text", "GraphicsWindow", "op", "GridWindow", "height", "ch", "width", "oldheight", "oldwidth", "blank_space", "new_line", "c", "rows_to_fix", "index", "acc", "cur", "last", "PairWindow", "keywin", "method", "size", "tr", "new_text", "from", "to", "prop", "RefBox", "val", "RefStruct", "index", "AsyncGlk", "DEFAULT_METRICS", "PACKAGE_VERSION", "constants_exports", "DidNotReturn", "options", "CachingDialogWrapper", "glkote_options", "id", "msg", "class_name", "_state", "state", "contents", "inputs", "sizes", "win", "update", "input_update", "timer", "cloneDeep_default", "arr", "_all_bytes", "str", "buf", "initlen", "buffer_transformer", "lowerrest", "prev", "ch", "special_cases", "slightly_less_special_cases", "thischar", "ev", "set_event", "factor", "struct", "timestamp_to_time_struct", "date_struct_to_timestamp_local", "date_struct_to_timestamp_utc", "datestruct", "timestruct", "usage", "filename", "rock", "fixed_filename", "fmode", "filemode", "FILE_MODES", "filetypenum", "filetype", "FILE_TYPES", "oldfref", "filetypename", "dialog_fref", "fref", "next", "rockbox", "next_fref", "sel", "hook_res", "wrap_for_array", "imgid", "val1", "val2", "info", "width", "height", "msecs", "_rock", "_volume", "_schannel", "_sound", "_repeats", "_notify", "_schannels", "_sounds", "__duration", "notify", "now", "style", "STYLE_NAMES", "keycodes", "terminators", "code", "TERMINATOR_KEYS", "_load", "result", "next_stream", "mode", "filenum", "pos", "seekmode", "_win", "_style1", "_style2", "_style", "_hint", "wintype", "hint", "selector", "remove_style", "styles", "CSS_STYLE_PROPERTIES", "value", "stylehints", "justifications", "weights", "stylevalue", "colour_code_to_css", "time", "timestamp_to_date_struct_local", "timestamp_to_date_struct_utc", "time_struct_to_timestamp", "stats", "parent_win", "sibling_win", "grandparent_win", "left", "top", "colour", "method", "size", "keywin", "parent", "widthbox", "heightbox", "metrics", "normalise_window_dimension", "next_window", "xpos", "ypos", "splitwin", "division", "direction", "BlankWindow", "GraphicsWindow", "BufferWindow", "GridWindow", "pairwin", "PairWindow", "oldparent", "win_parent", "new_dir", "new_vertical", "new_fixed", "new_backward", "temp_win", "stream", "fg", "bg", "type", "normalise_metrics", "KEY_NAMES_TO_CODES", "signature", "FileRef", "unicode", "data", "create_stream_from_buffer", "typed_array", "common_cb", "new_arr", "ArrayBackedStream", "copy_array", "NullStream", "chunk", "imginfo", "IMAGE_ALIGNMENTS", "input", "termkey", "input_buf", "terminator", "TERMINATOR_KEYS_TO_CODES", "box", "boxheight", "boxwidth", "min", "max", "splitwidth", "diff", "split", "box1", "box2", "recurse", "uni", "func", "dont_reduce", "utf32_array", "new_str", "newbuf", "newlen", "binary", "BEBuffer_to_Array", "text", "utf8decoder", "FileStream", "date", "normalised_metrics", "timestamp", "microsecs", "res", "GlkOteBase", "PACKAGE_VERSION", "DEFAULT_METRICS", "options", "error", "value", "name", "msg", "val", "data", "err", "replyfunc", "ref", "ex", "ev", "colour", "create", "tag", "className", "DOM", "options", "id", "props", "is_pinch_zoomed", "get_size", "el", "metrics_differ", "newmetrics", "oldmetrics", "ios15_0", "Metrics", "glkote", "throttle_default", "is_pinch_zoomed", "gameport", "input_is_active", "resolve", "dom", "layout_test_pane", "line", "create", "bufwin", "bufinnerwin", "bufline1", "bufline2", "bufspan", "graphwin", "graphcanvas", "gridwin", "gridline1", "gridline2", "gridspan", "font_family", "bufwinsize", "bufspansize", "bufline1size", "bufline2size", "graphicswinsize", "canvassize", "gridwinsize", "gridspansize", "gridline1size", "gridline2size", "TranscriptRecorder", "options", "windows", "state", "ev", "event", "eventtype", "input", "output", "update", "win", "textdata", "data", "content", "run_index", "instruction", "response", "err", "MAX_HISTORY_LENGTH", "TextInput", "window", "ev", "scroll_window", "is_pinch_zoomed", "char", "keycode", "KEY_CODE_DOWN", "KEY_CODE_UP", "history", "changed", "terminator", "KEY_CODES_TO_NAMES", "code", "KEY_CODE_RETURN", "OFFSCREEN_OFFSET", "inputparent", "val", "update", "metrics", "css_styles", "reverse", "apply_text_run_styles", "throttle_default", "do_scroll", "count", "no_text_selected", "WindowBase", "options", "window_types", "ev", "TextInput", "remove_frame", "apply_text_run_styles", "orig_styles", "reverse", "el", "styles", "bg", "fg", "split_after_spaces", "text", "res", "whitespace", "prev_whitespace", "c", "is_whitespace", "TextualWindow", "onlink", "target", "windowid", "selector", "original_styles", "full_selector", "css_styles", "reverse_styles", "normal_styles", "rule", "properties", "property", "name", "value", "run", "split_words", "run_style", "monospace_val", "monospace_class", "create", "els", "linkval", "styles_need_refreshing", "inline_alignment_classes", "BufferWindow", "frameel", "_", "rect", "after_metrics_change", "data", "line_index", "line", "content", "divel", "line_has_style", "NBSP", "run_index", "instruction", "is_pinch_zoomed", "GraphicsWindow", "debounce_default", "key", "url", "image", "height", "width", "dPR", "buffercontext", "frame", "loading_images", "op", "GridWindow", "lineel", "i", "window_classes", "Windows", "glkote", "windows", "window", "win", "testRO", "entries", "newinputs", "entry", "box", "update", "id", "type", "windowstoclose", "oldgen", "WebGlkOte", "GlkOteBase", "DOM", "throttle_default", "Metrics", "Windows", "options", "windowport", "viewport_meta_tag_content", "query_feedback", "cookie_name", "TranscriptRecorder", "err", "data", "win", "winid", "colour", "windows", "disable", "errorpane", "link", "error", "msg", "errorcontent", "name", "loadingpane", "graphics_bg", "ev", "val", "content", "pairStrings", "lookupE", "lookupD", "pairString", "r", "encodeRepertoire", "pair", "first", "last", "codePoint", "numZBits", "chr", "z", "encode", "uint8Array", "length", "str", "i", "uint8", "j", "bit", "decode", "numUint8s", "numUint8Bits", "utf_decoder", "utf_encoder", "String_to_Uint8Array", "str", "ch", "Dialog", "dialog_el_id", "is_open", "dialog_callback", "will_save", "confirming", "editing", "editing_dirent", "cur_usage", "cur_usage_name", "cur_gameid", "cur_filelist", "dialog_init", "version", "key", "value", "encode", "data", "dialog_open", "tosave", "usage", "gameid", "callback", "Storage", "label_for_usage", "root_el_id", "iface", "rootel", "screen", "frame", "dia", "form", "el", "row", "evhan_accept_save_button", "evhan_accept_load_button", "evhan_edit_button", "evhan_cancel_button", "evhan_delete_button", "evhan_display_button", "evhan_storage_changed", "focusfunc", "defer_func", "dialog_close", "set_caption", "msg", "isupper", "elid", "val", "usage_is_textual", "func", "evhan_select_change", "selel", "pos", "file", "fel", "evhan_select_change_editing", "butel", "file_ref_exists", "ev", "filename", "dirent", "file_construct_ref", "file_remove_ref", "bodyel", "dat", "file_read", "textel", "b64dat", "linkel", "ls", "files_list", "f1", "f2", "lastusage", "ix", "anyselected", "datestr", "format_date", "file_clean_fixed_name", "ref", "file_construct_temp_ref", "timestamp", "file_decode_ref", "dirkey", "oldpos", "conkey", "file_load_dirent", "statstring", "file_write", "content", "israw", "err1", "err2", "decode", "file_notimplemented", "file_ref_matches", "keyls", "date", "day", "time", "autosave_write", "signature", "snapshot", "key_meta", "key_ram", "saved_signature", "autosave_read", "ram", "autosave_clear", "htmlLocalStorage", "dialog_default", "Glk", "VM", "Blorb", "Dialog", "GiDispa", "GlkOte", "support", "option_exit_warning", "option_do_vm_autosave", "option_before_select_hook", "option_extevent_hook", "option_glk_gestalt_hook", "has_exited", "ui_disabled", "ui_specialinput", "ui_specialcallback", "event_generation", "current_partial_inputs", "current_partial_outputs", "init", "vm_options", "accept_ui_event", "obj", "box", "qlog", "content_metrics", "item", "res", "gli_timer_started", "Const", "handle_external_input", "handle_hyperlink_input", "handle_mouse_input", "handle_char_input", "handle_line_input", "gli_rootwin", "gli_window_rearrange", "handle_arrange_input", "handle_redraw_input", "gli_fileref_create_by_prompt_callback", "gli_selectref", "val1", "val2", "disprock", "val", "win", "gli_windowlist", "xpos", "ypos", "input", "charval", "KeystrokeNameMap", "termkey", "ix", "gli_set_style", "gli_window_put_string", "glk_put_jstring_stream", "termcode", "update", "dataobj", "winarray", "contentarray", "inputarray", "robj", "useobj", "lineobj", "ls", "cx", "initial", "lastpos", "geometry_changed", "clone_stylehints", "gli_window_buffer_deaccumulate", "laststyle", "lasthyperlink", "lastfg", "lastbg", "lastreverse", "StyleNameMap", "clearedat", "drawel", "setcol", "gli_window_grid_canonicalize", "gli_timer_lastsent", "gli_timer_interval", "current_page_pg", "stylehints", "last_page_bg", "gli_autorestore_glkstate", "eventarg", "get_library", "save_allstate", "gli_currentstr", "info", "ln", "str", "gli_streamlist", "strtype_Window", "strtype_Memory", "strtype_Resource", "strtype_File", "gli_stream_flush_file", "fref", "gli_filereflist", "restore_allstate", "restore_stylehints", "jx", "el", "tempref", "content", "glk_request_timer_events", "fatal_error", "msg", "KeystrokeValueMap", "FileTypeMap", "unicode_upper_table", "map", "unicode_lower_table", "unicode_title_table", "unicode_decomp_table", "unicode_combin_table", "unicode_compo_table", "CharToString", "TrimArrayToBytes", "arr", "newarr", "len", "ByteArrayToString", "UniArrayToString", "UniArrayToUTF8", "count", "UniArrayToBE32", "RefBox", "RefStruct", "pos", "DidNotReturn", "call_may_not_return", "id", "gli_schannellist", "gli_api_display_rocks", "gli_new_window", "type", "rock", "gli_stream_open_window", "gli_delete_window", "prev", "next", "gli_delete_stream", "gli_windows_unechostream", "ch", "conta", "stylename", "text", "gli_window_buffer_put_special", "special", "flowbreak", "gli_window_close", "recurse", "wx", "width", "height", "oldwidth", "oldheight", "min", "max", "diff", "split", "splitwid", "box1", "box2", "ch1", "ch2", "gli_new_stream", "readable", "writable", "gli_stream_dirty_file", "gli_new_fileref", "filename", "usage", "ref", "gameid", "gli_delete_fileref", "gli_put_char", "arr8", "buf", "gli_put_array", "allbytes", "gli_get_char", "want_unicode", "val0", "val3", "gli_get_line", "lx", "gotnewline", "gli_get_buffer", "gli_stream_fill_result", "result", "glk_put_jstring", "gli_set_hyperlink", "glk_exit", "glk_tick", "glk_gestalt", "sel", "glk_gestalt_ext", "glk_window_iterate", "rockref", "glk_window_get_rock", "glk_window_get_root", "glk_window_open", "splitwin", "method", "size", "wintype", "oldparent", "pairwin", "newwin", "glk_window_close", "statsref", "grandparwin", "sibwin", "keydamage_flag", "glk_window_get_size", "widthref", "heightref", "wid", "hgt", "boxwidth", "boxheight", "glk_window_set_arrangement", "keywin", "newdir", "newvertical", "newbackward", "glk_window_get_arrangement", "methodref", "sizeref", "keywinref", "glk_window_get_type", "glk_window_get_parent", "glk_window_clear", "glk_window_move_cursor", "glk_window_get_stream", "glk_window_set_echo_stream", "glk_window_get_echo_stream", "glk_set_window", "glk_window_get_sibling", "parent", "glk_stream_iterate", "glk_stream_get_rock", "glk_stream_open_file", "fmode", "fstream", "glk_stream_open_memory", "glk_stream_open_resource", "filenum", "isbinary", "glk_stream_open_resource_uni", "glk_stream_close", "glk_stream_set_position", "seekmode", "glk_stream_get_position", "glk_stream_set_current", "glk_stream_get_current", "glk_fileref_create_temp", "filetype", "filetypename", "glk_fileref_create_by_name", "glk_fileref_create_by_prompt", "modename", "callback", "glk_fileref_destroy", "glk_fileref_iterate", "glk_fileref_get_rock", "glk_fileref_delete_file", "glk_fileref_does_file_exist", "glk_fileref_create_from_fileref", "oldfref", "glk_put_char", "glk_put_char_stream", "glk_put_string", "glk_put_string_stream", "glk_put_buffer", "glk_put_buffer_stream", "glk_set_style", "glk_set_style_stream", "glk_get_char_stream", "glk_get_line_stream", "glk_get_buffer_stream", "glk_char_to_lower", "glk_char_to_upper", "newstylehints", "selector", "styles", "STYLE_NAMES", "CSS_STYLE_PROPERTIES", "stylenum", "stylehint", "css_style", "value", "glk_stylehint_set", "style", "hint", "add_css_style", "stylevalue", "justifications", "weights", "glk_stylehint_clear", "remove_style", "glk_style_distinguish", "glk_style_measure", "styl", "resultref", "garglk_set_zcolors", "fg", "bg", "garglk_set_zcolors_stream", "garglk_set_reversevideo", "reverse", "garglk_set_reversevideo_stream", "glk_select", "eventref", "glk_select_poll", "now", "glk_request_line_event", "initlen", "glk_cancel_line_event", "glk_request_char_event", "glk_cancel_char_event", "glk_set_echo_line_event", "glk_set_terminators_line_event", "glk_request_mouse_event", "glk_cancel_mouse_event", "msec", "glk_image_get_info", "imgid", "glk_image_draw", "img", "alignment", "glk_image_draw_scaled", "glk_window_flow_break", "glk_window_erase_rect", "left", "top", "glk_window_fill_rect", "color", "colstr", "gli_color_to_css", "glk_window_set_background_color", "glk_schannel_iterate", "schan", "glk_schannel_get_rock", "glk_schannel_create", "glk_schannel_destroy", "glk_schannel_play", "glk_schannel_play_ext", "glk_schannel_stop", "glk_schannel_set_volume", "glk_sound_load_hint", "glk_schannel_create_ext", "glk_schannel_play_multi", "glk_schannel_pause", "glk_schannel_unpause", "glk_schannel_set_volume_ext", "glk_set_hyperlink", "glk_set_hyperlink_stream", "glk_request_hyperlink_event", "glk_cancel_hyperlink_event", "glk_buffer_to_lower_case_uni", "numchars", "origval", "arrlen", "src", "glk_buffer_to_upper_case_uni", "glk_buffer_to_title_case_uni", "lowerrest", "gli_buffer_canon_decompose_uni", "grpstart", "grpend", "kx", "tmp", "gli_buffer_canon_compose_uni", "curch", "newch", "curclass", "newclass", "glk_buffer_canon_decompose_uni", "glk_buffer_canon_normalize_uni", "glk_put_char_uni", "glk_put_string_uni", "glk_put_buffer_uni", "glk_put_char_stream_uni", "glk_put_string_stream_uni", "glk_put_buffer_stream_uni", "glk_get_char_stream_uni", "glk_get_buffer_stream_uni", "glk_get_line_stream_uni", "glk_stream_open_file_uni", "glk_stream_open_memory_uni", "glk_request_char_event_uni", "glk_request_line_event_uni", "glk_current_time", "timevalref", "usec", "glk_current_simple_time", "factor", "glk_time_to_date_utc", "dateref", "glk_time_to_date_local", "glk_simple_time_to_date_utc", "time", "glk_simple_time_to_date_local", "glk_date_to_time_utc", "glk_date_to_time_local", "glk_date_to_simple_time_utc", "glk_date_to_simple_time_local", "glkapi_default", "get_default_options", "dialog_default", "glkapi_default", "WebGlkOte", "get_query_options", "possible_query_options", "query", "options", "option", "fetch_storyfile", "options", "url", "story_url", "story_domain", "same_domain", "proxy_url", "response", "data", "buffer", "parse_base64", "direct_access", "domain", "text", "matched", "fetch_vm_resource", "path", "data_type", "read_uploaded_file", "file", "resolve", "reject", "reader", "generic_emglken_vm", "options", "requires", "file_data", "engine", "wasmBinary", "vm_options", "vm", "formats", "quixe", "data_array", "zvm", "find_format", "format", "path", "formatspec", "identify_blorb_storyfile_format", "blorb", "blorb_chunks", "chunktype", "ParchmentLauncher", "parchment_options", "get_default_options", "get_query_options", "AsyncGlk", "theme", "api", "storyfile_path", "event", "file", "err", "story", "format", "find_format", "blorb", "fetch_storyfile", "Blorb", "identify_blorb_storyfile_format", "engine", "requires", "path", "fetch_vm_resource", "options", "view", "FileView", "read_uploaded_file", "url", "new_url", "parchment"]
}

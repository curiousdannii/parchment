/*

Parchment
=========

Built: 2011-11-06

Copyright (c) 2008-2011 The Parchment Contributors
BSD licenced
http://code.google.com/p/parchment

*/
jQuery.ajaxSetup({cache:1,converters:{"* binary":true}});jQuery.ajaxPrefilter("script",function(a){if(a.isLocal){a.crossDomain=1}});var parchment={options:{container:"#parchment",lib_path:"lib/",page_title:1,panels:["search","url","about"],proxy_url:"http://zcode.appspot.com/proxy/",width:80},lib:{}};(function(){var a=false,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;Object.subClass=function(g){var f=this.prototype,e=f,d,c;a=true;e=new this();a=false;for(d in g){e[d]=typeof g[d]=="function"&&typeof f[d]=="function"&&b.test(g[d])?(function(h,i){return function(){var k=this._super,j;this._super=f[h];j=i.apply(this,arguments);this._super=k;return j}})(d,g[d]):g[d]}c=e.init?function(){if(!a){this.init.apply(this,arguments)}}:function(){};c.prototype=e;c.constructor=c;c.subClass=Object.subClass;return c}})();(function(){function b(h,i){return h[i]<<24|h[i+1]<<16|h[i+2]<<8|h[i+3]}function c(h){return[(h>>24)&255,(h>>16)&255,(h>>8)&255,h&255]}function e(h,i){return String.fromCharCode(h[i],h[i+1],h[i+2],h[i+3])}function g(h){return[h.charCodeAt(0),h.charCodeAt(1),h.charCodeAt(2),h.charCodeAt(3)]}var f=Object.subClass({init:function a(k){this.type="";this.chunks=[];if(k){if(e(k,0)!="FORM"){throw new Error("Not an IFF file")}this.type=e(k,8);var j=12,h=k.length;while(j<h){var m=b(k,j+4);if(m<0||(m+j)>h){throw new Error("IFF: Chunk out of range")}this.chunks.push({type:e(k,j),offset:j,data:k.slice(j+8,j+8+m)});j+=8+m;if(m%2){j++}}}},write:function d(){var m=g(this.type);for(var n=0,j=this.chunks.length;n<j;n++){var k=this.chunks[n],o=k.data,h=o.length;m=m.concat(g(k.type),c(h),o);if(h%2){m.push(0)}}return g("FORM").concat(c(m.length),m)}});f.num_from=b;f.num_to_word=c;f.text_from=e;f.text_to_word=g;window.IFF=f})();(function(a){window.FatalError=function(b){this.message=b;this.traceback=this._makeTraceback(arguments.callee);this.onError(this);if(a(".load").length>0){a(".load").detach()}};FatalError.prototype={onError:function(c){var b=c.message;if(typeof c.message=="string"){b=b.entityify()}a("#parchment").append('<div class="error">An error occurred:<br/><pre>'+b+"\n\n"+c.traceback+"</pre></div>");if(window.console){console.error(b)}},_makeTraceback:function(b){var f="";var d=0;var c=100;while(b!=null&&d<c){var g=b.toString();if(!g){f="\n  (anonymous function)"+f}else{var h=g.match(/function (\w*)/);if(!h||!h[1]){f="\n  (anonymous function)"+f}else{f="\n  "+h[1]+f}}try{b=b.caller}catch(i){b=null}d++}if(d==c){f="..."+f}return"Traceback (most recent call last):\n"+f}}})(jQuery);(function(g,e){if(g.execScript){execScript("Function VBCStr(x)\nVBCStr=CStr(x)\nEnd Function\nFunction VBLastAsc(x)\nDim l\nl=LenB(x)\nIf l mod 2 Then\nVBLastAsc=AscB(MidB(x,l,1))\nElse\nVBLastAsc=-1\nEnd If\nEnd Function","VBScript")}var f=/chrome\/(\d+)/i.exec(navigator.userAgent),d=f&&parseInt(f[1])>4,a=function(q,r){var r=r||[],p=0,o;for(o=q.length%8;p<o;++p){r.push(q.charCodeAt(p)&255)}for(o=q.length;p<o;){r.push(q.charCodeAt(p++)&255,q.charCodeAt(p++)&255,q.charCodeAt(p++)&255,q.charCodeAt(p++)&255,q.charCodeAt(p++)&255,q.charCodeAt(p++)&255,q.charCodeAt(p++)&255,q.charCodeAt(p++)&255)}return r},l=function(p,o){return(o||"")+String.fromCharCode.apply(1,p)},h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=(function(){var o=[],p=0;for(;p<h.length;p++){o[h.charAt(p)]=p}return o})(),b=function(t,r){if(g.atob){return a(atob(t),r)}var r=r||[],u,q,p,y,x,w,v,s=0,o=t.length;while(s<o){y=c[t.charAt(s++)];x=c[t.charAt(s++)];w=c[t.charAt(s++)];v=c[t.charAt(s++)];u=(y<<2)+(x>>4);q=((x&15)<<4)+(w>>2);p=((w&3)<<6)+v;r.push(u,q,p)}if(v==64){r.pop()}if(w==64){r.pop()}return r},i=function(t,r){if(g.btoa){return btoa(l(t,r))}var r=r||"",u,q,p,y,x,w,v,s=0,o=t.length;while(s<o){u=t[s++];q=t[s++];p=t[s++];y=u>>2;x=((u&3)<<4)+(q>>4);w=((q&15)<<2)+(p>>6);v=p&63;r+=(h.charAt(y)+h.charAt(x)+h.charAt(w)+h.charAt(v))}if(isNaN(q)){r=r.slice(0,-2)+"=="}else{if(isNaN(p)){r=r.slice(0,-1)+"="}}return r},j=function(t){var u=VBCStr(t),s=VBLastAsc(t),o=[],q=0,p=u.length%4,r;while(q<p){o.push((r=u.charCodeAt(q++))&255,r>>8)}p=u.length;while(q<p){o.push((r=u.charCodeAt(q++))&255,r>>8,(r=u.charCodeAt(q++))&255,r>>8,(r=u.charCodeAt(q++))&255,r>>8,(r=u.charCodeAt(q++))&255,r>>8)}if(s>-1){o.push(s)}return o},m=jQuery.ajaxSettings.xhr(),k={binary:m.overrideMimeType&&!(e.browser.opera&&parseFloat(e.browser.version)<10.5)?"charset":"responseBody" in m?"responseBody":0},n=function(q,t,p){var s,o,r;q=e.trim(q);if(p.mode=="base64"){if(g.atob){r=atob(q);s=a(r)}else{s=b(q)}}else{if(p.mode=="charset"){s=a(q)}else{s=j(p.xhr.responseBody)}}p.responseArray=s;p.responseText=r};m=undefined;e.ajaxPrefilter("binary",function(p,s,q){var r=p.isLocal&&!p.crossDomain&&d?0:k.binary,o=p.xhr;p.xhr=function(){return q.xhr=o.apply(p)};p.binary=r;q.done(n);p.jsonp=false;p.jsonpCallback="processBase64Zcode";q.mode="base64";if(p.url.slice(-3).toLowerCase()==".js"){return"jsonp"}if(r&&!p.crossDomain){return"text"}if(p.legacy){p.url=p.legacy;return"jsonp"}p.data="url="+p.url;p.url=parchment.options.proxy_url;if(r&&e.support.cors){return"text"}p.data+="&encode=base64&callback=pproxy";p.jsonpCallback="pproxy";return"jsonp"});e.ajaxPrefilter("text",function(o,q,p){p.mode=o.binary;if(p.mode=="charset"){o.mimeType="text/plain; charset=x-user-defined"}});g.file={text_to_array:a,array_to_text:l,base64_decode:b,base64_encode:i,support:k}})(window,jQuery);(function(b){var a=this,c='<p><a href="'+location.href+"?story=http://mirror.ifarchive.org/",d=function(e){return c+e.path+'">'+e.desc.entityify()+"</a></p>"};a.gIsIphone=/iPhone|iPod|iPad|Android/i.test(navigator.userAgent);if(b.browser.msie&&parseInt(b.browser.version)<7){b(function(){var f=b("#top-window"),e=function(){f.style.top=document.documentElement.scrollTop+"px"};f.css("position","absolute").resize(e).scroll(e)})}parchment.lib.UI=Object.subClass({init:function(e){this.library=e;this.panels={};this.load_indicator=b('<div class="dialog load"><p>Parchment is loading.<p>&gt; <blink>_</blink></div>')},stylesheet_add:function(){var e=arguments,f;for(f=1;f<e.length;f++){if(document.createStyleSheet){document.createStyleSheet(e[f])}else{b("<link>",{rel:"alternate stylesheet",href:e[f],title:e[0],type:"text/css"}).appendTo("head")[0].disabled=true}}},stylesheet_switch:function(f,e){b('link[rel*="stylesheet"][title="'+f+'"]').each(function(){this.disabled=!e})},load_panels:function(){var e=parchment.options.panels,i,h,g,f=function(){var k=RegExp(h.val().replace(" ","( )?"),"i"),j=b.grep(i,function(l){return k.test(l.path+l.desc)});j=j.slice(0,30);g.html(b.map(j,d).join(""))};if(b.inArray("search",e)!=-1){this.panels.search=b('<div class="panel search"><label for="panel_search">Search the IF Archive for games you can play with Parchment. You might also like to search the <a href="http://ifdb.tads.org">IFDB</a> or the <a href="http://ifwiki.org">IF Wiki</a>.</label><input id="panel_search"><div></div></div>');h=this.panels.search.find("input");g=h.next();h.keydown(function(){h.unbind("keydown");b.getJSON("stories/if-archive.json").done(function(j){i=j;h.keyup(f);f()})})}if(b.inArray("url",e)!=-1){this.panels.url=b('<form class="panel url"><label for="panel_url">You may use Parchment to play any story file on the internet, simply copy its address here:</label><input id="panel_url" name="story"></form>')}this.library.container.append(this.panels[e[0]]);this.panels.active=e[0]}})})(jQuery);(function(g,e){var b=/story=([^;&]+)/,h=/vm=(\w+)/,i=/([-\w\s_]+)(\.[\w]+(\.js)?)?$/,k=/\.js$/,f=function(){throw new FatalError("Parchment could not load the story. Check your connection, and that the URL is correct.")},a=function(){e(".load").detach()};parchment.lib.Story=IFF.subClass({init:function j(r,n){this.title=n;if(r[0]<9){this._super();this.chunks.push({type:"ZCOD",data:r});this.zcode=r}else{if(IFF.text_from(r,0)=="Glul"){this._super();this.chunks.push({type:"GLUL",data:r});this.glulx=r}else{if(IFF.text_from(r,0)=="FORM"){this._super(r);if(this.type=="IFRS"){for(var p=0,m=this.chunks.length;p<m;p++){var q=this.chunks[p].type;if(q=="ZCOD"&&!this.zcode){this.zcode=this.chunks[p].data}else{if(q=="GLUL"&&!this.glulx){this.glulx=this.chunks[p].data}else{if(q=="IFmd"){this.metadata=file.array_to_text(this.chunks[p].data);var o=e(this.metadata);if(o){if(e("title",o)){this.title=e("title",o).text()}if(e("ifid",o)){this.ifid=e("ifid",o).text()}if(e("release",o)){this.release=e("release",o).text()}}}}}}}}}}}});var c=Object.subClass({add:function(l){this[l.ifid]=l;if(l.url){this.url[l.url]=l}},url:{}}),d=Object.subClass({init:function(){this.container=e(parchment.options.container);this.ui=new parchment.lib.UI(this)},load:function(s){var l=this,n=parchment.options,q=b.exec(location.search),m,p=h.exec(location.search),o=0;if(n.lock_story){q=n.default_story;if(!q){throw new FatalError("Story file not specified")}}else{if(n.default_story||q){q=q&&unescape(q[1])||n.default_story}else{return this.ui.load_panels()}}e("#about").remove();e("body").append(l.ui.load_indicator);if(!e.isArray(q)){q=[q,0]}m=q[0];l.url=m;storyName=i.exec(m);storyName=storyName?storyName[1]+" - Parchment":"Parchment";if(n.page_title){g.document.title=storyName}if(p){p=parchment.vms[p[1]]}else{for(;o<parchment.vms.length;o++){if(parchment.vms[o].match.test(m)){p=parchment.vms[o];break}}}if(!p){throw new FatalError("File type is not supported!")}try{this.launch(p,q)}catch(r){throw new FatalError(r)}},launch:function(p,q){var m=this,r=[e.ajax(q[0],{dataType:"binary",legacy:q[1]}).done(function(t,u,s){s.library=m;s.vm=p}).fail(f)],l=[],o=0,n;if(!p.loaded){p.loaded=1;while(o<p.files.length){n=parchment.options.lib_path+p.files[o++];if(k.test(n)){l.push(e.getScript(n))}else{this.ui.stylesheet_add(p.id,n)}}r[1]=e.when.apply(1,l)}e.when.apply(1,r).done(a).done(p.launcher)},stories:new c(),savefiles:{}});parchment.lib.Library=d;parchment.vms=[]})(window,jQuery);var Runner=Object.subClass({init:function(b,d,c){var a=this;this.e=b;this.io=d;this.inputEvent=function(e){b.inputEvent(e)};d.TextInput.callback=this.inputEvent;b.outputEvent=function(e){a.outputEvent(e)};this.inputEvent({code:"load",data:c});this.inputEvent({code:"restart",env:d.env})},outputEvent:function(e){var d=this.e,c=0,a,f,b;this.io.event(e);for(;c<e.length;c++){a=e[c];f=a.code;if(f=="quit"){return}if(f=="save"){this.savefile=a.data;b=1}if(f=="restart"){this.io.target=this.io.container.empty();b=1}if(f=="restore"){a.data=this.savefile;b=1}if(f=="tick"){b=1}}if(b){this.inputEvent(a)}}});var TextGrid=Object.subClass({init:function(b,c){var a=this;this.elem=b.addClass("TextGrid").bind("stream",function(d){a.stream(d.order.data);return false});this.io=c;this.io.TextInput.statuswin=this.elem;this.lines=[];this.styles=[];this.cursor=[0,0];this.blankline=Array(this.io.env.width+1).join(" ")},stream:function(d){var c,a,f,h=this.cursor[0],b=this.cursor[1],k,g,e;for(f=0;f<d.length;f++){c=d[f];a=c.code;if(a=="height"){while(c.lines>this.lines.length){this.lines.push(this.blankline);this.styles.push(Array(this.io.env.width))}if(c.lines<this.lines.length){this.lines.length=c.lines;this.styles.length=c.lines;if(h>c.lines-1){h=0;b=0}}}if(a=="cursor"){h=c.to[0]-1;b=c.to[1]-1}if(a=="get_cursor"){c.pos=[h,b];this.io.input(c)}if(a=="stream"){g=c.text.split("\n");e=0;while(e<g.length){k=this.lines[h];this.lines[h]=k.substr(0,b)+g[e]+k.substr(b+g[e].length);b+=g[e].length;if(++e<g.length){h++;b=0}}}if(a=="eraseline"){this.lines[h]=this.lines[h].slice(0,b)+this.blankline.slice(this.io.env.width-b)}}this.cursor=[h,b];this.elem.html("<tt>"+this.lines.join("</tt><br><tt>")+"</tt>")}});(function(b,c){b.cssHooks.reverse={set:function(f,h){if(h){var d=b(f),g=d.css("color"),e;d.add(d.parents()).each(function(){var i=b(this).css("background-color");if(!e&&i&&i!="transparent"&&i!="inherit"){e=i}});d.css({color:e,"background-color":g})}}};var a=function(h){var d=h.order,g=h.io.structures[d.name]||{node:"span"},f=b("<"+(d.node||g.node)+">").appendTo(h.target).addClass(d.name).css(d.css||{});d.text&&f.html(d.text.replace(/\n/g,"<br>"));if(g.func){g.func(f,h.io)}return false};window.StructIO=Object.subClass({init:function(e){e=b(e);this.container=e;this.target=e;e.bind("stream",a);this.TextInput=new TextInput(this.container);this.structures={main:{node:"div"},status:{node:"div",func:function(h,i){new TextGrid(h,i)}}};var d=b("<tt>00000</tt>").appendTo(e),f=d.width()/5,g=Math.min(Math.floor(e.width()/f),80);d.remove();this.env={width:g};this.charwidth=f;this.width=g*f;e.width(this.width)},event:function(g){var d,h,f,j=this.target,e;for(f=0;f<g.length;f++){d=g[f];h=d.code;if(h=="structures"){d.code=c;b.extend(this.structures,d)}if(h=="find"){this.target=j=b("."+d.name)}if(h=="stream"){(d.to?b("."+d.to):j).trigger({type:"stream",io:this,order:d})}if(h=="clear"){(d.name?b("."+d.name):j).empty().css("background-color",d.css&&d.css["background-color"])}if(h=="read"){d.target=j;this.TextInput.getLine(d)}if(h=="char"){this.TextInput.getChar(d)}}}})})(jQuery);(function(d,e){var g=e(d),f=e(document),c=d.scrollByPages,a,b=d.getSelection||(document.selection&&function(){return document.selection.createRange().text})||function(){return""};if(!c){e(function(){a=parseInt(e("body").css("line-height"))*2});c=function(i){var h=f[0].documentElement.clientHeight,j=h-Math.min(h/10,a);scrollBy(0,j*i)}}d.TextInput=Object.subClass({init:function(h){var j=this,i=e("<input>",{"class":"TextInput",autocapitalize:"off",keydown:function(l){var m=j.keyCode=l.which,k;if(j.mode!="line"){return}if(m==38){j.prev_next(1);k=1}if(m==40){j.prev_next(-1);k=1}if(m==33){c(-1);k=1}if(m==34){c(1);k=1}if(m==13){j.submitLine();k=1}l.stopPropagation();if(k){return false}},keypress:function(k){if(j.mode=="char"){j.charCode=k.which;j.submitChar();return false}},keyup:function(){if(j.mode=="char"){j.submitChar()}}});j.lastinput=e('<span class="lastinput"/>').appendTo(h);f.bind("click.TextInput keydown.TextInput",function(k){if(k.target.nodeName!="INPUT"&&b()==""&&g.scrollTop()+g.height()-i.offset().top>-60){i.focus().trigger(k)}});j.history=[];j.input=i;j.container=h;j.statuswin=e("<div>");j.scrollParent=e(e.browser.webkit?"body":"html")},die:function(){f.unbind(".TextInput")},getLine:function(i){var k=i.target.children().last(),j=this.input,l=this.scrollParent,h;this.order=i;this.mode="line";this.current=0;this.mutable_history=this.history.slice();this.mutable_history.unshift("");h=/^([\s\S]+<br>)(.+?)$/.exec(k.html());if(h){k.html(h[1]);h=e("<span>").html(h[2]).appendTo(k)}else{h=k}j.width(i.target.width()-h.offset().left-h.width()-5).val("").appendTo(k);l.scrollTop(this.lastinput.offset().top-this.statuswin.height()-h.height())},submitLine:function(){var h=this.input.val();this.lastinput.appendTo(this.input.parent());this.input.detach();if(h!=this.history[0]&&/\S/.test(h)){this.history.unshift(h)}f.trigger({type:"TextInput",mode:"line",input:h});this.mode=0;this.order.response=h;this.order.terminator=13;this.callback(this.order)},prev_next:function(l){var h=this.input,i=this.mutable_history,j=this.current,k=j+l;if(k<i.length&&k>=0){i[j]=h.val();h.val(i[k]);this.current=k}},getChar:function(h){this.order=h;this.mode="char";this.keyCode=this.charCode=0;this.input.addClass("CharInput").appendTo(this.container)},submitChar:function(){var j=this.keyCode,h=this.charCode,i={keyCode:j,charCode:h};if(!j&&!h){return}this.input.detach().removeClass("CharInput");f.trigger({type:"TextInput",mode:"char",input:i});this.mode=0;this.order.response=i;this.callback(this.order)}})})(window,jQuery);parchment.vms.quixe={id:"quixe",match:/(ulx|glb|(g|glulx.+)(blorb|blb))(.js)?$/i,files:["prototype.min.js","glkote.min.js","quixe.min.js","../src/quixe/media/i7-glkote.css","../src/quixe/media/dialog.css"],launcher:function(b){var d=b[2],a=d.library,c=new parchment.lib.Story(d.responseArray,storyName),e={inspacing:0,outspacing:0,vm:Quixe,};a.ui.stylesheet_switch("quixe",1);jQuery("#parchment").html('<div id="gameport"><div id="windowport"></div><div id="errorpane" style="display:none;"><div id="errorcontent">...</div></div><div id="layouttestpane">This should not be visible<div id="layouttest_grid" class="WindowFrame GridWindow"><div id="layouttest_gridline" class="GridLine"><span id="layouttest_gridspan" class="Style_normal">12345678</span></div><div id="layouttest_gridline2" class="GridLine"><span class="Style_normal">12345678</span></div></div><div id="layouttest_buffer" class="WindowFrame BufferWindow"><div id="layouttest_bufferline" class="BufferLine"><span id="layouttest_bufferspan" class="Style_normal">12345678</span></div><div id="layouttest_bufferline2" class="BufferLine"><span class="Style_normal">12345678</span></div></div></div></div>');Quixe.prepare(c.glulx,e);Glk.init(e)}};parchment.vms.push(parchment.vms.quixe);parchment.vms.gnusto={id:"gnusto",match:/(z[1-8]|zlb|(z|zcode.+)(blorb|blb))(.js)?$/i,files:["gnusto.min.js"],launcher:function(a){var b=new parchment.lib.Story(a[2].responseArray,storyName);window.engine=new GnustoEngine(window.console&&function(){console.log(msg)}||function(){});window.runner=new GnustoRunner(engine,new StructIO(parchment.options.container),b.zcode)}};parchment.vms.push(parchment.vms.gnusto);var ifvms_launcher=function(a){var b=new parchment.lib.Story(a[2].responseArray,storyName);window.engine=new window[a[2].vm.Class]();window.runner=new Runner(engine,new StructIO(parchment.options.container),b.zcode)};parchment.vms.zvm={id:"zvm",match:/(z[58]|zlb|(z|zcode.+)(blorb|blb))(.js)?$/i,files:["zvm.min.js"],Class:"ZVM",launcher:ifvms_launcher};parchment.vms.push(parchment.vms.zvm);(function(a,b){var c=a.parchment;b(function(){var e=/options=([^;&]+)/.exec(location.search),d;if(a.parchment_options){b.extend(c.options,parchment_options)}if(!c.options.lock_options&&e){b.extend(c.options,b.parseJSON(unescape(e[1])))}d=new c.lib.Library();c.library=d;d.load();if(location.href.indexOf("iplayif.com")!=-1){b.getScript("http://google-analytics.com/ga.js",function(){_gat._getTracker("UA-7949545-3")._trackPageview()})}})})(this,jQuery);(function(b,d){var e=function(f,h){for(var g in h){f[g]=h[g]}return f},c=[-2,65535,0,29,832,957,22944,31775,30624,32767,23254,17969,11627],a=function(f){var g=Math.round((f&31)*8.226)<<16|Math.round(((f&992)>>5)*8.226)<<8|Math.round(((f&31744)>>10)*8.226);g=g.toString(16);while(g.length<6){g="0"+g}return"#"+g};b.ZVMUI=Object.subClass({init:function(f,g){this.e=f;this.buffer="";this.styles={};this.mono=g;this.currentwin=0;this.status=[];f.orders.push({code:"stream",name:"status"},{code:"stream",name:"main"},{code:"find",name:"main"})},clear_window:function(f){this.e.orders.push({code:"clear",name:f?"status":"main",css:e({},this.styles)})},erase_line:function(f){if(f==1){this.flush();this.status.push({code:"eraseline"})}},erase_window:function(f){this.flush();if(f==-1){this.split_window(0);this.clear_window(0)}if(f==-2){this.clear_window(0);this.clear_window(1)}else{this.clear_window(f)}},flush:function(){var f;if(this.buffer!=""){f={code:"stream",css:e({},this.styles),text:this.buffer};if(this.mono){f.node="tt"}(this.currentwin?this.status:this.e.orders).push(f);this.buffer=""}},get_cursor:function(f){this.status.push({code:"get_cursor",addr:f});this.e.act()},set_colour:function(g,f){this.set_true_colour(c[g],c[f])},set_cursor:function(g,f){this.flush();this.status.push({code:"cursor",to:[g,f]})},set_font:function(f){if(f!=1&&f!=4){return 0}var g=this.mono&4?4:1;if(f!=g){this.flush();this.mono^=4}return g},set_style:function(f){var g=this.styles;this.flush();if(f==0){g.reverse=g["font-weight"]=g["font-style"]=d;this.mono&=254}if(f&1){g.reverse=1}if(f&2){g["font-weight"]="bold"}if(f&4){g["font-style"]="italic"}if(f&8){this.mono|=1}},set_true_colour:function(i,g){var h=this.styles,j=h.color,f=h["background-color"];this.flush();if(i==65535){j=d}else{if(i<32768){j=a(i)}}if(g==65535){f=d}else{if(g<32768){f=a(g)}}h.color=j;h["background-color"]=f},set_window:function(f){this.flush();this.currentwin=f;this.e.orders.push({code:"find",name:f?"status":"main"})},split_window:function(f){this.flush();this.status.push({code:"height",lines:f})}})})(this);